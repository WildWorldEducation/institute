<script>
// Import the store.
import { useSkillsStore } from '../../stores/SkillsStore.js';
import { useTagsStore } from '../../stores/TagsStore';
import { useSkillTagsStore } from '../../stores/SkillTagsStore';
import { useUserDetailsStore } from '../../stores/UserDetailsStore.js';

import { useRouter } from 'vue-router';
import LoadingModal from './skill-edit/loadingModal.vue';
import FailsModal from './share-components/FailsModal.vue';
import TooltipBtn from './share-components/TooltipBtn.vue';
export default {
    setup() {
        const userDetailsStore = useUserDetailsStore();
        const skillsStore = useSkillsStore();
        const tagsStore = useTagsStore();
        if (tagsStore.tagsList.length == 0) tagsStore.getTagsList();
        const skillTagsStore = useSkillTagsStore();
        const router = useRouter();
        return {
            skillsStore,
            tagsStore,
            skillTagsStore,
            router,
            userDetailsStore
        };
    },
    data() {
        return {
            skillUrl: this.$route.params.skillUrl,
            skills: [],
            skill: {
                id: '',
                name: '',
                parent: '',
                description: '',
                introduction: '',
                image: '',
                icon: '',
                mastery_requirements: '',
                tags: [],
                type: null,
                level: null,
                order: null,
                url: ''
            },
            filterChecked: false,
            image: '',
            icon: '',
            superSkills: [],
            levels: [
                {
                    id: 'grade_school',
                    name: 'Grade school'
                },
                {
                    id: 'middle_school',
                    name: 'Middle school'
                },
                {
                    id: 'high_school',
                    name: 'High school'
                },
                {
                    id: 'college',
                    name: 'College'
                },
                {
                    id: 'phd',
                    name: 'PhD'
                }
            ],
            // Input relate variable
            showLevelDropDown: false,
            showOrderDropDown: false,
            showLevel: '',
            parentInput: {
                inputText: '',
                suggestSkills: []
            },
            clusterParentInput: {
                inputText: '',
                suggestSuperSkills: []
            },

            // Validate Object for validate purpose
            validate: {
                violated: false,
                name: false,
                description: false,
                introduction: false,
                orphan: false,
                superValidate: false,
                noChild: false
            },
            filters: [],
            // A flag to determine if delete button is hover or not
            deleteButtonHover: false,
            // modals relate states
            showModal: false,
            step1Confirm: false,
            skillNameConfirm: '',
            step2Confirm: false,
            orderArray: Array.from({ length: 20 }, (_, i) => i + 1),
            comment: '',
            isAnotherInstanceOfExistingSkill: false,
            randomNum: 0,
            loadingStatus: '',
            showLoadingModal: false,
            originalSkill: {},
            parentLevel: '',
            showIconSizeWarn: false,
            iconSize: ''
        };
    },
    async mounted() {
        if (this.skillsStore.skillsList.length == 0) {
            await this.skillsStore.getSkillsList();
        }

        this.getParentSkills();
    },
    methods: {
        getParentSkills() {
            for (let i = 0; i < this.skillsStore.skillsList.length; i++) {
                if (this.skillsStore.skillsList[i].url != this.skillUrl) {
                    if (this.skillsStore.skillsList[i].type == 'super') {
                        this.superSkills.push(this.skillsStore.skillsList[i]);
                    }
                    if (this.skillsStore.skillsList[i].type != 'sub') {
                        this.skills.push(this.skillsStore.skillsList[i]);
                    }
                }
            }

            // Allow for there to be no parent.
            this.skills.unshift({ name: 'None', id: 0 });

            // Call this after the above, so that parent field loaded correctly.
            this.getSkill();
        },
        getSkill() {
            fetch('/skills/url/' + this.skillUrl)
                .then(function (response) {
                    return response.json();
                })
                .then((data) => {
                    this.skill = data;
                    this.originalSkill = { ...data };
                    if (this.skill.is_copy_of_skill_id != null) {
                        this.isAnotherInstanceOfExistingSkill = true;
                    }
                })
                .then(() => {
                    $('#summernote-introduction')
                        .summernote({
                            disableDragAndDrop: true,
                            toolbar: [
                                ['font', ['bold', 'underline', 'clear']],
                                ['para', ['ul', 'ol', 'paragraph']],
                                ['view', ['fullscreen', 'codeview', 'help']]
                            ],
                            callbacks: {
                                // To determine if content has changed, to unlock the "Submit" button.
                                onChange: (contents) => {
                                    this.skill.introduction = contents;
                                }
                            }
                        })
                        .summernote('code', this.skill.introduction);

                    $('#summernote-mastery-requirements')
                        .summernote({
                            disableDragAndDrop: true,
                            toolbar: [
                                ['style', ['style']],
                                ['font', ['bold', 'underline', 'clear']],
                                ['para', ['ul', 'ol', 'paragraph']],
                                ['table', ['table']],
                                ['insert', ['link']],
                                ['view', ['fullscreen', 'codeview', 'help']]
                            ],
                            callbacks: {
                                // To determine if content has changed, to unlock the "Submit" button.
                                onChange: (contents) => {
                                    this.skill.mastery_requirements = contents;
                                }
                            }
                        })
                        .summernote('code', this.skill.mastery_requirements);

                    // Background for fullscreen view.
                    $('.note-editor .note-editable').css(
                        'background-color',
                        '#ffffff'
                    );
                    // Levels
                    const skillResult = this.levels.find((level) => {
                        return level.id === this.skill.level;
                    });
                    this.showLevel = skillResult.name;

                    // Parent skill
                    if (this.skill.parent != 0) {
                        const parentResult = this.skills.find((element) => {
                            return element.id === this.skill.parent;
                        });
                        this.parentInput.inputText = parentResult.name;
                        this.clusterParentInput.inputText = parentResult.name;
                    }

                    // Skill image
                    this.image =
                        'https://institute-skill-infobox-image-thumbnails.s3.amazonaws.com/' +
                        this.skill.url;
                    // Skill icon
                    this.icon =
                        'https://institute-skill-icons.s3.us-east-1.amazonaws.com/' +
                        this.skill.url;
                    this.getSkillFilters();
                });
        },
        async getSkillFilters() {
            // Run the GET request.
            if (this.skillTagsStore.skillTagsList.length == 0)
                await this.skillTagsStore.getSkillTagsList();

            for (let i = 0; i < this.skillTagsStore.skillTagsList.length; i++) {
                if (
                    this.skillTagsStore.skillTagsList[i].skill_id ==
                    this.skill.id
                ) {
                    this.filters.push(
                        this.skillTagsStore.skillTagsList[i].tag_id
                    );
                }
            }
        },
        async DeleteSkill() {
            // check confirm state
            if (!this.step1Confirm || !this.step2Confirm) {
                return;
            }

            await this.skillsStore.deleteSkill(this.skill.id);
            // redirect user back to skill list page
            this.router.push('/skills');
        },
        // For image upload.
        onFileChange(e, fileType) {
            var files = e.target.files || e.dataTransfer.files;
            if (!files.length) return;
            if (fileType === 'image') {
                this.createImage(files[0]);
                return;
            }

            if (fileType === 'icon') {
                const fileSize = this.calculateFileSize(files[0].size);
                this.iconSize = fileSize.size + fileSize.unit;

                // if file size is larger than Kilobyte unit we show a warning
                if (fileSize.unit !== 'B' && fileSize.unit !== 'KB') {
                    this.showIconSizeWarn = true;
                    return;
                }

                // if file size is larger than 100 KB we also show the warning
                if (fileSize.size > 100 && fileSize.unit === 'KB') {
                    this.showIconSizeWarn = true;
                    return;
                }
                this.createIcon(files[0]);
                return;
            }
        },
        createImage(file) {
            var image = new Image();
            var reader = new FileReader();
            var vm = this;

            reader.onload = (e) => {
                vm.image = e.target.result;
                this.image = e.target.result;
                this.skill.image = this.image;
            };
            reader.readAsDataURL(file);
        },
        createIcon(file) {
            var image = new Image();
            var reader = new FileReader();
            var vm = this;

            reader.onload = (e) => {
                vm.icon = e.target.result;
                this.icon = e.target.result;
                this.skill.icon = this.icon;
            };
            reader.readAsDataURL(file);
        },
        openImage(elName) {
            // find the file input base on id and manually click them
            const input = document.getElementById(elName);
            input.click();
        },
        deleteImage(type) {
            if (type == 'image') {
                this.image = '';
                return;
            }
            if (type == 'icon') {
                this.icon = '';
                return;
            }
        },
        SubmitFilters() {
            // 1 delete the existing filters.
            fetch('/skill-tags/remove/' + this.skill.id, {
                method: 'DELETE'
                // 2 push the new filters.
            }).then(() => {
                var url = '/skill-tags/add/' + this.skill.id;
                // do stuff with `data`, call second `fetch`
                fetch(url, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        filters: this.filters
                    })
                });
            });
        },
        // If edit is from an admin or editor.
        Submit() {
            // Function to help compare level of parent and new skill.
            // Constraint: Parent cannot be higher level than new skill
            function levelToNumber(level) {
                if (level == 'grade_school') return 1;
                else if (level == 'middle_school') return 2;
                else if (level == 'high_school') return 3;
                else if (level == 'college') return 4;
                else if (level == 'phd') return 5;
            }
            // Determine parent level.
            let parentLevel = levelToNumber(this.parentLevel);
            // Determine new node level.
            let skillLevel = levelToNumber(this.skill.level);
            if (parentLevel > skillLevel) {
                alert(
                    'Child nodes cannot have a lower grade level than parent nodes.'
                );
                return;
            }

            this.showLoadingModal = true;
            // Check if this skill was a super skill with skills, and is being changed to another type.
            if (this.skill.type != 'super') {
                var hasSubSkills = false;
                for (let i = 0; i < this.skillsStore.skillsList.length; i++) {
                    if (
                        this.skillsStore.skillsList[i].type == 'sub' &&
                        this.skillsStore.skillsList[i].parent == this.skill.id
                    ) {
                        hasSubSkills = true;
                    }
                }
                if (hasSubSkills) {
                    this.validate.superValidate = true;
                    this.validate.violated = true;
                    this.closeModal();
                    alert(
                        'Please delete outer cluster nodes belonging to the skill, before changing its type.'
                    );
                }
            }
            // For subskills.
            else if (this.skill.type == 'sub') {
                // Make sure user has assigned a parent skill.
                if (this.skill.parent == 0) {
                    this.validate.orphan = true;
                    this.validate.violated = true;
                    this.closeModal();
                    alert('cluster nodes must have a parent');
                }
                for (let i = 0; i < this.skillsStore.skillsList.length; i++) {
                    // Copy the level from the parent node.
                    if (
                        this.skill.parent == this.skillsStore.skillsList[i].id
                    ) {
                        this.skill.level = this.skillsStore.skillsList[i].level;
                    }
                    // Cant change a skill to be a sub skill, while it has its own child skills.
                    if (
                        this.skillsStore.skillsList[i].parent == this.skill.id
                    ) {
                        this.validate.noChild = true;
                        this.validate.violated = true;
                        this.closeModal();
                        alert(
                            "please delete this node's child skills, before changing it to a cluster child skill"
                        );
                    }
                }
            }

            if (
                this.skill.type != 'domain' &&
                !this.isAnotherInstanceOfExistingSkill
            ) {
                // Update the skill.
                this.skill.mastery_requirements = $(
                    '#summernote-mastery-requirements'
                ).summernote('code');
                this.skill.introduction = $(
                    '#summernote-introduction'
                ).summernote('code');
            }

            if (this.skill.name === '' || this.skill.name === null) {
                this.validate.name = true;
                this.validate.violated = true;
                alert('please enter a skill name');
            }

            // We End function here if any of the validate is violated
            if (this.validate.violated) {
                this.closeModal();
                return;
            }

            this.skill.url = this.skill.name.replace(/\//g, 'or');
            this.skill.url = this.skill.url.replace(/ /g, '_');

            let updateSkillImage = null;
            if (
                this.image !==
                `https://institute-skill-infobox-image-thumbnails.s3.amazonaws.com/${this.skill.url}`
            ) {
                updateSkillImage = this.image;
            }      

            const requestOptions = {
                method: 'PUT',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    name: this.skill.name,
                    parent: this.skill.parent,
                    description: this.skill.description,
                    introduction: this.skill.introduction,
                    image: updateSkillImage,
                    icon: this.icon,
                    mastery_requirements: this.skill.mastery_requirements,
                    type: this.skill.type,
                    level: this.skill.level,
                    order: this.skill.order,
                    version_number: this.skill.version_number,
                    comment: this.comment,
                    url: this.skill.url
                })
            };

            var url = '/skills/' + this.skill.id + '/edit';
            fetch(url, requestOptions)
                .then((res) => {
                    if (res.ok) {
                        this.loadingStatus = 'success';
                        this.skillsStore.getNestedSkillsList();
                        this.SubmitFilters();
                    } else {
                        this.loadingStatus = 'fails';
                    }
                })
                .then(() => {
                    // Delete flag if exist
                    let dismissFlagId = this.$route.query.dismissFlagId;
                    if (dismissFlagId) {
                        fetch('/content-flags/' + dismissFlagId, {
                            method: 'DELETE'
                        }).finally(() => {
                            this.$router.back();
                        });
                    } else if (this.skill.type == 'domain') {
                        this.router.push('/skills');
                    } else {
                        this.$router.push('/skills/' + this.skill.url);
                    }
                });
        },
        // If edit is from a student or instructor.
        SubmitForReview() {
            // Update the skill.
            this.skill.mastery_requirements = $(
                '#summernote-mastery-requirements'
            ).summernote('code');
            this.skill.introduction = $('#summernote-introduction').summernote(
                'code'
            );

            const requestOptions = {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    userId: this.userDetailsStore.userId,
                    image: this.image,
                    icon: this.icon,
                    mastery_requirements: this.skill.mastery_requirements,
                    introduction: this.skill.introduction,
                    comment: this.comment
                })
            };

            var url = '/skills/' + this.skill.id + '/edit-for-review';
            fetch(url, requestOptions).then(() => {
                alert(
                    `This edit is being submitted for review.\nWe do this to prevent misinformation and sloppy wording from being added. If you would like to become an editor and help with this, please reach out.`
                );
                this.$router.back();
            });
        },
        handleChooseSkillLevel(level) {
            this.showLevelDropDown = false;
            this.showLevel = level.name;
            this.skill.level = level.id;
        },
        handleChooseSkillOrder(order) {
            this.showOrderDropDown = false;
            this.skill.order = order;
        },
        // 2 Method that handle parent dropdown
        getReferenceSkill() {
            // Only show the suggestion if the user type in 2 word
            if (this.parentInput.inputText.length < 2) {
                this.parentInput.suggestSkills = [];
            } else {
                this.parentInput.suggestSkills = this.skills.filter((skill) => {
                    // Lower case so the result wont be case sensitive
                    return skill.name
                        .toLowerCase()
                        .includes(this.parentInput.inputText.toLowerCase());
                });
            }
        },
        handleChooseSuggestSkill(skill) {
            // Need to make sure skill level is not higher than parent level.
            this.parentLevel = skill.level;

            // set form data
            this.skill.parent = skill.id;
            if (this.skill.type != 'sub') {
                //turn off the suggestion drop down
                this.parentInput.suggestSkills = [];
                // set input text
                this.parentInput.inputText = skill.name;
            } else {
                //turn off the suggestion drop down
                this.clusterParentInput.suggestSuperSkills = [];
                // set input text
                this.clusterParentInput.inputText = skill.name;
            }
        },
        // -----------------------------------------
        // 2 method for cluster outer skill type input
        getSuperSkillSuggestion() {
            // Only show the suggestion if the user type in 2 word
            if (this.clusterParentInput.inputText.length < 2) {
                this.clusterParentInput.suggestSuperSkills = [];
            } else {
                this.clusterParentInput.suggestSuperSkills =
                    this.superSkills.filter((skill) => {
                        // Lower case so the result wont be case sensitive
                        return skill.name
                            .toLowerCase()
                            .includes(
                                this.clusterParentInput.inputText.toLowerCase()
                            );
                    });
            }
        },
        handleChooseSuperSkill(skill) {
            this.clusterParentInput.suggestSuperSkills = [];
            this.skill.parent = skill.id;
            this.clusterParentInput.inputText = skill.name;
        },
        handleCancelDeleteSkill() {
            this.showModal = false;
            this.step1Confirm = false;
            this.step2Confirm = false;
            this.skillNameConfirm = '';
        },
        handleConfirmInputChange() {
            if (this.skillNameConfirm == this.skill.name) {
                this.step2Confirm = true;
            } else {
                this.step2Confirm = false;
            }
        },
        closeModal() {
            this.showLoadingModal = false;
        },
        closeIconSizeWarnModal() {
            this.showIconSizeWarn = false;
        },
        calculateFileSize(fileSize) {
            const TerabyteSize = Math.pow(1024, 4);
            const GigaByteSize = Math.pow(1024, 3);
            const MegaByteSize = Math.pow(1024, 2);
            const KiloByteSize = 1024;
            if (fileSize > TerabyteSize) {
                const resultFileSize = Math.round(fileSize / TerabyteSize);
                return {
                    size: resultFileSize,
                    unit: 'TB'
                };
            }

            if (fileSize > GigaByteSize) {
                const resultFileSize = Math.round(fileSize / GigaByteSize);

                return {
                    size: resultFileSize,
                    unit: 'GB'
                };
            }

            if (fileSize > MegaByteSize) {
                const resultFileSize = Math.round(fileSize / MegaByteSize);

                return {
                    size: resultFileSize,
                    unit: 'MB'
                };
            }

            if (fileSize > KiloByteSize) {
                const resultFileSize = Math.round(fileSize / KiloByteSize);

                return {
                    size: resultFileSize,
                    unit: 'KB'
                };
            }

            return {
                size: fileSize,
                unit: 'B'
            };
        }
    },
    components: {
        LoadingModal,
        FailsModal,
        TooltipBtn
    },
    computed: {
        isFormChanged() {
            return (
                this.skill.name !== this.originalSkill.name ||
                this.skill.parent !== this.originalSkill.parent ||
                this.image !== '' ||
                this.skill.type !== this.originalSkill.type ||
                this.skill.level !== this.originalSkill.level ||
                this.skill.mastery_requirements !==
                    this.originalSkill.mastery_requirements
            );
        }
    }
};
</script>

<template>
    <div class="container bg-light rounded p-3">
        <div class="d-flex justify-content-between top-row">
            <h1 class="heading">{{ skill.name }}</h1>
            <!-- Question Bank -->
            <router-link
                v-if="skill.type != 'domain' && skill.type != 'super'"
                class="btn primary-btn me-1"
                :to="'/skills/' + skillUrl + '/question-bank'"
                >Edit Questions&nbsp;
                <!-- Question icon -->
                <svg
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 384 512"
                    width="18"
                    height="20"
                    fill="white"
                >
                    <path
                        d="M192 0c-41.8 0-77.4 26.7-90.5 64L64 64C28.7 64 0 92.7 0 128L0 448c0 35.3 28.7 64 64 64l256 0c35.3 0 64-28.7 64-64l0-320c0-35.3-28.7-64-64-64l-37.5 0C269.4 26.7 233.8 0 192 0zm0 64a32 32 0 1 1 0 64 32 32 0 1 1 0-64zM105.8 229.3c7.9-22.3 29.1-37.3 52.8-37.3l58.3 0c34.9 0 63.1 28.3 63.1 63.1c0 22.6-12.1 43.5-31.7 54.8L216 328.4c-.2 13-10.9 23.6-24 23.6c-13.3 0-24-10.7-24-24l0-13.5c0-8.6 4.6-16.5 12.1-20.8l44.3-25.4c4.7-2.7 7.6-7.7 7.6-13.1c0-8.4-6.8-15.1-15.1-15.1l-58.3 0c-3.4 0-6.4 2.1-7.5 5.3l-.4 1.2c-4.4 12.5-18.2 19-30.6 14.6s-19-18.2-14.6-30.6l.4-1.2zM160 416a32 32 0 1 1 64 0 32 32 0 1 1 -64 0z"
                    />
                </svg>
            </router-link>
        </div>

        <div v-if="!isAnotherInstanceOfExistingSkill">
            <div
                v-if="
                    userDetailsStore.role == 'admin' ||
                    userDetailsStore.role == 'editor'
                "
            >
                <!-- Skill name -->
                <div class="row mt-3">
                    <div class="col-12 col-md-8 col-lg-5 mt-2">
                        <div class="mb-3">
                            <h2 class="secondary-heading h4">Name</h2>
                            <input
                                v-model="skill.name"
                                class="form-control"
                                type="text"
                                placeholder="name"
                            />
                            <div
                                v-if="
                                    validate.name &&
                                    (skill.name == '' || skill.name == null)
                                "
                                class="form-validate"
                            >
                                please enter a skill name
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Skill level -->
                <div class="row">
                    <div v-if="skill.type != 'sub'">
                        <div class="col col-md-8 col-lg-5 mt-2">
                            <!-- Custom Dropdown -->
                            <h2 class="secondary-heading h4">Level</h2>
                            <div class="d-flex flex-column position-relative">
                                <div
                                    :class="[
                                        showLevelDropDown
                                            ? 'custom-select-button-focus '
                                            : 'custom-select-button '
                                    ]"
                                    @click="
                                        showLevelDropDown = !showLevelDropDown
                                    "
                                >
                                    {{ showLevel }}
                                    <span>
                                        <svg
                                            width="20"
                                            height="20"
                                            viewBox="0 0 20 20"
                                            fill="none"
                                            xmlns="http://www.w3.org/2000/svg"
                                        >
                                            <path
                                                d="M14.2929 8.70711C14.9229 8.07714 14.4767 7 13.5858 7H6.41421C5.52331 7 5.07714 8.07714 5.70711 8.70711L9.29289 12.2929C9.68342 12.6834 10.3166 12.6834 10.7071 12.2929L14.2929 8.70711Z"
                                                fill="#344054"
                                            />
                                        </svg>
                                    </span>
                                </div>
                                <div
                                    v-if="showLevelDropDown"
                                    class="custom-dropdown-base"
                                >
                                    <div
                                        v-for="level in levels"
                                        class="custom-dropdown-option"
                                        @click="handleChooseSkillLevel(level)"
                                    >
                                        {{ level.name }}
                                    </div>
                                </div>
                            </div>
                            <!-- End of custom dropdown -->
                        </div>
                    </div>
                </div>
                <!-- Skill Filter Checker -->
                <div v-if="userDetailsStore.role == 'admin'" class="row">
                    <div class="col col-md-8 col-lg-5 mt-2">
                        <div v-if="skill.type != 'sub'">
                            <h2 class="secondary-heading h4">Filters</h2>
                            <div class="col">
                                <label
                                    v-for="tag in tagsStore.tagsList"
                                    class="control control-checkbox"
                                >
                                    <span class="my-auto mx-2 me-4">
                                        {{ tag.name }}</span
                                    >
                                    <input
                                        type="checkbox"
                                        :value="tag.id"
                                        v-model="filters"
                                    />
                                    <div class="control_indicator"></div>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div
            v-if="
                userDetailsStore.role == 'admin' ||
                userDetailsStore.role == 'editor'
            "
        >
            <!-- Skills Types Radio choose -->
            <div class="row">
                <div class="col-12 col-md-8 col-lg-5 mt-2">
                    <h2 class="secondary-heading h4">Node Type</h2>
                    <div class="row p-0 m-0">
                        <div class="form-check col-6 col-md-5 my-2">
                            <label class="control control-checkbox">
                                <span class="my-auto mx-2 me-4 text"
                                    >Regular</span
                                >
                                <input
                                    type="radio"
                                    name="nodeType"
                                    id="regularSkillRadio"
                                    value="regular"
                                    v-model="skill.type"
                                />
                                <div class="control_indicator"></div>
                            </label>
                        </div>
                        <div
                            class="form-check col-6 col-md-5 my-2"
                            v-if="!isAnotherInstanceOfExistingSkill"
                        >
                            <label class="control control-checkbox">
                                <span class="my-auto mx-2 me-4">Category</span>
                                <input
                                    type="radio"
                                    name="nodeType"
                                    id="domainSkillRadio"
                                    value="domain"
                                    v-model="skill.type"
                                />
                                <div class="control_indicator"></div>
                            </label>
                        </div>
                        <div
                            v-if="!isAnotherInstanceOfExistingSkill"
                            class="form-check col-6 col-md-5 my-2"
                        >
                            <label class="control control-checkbox">
                                <span class="my-auto mx-2 me-4"
                                    >Cluster node center</span
                                >
                                <input
                                    type="radio"
                                    name="nodeType"
                                    id="superSkillRadio"
                                    value="super"
                                    v-model="skill.type"
                                />
                                <div class="control_indicator"></div>
                            </label>
                        </div>
                        <div
                            v-if="skill.parent_type == 'super'"
                            class="form-check col-6 col-md-5 my-2"
                        >
                            <label class="control control-checkbox">
                                <span class="my-auto mx-2 me-4"
                                    >Cluster node outer</span
                                >
                                <input
                                    type="radio"
                                    name="nodeType"
                                    id="regularSkillRadio"
                                    value="sub"
                                    v-model="skill.type"
                                />
                                <div class="control_indicator"></div>
                            </label>
                        </div>
                    </div>
                    <div
                        v-if="
                            validate.orphan &&
                            this.skill.type == 'sub' &&
                            this.skill.parent == 0
                        "
                        class="form-validate"
                    >
                        please choose a parent for this skill
                    </div>
                    <div
                        v-if="validate.noChild && this.skill.type == 'sub'"
                        class="form-validate"
                    >
                        please delete this node's child skills, before changing
                        it to a cluster child skill
                    </div>
                </div>
            </div>

            <!-- Parent Typing Dropdown -->
            <div class="row">
                <div class="col-12 col-md-8 col-lg-5 mt-2">
                    <div v-if="skill.type != 'sub'" class="mb-3">
                        <h2 class="secondary-heading h4">Parent</h2>
                        <div class="row mt-3">
                            <div class="col position-relative">
                                <input
                                    id="skill-input"
                                    v-model="parentInput.inputText"
                                    @input="getReferenceSkill"
                                    placeholder="type skill name"
                                />
                                <div
                                    v-if="parentInput.suggestSkills.length > 0"
                                    id="suggest-skills"
                                    class="flex flex-column position-absolute"
                                >
                                    <div
                                        class="suggest-option"
                                        v-for="skill in parentInput.suggestSkills"
                                        @click="handleChooseSuggestSkill(skill)"
                                    >
                                        {{ skill.name }}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- -------------------------------------------------- -->
                    <div v-else class="mb-3">
                        <h2 class="secondary-heading h4">
                            Cluster node center
                        </h2>
                        <div class="row mt-3">
                            <div class="col position-relative">
                                <input
                                    id="skill-input"
                                    v-model="clusterParentInput.inputText"
                                    @input="getSuperSkillSuggestion"
                                    placeholder="type skill name"
                                />
                                <div
                                    v-if="
                                        clusterParentInput.suggestSuperSkills
                                            .length > 0
                                    "
                                    id="suggest-skills"
                                    class="flex flex-column position-absolute"
                                >
                                    <div
                                        class="suggest-option"
                                        v-for="skill in clusterParentInput.suggestSuperSkills"
                                        @click="handleChooseSuggestSkill(skill)"
                                    >
                                        {{ skill.name }}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div v-if="!isAnotherInstanceOfExistingSkill">
            <!-- Image For Skill -->
            <div class="row">
                <!-- Image chooser -->
                <div class="col-8 col-md-3 col-lg-2 mt-2">
                    <div
                        class="mb-3 row d-flex justify-content-center justify-content-md-start w-100"
                    >
                        <div
                            class="d-flex flex-row gap-2 align-items-start my-3"
                        >
                            <h2 class="secondary-heading h4">Image</h2>
                            <TooltipBtn
                                class="mt-1"
                                toolTipText="A detailed image to use on this skill's description page."
                                bubbleWidth="350px"
                                trianglePosition="left"
                                absoluteTop="37px"
                            />
                        </div>
                        <div v-if="!image">
                            <input
                                class="form-control d-none"
                                type="file"
                                accept="image/*"
                                @change="onFileChange($event, 'image')"
                                id="imageFile"
                            />
                            <div class="default-no-img">
                                <div
                                    class="plus-svg"
                                    @click="openImage('imageFile')"
                                >
                                    <!-- The plus Icon On Top Of the avatar -->
                                    <svg
                                        width="33"
                                        height="33"
                                        viewBox="0 0 53 53"
                                        fill="none"
                                        xmlns="http://www.w3.org/2000/svg"
                                    >
                                        <circle
                                            cx="26.5"
                                            cy="26.5"
                                            r="26.5"
                                            fill="#D9D9D9"
                                        />
                                        <g clip-path="url(#clip0_372_11959)">
                                            <path
                                                d="M19.7439 45.0784L19.7439 33.2515L7.93354 33.268C7.40615 33.2671 6.90063 33.0572 6.52771 32.6843C6.15479 32.3114 5.94488 31.8059 5.94396 31.2785L5.93291 21.7174C5.93382 21.1901 6.14373 20.6845 6.51665 20.3116C6.88957 19.9387 7.3951 19.7288 7.92249 19.7279L19.7439 19.7334L19.7439 7.90646C19.7411 7.64223 19.7911 7.38009 19.8909 7.13543C19.9907 6.89076 20.1384 6.66849 20.3252 6.48164C20.5121 6.29479 20.7344 6.14713 20.979 6.0473C21.2237 5.94747 21.4858 5.8975 21.75 5.9003L31.2779 5.92241C31.8053 5.92332 32.3108 6.13322 32.6838 6.50615C33.0567 6.87907 33.2666 7.38459 33.2675 7.91198L33.262 19.7334L45.0889 19.7334C45.615 19.7337 46.1195 19.9428 46.4915 20.3148C46.8635 20.6869 47.0726 21.1913 47.073 21.7174L47.0951 31.2453C47.0948 31.7714 46.8856 32.2759 46.5136 32.6479C46.1416 33.0199 45.6371 33.229 45.111 33.2294L33.262 33.2515L33.2786 45.0618C33.2776 45.5892 33.0677 46.0947 32.6948 46.4677C32.3219 46.8406 31.8164 47.0505 31.289 47.0514L21.7501 47.0846C21.4858 47.0874 21.2237 47.0374 20.979 46.9376C20.7344 46.8377 20.5121 46.6901 20.3252 46.5032C20.1384 46.3164 19.9907 46.0941 19.8909 45.8494C19.7911 45.6048 19.7411 45.3426 19.7439 45.0784Z"
                                                fill="white"
                                            />
                                        </g>
                                        <defs>
                                            <clipPath id="clip0_372_11959">
                                                <rect
                                                    width="37"
                                                    height="37"
                                                    fill="white"
                                                    transform="translate(8 8)"
                                                />
                                            </clipPath>
                                        </defs>
                                    </svg>
                                </div>
                            </div>
                            <p style="font-size: 14px">
                                <em class="text">Maximum file size 2mb</em>
                            </p>
                        </div>
                        <div v-else>
                            <p>
                                <img
                                    :src="image"
                                    height="158"
                                    width="158"
                                    style="background-color: lightgrey"
                                />
                            </p>
                            <p>
                                <button
                                    class="btn red-btn"
                                    @click="deleteImage('image')"
                                >
                                    Remove &nbsp;&nbsp;
                                    <svg
                                        xmlns="http://www.w3.org/2000/svg"
                                        viewBox="0 0 448 512"
                                        width="20"
                                        height="20"
                                        fill="white"
                                    >
                                        <path
                                            d="M135.2 17.7L128 32H32C14.3 32 0 46.3 0 64S14.3 96 32 96H416c17.7 0 32-14.3 32-32s-14.3-32-32-32H320l-7.2-14.3C307.4 6.8 296.3 0 284.2 0H163.8c-12.1 0-23.2 6.8-28.6 17.7zM416 128H32L53.2 467c1.6 25.3 22.6 45 47.9 45H346.9c25.3 0 46.3-19.7 47.9-45L416 128z"
                                        />
                                    </svg>
                                </button>
                            </p>
                        </div>
                        <!-- Using random number otherwise url doesn't change (cache)-->
                        <img
                            id="originalImage"
                            class="d-none"
                            :src="
                                'https://institute-skill-infobox-image-thumbnails.s3.amazonaws.com/' +
                                skillUrl
                            "
                        />
                    </div>
                </div>
            </div>

            <!-- Icon -->
            <div class="row">
                <!-- Image chooser -->
                <div class="col-8 col-md-3 col-lg-2 mt-2">
                    <div
                        class="mb-3 row d-flex justify-content-center justify-content-md-start w-100"
                    >
                        <div
                            class="d-flex flex-row gap-2 align-items-start my-3"
                        >
                            <h2 class="secondary-heading h4">Icon</h2>
                            <TooltipBtn
                                class="mt-1"
                                toolTipText="A simple icon to use in the skill tree."
                                bubbleWidth="350px"
                                trianglePosition="left"
                                absoluteTop="37px"
                            />
                        </div>
                        <div v-if="!icon">
                            <input
                                class="form-control d-none"
                                type="file"
                                accept="image/*"
                                @change="onFileChange($event, 'icon')"
                                id="iconFile"
                            />
                            <div class="default-no-img">
                                <div
                                    class="plus-svg"
                                    @click="openImage('iconFile')"
                                >
                                    <!-- The plus Icon On Top Of the image -->
                                    <svg
                                        width="33"
                                        height="33"
                                        viewBox="0 0 53 53"
                                        fill="none"
                                        xmlns="http://www.w3.org/2000/svg"
                                    >
                                        <circle
                                            cx="26.5"
                                            cy="26.5"
                                            r="26.5"
                                            fill="#D9D9D9"
                                        />
                                        <g clip-path="url(#clip0_372_11959)">
                                            <path
                                                d="M19.7439 45.0784L19.7439 33.2515L7.93354 33.268C7.40615 33.2671 6.90063 33.0572 6.52771 32.6843C6.15479 32.3114 5.94488 31.8059 5.94396 31.2785L5.93291 21.7174C5.93382 21.1901 6.14373 20.6845 6.51665 20.3116C6.88957 19.9387 7.3951 19.7288 7.92249 19.7279L19.7439 19.7334L19.7439 7.90646C19.7411 7.64223 19.7911 7.38009 19.8909 7.13543C19.9907 6.89076 20.1384 6.66849 20.3252 6.48164C20.5121 6.29479 20.7344 6.14713 20.979 6.0473C21.2237 5.94747 21.4858 5.8975 21.75 5.9003L31.2779 5.92241C31.8053 5.92332 32.3108 6.13322 32.6838 6.50615C33.0567 6.87907 33.2666 7.38459 33.2675 7.91198L33.262 19.7334L45.0889 19.7334C45.615 19.7337 46.1195 19.9428 46.4915 20.3148C46.8635 20.6869 47.0726 21.1913 47.073 21.7174L47.0951 31.2453C47.0948 31.7714 46.8856 32.2759 46.5136 32.6479C46.1416 33.0199 45.6371 33.229 45.111 33.2294L33.262 33.2515L33.2786 45.0618C33.2776 45.5892 33.0677 46.0947 32.6948 46.4677C32.3219 46.8406 31.8164 47.0505 31.289 47.0514L21.7501 47.0846C21.4858 47.0874 21.2237 47.0374 20.979 46.9376C20.7344 46.8377 20.5121 46.6901 20.3252 46.5032C20.1384 46.3164 19.9907 46.0941 19.8909 45.8494C19.7911 45.6048 19.7411 45.3426 19.7439 45.0784Z"
                                                fill="white"
                                            />
                                        </g>
                                        <defs>
                                            <clipPath id="clip0_372_11959">
                                                <rect
                                                    width="37"
                                                    height="37"
                                                    fill="white"
                                                    transform="translate(8 8)"
                                                />
                                            </clipPath>
                                        </defs>
                                    </svg>
                                </div>
                            </div>
                            <p style="font-size: 14px">
                                <em class="text">Maximum file size 100kb</em>
                            </p>
                        </div>
                        <div v-else>
                            <p>
                                <img
                                    :src="icon"
                                    height="158"
                                    width="158"
                                    style="background-color: lightgrey"
                                />
                            </p>
                            <div class="mb-2">Icon size: {{ iconSize }}</div>
                            <p>
                                <button
                                    class="btn red-btn"
                                    @click="deleteImage('icon')"
                                >
                                    Remove &nbsp;&nbsp;
                                    <svg
                                        xmlns="http://www.w3.org/2000/svg"
                                        viewBox="0 0 448 512"
                                        width="20"
                                        height="20"
                                        fill="white"
                                    >
                                        <path
                                            d="M135.2 17.7L128 32H32C14.3 32 0 46.3 0 64S14.3 96 32 96H416c17.7 0 32-14.3 32-32s-14.3-32-32-32H320l-7.2-14.3C307.4 6.8 296.3 0 284.2 0H163.8c-12.1 0-23.2 6.8-28.6 17.7zM416 128H32L53.2 467c1.6 25.3 22.6 45 47.9 45H346.9c25.3 0 46.3-19.7 47.9-45L416 128z"
                                        />
                                    </svg>
                                </button>
                            </p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Description -->
            <div v-if="userDetailsStore.role == 'admin'" class="row">
                <div class="col">
                    <div class="mb-3">
                        <h2>Description</h2>
                        <textarea
                            v-model="skill.description"
                            class="form-control"
                            rows="2"
                        ></textarea>
                    </div>
                    <div>
                        <div v-if="validate.description" class="form-validate">
                            please enter description for skill
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col">
                    <div class="mb-3">
                        <h2 class="secondary-heading h4">Introduction</h2>
                        <textarea
                            v-model="skill.introduction"
                            class="form-control"
                            rows="2"
                            id="summernote-introduction"
                        ></textarea>
                    </div>
                    <div>
                        <div v-if="validate.introduction" class="form-validate">
                            please enter introduction for skill
                        </div>
                    </div>
                </div>
            </div>

            <!-- Mastery Requirement summernote -->
            <div v-if="skill.type != 'domain'" class="mb-3">
                <h2 class="secondary-heading h4">Mastery Requirements</h2>

                <textarea
                    class="form-control"
                    v-model="skill.mastery_requirements"
                    id="summernote-mastery-requirements"
                    rows="3"
                ></textarea>
            </div>

            <!-- Order dropdown-->
            <div v-if="userDetailsStore.role == 'admin'" class="row">
                <div class="col col-md-8 col-lg-5 mt-2">
                    <!-- Custom Dropdown -->
                    <label class="form-label"
                        >Order
                        <span style="font-weight: 400"
                            >(optional: 0 is default)</span
                        ></label
                    >
                    <div class="d-flex flex-column position-relative">
                        <div
                            :class="[
                                showOrderDropDown
                                    ? 'custom-select-button-focus '
                                    : 'custom-select-button '
                            ]"
                            @click="showOrderDropDown = !showOrderDropDown"
                        >
                            {{ skill.order }}
                            <span>
                                <svg
                                    width="20"
                                    height="20"
                                    viewBox="0 0 20 20"
                                    fill="none"
                                    xmlns="http://www.w3.org/2000/svg"
                                >
                                    <path
                                        d="M14.2929 8.70711C14.9229 8.07714 14.4767 7 13.5858 7H6.41421C5.52331 7 5.07714 8.07714 5.70711 8.70711L9.29289 12.2929C9.68342 12.6834 10.3166 12.6834 10.7071 12.2929L14.2929 8.70711Z"
                                        fill="#344054"
                                    />
                                </svg>
                            </span>
                        </div>
                        <div
                            v-if="showOrderDropDown"
                            class="custom-dropdown-base"
                        >
                            <div
                                v-for="order in orderArray"
                                class="custom-dropdown-option"
                                @click="handleChooseSkillOrder(order)"
                            >
                                {{ order }}
                            </div>
                        </div>
                    </div>
                    <!-- End of custom dropdown -->
                </div>
            </div>

            <!-- Comment -->
            <div class="row">
                <div class="col">
                    <div class="mb-3">
                        <h2 class="secondary-heading h4">Comment</h2>
                        <textarea
                            v-model="comment"
                            class="form-control"
                            rows="2"
                        ></textarea>
                    </div>
                    <!-- Reason validate message -->
                    <div
                        v-if="comment.length > 255"
                        :class="[
                            shake
                                ? 'click-shake form-validate'
                                : 'form-validate initial-shake'
                        ]"
                    >
                        Your comment has too many words !!
                    </div>
                </div>
            </div>
        </div>
        <div v-else>
            For other edits, please edit the original instance of this skill
        </div>

        <!-- Submit, Delete and cancel button -->
        <div class="row">
            <div class="d-flex justify-content-between">
                <!-- Delete Button -->
                <div
                    v-if="userDetailsStore.role == 'admin'"
                    class="d-flex flex-column"
                >
                    <div id="danger-label-div">
                        <div
                            v-if="deleteButtonHover"
                            id="danger-label"
                            :class="{ shake: deleteButtonHover }"
                        >
                            Danger !!!
                        </div>
                    </div>
                    <div>
                        <button
                            class="btn red-btn"
                            @mouseover="deleteButtonHover = true"
                            @mouseleave="deleteButtonHover = false"
                            @click="showModal = true"
                        >
                            Delete
                            <span class="d-none d-md-block">&nbsp;skill </span>

                            <svg
                                xmlns="http://www.w3.org/2000/svg"
                                viewBox="0 0 448 512"
                                width="20"
                                height="20"
                                fill="white"
                                class="ms-1"
                            >
                                <path
                                    d="M135.2 17.7L128 32H32C14.3 32 0 46.3 0 64S14.3 96 32 96H416c17.7 0 32-14.3 32-32s-14.3-32-32-32H320l-7.2-14.3C307.4 6.8 296.3 0 284.2 0H163.8c-12.1 0-23.2 6.8-28.6 17.7zM416 128H32L53.2 467c1.6 25.3 22.6 45 47.9 45H346.9c25.3 0 46.3-19.7 47.9-45L416 128z"
                                />
                            </svg>
                        </button>
                    </div>
                </div>

                <!-- Cancel and Submit Action Buttons -->
                <div
                    class="d-flex justify-content-end gap-md-4 gap-1 align-items-end"
                >
                    <button class="btn red-btn" @click="$router.go(-1)">
                        <div class="d-none d-md-block">Cancel</div>
                        <!-- Exit Icon-->
                        <svg
                            xmlns="http://www.w3.org/2000/svg"
                            viewBox="0 0 512 512"
                            width="20"
                            height="20"
                            fill="white"
                            class="d-md-none exit-icon"
                        >
                            <path
                                d="M502.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-128-128c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L402.7 224 192 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l210.7 0-73.4 73.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l128-128zM160 96c17.7 0 32-14.3 32-32s-14.3-32-32-32L96 32C43 32 0 75 0 128L0 384c0 53 43 96 96 96l64 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-64 0c-17.7 0-32-14.3-32-32l0-256c0-17.7 14.3-32 32-32l64 0z"
                            />
                        </svg>
                    </button>
                    <button
                        v-if="
                            userDetailsStore.role == 'admin' ||
                            userDetailsStore.role == 'editor'
                        "
                        :disabled="!isFormChanged"
                        class="btn primary-btn"
                        @click="Submit()"
                    >
                        <div class="d-none d-md-block">Submit</div>
                        <!-- Pencil Into Square Icon -->
                        <svg
                            xmlns="http://www.w3.org/2000/svg"
                            viewBox="0 0 512 512"
                            fill="white"
                            height="20"
                            width="20"
                            class="d-md-none"
                        >
                            <path
                                d="M441 58.9L453.1 71c9.4 9.4 9.4 24.6 0 33.9L424 134.1 377.9 88 407 58.9c9.4-9.4 24.6-9.4 33.9 0zM209.8 256.2L344 121.9 390.1 168 255.8 302.2c-2.9 2.9-6.5 5-10.4 6.1l-58.5 16.7 16.7-58.5c1.1-3.9 3.2-7.5 6.1-10.4zM373.1 25L175.8 222.2c-8.7 8.7-15 19.4-18.3 31.1l-28.6 100c-2.4 8.4-.1 17.4 6.1 23.6s15.2 8.5 23.6 6.1l100-28.6c11.8-3.4 22.5-9.7 31.1-18.3L487 138.9c28.1-28.1 28.1-73.7 0-101.8L474.9 25C446.8-3.1 401.2-3.1 373.1 25zM88 64C39.4 64 0 103.4 0 152V424c0 48.6 39.4 88 88 88H360c48.6 0 88-39.4 88-88V312c0-13.3-10.7-24-24-24s-24 10.7-24 24V424c0 22.1-17.9 40-40 40H88c-22.1 0-40-17.9-40-40V152c0-22.1 17.9-40 40-40H200c13.3 0 24-10.7 24-24s-10.7-24-24-24H88z"
                            />
                        </svg>
                    </button>
                    <button
                        v-else-if="
                            userDetailsStore.role == 'instructor' ||
                            userDetailsStore.role == 'student'
                        "
                        class="btn primary-btn"
                        :disabled="!isFormChanged"
                        @click="SubmitForReview()"
                    >
                        <div class="d-none d-md-block">Submit for review</div>
                        <!-- Pencil Into Square Icon -->
                        <svg
                            xmlns="http://www.w3.org/2000/svg"
                            viewBox="0 0 512 512"
                            fill="white"
                            height="20"
                            width="20"
                            class="d-md-none"
                        >
                            <path
                                d="M441 58.9L453.1 71c9.4 9.4 9.4 24.6 0 33.9L424 134.1 377.9 88 407 58.9c9.4-9.4 24.6-9.4 33.9 0zM209.8 256.2L344 121.9 390.1 168 255.8 302.2c-2.9 2.9-6.5 5-10.4 6.1l-58.5 16.7 16.7-58.5c1.1-3.9 3.2-7.5 6.1-10.4zM373.1 25L175.8 222.2c-8.7 8.7-15 19.4-18.3 31.1l-28.6 100c-2.4 8.4-.1 17.4 6.1 23.6s15.2 8.5 23.6 6.1l100-28.6c11.8-3.4 22.5-9.7 31.1-18.3L487 138.9c28.1-28.1 28.1-73.7 0-101.8L474.9 25C446.8-3.1 401.2-3.1 373.1 25zM88 64C39.4 64 0 103.4 0 152V424c0 48.6 39.4 88 88 88H360c48.6 0 88-39.4 88-88V312c0-13.3-10.7-24-24-24s-24 10.7-24 24V424c0 22.1-17.9 40-40 40H88c-22.1 0-40-17.9-40-40V152c0-22.1 17.9-40 40-40H200c13.3 0 24-10.7 24-24s-10.7-24-24-24H88z"
                            />
                        </svg>
                    </button>
                </div>
            </div>
        </div>
    </div>
    <!-- ================ || Modal Components || ================ -->
    <!-- Warning Modal  -->
    <div v-if="showModal" id="myModal" class="modal">
        <!-- Modal content -->
        <div class="modal-content d-flex flex-column">
            <div class="mb-4">Delete "{{ skill.name }}"</div>
            <!-- Warning section  -->
            <div
                v-if="!step1Confirm"
                id="warning-section"
                class="d-flex align-items-center"
            >
                <div class="me-3">
                    <svg
                        xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 512 512"
                        width="15"
                        height="15"
                        fill="#eed888"
                    >
                        <path
                            d="M256 32c14.2 0 27.3 7.5 34.5 19.8l216 368c7.3 12.4 7.3 27.7 .2 40.1S486.3 480 472 480H40c-14.3 0-27.6-7.7-34.7-20.1s-7-27.8 .2-40.1l216-368C228.7 39.5 241.8 32 256 32zm0 128c-13.3 0-24 10.7-24 24V296c0 13.3 10.7 24 24 24s24-10.7 24-24V184c0-13.3-10.7-24-24-24zm32 224a32 32 0 1 0 -64 0 32 32 0 1 0 64 0z"
                        />
                    </svg>
                </div>
                <div>
                    This action will delete this skill and all its nested
                    skills, and is not reversible.
                </div>
            </div>
            <!-- Type Name Confirm -->
            <div v-if="step1Confirm">
                <label for="name" class="conform-label"
                    >Enter "{{ skill.name }}" in the box below to confirm</label
                >
                <input
                    v-model="skillNameConfirm"
                    class="form-control"
                    type="text"
                    placeholder="name"
                    @input="handleConfirmInputChange"
                />
            </div>
            <div class="mt-3 d-flex justify-content-between">
                <button class="btn green-btn" @click="handleCancelDeleteSkill">
                    Cancel
                </button>
                <button
                    v-if="!step1Confirm"
                    class="btn red-btn"
                    @click="step1Confirm = true"
                >
                    I still want to delete this skill
                </button>
                <button
                    v-if="step1Confirm"
                    :class="[
                        step2Confirm ? 'btn red-btn' : 'btn button-inactive'
                    ]"
                    @click="DeleteSkill(skill.id)"
                >
                    Delete skill
                </button>
            </div>
        </div>
    </div>
    <LoadingModal
        :skillUrl="skillUrl"
        :loadingStatus="loadingStatus"
        :showLoadingModal="showLoadingModal"
        :closeModal="closeModal"
    />
    <!-- Warn The User if the node icon is too big -->
    <FailsModal
        v-if="showIconSizeWarn"
        :handleOkClick="closeIconSizeWarnModal"
        :message="`Your icon is too big ! (${iconSize} / 100kb)`"
    />
</template>

<style scoped>
.text {
    color: var(--fifth-colour);
}

.green-btn {
    background-color: #36c1af;
    color: white;
    border: 1px solid #2ca695;
    font-family: 'Inter', sans-serif;
    font-weight: 600;
    font-size: 16px;
    line-height: 24px;
    display: flex;
    align-items: center;
    max-width: fit-content;
}

.green-btn:hover {
    background-color: #65e0a5;
}

.form-label {
    font-family: 'Poppins' sans-serif;
    font-size: 14px;
    font-weight: 600;
    line-height: 20px;
    letter-spacing: 0em;
    text-align: left;
}

.form-control {
    padding: 10px 0px 10px 14px;
    border-radius: 8px;
    border: 1px;
    gap: 8px;
    box-shadow: 0px 1px 2px 0px #1018280d;
    border: 1px solid #f2f4f7;
}

/* ----------------- a lot of css style for all the various input style ----------------------------  */

/* Parent skill input dropdown elements */
#skill-input {
    width: 100%;
    height: 42px;
    padding: 10px 0px 10px 14px;
    border-radius: 8px;
    border: 1px;
    gap: 8px;
    box-shadow: 0px 1px 2px 0px #1018280d;
    border: 1px solid #f2f4f7;
    gap: 8px;
    background: linear-gradient(0deg, #ffffff, #ffffff),
        linear-gradient(0deg, #f2f4f7, #f2f4f7);
    color: #667085;
    box-shadow: 0px 1px 2px 0px #1018280d;
    font-family: 'Poppins' sans-serif;
}

#skill-input:focus {
    outline-color: #667085;
}

#suggest-skills {
    z-index: 10;
    width: 95.5%;
    margin-right: 0px;
    margin-left: auto;
    border-radius: 6.63px;
    border: 0.83px;
    background: linear-gradient(0deg, #ffffff, #ffffff),
        linear-gradient(0deg, #65e0a5, #65e0a5);
    border: 1px solid #f2f4f7;
    border: 0.83px solid #65e0a5;
    box-shadow: 0px 3.317408561706543px 4.9761128425598145px -1.6587042808532715px
        #10182808;
    box-shadow: 0px 9.952225685119629px 13.269634246826172px -3.317408561706543px
        #10182814;
}

.suggest-option {
    height: 36.59px;
    padding: 8.29px 11px 8px 12px;
    gap: 6.63px;
    color: #344054;
}
.suggest-option:hover {
    background: #65e0a51a;
    cursor: pointer;
}
/* End of skill input and suggestion style */

/* =========================== */

/* Style For The Custom Select */
.custom-select-button {
    width: 100%;
    height: 42px;
    padding: 10px 0px 10px 14px;
    border-radius: 8px;
    gap: 8px;
    background: linear-gradient(0deg, #ffffff, #ffffff),
        linear-gradient(0deg, #f2f4f7, #f2f4f7);
    border: 1px solid #f2f4f7;
    box-shadow: 0px 1px 2px 0px #1018280d;
    font-family: 'Poppins' sans-serif;
    font-size: 1rem;
    font-weight: 400;
    line-height: 22px;
    letter-spacing: 0.03em;
    text-align: left;
    display: flex;
}

.custom-select-button-focus {
    width: 100%;
    height: 42px;
    padding: 10px 0px 10px 14px;
    border-radius: 8px;
    gap: 8px;
    background: linear-gradient(0deg, #ffffff, #ffffff),
        linear-gradient(0deg, #f2f4f7, #f2f4f7);
    border: 1px solid #9c7eec;
    box-shadow: 0px 0px 0px 4px #bca3ff4d;
    font-family: 'Poppins' sans-serif;
    font-size: 1rem;
    font-weight: 400;
    line-height: 22px;
    letter-spacing: 0.03em;
    text-align: left;
    display: flex;
}

.custom-select-button:hover {
    cursor: pointer;
    border: 1px solid #9c7eec;
}

.custom-select-button > span {
    margin-right: 2px;
    margin-left: auto;
    animation: rotationBack 0.52s cubic-bezier(0.36, 0.07, 0.19, 0.97) both;
    transform: translate3d(0, 0, 0);
}

.custom-select-button-focus > span {
    margin-right: 2px;
    margin-left: auto;
    animation: rotation 0.52s cubic-bezier(0.36, 0.07, 0.19, 0.97) both;
    transform: translate3d(0, 0, 0);
}

.form-validate {
    font-size: 0.75rem;
    color: red;
    font-weight: 300;
}

/* The animation key frame */
@keyframes rotation {
    from {
        transform: rotate(0deg);
    }
    to {
        transform: rotate(180deg);
    }
}

@keyframes rotationBack {
    from {
        transform: rotate(180deg);
    }
    to {
        transform: rotate(0deg);
    }
}

.custom-select-button-focus:hover {
    cursor: pointer;
}
.custom-dropdown-base {
    border-radius: 8px;
    border: 1px;
    background: linear-gradient(0deg, #ffffff, #ffffff);
    border: 1px solid #9c7eec;
    box-shadow: 0px 4px 6px -2px #10182808;
    box-shadow: 0px 12px 16px -4px #10182814;
    position: absolute;
    z-index: 10;
    width: 100%;
    top: 42px;
}

.custom-dropdown-option {
    padding: 10px 14px 10px 14px;
    gap: 8px;
    color: #344054;
}

.custom-dropdown-option:hover {
    cursor: pointer;
    background: #bca3ff1a;
}
/* End of CSS style for Custom Select */

/**-------------------------------------  */
/* A lot of CSS to styling two check box */
.control {
    font-family: 'Poppins' sans-serif;
    display: block;
    position: relative;
    padding-left: 30px;
    margin-bottom: 5px;
    padding-top: 3px;
    cursor: pointer;
}

.control > span {
    font-weight: 500;
    font-size: 0.938rem;
    color: #667085;
    text-align: center;
}
.control input {
    position: absolute;
    z-index: -1;
    opacity: 0;
}
.control_indicator {
    position: absolute;
    top: 2px;
    left: 0;
    height: 29.09px;
    width: 29.09px;
    background: #f9f5ff;
    border: 1.45px solid #9c7eec;
    border-radius: 8.73px;
}
.control:hover input ~ .control_indicator,
.control input:focus ~ .control_indicator {
    background: #e7ddf6;
}

.plus-svg:hover {
    cursor: pointer;
}
.control input:checked ~ .control_indicator {
    background: #f9f5ff;
}
.control:hover input:not([disabled]):checked ~ .control_indicator,
.control input:checked:focus ~ .control_indicator {
    background: #f9f5ff;
}
.control input:disabled ~ .control_indicator {
    background: #e6e6e6;
    opacity: 0.6;
    pointer-events: none;
}
.control_indicator:after {
    box-sizing: unset;
    content: '';
    position: absolute;
    display: none;
}
.control input:checked ~ .control_indicator:after {
    display: block;
}
.control-checkbox .control_indicator:after {
    left: 4px;
    top: 5px;
    width: 13.58px;
    height: 9.33px;
    border: solid #9c7eec;
    border-width: 0px 0px 2.9px 2.9px;
    transform: rotate(-45deg);
}
.control-checkbox input:disabled ~ .control_indicator:after {
    border-color: #7b7b7b;
}
.control-checkbox .control_indicator::before {
    content: '';
    display: block;
    position: absolute;
    left: 0;
    top: 0;
    width: 4.5rem;
    height: 4.5rem;
    margin-left: -1.3rem;
    margin-top: -1.3rem;
    background: #9c7eec;
    border-radius: 3rem;
    opacity: 0.6;
    z-index: 99999;
    transform: scale(0);
}

.control-checkbox input + .control_indicator::before {
    animation: s-ripple 250ms ease-out;
}
.control-checkbox input:checked + .control_indicator::before {
    animation-name: s-ripple-dup;
}
/* End of check box styling */

/* ------------------------------------------------------------- */
.form-check {
    margin: 0px;
    padding: 0px;
}

/* ================ */
/* Styling for default image */
.default-no-img {
    width: 100%;
    height: 158px;
    background-color: #e6e6e6;
    border-radius: 12px;
    border: #e7ddf6;
}
.plus-svg {
    display: flex;
    justify-content: end;
    padding-right: 10px;
    padding-left: auto;
    padding-bottom: auto;
    padding-top: 10px;
}

/* ================== */
.form-validate {
    font-size: 0.75rem;
    color: red;
    font-weight: 300;
}

#danger-label {
    font-size: 1rem;
    color: red;
    font-weight: 300;
}

/* Shake animation for waring line */
.shake {
    animation: shake 0.82s cubic-bezier(0.36, 0.07, 0.19, 0.97) both;
    transform: translate3d(0, 0, 0);
}

@keyframes shake {
    10%,
    90% {
        transform: translate3d(-1px, 0, 0);
    }

    20%,
    80% {
        transform: translate3d(2px, 0, 0);
    }

    30%,
    50%,
    70% {
        transform: translate3d(-4px, 0, 0);
    }

    40%,
    60% {
        transform: translate3d(4px, 0, 0);
    }
}

/* -- */
#danger-label-div {
    height: 1.5rem;
}

/* The Warning Modal */
.modal {
    display: block;
    /* Hidden by default */
    position: fixed;
    /* Stay in place */
    z-index: 1;
    /* Sit on top */
    left: 0;
    top: 0;
    width: 100%;
    /* Full width */
    height: 100%;
    /* Full height */
    overflow: auto;
    /* Enable scroll if needed */
    background-color: rgb(0, 0, 0);
    /* Fallback color */
    background-color: rgba(0, 0, 0, 0.4);
    /* Black w/ opacity */
}

.modal-content {
    background-color: #fefefe;
    margin: 15% auto;
    /* 15% from the top and centered */
    padding: 20px;
    border: 1px solid #888;
    width: 670px;
    /* Could be more or less, depending on screen size */
}

#warning-section {
    background-color: #fff8c5;
    border-radius: 5px;
    border: 1px solid #eed888;
    padding: 20px 10px;
    margin: 10px 0px;
}

.strong-warning {
    font-weight: 500;
}

.conform-label {
    font-size: 14px;
    font-weight: 400;
    margin-bottom: 4px;
}

.button-inactive {
    background-color: #868888;
    color: white;
    border: 1px solid #868686;
    font-family: 'Inter', sans-serif;
    font-weight: 600;
    font-size: 16px;
    line-height: 24px;
    display: flex;
    align-items: center;
    max-width: fit-content;
}

.button-inactive:hover {
    cursor: not-allowed;
}

/* _-_ End of warning modal styling _-_ */

/* Style specific for phone view */
@media (max-width: 767px) {
    .default-no-img {
        height: 100px;
        width: auto;
    }

    .exit-icon {
        transform: scale(-1, 1);
    }

    .top-row {
        flex-direction: column;
    }
}
</style>
