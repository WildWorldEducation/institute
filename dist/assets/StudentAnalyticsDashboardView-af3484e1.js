import{u as $}from"./AnalyticsStore-dae791b6.js";import{u as P}from"./TeacherAnalyticsStore-00cf311d.js";import{_ as b,o as c,c as m,e as B,r as _,a as e,f as S,k as y,p as f,b as M,j as C,F as j,x as q,t as D}from"./main-e512bfba.js";import{c as H,S as L}from"./StudentProgressChart-c1659278.js";import"./transform-af9a74a2.js";import{u as R,l as N}from"./line-85f04100.js";import{e as V}from"./extent-4cf1c809.js";import{l as T,a as F,b as A,c as U}from"./linear-5b188edc.js";import{m as I,o as z,b as E}from"./continuous-7328829e.js";import{s as w}from"./string-dd82ab4a.js";import{s as O}from"./sort-ed61f96d.js";import"./colors-98f238a0.js";import"./time-0457d93b.js";import"./point-ea70dc51.js";const Y={name:"SchoolTimeChart",props:[],data(){return{axisData:[]}},mounted(){},methods:{createChart(a){if(a.student.length==0)this.axisData=a.tenant;else if(a.tenant.length==0)this.axisData=a.student;else{const n=a.student.reduce((k,x)=>Math.max(k,x.quantity),-1/0),v=a.tenant.reduce((k,x)=>Math.max(k,x.quantity),-1/0);n>=v?this.axisData=a.student:this.axisData=a.tenant}const s=Object.entries(a).map(([n,v])=>({name:n,values:v})),o=document.getElementById("time-chart-container").clientWidth,r=document.getElementById("time-chart-container").clientHeight,i=5,g=0,d=25,p=25,l=R(V(this.axisData,n=>n.date),[p,o-g]),h=T([0,I(this.axisData,n=>n.formattedQuantity)],[r-d,i]);z().domain(s.map(n=>n.name)).range(H);const u=N().x(n=>l(n.date)).y(n=>h(n.formattedQuantity)),t=w("#time-chart-container").append("svg").attr("width","100%").attr("height","100%").attr("viewBox",[0,0,+Math.min(o,r),+Math.min(o,r)]).attr("preserveAspectRatio","xMinYMin");t.append("g").attr("transform",`translate(0,${r-d})`).call(F(l).ticks(7).tickSizeOuter(0)),t.append("g").attr("transform",`translate(${p},0)`).call(A(h).ticks(r/40)).call(n=>n.select(".domain").remove()).call(n=>n.selectAll(".tick line").clone().attr("x2",o-p-g).attr("stroke-opacity",.2)).call(n=>n.append("text").attr("x",-p).attr("y",10).attr("fill","currentColor").attr("text-anchor","start")),t.selectAll(".line").data(s).join("path").attr("fill","none").attr("stroke",n=>n.name=="student"?"RoyalBlue":"#ff7f0e").attr("stroke-width",n=>n.name=="student"?3:2).attr("d",n=>u(n.values))}}};function Q(a,s,o,r,i,g){return null}const W=b(Y,[["render",Q]]),G={name:"StudentComparisonChart",props:["data","colour"],data(){return{}},mounted(){},methods:{createChart(a){w("#student-comparison-container");const s=25,o=0,r=20,i=10,g=200,d=700,p=Math.ceil((a.length+.1)*s)+o+i,l=T().domain([0,I(a,t=>t.quantity)]).range([g,d-r]),h=E().domain(O(a,t=>-t.quantity).map(t=>t.name)).rangeRound([o,p-i]).padding(.1);l.tickFormat(20);const u=w("#student-comparison-container").append("svg").attr("width","100%").attr("height","100%").attr("viewBox",[0,0,d,p]).attr("style","max-width: 100%; height: 100%; font: 14px sans-serif;");u.append("g").selectAll().data(a).join("rect").attr("x",l(0)).attr("y",t=>h(t.name)).attr("width",t=>l(t.quantity)-l(0)).attr("height",h.bandwidth()).attr("fill",function(t){return t.name=="Language"?"DarkMagenta":t.name=="Mathematics"?"blue":t.name=="Science & Invention"?"purple":t.name=="Computer Science"?"deeppink":t.name=="Dangerous Ideas"?"brown":t.name=="History"?"cyan":t.name=="Life"?"magenta":"#ff7f0e"}),u.append("g").attr("fill","white").attr("text-anchor","end").selectAll().data(a).join("text").attr("x",t=>l(t.quantity)).attr("y",t=>h(t.name)+h.bandwidth()/2).attr("dy","0.35em").attr("dx",-4).text(t=>t.quantity).call(t=>t.filter(n=>l(n.quantity)-l(0)<20).attr("dx",4).attr("fill","black").attr("text-anchor","start")),u.append("g").attr("transform",`translate(0,${o})`).call(U(l).ticks(0)).call(t=>t.select(".domain").remove()),u.append("g").attr("transform",`translate(${g},0)`).attr("style","font-size: 16px").call(A(h).tickSizeOuter(0))}}},J={id:"student-comparison-container"};function K(a,s,o,r,i,g){return c(),m("div",J)}const X=b(G,[["render",K]]);const Z={name:"Student-Dashboard",setup(){const a=B(),s=$(),o=P();return{userDetailsStore:a,analyticsStore:s,teacherAnalyticsStore:o}},data(){return{showSidebar:!0,screenWidth:screen.width,isStudentData:!0,isSchoolData:!0,isLanguageData:!1,isMathData:!1,isHistoryData:!1,isLifeData:!1,isCSData:!1,isSAndIData:!1,isDIData:!1,progressData:{student:[],average:[]},isAboveTheCurve:!1,totalSkillsPassed:null,totalTimeSpent:null,totalAIUsage:null}},components:{StudentProgressChart:L,StudentComparisonChart:X,StudentTimeChart:W},async created(){console.log(this.userDetailsStore.userId),await this.analyticsStore.getStudentProgress(this.userDetailsStore.userId,this.userDetailsStore.tenantId),await this.analyticsStore.getStudentTotalTimeSpent(this.userDetailsStore.userId),this.totalTimeSpent=this.analyticsStore.studentTotalTimeSpent+" hrs",await this.analyticsStore.getStudentTotalSubjectsPassedAssessments(this.userDetailsStore.userId),this.totalSkillsPassed=this.analyticsStore.studentTotalSubjectsPassedAssessments,await this.analyticsStore.getStudentPassedAssessmentsBySubject(this.userDetailsStore.userId),await this.analyticsStore.getStudentTime(this.userDetailsStore.userId,this.userDetailsStore.tenantId),await this.analyticsStore.getStudentTotalTokensSpent(this.userDetailsStore.userId),this.totalAIUsage=this.analyticsStore.studentTotalTokensSpent+" tokens",await this.teacherAnalyticsStore.getStudentMultipleFails(this.userDetailsStore.userId),(this.analyticsStore.progress.student.length>0||this.analyticsStore.progress.tenant.length>0)&&this.analyticsStore.progress.student[this.analyticsStore.progress.student.length-1].quantity>this.analyticsStore.progress.tenant[this.analyticsStore.progress.tenant.length-1].quantity&&(this.isAboveTheCurve=!0),await this.HandleProgressData(),await this.HandleComparisonData(),await this.HandleTimeData()},methods:{async HandleProgressData(){if(this.isStudentData){this.progressData.student=[];for(let a=0;a<this.analyticsStore.progress.student.length;a++)this.progressData.student.push(this.analyticsStore.progress.student[a])}else this.progressData.student=[];if(this.isSchoolData){this.progressData.average=[];for(let a=0;a<this.analyticsStore.progress.tenant.length;a++)this.progressData.average.push(this.analyticsStore.progress.tenant[a])}else this.progressData.average=[];this.$nextTick(()=>{this.$refs.progressChart&&this.$refs.progressChart.createChart(this.progressData)})},async HandleComparisonData(){this.$nextTick(()=>{this.$refs.comparisonChart&&this.$refs.comparisonChart.createChart(this.analyticsStore.studentRootSubjectsPassedAssessments)})},async HandleTimeData(){this.$nextTick(()=>{this.$refs.timeChart&&this.$refs.timeChart.createChart(this.analyticsStore.time)})},toggleSidebar(){this.showSidebar=!this.showSidebar}}},tt={class:"dashboard"},et={class:"main"},st={class:"content container-fluid"},at={class:"dash-row row"},nt={class:"col-md-6 h-100 position-relative"},rt={key:0,class:""},it={id:"progress-chart-container"},ot={key:1},lt={class:"col-md-6"},ct={id:"comparison-chart-container"},dt={key:1},ht={class:"dash-row row"},ut={class:"col-md h-100 position-relative"},mt={id:"time-chart-container"},pt={key:1},gt={class:"col-md position-relative"},ft={class:"row"},St={class:"col-md"},yt={key:0},_t={key:1},Dt={class:"col-md"};function vt(a,s,o,r,i,g){const d=_("RouterLink"),p=_("StudentProgressChart"),l=_("StudentComparisonChart"),h=_("StudentTimeChart");return c(),m("div",tt,[e("div",et,[e("div",st,[e("div",at,[e("div",nt,[S(d,{to:"/my-progress/skills",class:"",target:"_blank"},{default:y(()=>s[0]||(s[0]=[e("h2",{class:"heading h5"},"Progress over time",-1)])),_:1,__:[0]}),i.progressData.student.length>0||i.progressData.average.length>0?(c(),m("figcaption",rt,s[1]||(s[1]=[e("span",{style:{color:"green"}},"You",-1),f(" vs ",-1),e("span",{style:{color:"#ff7f0e"}},"school average",-1)]))):M("",!0),e("div",it,[i.progressData.student.length>0||i.progressData.average.length>0?(c(),C(p,{key:0,ref:"progressChart"},null,512)):(c(),m("p",ot,"No progress yet"))])]),e("div",lt,[e("div",ct,[s[2]||(s[2]=e("h2",{class:"heading h5 mt-1"},"Progress comparison",-1)),r.analyticsStore.studentRootSubjectsPassedAssessments.length>0?(c(),C(l,{key:0,ref:"comparisonChart",data:r.analyticsStore.studentRootSubjectsPassedAssessments,colour:"#5f31dd"},null,8,["data"])):(c(),m("p",dt,"No progress yet"))])])]),e("div",ht,[e("div",ut,[S(d,{to:"/my-progress/time",target:"_blank"},{default:y(()=>s[3]||(s[3]=[e("h2",{class:"heading h5"},"Study time",-1)])),_:1,__:[3]}),s[4]||(s[4]=e("figcaption",null,[e("span",{style:{color:"blue"}},"You"),f(" vs "),e("span",{style:{color:"#ff7f0e"}},"school average")],-1)),e("div",mt,[r.analyticsStore.time.student.length>0||r.analyticsStore.time.tenant.length>0?(c(),C(h,{key:0,ref:"timeChart"},null,512)):(c(),m("p",pt,"No data available"))])]),e("div",gt,[e("div",ft,[e("div",St,[S(d,{to:"/my-progress/super-challenging",class:"col",target:"_blank"},{default:y(()=>s[5]||(s[5]=[e("h2",{class:"h5 heading"}," Consider asking for help ",-1)])),_:1,__:[5]}),r.teacherAnalyticsStore.studentMultipleFails.length>0?(c(),m("ul",yt,[(c(!0),m(j,null,q(r.teacherAnalyticsStore.studentMultipleFails,u=>(c(),m("li",{class:"failed-skills",key:u.id},[S(d,{to:"/skills/"+u.url,target:"_blank"},{default:y(()=>[f(D(u.name),1)]),_:2},1032,["to"])]))),128))])):(c(),m("p",_t,"Nothing to worry about yet"))]),e("div",Dt,[s[9]||(s[9]=e("h2",{class:"h5 heading"},"Stats",-1)),e("ul",null,[e("li",null,[s[6]||(s[6]=e("strong",null,"Skills passed:",-1)),f(" "+D(i.totalSkillsPassed),1)]),e("li",null,[s[7]||(s[7]=e("strong",null,"Total time spent:",-1)),f(" "+D(i.totalTimeSpent),1)]),e("li",null,[S(d,{to:"/my-progress/tokens",target:"_blank"},{default:y(()=>[s[8]||(s[8]=e("strong",null,"AI usage:",-1)),f(" "+D(i.totalAIUsage),1)]),_:1,__:[8]})])])])])])])])])])}const Ht=b(Z,[["render",vt],["__scopeId","data-v-d3067a06"]]);export{Ht as default};
