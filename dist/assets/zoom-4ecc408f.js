import{_ as xt,z as Bt,r as Ht,o as H,j as Ft,k as at,c as U,m as bt,a as O,f as kt,p as zt,t as Tt,b as lt,w as Rt,v as Vt,F as Ut,x as Jt,T as Zt,e as qt}from"./main-7ffa34c9.js";import{s as J,c as Gt}from"./string-dd82ab4a.js";import{w as Kt,s as Wt,c as It,x as Qt,y as jt}from"./point-ea70dc51.js";import{d as te,i as Ct,T as ct,a as ut}from"./transform-af9a74a2.js";const ee={setup(){},props:["skill","showSkillPanel"],data(){return{treeType:"",isImageLoading:!0,currentSkillId:null,isMobileCheck:window.innerWidth}},mounted(){const t=Bt();this.treeType=t.name,this.skill&&(this.currentSkillId=this.skill.id)},watch:{skill(t){t&&(!this.currentSkillId||t.id!==this.currentSkillId)&&(this.isImageLoading=!0,this.currentSkillId=t.id)}},computed:{},methods:{hideInfoPanel(){this.$parent.showSkillPanel=!1},toggleChildNodes(){this.skill.show_children==0?this.$parent.toggleShowChildren(this.skill):this.$parent.toggleHideChildren(this.skill)},imageUrlAlternative(t){t.target.src="",this.isImageLoading=!1},imageLoaded(){this.isImageLoading=!1}}},ne={class:"d-flex justify-content-between p-2 mb-3"},ie={class:"d-flex"},oe={class:"secondary-heading h3 text-center"},re={class:"image-container"},se={key:0,class:"image-placeholder"},ae=["src"],le=["innerHTML"],ce={key:0,class:"skill-introduction"},ue={class:"list-container"};function he(t,e,n,i,o,r){const l=Ht("router-link");return H(),Ft(Zt,{name:"skillPanel"},{default:at(()=>{var u,h;return[n.showSkillPanel?(H(),U("div",{key:0,class:bt(["skill-panel-container text-center overflow-auto",o.treeType==="radial-tree"&&"radial-skill-panel"])},[O("div",null,[O("div",ne,[O("div",ie,[kt(l,{class:"btn primary-btn",target:"_blank",id:"skillLink",to:"/skills/"+n.skill.url,"b-on-hover":"",title:"Learn more"},{default:at(()=>e[3]||(e[3]=[zt("Learn More ",-1)])),_:1,__:[3]},8,["to"])]),O("button",{class:"closebtn",onClick:e[0]||(e[0]=(...s)=>r.hideInfoPanel&&r.hideInfoPanel(...s)),"b-on-hover":"",title:"Close Panel "},e[4]||(e[4]=[O("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",fill:"#888",width:"20",height:"20"},[O("path",{d:"M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z"})],-1)]))]),O("h1",oe,Tt((u=n.skill)==null?void 0:u.name),1),O("div",re,[o.isImageLoading?(H(),U("div",se,e[5]||(e[5]=[O("div",{class:"spinner"},null,-1)]))):lt("",!0),Rt((H(),U("img",{src:n.skill.image_thumbnail_url,class:"rounded img-fluid mx-auto",onError:e[1]||(e[1]=(...s)=>r.imageUrlAlternative&&r.imageUrlAlternative(...s)),onLoad:e[2]||(e[2]=(...s)=>r.imageLoaded&&r.imageLoaded(...s)),key:n.skill.id},null,40,ae)),[[Vt,!o.isImageLoading]])]),O("div",{class:bt(["skill-introduction bg-white rounded p-2 text-start mt-2 mb-4",{"skill-introduction-mobile":o.isMobileCheck<576}]),innerHTML:n.skill.introduction},null,10,le),((h=n.skill)==null?void 0:h.type)=="super"?(H(),U("div",ce,[e[6]||(e[6]=O("h2",{class:"h4"},"Subskills",-1)),O("ul",ue,[(H(!0),U(Ut,null,Jt(n.skill.subskills,s=>(H(),U("li",null,[kt(l,{class:"btn mb-2",to:"/skills/"+s.url},{default:at(()=>[zt(Tt(s.name),1)]),_:2},1032,["to"])]))),256))])])):lt("",!0)])],2)):lt("",!0)]}),_:1})}const bn=xt(ee,[["render",he],["__scopeId","data-v-7a4b564a"]]);const de={setup(){},data(){return{oldScale:0}},computed:{},async mounted(){this.oldScale=this.$parent.scale},methods:{scaleTree(t){const e=this.$parent.context.canvas.width/2,n=this.$parent.context.canvas.height/2,i=this.$parent.scale+t,o=i/this.$parent.scale;let r=e+(this.$parent.panX-e)*o,l=n+(this.$parent.panY-n)*o;this.$parent.scale=i,this.oldScale=i,this.$parent.zoomInD3(i,r,l)},zoomIn(){this.$parent.scale<2&&this.scaleTree(.1)},zoomOut(){this.$parent.scale>.3&&this.scaleTree(-.1)}}},fe={id:"zoomcontrols"};function pe(t,e,n,i,o,r){return H(),U("div",fe,[O("div",{onClick:e[0]||(e[0]=(...l)=>r.zoomIn&&r.zoomIn(...l)),class:"zoom-button"},e[2]||(e[2]=[O("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512"},[O("path",{d:"M256 80c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 144L48 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l144 0 0 144c0 17.7 14.3 32 32 32s32-14.3 32-32l0-144 144 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-144 0 0-144z"})],-1)])),e[4]||(e[4]=O("div",{class:"divider"},null,-1)),O("div",{onClick:e[1]||(e[1]=(...l)=>r.zoomOut&&r.zoomOut(...l)),class:"zoom-button"},e[3]||(e[3]=[O("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512"},[O("path",{d:"M432 256c0 17.7-14.3 32-32 32L48 288c-17.7 0-32-14.3-32-32s14.3-32 32-32l352 0c17.7 0 32 14.3 32 32z"})],-1)]))])}const kn=xt(de,[["render",pe],["__scopeId","data-v-d66ddf5c"]]),it=(t,e)=>{const n=e.x-t.x,i=e.y-t.y;return Math.sqrt(n*n+i*i)},me=(t,e)=>{const n=e.x-t.x,i=e.y-t.y;return ye(Math.atan2(i,n))},ge=(t,e,n)=>{const i={x:0,y:0};return n=gt(n),i.x=t.x-e*Math.cos(n),i.y=t.y-e*Math.sin(n),i},gt=t=>t*(Math.PI/180),ye=t=>t*(180/Math.PI),ve=t=>isNaN(t.buttons)?t.pressure!==0:t.buttons!==0,ht=new Map,$t=t=>{ht.has(t)&&clearTimeout(ht.get(t)),ht.set(t,setTimeout(t,100))},rt=(t,e,n)=>{const i=e.split(/[ ,]+/g);let o;for(let r=0;r<i.length;r+=1)o=i[r],t.addEventListener?t.addEventListener(o,n,!1):t.attachEvent&&t.attachEvent(o,n)},Ot=(t,e,n)=>{const i=e.split(/[ ,]+/g);let o;for(let r=0;r<i.length;r+=1)o=i[r],t.removeEventListener?t.removeEventListener(o,n):t.detachEvent&&t.detachEvent(o,n)},Dt=t=>(t.preventDefault(),t.type.match(/^touch/)?t.changedTouches:t),St=()=>{const t=window.pageXOffset!==void 0?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,e=window.pageYOffset!==void 0?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop;return{x:t,y:e}},Mt=(t,e)=>{e.top||e.right||e.bottom||e.left?(t.style.top=e.top,t.style.right=e.right,t.style.bottom=e.bottom,t.style.left=e.left):(t.style.left=e.x+"px",t.style.top=e.y+"px")},wt=(t,e,n)=>{const i=Yt(t);for(let o in i)if(i.hasOwnProperty(o))if(typeof e=="string")i[o]=e+" "+n;else{let r="";for(let l=0,u=e.length;l<u;l+=1)r+=e[l]+" "+n+", ";i[o]=r.slice(0,-2)}return i},_e=(t,e)=>{const n=Yt(t);for(let i in n)n.hasOwnProperty(i)&&(n[i]=e);return n},Yt=t=>{const e={};return e[t]="",["webkit","Moz","o"].forEach(function(i){e[i+t.charAt(0).toUpperCase()+t.slice(1)]=""}),e},dt=(t,e)=>{for(let n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t},xe=(t,e)=>{const n={};for(let i in t)t.hasOwnProperty(i)&&e.hasOwnProperty(i)?n[i]=e[i]:t.hasOwnProperty(i)&&(n[i]=t[i]);return n},yt=(t,e)=>{if(t.length)for(let n=0,i=t.length;n<i;n+=1)e(t[n]);else e(t)},we=(t,e,n)=>({x:Math.min(Math.max(t.x,e.x-n),e.x+n),y:Math.min(Math.max(t.y,e.y-n),e.y+n)});var be="ontouchstart"in window,ke=!!window.PointerEvent,ze=!!window.MSPointerEvent,G={touch:{start:"touchstart",move:"touchmove",end:"touchend, touchcancel"},mouse:{start:"mousedown",move:"mousemove",end:"mouseup"},pointer:{start:"pointerdown",move:"pointermove",end:"pointerup, pointercancel"},MSPointer:{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}},q,W={};ke?q=G.pointer:ze?q=G.MSPointer:be?(q=G.touch,W=G.mouse):q=G.mouse;function F(){}F.prototype.on=function(t,e){var n=this,i=t.split(/[ ,]+/g),o;n._handlers_=n._handlers_||{};for(var r=0;r<i.length;r+=1)o=i[r],n._handlers_[o]=n._handlers_[o]||[],n._handlers_[o].push(e);return n};F.prototype.off=function(t,e){var n=this;return n._handlers_=n._handlers_||{},t===void 0?n._handlers_={}:e===void 0?n._handlers_[t]=null:n._handlers_[t]&&n._handlers_[t].indexOf(e)>=0&&n._handlers_[t].splice(n._handlers_[t].indexOf(e),1),n};F.prototype.trigger=function(t,e){var n=this,i=t.split(/[ ,]+/g),o;n._handlers_=n._handlers_||{};for(var r=0;r<i.length;r+=1)o=i[r],n._handlers_[o]&&n._handlers_[o].length&&n._handlers_[o].forEach(function(l){l.call(n,{type:o,target:n},e)})};F.prototype.config=function(t){var e=this;e.options=e.defaults||{},t&&(e.options=xe(e.options,t))};F.prototype.bindEvt=function(t,e){var n=this;return n._domHandlers_=n._domHandlers_||{},n._domHandlers_[e]=function(){typeof n["on"+e]=="function"?n["on"+e].apply(n,arguments):console.warn('[WARNING] : Missing "on'+e+'" handler.')},rt(t,q[e],n._domHandlers_[e]),W[e]&&rt(t,W[e],n._domHandlers_[e]),n};F.prototype.unbindEvt=function(t,e){var n=this;return n._domHandlers_=n._domHandlers_||{},Ot(t,q[e],n._domHandlers_[e]),W[e]&&Ot(t,W[e],n._domHandlers_[e]),delete n._domHandlers_[e],this};function M(t,e){return this.identifier=e.identifier,this.position=e.position,this.frontPosition=e.frontPosition,this.collection=t,this.defaults={size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:.5,mode:"dynamic",zone:document.body,lockX:!1,lockY:!1,shape:"circle"},this.config(e),this.options.mode==="dynamic"&&(this.options.restOpacity=0),this.id=M.id,M.id+=1,this.buildEl().stylize(),this.instance={el:this.ui.el,on:this.on.bind(this),off:this.off.bind(this),show:this.show.bind(this),hide:this.hide.bind(this),add:this.addToDom.bind(this),remove:this.removeFromDom.bind(this),destroy:this.destroy.bind(this),setPosition:this.setPosition.bind(this),resetDirection:this.resetDirection.bind(this),computeDirection:this.computeDirection.bind(this),trigger:this.trigger.bind(this),position:this.position,frontPosition:this.frontPosition,ui:this.ui,identifier:this.identifier,id:this.id,options:this.options},this.instance}M.prototype=new F;M.constructor=M;M.id=0;M.prototype.buildEl=function(t){return this.ui={},this.options.dataOnly?this:(this.ui.el=document.createElement("div"),this.ui.back=document.createElement("div"),this.ui.front=document.createElement("div"),this.ui.el.className="nipple collection_"+this.collection.id,this.ui.back.className="back",this.ui.front.className="front",this.ui.el.setAttribute("id","nipple_"+this.collection.id+"_"+this.id),this.ui.el.appendChild(this.ui.back),this.ui.el.appendChild(this.ui.front),this)};M.prototype.stylize=function(){if(this.options.dataOnly)return this;var t=this.options.fadeTime+"ms",e=_e("borderRadius","50%"),n=wt("transition","opacity",t),i={};return i.el={position:"absolute",opacity:this.options.restOpacity,display:"block",zIndex:999},i.back={position:"absolute",display:"block",width:this.options.size+"px",height:this.options.size+"px",left:0,marginLeft:-this.options.size/2+"px",marginTop:-this.options.size/2+"px",background:this.options.color,opacity:".5"},i.front={width:this.options.size/2+"px",height:this.options.size/2+"px",position:"absolute",display:"block",left:0,marginLeft:-this.options.size/4+"px",marginTop:-this.options.size/4+"px",background:this.options.color,opacity:".5",transform:"translate(0px, 0px)"},dt(i.el,n),this.options.shape==="circle"&&dt(i.back,e),dt(i.front,e),this.applyStyles(i),this};M.prototype.applyStyles=function(t){for(var e in this.ui)if(this.ui.hasOwnProperty(e))for(var n in t[e])this.ui[e].style[n]=t[e][n];return this};M.prototype.addToDom=function(){return this.options.dataOnly||document.body.contains(this.ui.el)?this:(this.options.zone.appendChild(this.ui.el),this)};M.prototype.removeFromDom=function(){return this.options.dataOnly||!document.body.contains(this.ui.el)?this:(this.options.zone.removeChild(this.ui.el),this)};M.prototype.destroy=function(){clearTimeout(this.removeTimeout),clearTimeout(this.showTimeout),clearTimeout(this.restTimeout),this.trigger("destroyed",this.instance),this.removeFromDom(),this.off()};M.prototype.show=function(t){var e=this;return e.options.dataOnly||(clearTimeout(e.removeTimeout),clearTimeout(e.showTimeout),clearTimeout(e.restTimeout),e.addToDom(),e.restCallback(),setTimeout(function(){e.ui.el.style.opacity=1},0),e.showTimeout=setTimeout(function(){e.trigger("shown",e.instance),typeof t=="function"&&t.call(this)},e.options.fadeTime)),e};M.prototype.hide=function(t){var e=this;if(e.options.dataOnly)return e;if(e.ui.el.style.opacity=e.options.restOpacity,clearTimeout(e.removeTimeout),clearTimeout(e.showTimeout),clearTimeout(e.restTimeout),e.removeTimeout=setTimeout(function(){var n=e.options.mode==="dynamic"?"none":"block";e.ui.el.style.display=n,typeof t=="function"&&t.call(e),e.trigger("hidden",e.instance)},e.options.fadeTime),e.options.restJoystick){const n=e.options.restJoystick,i={};i.x=n===!0||n.x!==!1?0:e.instance.frontPosition.x,i.y=n===!0||n.y!==!1?0:e.instance.frontPosition.y,e.setPosition(t,i)}return e};M.prototype.setPosition=function(t,e){var n=this;n.frontPosition={x:e.x,y:e.y};var i=n.options.fadeTime+"ms",o={};o.front=wt("transition",["transform"],i);var r={front:{}};r.front={transform:"translate("+n.frontPosition.x+"px,"+n.frontPosition.y+"px)"},n.applyStyles(o),n.applyStyles(r),n.restTimeout=setTimeout(function(){typeof t=="function"&&t.call(n),n.restCallback()},n.options.fadeTime)};M.prototype.restCallback=function(){var t=this,e={};e.front=wt("transition","none",""),t.applyStyles(e),t.trigger("rested",t.instance)};M.prototype.resetDirection=function(){this.direction={x:!1,y:!1,angle:!1}};M.prototype.computeDirection=function(t){var e=t.angle.radian,n=Math.PI/4,i=Math.PI/2,o,r,l;if(e>n&&e<n*3&&!t.lockX?o="up":e>-n&&e<=n&&!t.lockY?o="left":e>-n*3&&e<=-n&&!t.lockX?o="down":t.lockY||(o="right"),t.lockY||(e>-i&&e<i?r="left":r="right"),t.lockX||(e>0?l="up":l="down"),t.force>this.options.threshold){var u={},h;for(h in this.direction)this.direction.hasOwnProperty(h)&&(u[h]=this.direction[h]);var s={};this.direction={x:r,y:l,angle:o},t.direction=this.direction;for(h in u)u[h]===this.direction[h]&&(s[h]=!0);if(s.x&&s.y&&s.angle)return t;(!s.x||!s.y)&&this.trigger("plain",t),s.x||this.trigger("plain:"+r,t),s.y||this.trigger("plain:"+l,t),s.angle||this.trigger("dir dir:"+o,t)}else this.resetDirection();return t};function $(t,e){var n=this;n.nipples=[],n.idles=[],n.actives=[],n.ids=[],n.pressureIntervals={},n.manager=t,n.id=$.id,$.id+=1,n.defaults={zone:document.body,multitouch:!1,maxNumberOfNipples:10,mode:"dynamic",position:{top:0,left:0},catchDistance:200,size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:.5,lockX:!1,lockY:!1,shape:"circle",dynamicPage:!1,follow:!1},n.config(e),(n.options.mode==="static"||n.options.mode==="semi")&&(n.options.multitouch=!1),n.options.multitouch||(n.options.maxNumberOfNipples=1);const i=getComputedStyle(n.options.zone.parentElement);return i&&i.display==="flex"&&(n.parentIsFlex=!0),n.updateBox(),n.prepareNipples(),n.bindings(),n.begin(),n.nipples}$.prototype=new F;$.constructor=$;$.id=0;$.prototype.prepareNipples=function(){var t=this,e=t.nipples;e.on=t.on.bind(t),e.off=t.off.bind(t),e.options=t.options,e.destroy=t.destroy.bind(t),e.ids=t.ids,e.id=t.id,e.processOnMove=t.processOnMove.bind(t),e.processOnEnd=t.processOnEnd.bind(t),e.get=function(n){if(n===void 0)return e[0];for(var i=0,o=e.length;i<o;i+=1)if(e[i].identifier===n)return e[i];return!1}};$.prototype.bindings=function(){var t=this;t.bindEvt(t.options.zone,"start"),t.options.zone.style.touchAction="none",t.options.zone.style.msTouchAction="none"};$.prototype.begin=function(){var t=this,e=t.options;if(e.mode==="static"){var n=t.createNipple(e.position,t.manager.getIdentifier());n.add(),t.idles.push(n)}};$.prototype.createNipple=function(t,e){var n=this,i=n.manager.scroll,o={},r=n.options,l={x:n.parentIsFlex?i.x:i.x+n.box.left,y:n.parentIsFlex?i.y:i.y+n.box.top};if(t.x&&t.y)o={x:t.x-l.x,y:t.y-l.y};else if(t.top||t.right||t.bottom||t.left){var u=document.createElement("DIV");u.style.display="hidden",u.style.top=t.top,u.style.right=t.right,u.style.bottom=t.bottom,u.style.left=t.left,u.style.position="absolute",r.zone.appendChild(u);var h=u.getBoundingClientRect();r.zone.removeChild(u),o=t,t={x:h.left+i.x,y:h.top+i.y}}var s=new M(n,{color:r.color,size:r.size,threshold:r.threshold,fadeTime:r.fadeTime,dataOnly:r.dataOnly,restJoystick:r.restJoystick,restOpacity:r.restOpacity,mode:r.mode,identifier:e,position:t,zone:r.zone,frontPosition:{x:0,y:0},shape:r.shape});return r.dataOnly||(Mt(s.ui.el,o),Mt(s.ui.front,s.frontPosition)),n.nipples.push(s),n.trigger("added "+s.identifier+":added",s),n.manager.trigger("added "+s.identifier+":added",s),n.bindNipple(s),s};$.prototype.updateBox=function(){var t=this;t.box=t.options.zone.getBoundingClientRect()};$.prototype.bindNipple=function(t){var e=this,n,i=function(o,r){n=o.type+" "+r.id+":"+o.type,e.trigger(n,r)};t.on("destroyed",e.onDestroyed.bind(e)),t.on("shown hidden rested dir plain",i),t.on("dir:up dir:right dir:down dir:left",i),t.on("plain:up plain:right plain:down plain:left",i)};$.prototype.pressureFn=function(t,e,n){var i=this,o=0;clearInterval(i.pressureIntervals[n]),i.pressureIntervals[n]=setInterval((function(){var r=t.force||t.pressure||t.webkitForce||0;r!==o&&(e.trigger("pressure",r),i.trigger("pressure "+e.identifier+":pressure",r),o=r)}).bind(i),100)};$.prototype.onstart=function(t){var e=this,n=e.options,i=t;t=Dt(t),e.updateBox();var o=function(r){e.actives.length<n.maxNumberOfNipples?e.processOnStart(r):i.type.match(/^touch/)&&(Object.keys(e.manager.ids).forEach(function(l){if(Object.values(i.touches).findIndex(function(h){return h.identifier===l})<0){var u=[t[0]];u.identifier=l,e.processOnEnd(u)}}),e.actives.length<n.maxNumberOfNipples&&e.processOnStart(r))};return yt(t,o),e.manager.bindDocument(),!1};$.prototype.processOnStart=function(t){var e=this,n=e.options,i,o=e.manager.getIdentifier(t),r=t.force||t.pressure||t.webkitForce||0,l={x:t.pageX,y:t.pageY},u=e.getOrCreate(o,l);u.identifier!==o&&e.manager.removeIdentifier(u.identifier),u.identifier=o;var h=function(m){m.trigger("start",m),e.trigger("start "+m.id+":start",m),m.show(),r>0&&e.pressureFn(t,m,m.identifier),e.processOnMove(t)};if((i=e.idles.indexOf(u))>=0&&e.idles.splice(i,1),e.actives.push(u),e.ids.push(u.identifier),n.mode!=="semi")h(u);else{var s=it(l,u.position);if(s<=n.catchDistance)h(u);else{u.destroy(),e.processOnStart(t);return}}return u};$.prototype.getOrCreate=function(t,e){var n=this,i=n.options,o;return/(semi|static)/.test(i.mode)?(o=n.idles[0],o?(n.idles.splice(0,1),o):i.mode==="semi"?n.createNipple(e,t):(console.warn("Coudln't find the needed nipple."),!1)):(o=n.createNipple(e,t),o)};$.prototype.processOnMove=function(t){var e=this,n=e.options,i=e.manager.getIdentifier(t),o=e.nipples.get(i),r=e.manager.scroll;if(!ve(t)){this.processOnEnd(t);return}if(!o){console.error("Found zombie joystick with ID "+i),e.manager.removeIdentifier(i);return}if(n.dynamicPage){var l=o.el.getBoundingClientRect();o.position={x:r.x+l.left,y:r.y+l.top}}o.identifier=i;var u=o.options.size/2,h={x:t.pageX,y:t.pageY};n.lockX&&(h.y=o.position.y),n.lockY&&(h.x=o.position.x);var s=it(h,o.position),m=me(h,o.position),T=gt(m),g=s/u,k={distance:s,position:h},z,w;if(o.options.shape==="circle"?(z=Math.min(s,u),w=ge(o.position,z,m)):(w=we(h,o.position,u),z=it(w,o.position)),n.follow){if(s>u){let D=h.x-w.x,C=h.y-w.y;o.position.x+=D,o.position.y+=C,o.el.style.top=o.position.y-(e.box.top+r.y)+"px",o.el.style.left=o.position.x-(e.box.left+r.x)+"px",s=it(h,o.position)}}else h=w,s=z;var S=h.x-o.position.x,p=h.y-o.position.y;o.frontPosition={x:S,y:p},n.dataOnly||(o.ui.front.style.transform="translate("+S+"px,"+p+"px)");var x={identifier:o.identifier,position:h,force:g,pressure:t.force||t.pressure||t.webkitForce||0,distance:s,angle:{radian:T,degree:m},vector:{x:S/u,y:-p/u},raw:k,instance:o,lockX:n.lockX,lockY:n.lockY};x=o.computeDirection(x),x.angle={radian:gt(180-m),degree:180-m},o.trigger("move",x),e.trigger("move "+o.id+":move",x)};$.prototype.processOnEnd=function(t){var e=this,n=e.options,i=e.manager.getIdentifier(t),o=e.nipples.get(i),r=e.manager.removeIdentifier(o.identifier);o&&(n.dataOnly||o.hide(function(){n.mode==="dynamic"&&(o.trigger("removed",o),e.trigger("removed "+o.id+":removed",o),e.manager.trigger("removed "+o.id+":removed",o),o.destroy())}),clearInterval(e.pressureIntervals[o.identifier]),o.resetDirection(),o.trigger("end",o),e.trigger("end "+o.id+":end",o),e.ids.indexOf(o.identifier)>=0&&e.ids.splice(e.ids.indexOf(o.identifier),1),e.actives.indexOf(o)>=0&&e.actives.splice(e.actives.indexOf(o),1),/(semi|static)/.test(n.mode)?e.idles.push(o):e.nipples.indexOf(o)>=0&&e.nipples.splice(e.nipples.indexOf(o),1),e.manager.unbindDocument(),/(semi|static)/.test(n.mode)&&(e.manager.ids[r.id]=r.identifier))};$.prototype.onDestroyed=function(t,e){var n=this;n.nipples.indexOf(e)>=0&&n.nipples.splice(n.nipples.indexOf(e),1),n.actives.indexOf(e)>=0&&n.actives.splice(n.actives.indexOf(e),1),n.idles.indexOf(e)>=0&&n.idles.splice(n.idles.indexOf(e),1),n.ids.indexOf(e.identifier)>=0&&n.ids.splice(n.ids.indexOf(e.identifier),1),n.manager.removeIdentifier(e.identifier),n.manager.unbindDocument()};$.prototype.destroy=function(){var t=this;t.unbindEvt(t.options.zone,"start"),t.nipples.forEach(function(n){n.destroy()});for(var e in t.pressureIntervals)t.pressureIntervals.hasOwnProperty(e)&&clearInterval(t.pressureIntervals[e]);t.trigger("destroyed",t.nipples),t.manager.unbindDocument(),t.off()};function E(t){var e=this;e.ids={},e.index=0,e.collections=[],e.scroll=St(),e.config(t),e.prepareCollections();var n=function(){var o;e.collections.forEach(function(r){r.forEach(function(l){o=l.el.getBoundingClientRect(),l.position={x:e.scroll.x+o.left,y:e.scroll.y+o.top}})})};rt(window,"resize",function(){$t(n)});var i=function(){e.scroll=St()};return rt(window,"scroll",function(){$t(i)}),e.collections}E.prototype=new F;E.constructor=E;E.prototype.prepareCollections=function(){var t=this;t.collections.create=t.create.bind(t),t.collections.on=t.on.bind(t),t.collections.off=t.off.bind(t),t.collections.destroy=t.destroy.bind(t),t.collections.get=function(e){var n;return t.collections.every(function(i){return n=i.get(e),!n}),n}};E.prototype.create=function(t){return this.createCollection(t)};E.prototype.createCollection=function(t){var e=this,n=new $(e,t);return e.bindCollection(n),e.collections.push(n),n};E.prototype.bindCollection=function(t){var e=this,n,i=function(o,r){n=o.type+" "+r.id+":"+o.type,e.trigger(n,r)};t.on("destroyed",e.onDestroyed.bind(e)),t.on("shown hidden rested dir plain",i),t.on("dir:up dir:right dir:down dir:left",i),t.on("plain:up plain:right plain:down plain:left",i)};E.prototype.bindDocument=function(){var t=this;t.binded||(t.bindEvt(document,"move").bindEvt(document,"end"),t.binded=!0)};E.prototype.unbindDocument=function(t){var e=this;(!Object.keys(e.ids).length||t===!0)&&(e.unbindEvt(document,"move").unbindEvt(document,"end"),e.binded=!1)};E.prototype.getIdentifier=function(t){var e;return t?(e=t.identifier===void 0?t.pointerId:t.identifier,e===void 0&&(e=this.latest||0)):e=this.index,this.ids[e]===void 0&&(this.ids[e]=this.index,this.index+=1),this.latest=e,this.ids[e]};E.prototype.removeIdentifier=function(t){var e={};for(var n in this.ids)if(this.ids[n]===t){e.id=n,e.identifier=this.ids[n],delete this.ids[n];break}return e};E.prototype.onmove=function(t){var e=this;return e.onAny("move",t),!1};E.prototype.onend=function(t){var e=this;return e.onAny("end",t),!1};E.prototype.oncancel=function(t){var e=this;return e.onAny("end",t),!1};E.prototype.onAny=function(t,e){var n=this,i,o="processOn"+t.charAt(0).toUpperCase()+t.slice(1);e=Dt(e);var r=function(u,h,s){s.ids.indexOf(h)>=0&&(s[o](u),u._found_=!0)},l=function(u){i=n.getIdentifier(u),yt(n.collections,r.bind(null,u,i)),u._found_||n.removeIdentifier(i)};return yt(e,l),!1};E.prototype.destroy=function(){var t=this;t.unbindDocument(!0),t.ids={},t.index=0,t.collections.forEach(function(e){e.destroy()}),t.off()};E.prototype.onDestroyed=function(t,e){var n=this;if(n.collections.indexOf(e)<0)return!1;n.collections.splice(n.collections.indexOf(e),1)};new E;const Te={setup(){return{userDetailsStore:qt()}},data(){return{holdTime:0,interval:null,fps:10,holdTimeInterval:null,fnZoomKey:!1,lefClick:!1,oldMY:0,oldScale:0}},computed:{},async mounted(){switch(this.userDetailsStore.theme){}this.oldScale=this.$parent.scale;const t=Math.floor(1e3/this.fps)+1;this.$parent.$refs.canvas.addEventListener("keydown",e=>{if(this.interval==null){this.holdTimeInterval=setInterval(()=>{this.holdTime+=1},300);const n=this.$parent.scale>=1?this.$parent.scale/10:50/this.$parent.scale,i=this.$parent.scale>1?this.$parent.scale*15:10/this.$parent.scale;switch(e.code){case"ArrowRight":this.interval=setInterval(()=>{this.$parent.panX=this.$parent.panX-20-(this.holdTime*i+n),this.$parent.panInD3(this.$parent.panX,this.$parent.panY)},t);break;case"ArrowLeft":this.interval=setInterval(()=>{this.$parent.panX=this.$parent.panX+20+(this.holdTime*i+n),this.$parent.panInD3(this.$parent.panX,this.$parent.panY)},t);break;case"ArrowUp":this.interval=setInterval(()=>{this.$parent.panY=this.$parent.panY+20+(this.holdTime*i+n),this.$parent.panInD3(this.$parent.panX,this.$parent.panY)},t);break;case"ArrowDown":this.interval=setInterval(()=>{this.$parent.panY=this.$parent.panY-20-(this.holdTime*i+n),this.$parent.panInD3(this.$parent.panX,this.$parent.panY)},t);break;case"Equal":this.interval=setInterval(()=>{this.$parent.scale<2&&this.scaleTree(.03)},50);break;case"Minus":this.interval=setInterval(()=>{this.$parent.scale>.3&&this.scaleTree(-.03)},50);break}}(e.code.includes("Shift")||e.code.includes("Control"))&&(this.fnZoomKey=!0,e.preventDefault()),(e.code.includes("Arrow")||e.code.includes("Page"))&&e.preventDefault()},!1),this.$parent.$refs.canvas.addEventListener("keyup",e=>{clearInterval(this.interval),clearInterval(this.holdTimeInterval),this.interval=null,this.holdTime=0,(e.code.includes("Shift")||e.code.includes("Control"))&&(this.fnZoomKey=!1)},!1),this.$parent.$refs.canvas.addEventListener("mousemove",e=>{if(this.fnZoomKey)if(e.pageY<this.oldMY){this.$parent.scale+=.01;const n=this.oldScale/this.$parent.scale;let i=this.$parent.scale>=1?this.$parent.panX:this.$parent.panX*this.$parent.scale,o=this.$parent.scale>=1?this.$parent.panY:this.$parent.panY*this.$parent.scale;i=i*n,o=o*n,this.oldScale=this.$parent.scale,this.$parent.zoomInD3(this.$parent.scale,i,o)}else{this.$parent.scale-=.01;const n=this.oldScale/this.$parent.scale;let i=this.$parent.scale>=1?this.$parent.panX:this.$parent.panX*this.$parent.scale,o=this.$parent.scale>=1?this.$parent.panY:this.$parent.panY*this.$parent.scale;i=i*n,o=o*n,this.oldScale=this.$parent.scale,this.$parent.zoomInD3(this.$parent.scale,i,o)}this.oldMY=e.pageY})},watch:{},methods:{scaleTree(t){const e=this.$parent.context.canvas.width/2,n=this.$parent.context.canvas.height/2,i=this.$parent.scale+t,o=i/this.$parent.scale;let r=e+(this.$parent.panX-e)*o,l=n+(this.$parent.panY-n)*o;this.$parent.scale=i,this.oldScale=i,this.$parent.zoomInD3(i,r,l)}}},Ie={id:"controlsWrapper"};function $e(t,e,n,i,o,r){return H(),U("div",Ie,e[0]||(e[0]=[O("div",{id:"panJoystick"},null,-1)]))}const zn=xt(Te,[["render",$e],["__scopeId","data-v-4a458f68"]]);function Tn(t){return J(Gt(t).call(document.documentElement))}function Oe(t){let e;for(;e=t.sourceEvent;)t=e;return t}function Z(t,e){if(t=Oe(t),e===void 0&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var i=n.createSVGPoint();return i.x=t.clientX,i.y=t.clientY,i=i.matrixTransform(e.getScreenCTM().inverse()),[i.x,i.y]}if(e.getBoundingClientRect){var o=e.getBoundingClientRect();return[t.clientX-o.left-e.clientLeft,t.clientY-o.top-e.clientTop]}}return[t.pageX,t.pageY]}const vt={capture:!0,passive:!1};function _t(t){t.preventDefault(),t.stopImmediatePropagation()}function Se(t){var e=t.document.documentElement,n=J(t).on("dragstart.drag",_t,vt);"onselectstart"in e?n.on("selectstart.drag",_t,vt):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function Me(t,e){var n=t.document.documentElement,i=J(t).on("dragstart.drag",null);e&&(i.on("click.drag",_t,vt),setTimeout(function(){i.on("click.drag",null)},0)),"onselectstart"in n?i.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}var Ee=1e-12;function Et(t){return((t=Math.exp(t))+1/t)/2}function Pe(t){return((t=Math.exp(t))-1/t)/2}function Ce(t){return((t=Math.exp(2*t))-1)/(t+1)}const De=function t(e,n,i){function o(r,l){var u=r[0],h=r[1],s=r[2],m=l[0],T=l[1],g=l[2],k=m-u,z=T-h,w=k*k+z*z,S,p;if(w<Ee)p=Math.log(g/s)/e,S=function(V){return[u+V*k,h+V*z,s*Math.exp(e*V*p)]};else{var x=Math.sqrt(w),D=(g*g-s*s+i*w)/(2*s*n*x),C=(g*g-s*s-i*w)/(2*g*n*x),R=Math.log(Math.sqrt(D*D+1)-D),Y=Math.log(Math.sqrt(C*C+1)-C);p=(Y-R)/e,S=function(V){var j=V*p,tt=Et(R),et=s/(n*x)*(tt*Ce(e*j+R)-Pe(R));return[u+et*k,h+et*z,s*tt/Et(e*j+R)]}}return S.duration=p*1e3*e/Math.SQRT2,S}return o.rho=function(r){var l=Math.max(.001,+r),u=l*l,h=u*u;return t(l,u,h)},o}(Math.SQRT2,2,4);function Ye(t){var e=0,n=t.children,i=n&&n.length;if(!i)e=1;else for(;--i>=0;)e+=n[i].value;t.value=e}function Xe(){return this.eachAfter(Ye)}function Ne(t,e){let n=-1;for(const i of this)t.call(e,i,++n,this);return this}function Le(t,e){for(var n=this,i=[n],o,r,l=-1;n=i.pop();)if(t.call(e,n,++l,this),o=n.children)for(r=o.length-1;r>=0;--r)i.push(o[r]);return this}function Ae(t,e){for(var n=this,i=[n],o=[],r,l,u,h=-1;n=i.pop();)if(o.push(n),r=n.children)for(l=0,u=r.length;l<u;++l)i.push(r[l]);for(;n=o.pop();)t.call(e,n,++h,this);return this}function Be(t,e){let n=-1;for(const i of this)if(t.call(e,i,++n,this))return i}function He(t){return this.eachAfter(function(e){for(var n=+t(e.data)||0,i=e.children,o=i&&i.length;--o>=0;)n+=i[o].value;e.value=n})}function Fe(t){return this.eachBefore(function(e){e.children&&e.children.sort(t)})}function Re(t){for(var e=this,n=Ve(e,t),i=[e];e!==n;)e=e.parent,i.push(e);for(var o=i.length;t!==n;)i.splice(o,0,t),t=t.parent;return i}function Ve(t,e){if(t===e)return t;var n=t.ancestors(),i=e.ancestors(),o=null;for(t=n.pop(),e=i.pop();t===e;)o=t,t=n.pop(),e=i.pop();return o}function Ue(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e}function Je(){return Array.from(this)}function Ze(){var t=[];return this.eachBefore(function(e){e.children||t.push(e)}),t}function qe(){var t=this,e=[];return t.each(function(n){n!==t&&e.push({source:n.parent,target:n})}),e}function*Ge(){var t=this,e,n=[t],i,o,r;do for(e=n.reverse(),n=[];t=e.pop();)if(yield t,i=t.children)for(o=0,r=i.length;o<r;++o)n.push(i[o]);while(n.length)}function Xt(t,e){t instanceof Map?(t=[void 0,t],e===void 0&&(e=Qe)):e===void 0&&(e=We);for(var n=new Q(t),i,o=[n],r,l,u,h;i=o.pop();)if((l=e(i.data))&&(h=(l=Array.from(l)).length))for(i.children=l,u=h-1;u>=0;--u)o.push(r=l[u]=new Q(l[u])),r.parent=i,r.depth=i.depth+1;return n.eachBefore(tn)}function Ke(){return Xt(this).eachBefore(je)}function We(t){return t.children}function Qe(t){return Array.isArray(t)?t[1]:null}function je(t){t.data.value!==void 0&&(t.value=t.data.value),t.data=t.data.data}function tn(t){var e=0;do t.height=e;while((t=t.parent)&&t.height<++e)}function Q(t){this.data=t,this.depth=this.height=0,this.parent=null}Q.prototype=Xt.prototype={constructor:Q,count:Xe,each:Ne,eachAfter:Ae,eachBefore:Le,find:Be,sum:He,sort:Fe,path:Re,ancestors:Ue,descendants:Je,leaves:Ze,links:qe,copy:Ke,[Symbol.iterator]:Ge};function en(t,e){return t.parent===e.parent?1:2}function ft(t){var e=t.children;return e?e[0]:t.t}function pt(t){var e=t.children;return e?e[e.length-1]:t.t}function nn(t,e,n){var i=n/(e.i-t.i);e.c-=i,e.s+=n,t.c+=i,e.z+=n,e.m+=n}function on(t){for(var e=0,n=0,i=t.children,o=i.length,r;--o>=0;)r=i[o],r.z+=e,r.m+=e,e+=r.s+(n+=r.c)}function rn(t,e,n){return t.a.parent===e.parent?t.a:n}function ot(t,e){this._=t,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=e}ot.prototype=Object.create(Q.prototype);function sn(t){for(var e=new ot(t,0),n,i=[e],o,r,l,u;n=i.pop();)if(r=n._.children)for(n.children=new Array(u=r.length),l=u-1;l>=0;--l)i.push(o=n.children[l]=new ot(r[l],l)),o.parent=n;return(e.parent=new ot(null,0)).children=[e],e}function In(){var t=en,e=1,n=1,i=null;function o(s){var m=sn(s);if(m.eachAfter(r),m.parent.m=-m.z,m.eachBefore(l),i)s.eachBefore(h);else{var T=s,g=s,k=s;s.eachBefore(function(x){x.x<T.x&&(T=x),x.x>g.x&&(g=x),x.depth>k.depth&&(k=x)});var z=T===g?1:t(T,g)/2,w=z-T.x,S=e/(g.x+z+w),p=n/(k.depth||1);s.eachBefore(function(x){x.x=(x.x+w)*S,x.y=x.depth*p})}return s}function r(s){var m=s.children,T=s.parent.children,g=s.i?T[s.i-1]:null;if(m){on(s);var k=(m[0].z+m[m.length-1].z)/2;g?(s.z=g.z+t(s._,g._),s.m=s.z-k):s.z=k}else g&&(s.z=g.z+t(s._,g._));s.parent.A=u(s,g,s.parent.A||T[0])}function l(s){s._.x=s.z+s.parent.m,s.m+=s.parent.m}function u(s,m,T){if(m){for(var g=s,k=s,z=m,w=g.parent.children[0],S=g.m,p=k.m,x=z.m,D=w.m,C;z=pt(z),g=ft(g),z&&g;)w=ft(w),k=pt(k),k.a=s,C=z.z+x-g.z-S+t(z._,g._),C>0&&(nn(rn(z,s,T),s,C),S+=C,p+=C),x+=z.m,S+=g.m,D+=w.m,p+=k.m;z&&!pt(k)&&(k.t=z,k.m+=x-p),g&&!ft(w)&&(w.t=g,w.m+=S-D,T=s)}return T}function h(s){s.x*=e,s.y=s.depth*n}return o.separation=function(s){return arguments.length?(t=s,o):t},o.size=function(s){return arguments.length?(i=!1,e=+s[0],n=+s[1],o):i?null:[e,n]},o.nodeSize=function(s){return arguments.length?(i=!0,e=+s[0],n=+s[1],o):i?[e,n]:null},o}class an{constructor(e,n){this._context=e,this._x=n}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(e,n){switch(e=+e,n=+n,this._point){case 0:{this._point=1,this._line?this._context.lineTo(e,n):this._context.moveTo(e,n);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+e)/2,this._y0,this._x0,n,e,n):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+n)/2,e,this._y0,e,n);break}}this._x0=e,this._y0=n}}function ln(t){return new an(t,!0)}function cn(t){return t.source}function un(t){return t.target}function hn(t){let e=cn,n=un,i=Qt,o=jt,r=null,l=null,u=Kt(h);function h(){let s;const m=Wt.call(arguments),T=e.apply(this,m),g=n.apply(this,m);if(r==null&&(l=t(s=u())),l.lineStart(),m[0]=T,l.point(+i.apply(this,m),+o.apply(this,m)),m[0]=g,l.point(+i.apply(this,m),+o.apply(this,m)),l.lineEnd(),s)return l=null,s+""||null}return h.source=function(s){return arguments.length?(e=s,h):e},h.target=function(s){return arguments.length?(n=s,h):n},h.x=function(s){return arguments.length?(i=typeof s=="function"?s:It(+s),h):i},h.y=function(s){return arguments.length?(o=typeof s=="function"?s:It(+s),h):o},h.context=function(s){return arguments.length?(s==null?r=l=null:l=t(r=s),h):r},h}function $n(){return hn(ln)}const nt=t=>()=>t;function dn(t,{sourceEvent:e,target:n,transform:i,dispatch:o}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:i,enumerable:!0,configurable:!0},_:{value:o}})}function mt(t){t.stopImmediatePropagation()}function K(t){t.preventDefault(),t.stopImmediatePropagation()}function fn(t){return(!t.ctrlKey||t.type==="wheel")&&!t.button}function pn(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t,t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]):[[0,0],[t.clientWidth,t.clientHeight]]}function Pt(){return this.__zoom||Ct}function mn(t){return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function gn(){return navigator.maxTouchPoints||"ontouchstart"in this}function yn(t,e,n){var i=t.invertX(e[0][0])-n[0][0],o=t.invertX(e[1][0])-n[1][0],r=t.invertY(e[0][1])-n[0][1],l=t.invertY(e[1][1])-n[1][1];return t.translate(o>i?(i+o)/2:Math.min(0,i)||Math.max(0,o),l>r?(r+l)/2:Math.min(0,r)||Math.max(0,l))}function On(){var t=fn,e=pn,n=yn,i=mn,o=gn,r=[0,1/0],l=[[-1/0,-1/0],[1/0,1/0]],u=250,h=De,s=te("start","zoom","end"),m,T,g,k=500,z=150,w=0,S=10;function p(a){a.property("__zoom",Pt).on("wheel.zoom",j,{passive:!1}).on("mousedown.zoom",tt).on("dblclick.zoom",et).filter(o).on("touchstart.zoom",Nt).on("touchmove.zoom",Lt).on("touchend.zoom touchcancel.zoom",At).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}p.transform=function(a,d,c,f){var y=a.selection?a.selection():a;y.property("__zoom",Pt),a!==y?R(a,d,c,f):y.interrupt().each(function(){Y(this,arguments).event(f).start().zoom(null,typeof d=="function"?d.apply(this,arguments):d).end()})},p.scaleBy=function(a,d,c,f){p.scaleTo(a,function(){var y=this.__zoom.k,v=typeof d=="function"?d.apply(this,arguments):d;return y*v},c,f)},p.scaleTo=function(a,d,c,f){p.transform(a,function(){var y=e.apply(this,arguments),v=this.__zoom,_=c==null?C(y):typeof c=="function"?c.apply(this,arguments):c,b=v.invert(_),I=typeof d=="function"?d.apply(this,arguments):d;return n(D(x(v,I),_,b),y,l)},c,f)},p.translateBy=function(a,d,c,f){p.transform(a,function(){return n(this.__zoom.translate(typeof d=="function"?d.apply(this,arguments):d,typeof c=="function"?c.apply(this,arguments):c),e.apply(this,arguments),l)},null,f)},p.translateTo=function(a,d,c,f,y){p.transform(a,function(){var v=e.apply(this,arguments),_=this.__zoom,b=f==null?C(v):typeof f=="function"?f.apply(this,arguments):f;return n(Ct.translate(b[0],b[1]).scale(_.k).translate(typeof d=="function"?-d.apply(this,arguments):-d,typeof c=="function"?-c.apply(this,arguments):-c),v,l)},f,y)};function x(a,d){return d=Math.max(r[0],Math.min(r[1],d)),d===a.k?a:new ct(d,a.x,a.y)}function D(a,d,c){var f=d[0]-c[0]*a.k,y=d[1]-c[1]*a.k;return f===a.x&&y===a.y?a:new ct(a.k,f,y)}function C(a){return[(+a[0][0]+ +a[1][0])/2,(+a[0][1]+ +a[1][1])/2]}function R(a,d,c,f){a.on("start.zoom",function(){Y(this,arguments).event(f).start()}).on("interrupt.zoom end.zoom",function(){Y(this,arguments).event(f).end()}).tween("zoom",function(){var y=this,v=arguments,_=Y(y,v).event(f),b=e.apply(y,v),I=c==null?C(b):typeof c=="function"?c.apply(y,v):c,L=Math.max(b[1][0]-b[0][0],b[1][1]-b[0][1]),P=y.__zoom,X=typeof d=="function"?d.apply(y,v):d,A=h(P.invert(I).concat(L/P.k),X.invert(I).concat(L/X.k));return function(N){if(N===1)N=X;else{var B=A(N),st=L/B[2];N=new ct(st,I[0]-B[0]*st,I[1]-B[1]*st)}_.zoom(null,N)}})}function Y(a,d,c){return!c&&a.__zooming||new V(a,d)}function V(a,d){this.that=a,this.args=d,this.active=0,this.sourceEvent=null,this.extent=e.apply(a,d),this.taps=0}V.prototype={event:function(a){return a&&(this.sourceEvent=a),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(a,d){return this.mouse&&a!=="mouse"&&(this.mouse[1]=d.invert(this.mouse[0])),this.touch0&&a!=="touch"&&(this.touch0[1]=d.invert(this.touch0[0])),this.touch1&&a!=="touch"&&(this.touch1[1]=d.invert(this.touch1[0])),this.that.__zoom=d,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(a){var d=J(this.that).datum();s.call(a,this.that,new dn(a,{sourceEvent:this.sourceEvent,target:p,type:a,transform:this.that.__zoom,dispatch:s}),d)}};function j(a,...d){if(!t.apply(this,arguments))return;var c=Y(this,d).event(a),f=this.__zoom,y=Math.max(r[0],Math.min(r[1],f.k*Math.pow(2,i.apply(this,arguments)))),v=Z(a);if(c.wheel)(c.mouse[0][0]!==v[0]||c.mouse[0][1]!==v[1])&&(c.mouse[1]=f.invert(c.mouse[0]=v)),clearTimeout(c.wheel);else{if(f.k===y)return;c.mouse=[v,f.invert(v)],ut(this),c.start()}K(a),c.wheel=setTimeout(_,z),c.zoom("mouse",n(D(x(f,y),c.mouse[0],c.mouse[1]),c.extent,l));function _(){c.wheel=null,c.end()}}function tt(a,...d){if(g||!t.apply(this,arguments))return;var c=a.currentTarget,f=Y(this,d,!0).event(a),y=J(a.view).on("mousemove.zoom",I,!0).on("mouseup.zoom",L,!0),v=Z(a,c),_=a.clientX,b=a.clientY;Se(a.view),mt(a),f.mouse=[v,this.__zoom.invert(v)],ut(this),f.start();function I(P){if(K(P),!f.moved){var X=P.clientX-_,A=P.clientY-b;f.moved=X*X+A*A>w}f.event(P).zoom("mouse",n(D(f.that.__zoom,f.mouse[0]=Z(P,c),f.mouse[1]),f.extent,l))}function L(P){y.on("mousemove.zoom mouseup.zoom",null),Me(P.view,f.moved),K(P),f.event(P).end()}}function et(a,...d){if(t.apply(this,arguments)){var c=this.__zoom,f=Z(a.changedTouches?a.changedTouches[0]:a,this),y=c.invert(f),v=c.k*(a.shiftKey?.5:2),_=n(D(x(c,v),f,y),e.apply(this,d),l);K(a),u>0?J(this).transition().duration(u).call(R,_,f,a):J(this).call(p.transform,_,f,a)}}function Nt(a,...d){if(t.apply(this,arguments)){var c=a.touches,f=c.length,y=Y(this,d,a.changedTouches.length===f).event(a),v,_,b,I;for(mt(a),_=0;_<f;++_)b=c[_],I=Z(b,this),I=[I,this.__zoom.invert(I),b.identifier],y.touch0?!y.touch1&&y.touch0[2]!==I[2]&&(y.touch1=I,y.taps=0):(y.touch0=I,v=!0,y.taps=1+!!m);m&&(m=clearTimeout(m)),v&&(y.taps<2&&(T=I[0],m=setTimeout(function(){m=null},k)),ut(this),y.start())}}function Lt(a,...d){if(this.__zooming){var c=Y(this,d).event(a),f=a.changedTouches,y=f.length,v,_,b,I;for(K(a),v=0;v<y;++v)_=f[v],b=Z(_,this),c.touch0&&c.touch0[2]===_.identifier?c.touch0[0]=b:c.touch1&&c.touch1[2]===_.identifier&&(c.touch1[0]=b);if(_=c.that.__zoom,c.touch1){var L=c.touch0[0],P=c.touch0[1],X=c.touch1[0],A=c.touch1[1],N=(N=X[0]-L[0])*N+(N=X[1]-L[1])*N,B=(B=A[0]-P[0])*B+(B=A[1]-P[1])*B;_=x(_,Math.sqrt(N/B)),b=[(L[0]+X[0])/2,(L[1]+X[1])/2],I=[(P[0]+A[0])/2,(P[1]+A[1])/2]}else if(c.touch0)b=c.touch0[0],I=c.touch0[1];else return;c.zoom("touch",n(D(_,b,I),c.extent,l))}}function At(a,...d){if(this.__zooming){var c=Y(this,d).event(a),f=a.changedTouches,y=f.length,v,_;for(mt(a),g&&clearTimeout(g),g=setTimeout(function(){g=null},k),v=0;v<y;++v)_=f[v],c.touch0&&c.touch0[2]===_.identifier?delete c.touch0:c.touch1&&c.touch1[2]===_.identifier&&delete c.touch1;if(c.touch1&&!c.touch0&&(c.touch0=c.touch1,delete c.touch1),c.touch0)c.touch0[1]=this.__zoom.invert(c.touch0[0]);else if(c.end(),c.taps===2&&(_=Z(_,this),Math.hypot(T[0]-_[0],T[1]-_[1])<S)){var b=J(this).on("dblclick.zoom");b&&b.apply(this,arguments)}}}return p.wheelDelta=function(a){return arguments.length?(i=typeof a=="function"?a:nt(+a),p):i},p.filter=function(a){return arguments.length?(t=typeof a=="function"?a:nt(!!a),p):t},p.touchable=function(a){return arguments.length?(o=typeof a=="function"?a:nt(!!a),p):o},p.extent=function(a){return arguments.length?(e=typeof a=="function"?a:nt([[+a[0][0],+a[0][1]],[+a[1][0],+a[1][1]]]),p):e},p.scaleExtent=function(a){return arguments.length?(r[0]=+a[0],r[1]=+a[1],p):[r[0],r[1]]},p.translateExtent=function(a){return arguments.length?(l[0][0]=+a[0][0],l[1][0]=+a[1][0],l[0][1]=+a[0][1],l[1][1]=+a[1][1],p):[[l[0][0],l[0][1]],[l[1][0],l[1][1]]]},p.constrain=function(a){return arguments.length?(n=a,p):n},p.duration=function(a){return arguments.length?(u=+a,p):u},p.interpolate=function(a){return arguments.length?(h=a,p):h},p.on=function(){var a=s.on.apply(s,arguments);return a===s?p:a},p.clickDistance=function(a){return arguments.length?(w=(a=+a)*a,p):Math.sqrt(w)},p.tapDistance=function(a){return arguments.length?(S=+a,p):S},p}export{zn as J,bn as S,kn as Z,Tn as c,Xt as h,$n as l,Z as p,In as t,On as z};
