import{_ as u,o,c as d,A as m,r as p,a as h,t as g,k as y}from"./main-0d6acd1d.js";import{u as _}from"./TeacherAnalyticsStore-c927ed1e.js";import{s as f}from"./transform-62bed377.js";import{b as S}from"./band-22321830.js";import{l as v,m as b,b as k}from"./linear-c1216a03.js";import"./ordinal-3694ef9e.js";const A={name:"StudentSkillActivityChart",props:["data","colour"],data(){return{chartHeight:400,chartWidth:1200,labelWidth:20}},watch:{data:{handler(){this.labelWidth=this.calculateLongestLabelWidth(),this.chartHeight=this.calculateChartHeight(),this.drawChart()}}},methods:{drawChart(){const e=this.data;if(!e||e.length===0){console.warn("No data available for the chart");return}const t={top:20,right:400,bottom:40,left:200},s=400,i=this.chartHeight-t.top-t.bottom,n=f("#student-skill-activity-chart-container").append("svg").attr("width",s+t.left+t.right).attr("height",i+t.top+t.bottom).append("g").attr("transform",`translate(${t.left},${t.top})`),r=S().domain(this.data.map(a=>a.name)).range([0,i]).padding(.3),c=v().domain([0,b(this.data,a=>a.quantity)]).range([0,s]);n.selectAll(".bar").data(this.data).enter().append("rect").attr("class","bar").attr("x",0).attr("y",a=>r(a.name)).attr("width",a=>a.quantity>0?c(a.quantity):c(1)).attr("height",a=>a.quantity>0?r.bandwidth():1).attr("fill","#5f31dd"),n.append("g").attr("class","axis").call(k(r)),n.append("text").attr("class","axis-label").attr("transform",`translate(${s/2},${i+35})`).style("text-anchor","middle").text("Duration (hours)"),n.selectAll(".bar-label").data(this.data).enter().append("text").attr("class","bar-label").attr("x",a=>c(a.quantity)+5).attr("y",a=>r(a.name)+r.bandwidth()/2).attr("dy","0.35em").style("font-size","12px").text(a=>a.quantity)},calculateChartHeight(){return this.data.length>0?this.data.length*30+100:400},calculateLongestLabelWidth(){let e=0;for(const s of this.data)e=Math.max(e,s.name.length);return e+10}}},x={id:"student-skill-activity-chart-container"};function w(e,t,s,i,l,n){return o(),d("div",x)}const $=u(A,[["render",w],["__scopeId","data-v-9904b4a0"]]),H={setup(){const e=m(),t=_();return{usersStore:e,teacherAnalyticsStore:t}},data(){return{studentId:this.$route.params.studentId,studentName:null,visitedSkills:[]}},components:{StudentSkillActivityChart:$},async created(){this.usersStore.users.length<1&&await this.usersStore.getUsers();const e=this.usersStore.users.find(t=>t.id===this.studentId);e&&(this.studentName=e.username),this.teacherAnalyticsStore.skillActivities.length==0&&await this.teacherAnalyticsStore.getSkillActivityReport(this.studentId),this.teacherAnalyticsStore.skillActivities=this.teacherAnalyticsStore.skillActivities.map(t=>({...t,quantity:this.millisecondsToHours(t.quantity,2)}))},methods:{visitedDate(e){return new Date(e).toLocaleString("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})},millisecondsToHours(e,t){return(e/36e5).toFixed(t)}}},C={class:"container"},q={class:"d-flex justify-content-between w-100"},L=h("h1",{class:"heading"},"Skill Activity Report",-1),W={class:"secondary-heading h3"},D={key:1};function N(e,t,s,i,l,n){const r=p("StudentSkillActivityChart");return o(),d("div",C,[h("span",q,[L,h("h2",W,g(l.studentName),1)]),i.teacherAnalyticsStore.skillActivities.length>0?(o(),y(r,{key:0,data:i.teacherAnalyticsStore.skillActivities,colour:"darkred"},null,8,["data"])):(o(),d("p",D,"No skills visited by this student."))])}const P=u(H,[["render",N]]);export{P as default};
