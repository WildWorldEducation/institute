import{_ as x,o as n,c as l,A as F,J as A,r as S,a as t,t as h,F as p,z as g,k as B,b as C,g as y,l as k,s as f}from"./main-2ae6c8b9.js";import{s as b}from"./transform-7263f110.js";import{l as D,m as $,b as j,s as q,a as I,c as N}from"./linear-7d255e99.js";const T={name:"BarChart",props:["data","colour"],data(){return{padding:60}},mounted(){b("#chart-container");const s=25,r=0,_=0,u=10,o=200,d=1e3,c=Math.ceil((this.data.length+.1)*s)+r+u,i=D().domain([0,$(this.data,a=>a.quantity)]).range([o,d-_]),e=j().domain(q(this.data,a=>-a.quantity).map(a=>a.name)).rangeRound([r,c-u]).padding(.1),w=i.tickFormat(20),m=b("#chart-container").append("svg").attr("width",d).attr("height",c).attr("viewBox",[0,0,d,c]).attr("style","max-width: 100%; height: 100%; font: 14px sans-serif;");m.append("g").attr("fill",this.colour).selectAll().data(this.data).join("rect").attr("x",i(0)).attr("y",a=>e(a.name)).attr("width",a=>i(a.quantity)-i(0)).attr("height",e.bandwidth()),m.append("g").attr("fill","white").attr("text-anchor","end").selectAll().data(this.data).join("text").attr("x",a=>i(a.quantity)).attr("y",a=>e(a.name)+e.bandwidth()/2).attr("dy","0.35em").attr("dx",-4).text(a=>w(a.quantity)).call(a=>a.filter(v=>i(v.quantity)-i(0)<20).attr("dx",4).attr("fill","black").attr("text-anchor","start")),m.append("g").attr("transform",`translate(0,${r})`).call(I(i).ticks(0)).call(a=>a.select(".domain").remove()),m.append("g").attr("transform",`translate(${o},0)`).call(N(e).tickSizeOuter(0))},computed:{}},z={id:"chart-container"};function H(s,r,_,u,o,d){return n(),l("div",z)}const V=x(T,[["render",H],["__scopeId","data-v-d7222d4d"]]),L={setup(){const s=F(),r=A();return{usersStore:s,userSkillsStore:r}},components:{FailedAssessmentsHorizontalBarChart:V},data(){return{studentId:this.$route.params.studentId,studentName:null,assessmentAttempts:[],multipleFails:[]}},async created(){this.usersStore.users.length<1&&await this.usersStore.getUsers();const s=this.usersStore.users.find(r=>r.id===this.studentId);s&&(this.studentName=s.username),await this.userSkillsStore.getMasteredSkills(this.studentId),await this.getAssessmentAttempts(),await this.getMultipleFails()},methods:{async getAssessmentAttempts(){fetch(`/student-analytics/started-unmastered-assessments/${this.studentId}`).then(s=>s.json()).then(s=>{this.assessmentAttempts=s}).catch(s=>{console.error("Error fetching last visited skills:",s)})},assessmentDate(s){return new Date(s).toLocaleString("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})},async getMultipleFails(){fetch(`/student-analytics/multiple-fails/${this.studentId}`).then(s=>s.json()).then(s=>{this.multipleFails=s}).catch(s=>{console.error("Error fetching last visited skills:",s)})}}},M={class:"container"},R={class:"heading"},U=t("h2",{class:"secondary-heading"},"Combined",-1),E=t("h2",{class:"secondary-heading"},"Completed",-1),O={key:0,class:"mb-4"},J={class:"table"},G=t("tr",null,[t("th",null,"Skill"),t("th",null,"Date")],-1),K={key:1},P=t("h2",{class:"secondary-heading"},"Attempted",-1),Q={key:2,class:"mb-4"},W={class:"table"},X=t("tr",null,[t("th",null,"Skill"),t("th",null,"Date")],-1),Y={key:3},Z=t("p",null,null,-1),tt=t("h2",{class:"secondary-heading"},"Has failed multiple times",-1),st={key:5,class:"mb-4"},et={class:"table"},at=t("tr",null,[t("th",null,"Skill"),t("th",null,"Times")],-1),nt={key:6};function lt(s,r,_,u,o,d){const c=S("router-link"),i=S("FailedAssessmentsHorizontalBarChart");return n(),l("div",M,[t("h1",R,"Assessment Status Report: "+h(o.studentName),1),U,E,this.userSkillsStore.masteredSkills.length>0?(n(),l("div",O,[t("table",J,[G,(n(!0),l(p,null,g(u.userSkillsStore.masteredSkills,e=>(n(),l("tr",{key:e.id,class:"table-rows"},[t("td",null,[y(c,{target:"_blank",to:"/skills/"+e.url},{default:k(()=>[f(h(e.name),1)]),_:2},1032,["to"])]),t("td",null,h(d.assessmentDate(e.date)),1)]))),128))])])):(n(),l("p",K,"This student has not completed any assessments yet.")),P,this.assessmentAttempts.length>0?(n(),l("div",Q,[t("table",W,[X,(n(!0),l(p,null,g(o.assessmentAttempts,e=>(n(),l("tr",{key:e.id,class:"table-rows"},[t("td",null,[y(c,{target:"_blank",to:"/skills/"+e.url},{default:k(()=>[f(h(e.name),1)]),_:2},1032,["to"])]),t("td",null,h(d.assessmentDate(e.date)),1)]))),128))])])):(n(),l("p",Y,"This student has attempted any assessments yet.")),Z,tt,o.multipleFails.length>0?(n(),B(i,{key:4,data:o.multipleFails,colour:"darkred"},null,8,["data"])):C("",!0),this.multipleFails.length>0?(n(),l("div",st,[t("table",et,[at,(n(!0),l(p,null,g(o.multipleFails,e=>(n(),l("tr",{key:e.id,class:"table-rows"},[t("td",null,[y(c,{target:"_blank",to:"/skills/"+e.url},{default:k(()=>[f(h(e.name),1)]),_:2},1032,["to"])]),t("td",null,h(e.quantity),1)]))),128))])])):(n(),l("p",nt," This student has not failed any assessments more than once yet. "))])}const dt=x(L,[["render",lt]]);export{dt as default};
