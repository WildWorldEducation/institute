import{_ as h,e as d,o as a,c as u,a as t,t as n,q as r,b as m,w as k,B as g}from"./main-ae449f61.js";import{u as p}from"./SettingsStore-1acb2e1c.js";const S={setup(){const e=d(),s=p();return{userDetailsStore:e,settingsStore:s}},data(){return{monthlyTokenUsage:null,year:0,month:"",dollars:10,isAITokenLimitReached:!1,assistantsModelPrice:{input:75,output:150},amountOfTokens:0}},async mounted(){this.settingsStore.freeMonthlyTokens==0&&await this.settingsStore.getSettings(),await this.userDetailsStore.getUserDetails(),this.userDetailsStore.tokens<=0&&this.settingsStore.freeMonthlyTokens<=this.userDetailsStore.monthlyTokenUsage&&(this.isAITokenLimitReached=!0),this.year=new Date().getFullYear();const e=["January","February","March","April","May","June","July","August","September","October","November","December"],s=new Date;this.month=e[s.getMonth()]},methods:{checkout(){this.amountOfTokens=this.dollars*this.settingsStore.tokensPerDollar,fetch("/subscriptions/create-checkout-session",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({dollars:this.dollars,userId:this.userDetailsStore.userId,tokensPerDollar:this.settingsStore.tokensPerDollar,amountOfTokens:this.amountOfTokens})}).then(e=>e.ok?e.json():e.json().then(s=>Promise.reject(s))).then(({url:e})=>{console.log("add tokens"),window.location=e}).catch(e=>{console.error(e.error)})}},computed:{numberOfInputTokens(){let e=1e6/this.assistantsModelPrice.input;return Math.trunc(this.dollars*e)},numberOfOutputTokens(){let e=1e6/this.assistantsModelPrice.output;return Math.trunc(this.dollars*e)}}},_={class:"container"},f=t("h1",{class:"heading"},"Subscription",-1),y={class:"secondary-heading h4 mb-4"},D=t("strong",null,"Free limit:",-1),b=t("strong",null,"Your tokens:",-1),T=t("strong",null,"Current usage:",-1),M={key:0,class:"alert alert-warning",role:"alert"},P=t("h2",{class:"secondary-heading h4 mt-5"},"Buy tokens",-1),w=t("label",null,"$Â  ",-1),O=t("br",null,null,-1),A={class:"mt-3"},I=t("strong",null,"Amount of tokens:",-1);function v(e,s,x,l,o,c){return a(),u("div",_,[f,t("h2",y," Monthly AI usage: "+n(o.month)+", "+n(o.year),1),t("ul",null,[t("li",null,[t("p",null,[D,r(" "+n(l.settingsStore.freeMonthlyTokens.toLocaleString()),1)])]),t("li",null,[t("p",null,[b,r(" "+n(l.userDetailsStore.tokens.toLocaleString()),1)])]),t("li",null,[t("p",null,[T,r(" "+n(l.userDetailsStore.monthlyTokenUsage.toLocaleString()),1)])])]),o.isAITokenLimitReached?(a(),u("div",M," You are over the monthly free limit. You can't use the AI features until next month. ")):m("",!0),P,w,k(t("input",{class:"",type:"number","onUpdate:modelValue":s[0]||(s[0]=i=>o.dollars=i),min:"1",max:"500"},null,512),[[g,o.dollars]]),O,t("p",A,[I,r(" "+n((o.dollars*this.settingsStore.tokensPerDollar).toLocaleString()),1)]),t("button",{onClick:s[1]||(s[1]=i=>c.checkout()),class:"btn primary-btn mt-2"}," Check out ")])}const B=h(S,[["render",v]]);export{B as default};
