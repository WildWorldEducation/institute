import{_ as l,o as a,c as u,a as r,r as d,f,k as h,b as p,F as k}from"./main-feaec095.js";import{S as g}from"./SkillTimeTracker-6095ce0a.js";const b={setup(){},data(){return{resourceId:this.$route.params.resourceId,newContent:"",originalContent:""}},async created(){const e=await(await fetch("/resources/show/"+this.resourceId)).json();$("#summernote").summernote({maximumImageFileSize:2048*1024,callbacks:{onImageUploadError:function(t){alert("Max image size is 2MB.")},onChange:t=>{this.newContent=t}}}).summernote("code",e.content),$(".note-editor .note-editable").css("background-color","#ffffff"),this.originalContent=e.content},methods:{Submit(){var s="/resources/edit/"+this.resourceId,e=$("#summernote").summernote("code");const t={method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({editordata:e})};fetch(s,t).then(()=>{let o=this.$route.query.dismissFlagId;o?fetch("/content-flags/"+o,{method:"DELETE"}).finally(()=>{this.$router.back()}):this.$router.back()})}},computed:{isFormChanged(){return this.originalContent!==this.newContent}}},_={class:"container p-2 bg-light rounded"},I=["disabled"];function C(s,e,t,o,i,n){return a(),u("div",_,[e[1]||(e[1]=r("h1",{class:"heading"},"Edit Source",-1)),e[2]||(e[2]=r("div",{class:"row"},[r("div",{class:"mb-3"},[r("textarea",{id:"summernote",name:"editordata"})])],-1)),r("button",{class:"btn btn-dark",disabled:!n.isFormChanged,onClick:e[0]||(e[0]=c=>n.Submit())}," Submit ",8,I)])}const T=l(b,[["render",C]]),w={data(){return{resourceId:this.$route.params.resourceId,skillId:null}},components:{EditResource:T,SkillTimeTracker:g},async created(){const e=await(await fetch("/resources/show/"+this.resourceId)).json();this.skillId=e.skill_id},beforeRouteLeave(s,e,t){this.$refs.skillTimeTracker.saveDuration(),t()}};function E(s,e,t,o,i,n){const c=d("EditResource"),m=d("SkillTimeTracker");return a(),u(k,null,[f(c),i.skillId?(a(),h(m,{key:0,ref:"skillTimeTracker"},null,512)):p("",!0)],64)}const y=l(w,[["render",E]]);export{y as default};
