import{s as m}from"./transform-35b9fb9e.js";import{_ as g,o as u,c as k,f as P,r as y,a as r,b as M,s as _,k as w,p as $,d as B}from"./main-2e4248c9.js";import{l as v,m as x,a as b,b as S,c as z}from"./linear-c968f95f.js";import{b as C}from"./band-18e9f0c1.js";import{s as L}from"./sort-855cf5d1.js";import{u as D,l as A}from"./line-8aa3dac8.js";import{e as j}from"./time-962c8065.js";import{u as q}from"./AnalyticsStore-43739070.js";import"./point-ea70dc51.js";const I={name:"TenantAvgTokensToMasterSkillsHorizontalBarChart",props:["data","colour"],data(){return{padding:60}},mounted(){m("#tenant-avg-tokens-to-master-skills-chart-container");const t=25,e=0,i=0,s=10,d=200,o=1e3,l=Math.ceil((this.data.length+.1)*t)+e+s,n=v().domain([0,x(this.data,a=>a.quantity)]).range([d,o-i]),c=C().domain(L(this.data,a=>-a.quantity).map(a=>a.name)).rangeRound([e,l-s]).padding(.1),h=n.tickFormat(20),p=m("#tenant-avg-tokens-to-master-skills-chart-container").append("svg").attr("width",o).attr("height",l).attr("viewBox",[0,0,o,l]).attr("style","max-width: 100%; height: 100%; font: 14px sans-serif;");p.append("g").attr("fill",this.colour).selectAll().data(this.data).join("rect").attr("x",n(0)).attr("y",a=>c(a.name)).attr("width",a=>n(a.quantity)-n(0)).attr("height",c.bandwidth()),p.append("g").attr("fill","white").attr("text-anchor","end").selectAll().data(this.data).join("text").attr("x",a=>n(a.quantity)).attr("y",a=>c(a.name)+c.bandwidth()/2).attr("dy","0.35em").attr("dx",-4).text(a=>h(a.quantity)).call(a=>a.filter(f=>n(f.quantity)-n(0)<20).attr("dx",4).attr("fill","black").attr("text-anchor","start")),p.append("g").attr("transform",`translate(0,${e})`).call(b(n).ticks(0)).call(a=>a.select(".domain").remove()),p.append("g").attr("transform",`translate(${d},0)`).call(S(c).tickSizeOuter(0))},computed:{}},H={id:"tenant-avg-tokens-to-master-skills-chart-container"};function R(t,e,i,s,d,o){return u(),k("div",H)}const O=g(I,[["render",R],["__scopeId","data-v-e380fbfe"]]);const E={name:"TenantTokensPerSkillHorizontalBarChart",props:["data","colour"],data(){return{padding:60}},mounted(){m("#tenant-tokens-per-skill-chart-container");const t=25,e=0,i=0,s=10,d=200,o=1e3,l=Math.ceil((this.data.length+.1)*t)+e+s,n=v().domain([0,x(this.data,a=>a.quantity)]).range([d,o-i]),c=C().domain(L(this.data,a=>-a.quantity).map(a=>a.name)).rangeRound([e,l-s]).padding(.1),h=n.tickFormat(20),p=m("#tenant-tokens-per-skill-chart-container").append("svg").attr("width",o).attr("height",l).attr("viewBox",[0,0,o,l]).attr("style","max-width: 100%; height: 100%; font: 14px sans-serif;");p.append("g").attr("fill",this.colour).selectAll().data(this.data).join("rect").attr("x",n(0)).attr("y",a=>c(a.name)).attr("width",a=>n(a.quantity)-n(0)).attr("height",c.bandwidth()),p.append("g").attr("fill","white").attr("text-anchor","end").selectAll().data(this.data).join("text").attr("x",a=>n(a.quantity)).attr("y",a=>c(a.name)+c.bandwidth()/2).attr("dy","0.35em").attr("dx",-4).text(a=>h(a.quantity)).call(a=>a.filter(f=>n(f.quantity)-n(0)<20).attr("dx",4).attr("fill","black").attr("text-anchor","start")),p.append("g").attr("transform",`translate(0,${e})`).call(b(n).ticks(0)).call(a=>a.select(".domain").remove()),p.append("g").attr("transform",`translate(${d},0)`).call(S(c).tickSizeOuter(0))},computed:{}},N={id:"tenant-tokens-per-skill-chart-container"};function V(t,e,i,s,d,o){return u(),k("div",N)}const U=g(E,[["render",V],["__scopeId","data-v-039ce704"]]),F={name:"TenantTokensPerDayLineChart",props:["data","colour"],data(){return{padding:60}},mounted(){const t=this.data;m("#tenant-tokens-per-day-chart-container");const e=928,i=500,s=20,d=30,o=30,l=40,n=D(j(t,a=>a.date),[l,e-d]),c=v([0,x(t,a=>a.quantity)],[i-o,s]),h=A().x(a=>n(a.date)).y(a=>c(a.quantity)),p=m("#tenant-tokens-per-day-chart-container").append("svg").attr("width",e).attr("height",i).attr("viewBox",[0,0,e,i]).attr("style","max-width: 100%; height: auto; height: intrinsic;");p.append("g").attr("transform",`translate(0,${i-o})`).call(z(n).ticks(t.length/2).tickSizeOuter(0)),p.append("g").attr("transform",`translate(${l},0)`).call(S(c).ticks(i/80)).call(a=>a.selectAll(".tick line").clone().attr("x2",e-l-d).attr("stroke-opacity",.1)).call(a=>a.append("text").attr("x",-l).attr("y",10).attr("fill","currentColor").attr("text-anchor","start").text("â†‘ Tokens")),p.append("path").attr("fill","none").attr("stroke","#5f31dd").attr("stroke-width",1.5).attr("d",h(t))}},W={id:"tenant-tokens-per-day-chart-container"};function G(t,e,i,s,d,o){return u(),k("div",W)}const J=g(F,[["render",G]]);const K={setup(){const t=P(),e=q();return{userDetailsStore:t,analyticsStore:e}},components:{TenantAvgTokensToMasterSkillsHorizontalBarChart:O,TenantTokensPerSkillHorizontalBarChart:U,TenantTokensPerDayLineChart:J},data(){return{tenantId:this.$route.params.tenantId,isDataWeekly:!1,isTutorialComplete:!1,showTutorialTip1:!1,showTutorialTip2:!1,showTutorialTip3:!1,showTutorialTip4:!1,dataMode:"total"}},async created(){await this.checkIfTutorialComplete(),await this.getAvgTokensToMasterSkills(),await this.getTotalTokensPerSkill(),await this.getTotalTokensPerDay()},methods:{async checkIfTutorialComplete(){const e=await(await fetch(`/users/check-tutorial-progress/school-report/${this.userDetailsStore.userId}`)).json();e==0?(this.isTutorialComplete=!1,this.showTutorialTip1=!0):e==1&&(this.isTutorialComplete=!0)},progressTutorial(t){t==1?(this.showTutorialTip1=!1,this.showTutorialTip2=!0):t==2?(this.showTutorialTip2=!1,this.showTutorialTip3=!0):t==3?(this.showTutorialTip3=!1,this.showTutorialTip4=!0):t==4&&(this.showTutorialTip4=!1,this.markTutorialComplete())},restartTutorial(){this.isTutorialComplete=!1,this.showTutorialTip1=!0,this.showTutorialTip2=!1,this.showTutorialTip3=!1,this.showTutorialTip4=!1},markTutorialComplete(){let t="/users/mark-tutorial-complete/school-report/"+this.userDetailsStore.userId;fetch(t,{method:"PUT",headers:{"Content-Type":"application/json"}})},skipTutorial(){this.showTutorialTip1=!1,this.showTutorialTip2=!1,this.showTutorialTip3=!1,this.showTutorialTip4=!1,this.isTutorialComplete=!0,this.markTutorialComplete()},async getAvgTokensToMasterSkills(){try{const t=await fetch(`/student-analytics/avg-tokens-to-master-skills/tenant/${this.tenantId}`);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const e=await t.json();this.analyticsStore.avgTokensToMasterSkills=Array.isArray(e)?e:[]}catch(t){console.error("Error fetching cohort mastered assessments:",t),this.analyticsStore.avgTokensToMasterSkills=[]}},async getTotalTokensPerSkill(){try{const t=await fetch(`/student-analytics/total-tokens-per-skill/tenant/${this.tenantId}`);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const e=await t.json();this.analyticsStore.totalTokensPerSkill=Array.isArray(e)?e:[]}catch(t){console.error("Error fetching cohort mastered assessments:",t),this.analyticsStore.totalTokensPerSkill=[]}},async getTotalTokensPerDay(){this.analyticsStore.totalTokensPerDay=[],fetch(`/student-analytics/tenant-tokens-per-day/${this.dataMode}/${this.tenantId}`).then(t=>t.json()).then(t=>{for(let e=0;e<t.length;e++)t[e].date=new Date(t[e].date);t.sort((e,i)=>e.date-i.date),this.analyticsStore.totalTokensPerDay=t}).catch(t=>{console.error("Error fetching student progress:",t)})},downloadData(t,e){const i=Object.keys(t[0]);console.log(i);const s=[];s.push(i.join(","));for(const n of t){const c=i.map(h=>{const p=n[h];return`"${String(p).replace(/"/g,'""')}"`});s.push(c.join(","))}const d=s.join(`
`),o=new Blob([d],{type:"text/csv;charset=utf-8;"}),l=document.createElement("a");l.href=URL.createObjectURL(o),l.download=e+".csv",l.click()},async toggleWeeklyCumulativeData(){this.dataMode=="total"?this.dataMode="weekly":this.dataMode="total",await this.getTenantDuration(),await this.getPercentageStudentsMasteredOneSkill(),await this.getTotalTokensPerDay()}}},T=t=>($("data-v-f17a87e5"),t=t(),B(),t),Q={class:"container"},X={class:"d-flex justify-content-between w-100"},Y=T(()=>r("h1",{class:"heading"},"Cost Report",-1)),Z=T(()=>r("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 192 512",width:"20",height:"23",class:"primary-icon"},[r("path",{d:"M48 80a48 48 0 1 1 96 0A48 48 0 1 1 48 80zM0 224c0-17.7 14.3-32 32-32l64 0c17.7 0 32 14.3 32 32l0 224 32 0c17.7 0 32 14.3 32 32s-14.3 32-32 32L32 512c-17.7 0-32-14.3-32-32s14.3-32 32-32l32 0 0-192-32 0c-17.7 0-32-14.3-32-32z"})],-1)),tt=[Z],at={key:0,class:"modal"},et={class:"modal-content"},st=T(()=>r("p",{class:"modal-text"}," The School Admin Report provides comprehensive analytics on student engagement, academic performance, and resource usage across your school. ",-1)),ot={class:"d-flex justify-content-between"},nt={class:"d-flex justify-content-between"},rt=T(()=>r("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",width:"18",height:"18"},[r("path",{d:"M0 64C0 28.7 28.7 0 64 0L213.5 0c17 0 33.3 6.7 45.3 18.7L365.3 125.3c12 12 18.7 28.3 18.7 45.3L384 448c0 35.3-28.7 64-64 64L64 512c-35.3 0-64-28.7-64-64L0 64zm208-5.5l0 93.5c0 13.3 10.7 24 24 24L325.5 176 208 58.5zM175 441c9.4 9.4 24.6 9.4 33.9 0l64-64c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0l-23 23 0-86.1c0-13.3-10.7-24-24-24s-24 10.7-24 24l0 86.1-23-23c-9.4-9.4-24.6-9.4-33.9 0s-9.4 24.6 0 33.9l64 64z"})],-1)),it=[rt],lt={key:2},ct=T(()=>r("p",null,[r("em",null,"Please note recording of tokens per skill stops after student mastery of that skill")],-1)),dt={class:"d-flex justify-content-between"},ht=T(()=>r("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",width:"18",height:"18"},[r("path",{d:"M0 64C0 28.7 28.7 0 64 0L213.5 0c17 0 33.3 6.7 45.3 18.7L365.3 125.3c12 12 18.7 28.3 18.7 45.3L384 448c0 35.3-28.7 64-64 64L64 512c-35.3 0-64-28.7-64-64L0 64zm208-5.5l0 93.5c0 13.3 10.7 24 24 24L325.5 176 208 58.5zM175 441c9.4 9.4 24.6 9.4 33.9 0l64-64c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0l-23 23 0-86.1c0-13.3-10.7-24-24-24s-24 10.7-24 24l0 86.1-23-23c-9.4-9.4-24.6-9.4-33.9 0s-9.4 24.6 0 33.9l64 64z"})],-1)),pt=[ht],ut={key:4},kt={class:"d-flex justify-content-between mt-5"},Tt=T(()=>r("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",width:"18",height:"18"},[r("path",{d:"M0 64C0 28.7 28.7 0 64 0L213.5 0c17 0 33.3 6.7 45.3 18.7L365.3 125.3c12 12 18.7 28.3 18.7 45.3L384 448c0 35.3-28.7 64-64 64L64 512c-35.3 0-64-28.7-64-64L0 64zm208-5.5l0 93.5c0 13.3 10.7 24 24 24L325.5 176 208 58.5zM175 441c9.4 9.4 24.6 9.4 33.9 0l64-64c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0l-23 23 0-86.1c0-13.3-10.7-24-24-24s-24 10.7-24 24l0 86.1-23-23c-9.4-9.4-24.6-9.4-33.9 0s-9.4 24.6 0 33.9l64 64z"})],-1)),mt=[Tt],gt={key:6,class:"mb-5"};function ft(t,e,i,s,d,o){const l=y("TenantTokensPerDayLineChart"),n=y("TenantAvgTokensToMasterSkillsHorizontalBarChart"),c=y("TenantTokensPerSkillHorizontalBarChart");return u(),k("div",Q,[r("span",X,[Y,r("button",{class:"btn me-1",onClick:e[0]||(e[0]=(...h)=>o.restartTutorial&&o.restartTutorial(...h)),"aria-label":"info"},tt)]),d.showTutorialTip1?(u(),k("div",at,[r("div",et,[st,r("div",ot,[r("button",{class:"btn primary-btn",onClick:e[1]||(e[1]=h=>o.progressTutorial(1))}," next "),r("button",{class:"btn red-btn",onClick:e[2]||(e[2]=(...h)=>o.skipTutorial&&o.skipTutorial(...h))}," exit tutorial ")])])])):M("",!0),r("h4",nt,[_(" Tokens spent per day "),r("button",{class:"btn",onClick:e[3]||(e[3]=h=>o.downloadData(s.analyticsStore.totalTokensPerDay,"Tokens-per-day"))},it)]),s.analyticsStore.totalTokensPerDay.length>0?(u(),w(l,{key:1,data:s.analyticsStore.totalTokensPerDay,colour:"#5f31dd",class:"mb-5"},null,8,["data"])):(u(),k("p",lt,"No data yet")),ct,r("h4",dt,[_(" Average number of tokens spent to master a skill "),r("button",{class:"btn",onClick:e[4]||(e[4]=h=>o.downloadData(s.analyticsStore.avgTokensToMasterSkills,"Avg-tokens-to-master-skill"))},pt)]),s.analyticsStore.avgTokensToMasterSkills.length>0?(u(),w(n,{key:3,data:s.analyticsStore.avgTokensToMasterSkills,colour:"darkgreen"},null,8,["data"])):(u(),k("p",ut,"No data yet")),r("h4",kt,[_(" Tokens spent per skill "),r("button",{class:"btn",onClick:e[5]||(e[5]=h=>o.downloadData(s.analyticsStore.totalTokensPerSkill,"Tokens-per-skill"))},mt)]),s.analyticsStore.totalTokensPerSkill.length>0?(u(),w(c,{key:5,data:s.analyticsStore.totalTokensPerSkill,colour:"#5f31dd",class:"mb-5"},null,8,["data"])):(u(),k("p",gt,"No data yet"))])}const Pt=g(K,[["render",ft],["__scopeId","data-v-f17a87e5"]]);export{Pt as default};
