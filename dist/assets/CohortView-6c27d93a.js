import{_ as w,r as b,o as i,c as r,a as s,t as u,M as v,b as h,n as y,m,F as c,x as f,j as p,e as M,f as _,k as x,T as S,w as F,N as I}from"./main-c6062aed.js";import{u as C}from"./CohortsStore-002c27a8.js";const L={setup(){return{cohortsStore:C()}},props:["id","children","name","type","level","depth","filtered"],data(){return{cohortId:this.$route.params.cohortId,showChildren:!1,isFiltered:null}},computed:{indent(){var t=0;return screen.width<=480?this.depth==1?t=25:t=20:t=50,this.type!="sub"?{transform:`translate(${this.depth*t-35.2}px)`}:{transform:`translate(${(this.depth-1)*t-35.2}px)`}}},mounted(){this.$refs.name.offsetHeight>90?this.$refs.name.classList.add("four-row-domain-name"):this.$refs.name.offsetHeight>60?this.$refs.name.classList.add("three-row-domain-name"):this.$refs.name.offsetHeight>30&&this.$refs.name.classList.add("two-row-domain-name")},methods:{toggleChildSkills(){this.showChildren=!this.showChildren},filter(){this.filtered==1?this.isFiltered=0:this.isFiltered=1;const t={method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({cohortId:this.cohortId,skillId:this.id,isFiltered:this.isFiltered})};var e="/cohorts/"+this.cohortId+"/edit-filters";fetch(e,t).then(n=>{this.cohortsStore.getCohortSkillFilters(this.cohortId)})}},components:{}},D={key:0,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",height:"18",width:"18"},j={key:1,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 576 512",height:"18",width:"18"},B={key:0,height:"18",width:"18",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512"},z={key:1,height:"18",width:"18",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512"};function O(t,e,n,g,l,d){const a=b("FilterChild",!0);return i(),r(c,null,[s("button",{style:y(d.indent),class:m(["filter-button d-flex justify-content-between align-items-center",{"is-filtered":n.filtered==1}]),onClick:e[2]||(e[2]=o=>d.toggleChildSkills())},[s("span",{ref:"name"},u(n.name),513),s("div",null,[s("button",{class:"btn",onClick:e[0]||(e[0]=v((...o)=>d.filter&&d.filter(...o),["stop"]))},[n.filtered!=1?(i(),r("svg",D,e[3]||(e[3]=[s("path",{d:"M3.9 54.9C10.5 40.9 24.5 32 40 32l432 0c15.5 0 29.5 8.9 36.1 22.9s4.6 30.5-5.2 42.5L320 320.9 320 448c0 12.1-6.8 23.2-17.7 28.6s-23.8 4.3-33.5-3l-64-48c-8.1-6-12.8-15.5-12.8-25.6l0-79.1L9 97.3C-.7 85.4-2.8 68.8 3.9 54.9z",fill:"black"},null,-1)]))):(i(),r("svg",j,e[4]||(e[4]=[s("path",{d:"M3.9 22.9C10.5 8.9 24.5 0 40 0L472 0c15.5 0 29.5 8.9 36.1 22.9s4.6 30.5-5.2 42.5L396.4 195.6C316.2 212.1 256 283 256 368c0 27.4 6.3 53.4 17.5 76.5c-1.6-.8-3.2-1.8-4.7-2.9l-64-48c-8.1-6-12.8-15.5-12.8-25.6l0-79.1L9 65.3C-.7 53.4-2.8 36.8 3.9 22.9zM432 224a144 144 0 1 1 0 288 144 144 0 1 1 0-288zm59.3 107.3c6.2-6.2 6.2-16.4 0-22.6s-16.4-6.2-22.6 0L432 345.4l-36.7-36.7c-6.2-6.2-16.4-6.2-22.6 0s-6.2 16.4 0 22.6L409.4 368l-36.7 36.7c-6.2 6.2-6.2 16.4 0 22.6s16.4 6.2 22.6 0L432 390.6l36.7 36.7c6.2 6.2 16.4 6.2 22.6 0s6.2-16.4 0-22.6L454.6 368l36.7-36.7z",fill:"white"},null,-1)])))]),n.children.length!=0?(i(),r("button",{key:0,onClick:e[1]||(e[1]=v((...o)=>d.toggleChildSkills&&d.toggleChildSkills(...o),["stop"])),class:"btn"},[l.showChildren?(i(),r("svg",z,e[6]||(e[6]=[s("path",{fill:"black",d:"M201.4 137.4c12.5-12.5 32.8-12.5 45.3 0l160 160c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L224 205.3 86.6 342.6c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3l160-160z"},null,-1)]))):(i(),r("svg",B,e[5]||(e[5]=[s("path",{fill:"black",d:"M201.4 374.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 306.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z"},null,-1)])))])):h("",!0)])],6),l.showChildren&&n.filtered==1?(i(!0),r(c,{key:0},f(n.children,o=>(i(),p(a,{id:o.id,filtered:n.filtered,children:o.children,type:o.type,level:o.level,name:o.name,depth:n.depth+1},null,8,["id","filtered","children","type","level","name","depth"]))),256)):l.showChildren&&n.filtered==0?(i(!0),r(c,{key:1},f(n.children,o=>(i(),p(a,{id:o.id,filtered:o.filtered,children:o.children,type:o.type,level:o.level,name:o.name,depth:n.depth+1},null,8,["id","filtered","children","type","level","name","depth"]))),256)):h("",!0)],64)}const P=w(L,[["render",O],["__scopeId","data-v-ce70adab"]]);const T={setup(){return{cohortsStore:C()}},data(){return{cohortId:this.$route.params.cohortId}},computed:{},async created(){await this.cohortsStore.getCohortSkillFilters(this.cohortId)},methods:{},components:{FilterChild:P}};function U(t,e,n,g,l,d){const a=b("FilterChild");return i(!0),r(c,null,f(this.cohortsStore.cohortSkills,o=>(i(),p(a,{id:o.id,children:o.children,depth:1,name:o.name,type:o.type,filtered:o.filtered},null,8,["id","children","name","type","filtered"]))),256)}const V=w(T,[["render",U],["__scopeId","data-v-c384659f"]]);const N={setup(){return{userDetailsStore:M()}},data(){return{cohortId:this.$route.params.cohortId,cohort:{},students:[],unavailableStudents:[],members:[],showFilters:!0,showMembers:!0,isLoading:!1,showSuccessModal:!1,showDeleteModal:!1,deleteMessage:"",hideOkButton:!1}},async created(){await this.getCohort(),await this.getMembers(),await this.getUnavailableStudents(),this.students.length==0&&await this.getStudents()},components:{FilterParent:V},computed:{},methods:{async getCohort(){fetch("/cohorts/"+this.cohortId).then(function(t){return t.json()}).then(t=>{this.cohort=t})},async getMembers(){fetch("/cohorts/"+this.cohortId+"/members").then(function(t){return t.json()}).then(t=>{this.members=t})},async getUnavailableStudents(){fetch("/cohorts/unavailable/"+this.cohortId+"/list").then(function(t){return t.json()}).then(t=>{this.unavailableStudents=t})},async getStudents(){fetch("/instructor-students/"+this.userDetailsStore.userId+"/list").then(function(t){return t.json()}).then(t=>{this.students=t;for(let e=0;e<this.students.length;e++){this.students[e].isMember=!1;for(let n=0;n<this.members.length;n++)this.students[e].id==this.members[n].id&&(this.students[e].isMember=!0)}for(let e=0;e<this.students.length;e++){this.students[e].unavailable=!1;for(let n=0;n<this.unavailableStudents.length;n++)this.students[e].id==this.unavailableStudents[n].user_id&&(this.students[e].unavailable=!0)}})},submit(){this.isLoading=!0;let t=0;this.updateCohortMembers(t)},async updateCohortMembers(t){const e={method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({studentId:this.students[t].id,isMember:this.students[t].isMember})};var n="/cohorts/edit/"+this.cohortId;fetch(n,e).then(()=>{if(t+1<this.students.length)t++,this.updateCohortMembers(t);else{this.getMembers(),this.isLoading=!1,this.showSuccessModal=!0;return}})},openDeleteModal(){this.showDeleteModal=!0,this.deleteMessage="Are you sure you want to delete this cohort?",this.hideOkButton=!1},async deleteCohort(){if(this.members.length>0){this.deleteMessage="Please remove all members from this cohort before deleting it.",this.hideOkButton=!0;return}try{const t=await fetch(`/cohorts/${this.cohortId}`,{method:"DELETE"});t.ok||console.log(t.error),this.showDeleteModal=!1,this.$router.push("/cohorts")}catch(t){console.error(t)}}}},H={class:"container cohort-page bg-light rounded p-1"},E={class:"d-flex justify-content-between"},q={class:"heading"},A={key:0},J={class:"d-flex flex-column"},G={class:"d-flex flex-row justify-content-between"},K=["title"],Q={class:"d-flex"},R={key:0},W={style:{"list-style":"none"}},X={class:"form-check"},Y={class:"control control-checkbox"},Z=["value","onUpdate:modelValue","disabled"],$={class:"students"},ee={class:"d-flex flex-column mt-4"},te={class:"d-flex flex-row justify-content-between"},se=["title"],oe={class:"d-flex"},le={key:0},ne={key:1,class:"loading-animation d-flex justify-content-center align-items-center py-4"},ie={key:2,class:"modal"},re={class:"modal-content bg-light"},de={key:3,class:"modal"},he={class:"modal-content bg-light"},ae={class:"d-flex justify-content-between"};function ce(t,e,n,g,l,d){const a=b("FilterParent");return i(),r("div",H,[s("span",E,[s("h1",q,u(l.cohort.name),1),s("button",{class:"btn red-btn",onClick:e[0]||(e[0]=(...o)=>d.openDeleteModal&&d.openDeleteModal(...o))}," Delete ")]),l.isLoading==!1?(i(),r("div",A,[s("div",J,[s("div",G,[s("div",{class:"log-type",onClick:e[1]||(e[1]=o=>l.showMembers=!l.showMembers),"b-on-hover":"",title:l.showMembers?"collapse":"expand"},[s("div",Q,[e[8]||(e[8]=s("h2",{class:"secondary-heading h4"}," Available Students ",-1)),(i(),r("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 320 512",width:"22",height:"22",fill:"#667085",class:m([l.showMembers?"arrow-point-down mb-2":"arrow-point-up "])},e[7]||(e[7]=[s("path",{d:"M182.6 137.4c-12.5-12.5-32.8-12.5-45.3 0l-128 128c-9.2 9.2-11.9 22.9-6.9 34.9s16.6 19.8 29.6 19.8H288c12.9 0 24.6-7.8 29.6-19.8s2.2-25.7-6.9-34.9l-128-128z"},null,-1)]),2))]),e[9]||(e[9]=s("p",null,[s("em",null,"Please note that a student can only be in one cohort.")],-1))],8,K)])]),l.showMembers?(i(),r("div",R,[s("ul",W,[(i(!0),r(c,null,f(l.students,o=>(i(),r("li",null,[s("div",X,[s("label",Y,[F(s("input",{type:"checkbox",value:o.id,"onUpdate:modelValue":k=>o.isMember=k,disabled:!!o.unavailable},null,8,Z),[[I,o.isMember]]),e[10]||(e[10]=s("div",{class:"control_indicator"},null,-1))]),s("span",$,u(o.username),1)])]))),256))]),s("button",{class:"green-btn btn",onClick:e[2]||(e[2]=(...o)=>d.submit&&d.submit(...o))},"Submit")])):h("",!0),s("div",ee,[s("div",te,[s("div",{class:"log-type",onClick:e[3]||(e[3]=o=>l.showFilters=!l.showFilters),"b-on-hover":"",title:l.showFilters?"collapse":"expand"},[s("div",oe,[e[12]||(e[12]=s("h2",{class:"secondary-heading h4"},"Filters",-1)),(i(),r("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 320 512",width:"22",height:"22",fill:"#667085",class:m([l.showFilters?"arrow-point-down mb-2":"arrow-point-up "])},e[11]||(e[11]=[s("path",{d:"M182.6 137.4c-12.5-12.5-32.8-12.5-45.3 0l-128 128c-9.2 9.2-11.9 22.9-6.9 34.9s16.6 19.8 29.6 19.8H288c12.9 0 24.6-7.8 29.6-19.8s2.2-25.7-6.9-34.9l-128-128z"},null,-1)]),2))])],8,se)])]),_(S,{name:"dropdown"},{default:x(()=>[l.showFilters?(i(),r("div",le,[_(a)])):h("",!0)]),_:1})])):h("",!0),l.isLoading==!0?(i(),r("div",ne,e[13]||(e[13]=[s("span",{class:"loader"},null,-1)]))):h("",!0),l.showSuccessModal?(i(),r("div",ie,[s("div",re,[e[14]||(e[14]=s("p",null,"Cohort updated",-1)),s("button",{class:"btn primary-btn",onClick:e[4]||(e[4]=o=>l.showSuccessModal=!1)}," close ")])])):h("",!0),l.showDeleteModal?(i(),r("div",de,[s("div",he,[s("p",null,u(l.deleteMessage),1),s("div",ae,[s("button",{class:"btn red-btn",onClick:e[5]||(e[5]=o=>l.showDeleteModal=!1)}," Close "),s("button",{class:"btn primary-btn",style:y({display:l.hideOkButton?"none":"block"}),onClick:e[6]||(e[6]=(...o)=>d.deleteCohort&&d.deleteCohort(...o))}," Ok ",4)])])])):h("",!0)])}const me=w(N,[["render",ce],["__scopeId","data-v-a4c7bcc3"]]);export{me as default};
