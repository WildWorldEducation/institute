import{_,o,c as d,f as S,r as p,k,a as h}from"./main-84db89d7.js";import{T as D,S as T}from"./StudentDurationPerDayLineChart-f530289d.js";import{s as y}from"./transform-62bed377.js";import{l as v,m as x,f as w,b as P}from"./linear-c1216a03.js";import{b as A}from"./band-22321830.js";import{s as B}from"./sort-a49d696f.js";import"./line-61e28c6d.js";import"./time-8a8f3333.js";import"./point-ea70dc51.js";import"./ordinal-3694ef9e.js";const C={name:"TenantAvgTokensToMasterSkillsHorizontalBarChart",props:["data","colour"],data(){return{padding:60}},mounted(){y("#tenant-avg-tokens-to-master-skills-chart-container");const t=25,e=0,r=0,u=10,s=200,l=1e3,c=Math.ceil((this.data.length+.1)*t)+e+u,n=v().domain([0,x(this.data,a=>a.quantity)]).range([s,l-r]),i=A().domain(B(this.data,a=>-a.quantity).map(a=>a.name)).rangeRound([e,c-u]).padding(.1),g=n.tickFormat(20),m=y("#tenant-avg-tokens-to-master-skills-chart-container").append("svg").attr("width",l).attr("height",c).attr("viewBox",[0,0,l,c]).attr("style","max-width: 100%; height: 100%; font: 14px sans-serif;");m.append("g").attr("fill",this.colour).selectAll().data(this.data).join("rect").attr("x",n(0)).attr("y",a=>i(a.name)).attr("width",a=>n(a.quantity)-n(0)).attr("height",i.bandwidth()),m.append("g").attr("fill","white").attr("text-anchor","end").selectAll().data(this.data).join("text").attr("x",a=>n(a.quantity)).attr("y",a=>i(a.name)+i.bandwidth()/2).attr("dy","0.35em").attr("dx",-4).text(a=>g(a.quantity)).call(a=>a.filter(f=>n(f.quantity)-n(0)<20).attr("dx",4).attr("fill","black").attr("text-anchor","start")),m.append("g").attr("transform",`translate(0,${e})`).call(w(n).ticks(0)).call(a=>a.select(".domain").remove()),m.append("g").attr("transform",`translate(${s},0)`).call(P(i).tickSizeOuter(0))},computed:{}},M={id:"tenant-avg-tokens-to-master-skills-chart-container"};function $(t,e,r,u,s,l){return o(),d("div",M)}const H=_(C,[["render",$],["__scopeId","data-v-6e86d297"]]),b={setup(){return{userDetailsStore:S()}},components:{TimePerSkillHorizontalBarChart:D,StudentDurationPerDayLineChart:T,StudentAvgTokensToMasterSkillsHorizontalBarChart:H},data(){return{studentId:this.userDetailsStore.userId,skillDurations:[],durationsPerDay:[],tokensPerSkills:[]}},async created(){await this.getSkillDuration(),await this.getStudentDurationPerDay(),await this.getAvgTokensToMasterSkills()},methods:{async getSkillDuration(){fetch(`/student-analytics/skill-durations/${this.studentId}`).then(t=>t.json()).then(t=>{this.skillDurations=t;for(let e=0;e<this.skillDurations.length;e++)this.skillDurations[e].formattedQuantity=this.millisToMinutesAndSeconds(this.skillDurations[e].quantity)}).catch(t=>{console.error("Error fetching last visited skills:",t)})},async getStudentDurationPerDay(){fetch(`/student-analytics/student-duration-per-day/${this.studentId}`).then(t=>t.json()).then(t=>{for(let e=0;e<t.length;e++)t[e].formattedQuantity=t[e].quantity/1e3,t[e].date=new Date(t[e].date);t.sort((e,r)=>e.date-r.date),this.durationsPerDay=t}).catch(t=>{console.error("Error fetching student duration per day:",t)})},async getAvgTokensToMasterSkills(){try{const t=await fetch(`/student-analytics/avg-tokens-to-master-skills/student/${this.studentId}`);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const e=await t.json();this.tokensPerSkills=Array.isArray(e)?e:[]}catch(t){console.error("Error fetching cohort mastered assessments:",t),this.tokensPerSkills=[]}},millisToMinutesAndSeconds(t){var e=Math.floor(t/6e4),r=(t%6e4/1e3).toFixed(0);return e+":"+(r<10?"0":"")+r}}},z={class:"container"},q=h("span",{class:"d-flex justify-content-between w-100"},[h("h1",{class:"heading"},"My Progress")],-1),j=h("h4",null,"Time spent on each skill",-1),I={key:1},E=h("h4",{class:"mt-5"},"Time spent per day",-1),L={key:3},N=h("h4",{class:"mt-5"},"Tokens spent per skill",-1),F={key:5};function Q(t,e,r,u,s,l){const c=p("TimePerSkillHorizontalBarChart"),n=p("StudentDurationPerDayLineChart"),i=p("StudentAvgTokensToMasterSkillsHorizontalBarChart");return o(),d("div",z,[q,j,s.skillDurations.length>0?(o(),k(c,{key:0,data:s.skillDurations,colour:"purple"},null,8,["data"])):(o(),d("p",I,"No data yet")),E,s.durationsPerDay.length>0?(o(),k(n,{key:2,data:s.durationsPerDay,colour:"purple"},null,8,["data"])):(o(),d("p",L,"No data yet")),N,s.tokensPerSkills.length>0?(o(),k(i,{key:4,class:"mb-5",data:s.tokensPerSkills,colour:"purple"},null,8,["data"])):(o(),d("p",F,"No data yet"))])}const Z=_(b,[["render",Q]]);export{Z as default};
