import{_ as y,f as b,L as g,i as f,o as u,c as d,a as e,q as c,t as h,s as m,b as p,F as k,z as _,p as S,d as T}from"./main-a9341a46.js";const w={setup(){const s=b(),t=g(),n=f();return{userDetailsStore:s,settingsStore:t,sessionDetailsStore:n}},data(){return{monthlyTokenUsage:null,year:0,month:"",isAITokenLimitReached:!1,isMobileCheck:window.innerWidth,showTooltip:!1,receipts:[],isAITokenLimitReached:!1,assistantsModelPrice:{input:75,output:150}}},async created(){this.settingsStore.freeTokenMonthlyLimit==0&&await this.settingsStore.getSettings(),await this.userDetailsStore.getUserDetails()},async mounted(){let s=document.createElement("script");s.setAttribute("src","https://js.stripe.com/v3/"),document.head.appendChild(s);let t=this.userDetailsStore.monthlyTokenUsage-this.settingsStore.freeTokenMonthlyLimit;this.settingsStore.freeTokenMonthlyLimit<=this.userDetailsStore.monthlyTokenUsage&&t>this.userDetailsStore.tokens&&(this.isAITokenLimitReached=!0),this.year=new Date().getFullYear();const n=["January","February","March","April","May","June","July","August","September","October","November","December"],i=new Date;this.month=n[i.getMonth()],this.getReceipts()},computed:{formattedStripeCurrentPeriodEndDate(){let s=new Date(this.subscription.current_period_end*1e3);const t="en-US",n=new Intl.DateTimeFormat(t,{weekday:"long"}).format(s),i=s.getDate();let o="th";i%10===1&&i!==11&&(o="st"),i%10===2&&i!==12&&(o="nd"),i%10===3&&i!==13&&(o="rd");const r=new Intl.DateTimeFormat(t,{month:"long"}).format(s),a=s.getFullYear();return`${n} the ${i}${o} of ${r}, ${a}`},formattedMonthlyTokenUsage(){return this.userDetailsStore.monthlyTokenUsage?this.userDetailsStore.monthlyTokenUsage.toLocaleString():"0"}},methods:{async getReceipts(){const t=await(await fetch("/subscriptions/get-receipts/"+this.userDetailsStore.userId)).json();for(let n=0;n<t.charges.data.length;n++)this.receipts.push(t.charges.data[n])},checkout(s){fetch("/subscriptions/create-checkout-session",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:this.userDetailsStore.userId,numberOfTokens:s})}).then(t=>t.ok?t.json():t.json().then(n=>Promise.reject(n))).then(({url:t})=>{window.location=t}).catch(t=>{console.error(t.error)})},loadPortal(){fetch("/subscriptions/create-customer-portal-session",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:this.userDetailsStore.userId})}).then(s=>s.ok?s.json():s.json().then(t=>Promise.reject(t))).then(({url:s})=>{window.location=s}).catch(s=>{console.error(s.error)})},formattedStripeReceiptDate(s){let t=new Date(s.created*1e3);const n=t.getUTCMonth()+1,i=t.getUTCDate();return t.getUTCFullYear()+"/"+n+"/"+i},formattedStripeReceiptAmount(s){return(s.amount_captured/100).toLocaleString("en-US",{style:"currency",currency:"USD"})},openTooltip(){this.showTooltip=!0},closeTooltip(){this.showTooltip=!1}}},l=s=>(S("data-v-73bdb60e"),s=s(),T(),s),D={class:"container"},v={class:"row"},C={class:"col-md"},M=l(()=>e("strong",null,"Free limit:",-1)),I=l(()=>e("strong",null,"Current token usage:",-1)),L=l(()=>e("strong",null,"Your tokens:",-1)),U={key:0,class:"modal"},j={class:"modal-content"},x=l(()=>e("p",null," It is against our policy to share accounts and each account is meant to only be used by one user. ",-1)),A=l(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 192 512",width:"20",height:"20",class:"primary-icon"},[e("path",{d:"M48 80a48 48 0 1 1 96 0A48 48 0 1 1 48 80zM0 224c0-17.7 14.3-32 32-32l64 0c17.7 0 32 14.3 32 32l0 224 32 0c17.7 0 32 14.3 32 32s-14.3 32-32 32L32 512c-17.7 0-32-14.3-32-32s14.3-32 32-32l32 0 0-192-32 0c-17.7 0-32-14.3-32-32z"})],-1)),R=[A],F=l(()=>e("hr",null,null,-1)),N={class:"row mt-4"},O=l(()=>e("h2",{class:"secondary-heading h5"},"200,000 tokens",-1)),P=l(()=>e("p",null,"$10",-1)),Y=l(()=>e("h2",{class:"secondary-heading h5"},"400,000 tokens",-1)),B=l(()=>e("p",null,"$20",-1)),J=l(()=>e("h2",{class:"secondary-heading h5"},"1,000,000 tokens",-1)),z=l(()=>e("p",null,"$50",-1)),V=l(()=>e("hr",null,null,-1)),E=l(()=>e("h2",{class:"secondary-heading h4"},"Receipts",-1)),q=["href"],W={key:0};function G(s,t,n,i,o,r){return u(),d("div",D,[e("div",v,[e("div",C,[e("h2",{class:c(["secondary-heading h4 mb-4",{"text-center":o.isMobileCheck<576}])}," Monthly AI usage: "+h(o.month)+" "+h(o.year),3),e("ul",null,[e("li",null,[e("p",null,[M,m(" "+h(i.settingsStore.freeTokenMonthlyLimit.toLocaleString()),1)])]),e("li",null,[e("p",null,[I,m(" "+h(r.formattedMonthlyTokenUsage),1)])]),e("li",null,[e("p",null,[L,m(" "+h(i.userDetailsStore.tokens.toLocaleString()),1)])])]),o.isAITokenLimitReached?(u(),d("div",{key:0,class:c(["alert alert-warning",{"mb-0":o.isMobileCheck>=576}]),role:"alert"}," You are over the monthly free limit. You can't use the AI features until next month. ",2)):p("",!0)]),o.showTooltip?(u(),d("div",U,[e("div",j,[e("div",null,[x,e("button",{class:"btn primary-btn",onClick:t[0]||(t[0]=(...a)=>r.closeTooltip&&r.closeTooltip(...a))}," Close ")])])])):p("",!0),e("div",{class:c(["col-md d-flex",o.isMobileCheck>576?"justify-content-end":"justify-content-center"])},[e("button",{class:"btn primary-btn",onClick:t[1]||(t[1]=a=>r.loadPortal())}," Manage billing "),e("button",{class:"btn info-btn ms-1",onClick:t[2]||(t[2]=(...a)=>r.openTooltip&&r.openTooltip(...a))},R)],2)]),F,e("div",N,[e("div",{class:c(["col-md mb-3",{"text-center":o.isMobileCheck<576}])},[O,P,e("button",{onClick:t[3]||(t[3]=a=>r.checkout(2e5)),class:"btn primary-btn mt-1"}," buy ")],2),e("div",{class:c(["col-md mb-3",{"text-center":o.isMobileCheck<576}])},[Y,B,e("button",{onClick:t[4]||(t[4]=a=>r.checkout(4e5)),class:"btn primary-btn mt-1"}," buy ")],2),e("div",{class:c(["col-md mb-3",{"text-center":o.isMobileCheck<576}])},[J,z,e("button",{onClick:t[5]||(t[5]=a=>r.checkout(1e6)),class:"btn primary-btn mt-1"}," buy ")],2)]),V,e("div",{class:c({"text-center":o.isMobileCheck<576})},[E,(u(!0),d(k,null,_(o.receipts,a=>(u(),d("div",null,[e("a",{href:a.receipt_url,target:"_blank"},h(r.formattedStripeReceiptAmount(a))+" "+h(r.formattedStripeReceiptDate(a)),9,q)]))),256)),o.isMobileCheck<576?(u(),d("p",W,"Â ")):p("",!0)],2)])}const K=y(w,[["render",G],["__scopeId","data-v-73bdb60e"]]);export{K as default};
