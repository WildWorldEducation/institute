import{_ as f,e as g,r as m,o as i,c as h,a as o,f as v,j as _,b as y,F as $}from"./main-c6062aed.js";import{u as A}from"./AnalyticsStore-7dbb0765.js";import"./transform-af9a74a2.js";import{l as b,c as C,b as x}from"./linear-5b188edc.js";import{m as B,b as D}from"./continuous-7328829e.js";import{s as T}from"./sort-ed61f96d.js";import{s as k}from"./string-dd82ab4a.js";import{D as w}from"./downloadCSVBtn-bbf40106.js";import{F}from"./FailedAssessmentsHorizontalBarChart-0bd45108.js";const R={name:"TenantFailedAssessmentsHorizontalBarChart",props:["data","colour"],data(){return{}},mounted(){this.data;const l=document.getElementById("failed-assessments-chart-container").clientWidth,r=30*this.data.length+0+10,a=b().domain([0,B(this.data,e=>e.quantity)]).range([200,l-0]),c=D().domain(T(this.data,e=>-e.quantity).map(e=>e.name)).rangeRound([0,r-10]).padding(.1),u=k("#failed-assessments-chart-container").append("svg").attr("width",l).attr("height",r).attr("viewBox",[0,0,+Math.min(l,r),+Math.min(l,r)]).attr("preserveAspectRatio","xMinYMin");u.append("g").attr("fill","darkred").selectAll().data(this.data).join("rect").attr("x",a(0)).attr("y",e=>c(e.name)).attr("width",e=>a(e.quantity)-a(0)).attr("height",c.bandwidth()),u.append("g").attr("fill","white").attr("text-anchor","end").selectAll().data(this.data).join("text").attr("x",e=>a(e.quantity)).attr("y",e=>c(e.name)+c.bandwidth()/2).attr("dy","0.35em").attr("dx",-4).text(e=>e.quantity).call(e=>e.filter(S=>a(S.quantity)-a(0)<20).attr("dx",4).attr("fill","black").attr("text-anchor","start")),u.append("g").attr("transform","translate(0,0)").call(C(a).ticks(0)).call(e=>e.select(".domain").remove()),u.append("g").attr("transform","translate(200,0)").call(x(c).tickSizeOuter(0))}};function z(t,s,p,n,d,l){return null}const H=f(R,[["render",z]]);const L={setup(){const t=g(),s=A();return{userDetailsStore:t,analyticsStore:s}},components:{TenantFailedAssessmentsHorizontalBarChart:H,DownloadCSVBtn:w},data(){return{studentId:this.$route.params.studentId}},async created(){this.analyticsStore.failedAssessments.length==0&&await this.getFailedAssessments()},methods:{async getFailedAssessments(){try{const t=await fetch(`/student-analytics/failed-assessments/tenant/${this.userDetailsStore.tenantId}`);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);this.analyticsStore.failedAssessments=await t.json()}catch(t){console.error("Error fetching cohort mastered assessments:",t),this.analyticsStore.failedAssessments=[]}}}},V={class:"container chart-page"},j={class:"row h-100"},I={class:"col-md position-relative overflow-auto"},q={id:"failed-assessments-chart-container"},E={key:1};function M(t,s,p,n,d,l){const r=m("DownloadCSVBtn"),a=m("TenantFailedAssessmentsHorizontalBarChart");return i(),h("div",V,[o("div",j,[o("div",I,[s[0]||(s[0]=o("h3",{class:"heading h4"},"School-wide assessments failed",-1)),o("div",q,[v(r,{data:n.analyticsStore.failedAssessments,fileName:"Assessments-failed",toolTip:"Download CSV",class:"download-btn position-absolute"},null,8,["data"]),n.analyticsStore.failedAssessments.length>0?(i(),_(a,{key:0,data:n.analyticsStore.failedAssessments},null,8,["data"])):(i(),h("p",E,"No data yet"))])])])])}const Q=f(L,[["render",M],["__scopeId","data-v-adb2bf72"]]);const N={setup(){const t=g(),s=A();return{userDetailsStore:t,analyticsStore:s}},components:{FailedAssessmentsHorizontalBarChart:F,DownloadCSVBtn:w},data(){return{failedAssessmentQuantities:[],failedAssessmentQuantitiesDownloadData:[]}},async created(){this.getAllStudentsFailedAssessments()},methods:{async getAllStudentsFailedAssessments(){try{const t=await fetch(`/student-analytics/failed-assessments/all-students/${this.userDetailsStore.userId}`);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const s=await t.json();this.failedAssessmentQuantities=Array.isArray(s)?s:[]}catch(t){console.error("Error fetching all students failed assessments:",t),this.failedAssessmentQuantities=[]}}}},P={class:"container chart-page"},O={class:"row h-100"},U={class:"col-md position-relative"},W={id:"fails-by-skill-chart-container"},Y={key:1};function G(t,s,p,n,d,l){const r=m("FailedAssessmentsHorizontalBarChart");return i(),h("div",P,[o("div",O,[o("div",U,[s[2]||(s[2]=o("h3",{class:"heading h4"},"Assessments failed",-1)),o("div",W,[o("button",{class:"position-absolute download-btn btn",onClick:s[0]||(s[0]=a=>t.downloadData(n.analyticsStore.rootSubjectsFailedAssessments,"Subjects-failed"))},s[1]||(s[1]=[o("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",width:"18",height:"18"},[o("path",{d:"M0 64C0 28.7 28.7 0 64 0L213.5 0c17 0 33.3 6.7 45.3 18.7L365.3 125.3c12 12 18.7 28.3 18.7 45.3L384 448c0 35.3-28.7 64-64 64L64 512c-35.3 0-64-28.7-64-64L0 64zm208-5.5l0 93.5c0 13.3 10.7 24 24 24L325.5 176 208 58.5zM175 441c9.4 9.4 24.6 9.4 33.9 0l64-64c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0l-23 23 0-86.1c0-13.3-10.7-24-24-24s-24 10.7-24 24l0 86.1-23-23c-9.4-9.4-24.6-9.4-33.9 0s-9.4 24.6 0 33.9l64 64z"})],-1)])),d.failedAssessmentQuantities.length>0?(i(),_(r,{key:0,data:d.failedAssessmentQuantities},null,8,["data"])):(i(),h("p",Y,"Students have not failed any assessments more than once yet"))])])])])}const J=f(N,[["render",G],["__scopeId","data-v-1eb1a053"]]),K={name:"Dashboard",setup(){return{userDetailsStore:g()}},data(){return{}},components:{SchoolAdminChallengesReport:Q,TeacherChallengesReport:J},async created(){}};function X(t,s,p,n,d,l){const r=m("SchoolAdminChallengesReport"),a=m("TeacherChallengesReport");return i(),h($,null,[n.userDetailsStore.role=="school_admin"?(i(),_(r,{key:0})):y("",!0),n.userDetailsStore.role=="instructor"||n.userDetailsStore.role=="partner"?(i(),_(a,{key:1})):y("",!0)],64)}const lt=f(K,[["render",X]]);export{lt as default};
