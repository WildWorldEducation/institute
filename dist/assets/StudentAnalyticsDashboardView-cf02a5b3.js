import{u as T}from"./AnalyticsStore-585cd30a.js";import{u as I}from"./TeacherAnalyticsStore-9aa42c7a.js";import{_ as x,o as u,c as _,f as P,r as D,a as t,g as y,l as S,k as C,b,F as B,z as j,t as q,s as w,p as M,d as R}from"./main-694b4f39.js";import"./transform-4d0f7c8f.js";import{u as L,l as F}from"./line-d122782f.js";import{e as H}from"./time-3c9385c3.js";import{l as k,a as V,b as N}from"./linear-d9b6cbf2.js";import{m as A}from"./continuous-93813e6c.js";import{o as O,b as z}from"./band-2263c9e7.js";import{s as f}from"./string-c67ea49d.js";import{c as E}from"./category10-63f9141e.js";import{s as W}from"./sort-fcaf8f38.js";import"./point-ea70dc51.js";import"./colors-98f238a0.js";const Y={name:"SchoolProgressChart",props:[],data(){return{axisData:[]}},mounted(){},methods:{createChart(s){f("svg").remove(),s.student.length>0?this.axisData=s.student:s.average.length>0?this.axisData=s.average:this.axisData=[];const d=Object.entries(s).map(([a,$])=>({name:a,values:$}));f("#progress-chart-container");const o=document.getElementById("progress-chart-container").clientWidth,r=document.getElementById("progress-chart-container").clientHeight,h=0,p=0,c=0,g=0,n=L(H(this.axisData,a=>a.date),[g,o-p]),l=k([0,A(this.axisData,a=>a.quantity)],[r-c,h]),v=O().domain(d.map(a=>a.name)).range(E),m=F().x(a=>n(a.date)).y(a=>l(a.quantity));f("#progress-chart-container").append("svg").attr("width","100%").attr("height","100%").attr("viewBox",[0,0,+Math.min(o,r),+Math.min(o,r)]).attr("preserveAspectRatio","xMinYMin").selectAll(".line").data(d).join("path").attr("fill","none").attr("stroke",a=>v(a.name)).attr("stroke-width",3).attr("d",a=>m(a.values))}}};function U(s,d,o,r,h,p){return null}const G=x(Y,[["render",U]]),J={name:"StudentComparisonChart",props:["data","colour"],data(){return{}},mounted(){},methods:{createChart(s){f("#student-comparison-container");const d=25,o=0,r=0,h=10,p=200,c=700,g=Math.ceil((s.length+.1)*d)+o+h,n=k().domain([0,A(s,e=>e.quantity)]).range([p,c-r]),l=z().domain(W(s,e=>-e.quantity).map(e=>e.name)).rangeRound([o,g-h]).padding(.1),v=n.tickFormat(20),m=f("#student-comparison-container").append("svg").attr("width",c).attr("height",g).attr("viewBox",[0,0,c,g]).attr("style","max-width: 100%; height: 100%; font: 14px sans-serif;");m.append("g").attr("fill",this.colour).selectAll().data(s).join("rect").attr("x",n(0)).attr("y",e=>l(e.name)).attr("width",e=>n(e.quantity)-n(0)).attr("height",l.bandwidth()),m.append("g").attr("fill","white").attr("text-anchor","end").selectAll().data(s).join("text").attr("x",e=>n(e.quantity)).attr("y",e=>l(e.name)+l.bandwidth()/2).attr("dy","0.35em").attr("dx",-4).text(e=>v(e.quantity)).call(e=>e.filter(a=>n(a.quantity)-n(0)<20).attr("dx",4).attr("fill","black").attr("text-anchor","start")),m.append("g").attr("transform",`translate(0,${o})`).call(V(n).ticks(0)).call(e=>e.select(".domain").remove()),m.append("g").attr("transform",`translate(${p},0)`).attr("style","font-size: 16px").call(N(l).tickSizeOuter(0))}}},K={id:"student-comparison-container"};function Q(s,d,o,r,h,p){return u(),_("div",K)}const X=x(J,[["render",Q]]);const Z={name:"Student-Dashboard",setup(){const s=P(),d=T(),o=I();return{userDetailsStore:s,analyticsStore:d,teacherAnalyticsStore:o}},data(){return{showSidebar:!0,screenWidth:screen.width,isStudentData:!0,isSchoolData:!0,isLanguageData:!1,isMathData:!1,isHistoryData:!1,isLifeData:!1,isCSData:!1,isSAndIData:!1,isDIData:!1,progressData:{student:[],average:[]},isAboveTheCurve:!1}},components:{StudentProgressChart:G,StudentComparisonChart:X},async created(){await this.analyticsStore.getStudentProgress(this.userDetailsStore.userId,this.userDetailsStore.tenantId),await this.analyticsStore.getStudentPassedAssessmentsBySubject(this.userDetailsStore.userId),await this.teacherAnalyticsStore.getStudentMultipleFails(this.userDetailsStore.userId),console.log(this.teacherAnalyticsStore.studentMultipleFails),this.analyticsStore.progress.student[this.analyticsStore.progress.student.length-1].quantity>this.analyticsStore.progress.tenant[this.analyticsStore.progress.tenant.length-1].quantity&&(this.isAboveTheCurve=!0),await this.HandleProgressData(),await this.HandleComparisonData()},methods:{async HandleProgressData(){if(this.isStudentData){this.progressData.student=[];for(let s=0;s<this.analyticsStore.progress.student.length;s++)this.progressData.student.push(this.analyticsStore.progress.student[s])}else this.progressData.student=[];if(this.isSchoolData){this.progressData.average=[];for(let s=0;s<this.analyticsStore.progress.tenant.length;s++)this.progressData.average.push(this.analyticsStore.progress.tenant[s])}else this.progressData.average=[];this.$nextTick(()=>{this.$refs.progressChart&&this.$refs.progressChart.createChart(this.progressData)})},async HandleComparisonData(){this.$nextTick(()=>{this.$refs.comparisonChart&&this.$refs.comparisonChart.createChart(this.analyticsStore.studentRootSubjectsPassedAssessments)})},toggleSidebar(){this.showSidebar=!this.showSidebar}}},i=s=>(M("data-v-c53f8f05"),s=s(),R(),s),tt={class:"dashboard"},st={class:"main"},et={class:"content container"},at={class:"dash-row row"},ot={class:"col-md-6 h-100 p-0 position-relative"},rt={id:"progress-chart-container"},nt={class:"position-absolute chart-heading"},it=i(()=>t("h2",{class:"heading h5"}," Progress over time ",-1)),ct=i(()=>t("span",{style:{color:"#5f31dd"}},[t("strong",null,"You")],-1)),lt=i(()=>t("br",null,null,-1)),dt=i(()=>t("span",{style:{color:"#ff7f0e"}},[t("strong",null,"School average")],-1)),ht={class:"col-md-6 position-relative"},ut=i(()=>t("h2",{class:"heading chart-heading h5 mt-1"}," Subject comparison ",-1)),pt=i(()=>t("p",null,[t("em",null,"TODO: different color for each subject")],-1)),gt={class:"dash-row row"},mt={class:"col-md p-0 position-relative"},_t={class:"position-absolute chart-heading"},ft=i(()=>t("h2",{class:"heading h5"},"Study time",-1)),yt={class:"col-md p-0 position-relative"},St={class:"row"},vt={class:"col"},Dt=i(()=>t("h2",{class:"h5 heading"}," Super challenging skills ",-1)),xt={key:0},wt={key:1},Ct={class:"col"},bt=i(()=>t("h2",{class:"h5 heading"},"Stats",-1)),kt=i(()=>t("li",null,[t("strong",null,"Skills passed:"),w(" 25")],-1)),At=i(()=>t("li",null,[t("strong",null,"Total time spent:"),w(" 5:00 ")],-1)),$t=i(()=>t("strong",null,"Tokens used:",-1));function Tt(s,d,o,r,h,p){const c=D("RouterLink"),g=D("StudentProgressChart"),n=D("StudentComparisonChart");return u(),_("div",tt,[t("div",st,[t("div",et,[t("div",at,[t("div",ot,[t("div",rt,[t("div",nt,[y(c,{to:"/my-progress/skills",class:""},{default:S(()=>[it]),_:1}),ct,lt,dt]),h.progressData.student.length>0||h.progressData.average.length>0?(u(),C(g,{key:0,ref:"progressChart"},null,512)):b("",!0)])]),t("div",ht,[ut,pt,r.analyticsStore.studentRootSubjectsPassedAssessments.length>0?(u(),C(n,{key:0,ref:"comparisonChart",data:r.analyticsStore.studentRootSubjectsPassedAssessments,colour:"#5f31dd"},null,8,["data"])):b("",!0)])]),t("div",gt,[t("div",mt,[t("div",_t,[y(c,{to:"/my-progress/time"},{default:S(()=>[ft]),_:1})])]),t("div",yt,[t("div",St,[t("div",vt,[y(c,{to:"/my-progress/super-challenging",class:"col"},{default:S(()=>[Dt]),_:1}),r.teacherAnalyticsStore.studentMultipleFails.length>0?(u(),_("ul",xt,[(u(!0),_(B,null,j(r.teacherAnalyticsStore.studentMultipleFails,l=>(u(),_("li",{key:l.id},q(l.name),1))),128))])):(u(),_("p",wt,"Nothing to worry about yet"))]),t("div",Ct,[bt,t("ul",null,[kt,At,t("li",null,[y(c,{to:"/my-progress/tokens"},{default:S(()=>[$t,w(" 10,000")]),_:1})])])])])])])])])])}const Et=x(Z,[["render",Tt],["__scopeId","data-v-c53f8f05"]]);export{Et as default};
