import{_ as m,f as S,L as g,i as y,o as r,c as l,a as e,q as b,t as u,s as p,b as d,p as f,d as T}from"./main-6f1da47c.js";const k={setup(){const s=S(),t=g(),a=y();return{userDetailsStore:s,settingsStore:t,sessionDetailsStore:a}},data(){return{monthlyTokenUsage:null,year:0,month:"",isAITokenLimitReached:!1,isMobileCheck:window.innerWidth,showTooltip:!1,subscription:{},subSchedule:{},basicPlanPriceId:"price_1RCKSvFfW0WtxYZHCcfnbL5R",infinitePlanPriceId:"price_1RCKUZFfW0WtxYZHxz1ksgww",nextSubSchedulePhasePlan:""}},async created(){this.settingsStore.freePlanTokenLimit||await this.settingsStore.getSettings(),await this.userDetailsStore.getUserDetails(),await this.getSubscription()},async mounted(){let s=document.createElement("script");s.setAttribute("src","https://js.stripe.com/v3/"),document.head.appendChild(s),this.userDetailsStore.subscriptionTier=="free"?this.settingsStore.freePlanTokenLimit&&this.userDetailsStore.monthlyTokenUsage&&this.settingsStore.freePlanTokenLimit<=this.userDetailsStore.monthlyTokenUsage&&(this.isAITokenLimitReached=!0):this.userDetailsStore.subscriptionTier=="basic"&&this.settingsStore.basicPlanTokenLimit&&this.userDetailsStore.monthlyTokenUsage&&this.settingsStore.basicPlanTokenLimit<=this.userDetailsStore.monthlyTokenUsage&&(this.isAITokenLimitReached=!0),this.year=new Date().getFullYear();const t=["January","February","March","April","May","June","July","August","September","October","November","December"],a=new Date;this.month=t[a.getMonth()]},computed:{formattedStripeCurrentPeriodEndDate(){let s=new Date(this.subscription.current_period_end*1e3);const t=s.getUTCMonth()+1,a=s.getUTCDate();return s.getUTCFullYear()+"/"+t+"/"+a},formattedMonthlyTokenUsage(){return this.userDetailsStore.monthlyTokenUsage?this.userDetailsStore.monthlyTokenUsage.toLocaleString():"0"},formattedFreePlanTokenLimit(){return this.settingsStore.freePlanTokenLimit?this.settingsStore.freePlanTokenLimit.toLocaleString():"0"},formattedBasicPlanTokenLimit(){return this.settingsStore.basicPlanTokenLimit?this.settingsStore.basicPlanTokenLimit.toLocaleString():"0"},subscriptionTierFormatted(){return this.userDetailsStore.subscriptionTier?this.userDetailsStore.subscriptionTier.toLocaleString():"free"}},methods:{async getSubscription(){const t=await(await fetch("/subscriptions/get-sub/"+this.userDetailsStore.userId)).json();if(this.subscription=t.subscription,this.subSchedule=t.subSchedule,this.subSchedule){let a=this.subSchedule.phases[1].items[0].price;a==this.basicPlanPriceId?this.nextSubSchedulePhasePlan="Basic":a==this.infinitePlanPriceId&&(this.nextSubSchedulePhasePlan="Infinite"),console.log(this.nextSubSchedulePhasePlan)}console.log(t)},checkout(s){fetch("/subscriptions/create-checkout-session",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:this.userDetailsStore.userId,planType:s})}).then(t=>t.ok?t.json():t.json().then(a=>Promise.reject(a))).then(({url:t})=>{window.location=t}).catch(t=>{console.error(t.error)})},loadPortal(){fetch("/subscriptions/create-customer-portal-session",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:this.userDetailsStore.userId})}).then(s=>s.ok?s.json():s.json().then(t=>Promise.reject(t))).then(({url:s})=>{window.location=s}).catch(s=>{console.error(s.error)})},cancelPlan(){if(confirm("Are you sure you want to downgrade to the Free plan?"))fetch("/subscriptions/cancel",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:this.userDetailsStore.userId})}).then(()=>{this.getSubscription()});else return},downgradePlan(){if(confirm("Are you sure you want to downgrade to the Basic plan?"))fetch("/subscriptions/downgrade",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({subscriptionId:this.subscription.id,subScheduleId:this.subSchedule?this.subSchedule.id:null})}).then(()=>{this.getSubscription()});else return},upgradePlan(){if(confirm("Are you sure you want to upgrade to the Infinite plan?"))fetch("/subscriptions/upgrade",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:this.userDetailsStore.userId})}).then(()=>{this.getSubscription()});else return},openTooltip(){this.showTooltip=!0},closeTooltip(){this.showTooltip=!1}}},o=s=>(f("data-v-2e6b60f8"),s=s(),T(),s),_={class:"container"},P={class:"d-flex justify-content-end w-100"},w=o(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 192 512",width:"20",height:"20",class:"primary-icon"},[e("path",{d:"M48 80a48 48 0 1 1 96 0A48 48 0 1 1 48 80zM0 224c0-17.7 14.3-32 32-32l64 0c17.7 0 32 14.3 32 32l0 224 32 0c17.7 0 32 14.3 32 32s-14.3 32-32 32L32 512c-17.7 0-32-14.3-32-32s14.3-32 32-32l32 0 0-192-32 0c-17.7 0-32-14.3-32-32z"})],-1)),D=[w],C={class:"row mt-4"},I={class:"col-md mb-3"},v=o(()=>e("strong",null,"Your subscription tier:",-1)),x=o(()=>e("strong",null,"Current token usage:",-1)),L={key:0,class:"alert alert-warning",role:"alert"},j={key:1,class:"alert alert-warning",role:"alert"},M={key:2,class:"alert alert-warning",role:"alert"},U={key:0,class:"modal"},A={class:"modal-content"},F=o(()=>e("p",null," It is against our policy to share accounts and each account is meant to only be used by one user. ",-1)),O=o(()=>e("hr",null,null,-1)),B={class:"row mt-4"},N=o(()=>e("h2",{class:"secondary-heading h4"},"Free",-1)),Y=o(()=>e("strong",null,"Token limit:",-1)),J={key:0,disabled:"",class:"btn primary-btn mt-1"},R=o(()=>e("h2",{class:"secondary-heading h4"},"Basic",-1)),E=o(()=>e("p",null,"Ideal for moderate use",-1)),W=o(()=>e("p",null,"$20 / month",-1)),z=o(()=>e("strong",null,"Token limit:",-1)),V={key:2,disabled:"",class:"btn primary-btn mt-1 mb-3"},Z=o(()=>e("h2",{class:"secondary-heading h4"},"Infinite",-1)),H=o(()=>e("p",null,"Ideal for daily use",-1)),K=o(()=>e("p",null,"$100 / month",-1)),q=o(()=>e("p",null,[e("strong",null,"Token limit:"),p(" Infinite ")],-1)),G={key:2,disabled:"",class:"btn primary-btn mt-1"};function Q(s,t,a,h,i,n){return r(),l("div",_,[e("div",P,[e("button",{class:"btn mb-2",onClick:t[0]||(t[0]=(...c)=>n.openTooltip&&n.openTooltip(...c))},D)]),e("div",C,[e("div",I,[e("h2",{class:b(["secondary-heading h4 mb-4",{"text-center":i.isMobileCheck<576}])}," Monthly AI usage: "+u(i.month)+" "+u(i.year),3),e("ul",null,[e("li",null,[e("p",null,[v,p(" "+u(n.subscriptionTierFormatted),1)])]),e("li",null,[e("p",null,[x,p(" "+u(n.formattedMonthlyTokenUsage),1)])])]),i.isAITokenLimitReached?(r(),l("div",L," You are over the monthly free limit. You can't use the AI features until next month. ")):d("",!0),i.subscription&&i.subscription.cancel_at_period_end?(r(),l("div",j," Your plan will downgrade to the Free plan on "+u(n.formattedStripeCurrentPeriodEndDate),1)):d("",!0),i.nextSubSchedulePhasePlan!=""?(r(),l("div",M," Your plan will downgrade to the "+u(i.nextSubSchedulePhasePlan)+" plan on "+u(n.formattedStripeCurrentPeriodEndDate),1)):d("",!0)]),i.showTooltip?(r(),l("div",U,[e("div",A,[e("div",null,[F,e("button",{class:"btn primary-btn",onClick:t[1]||(t[1]=(...c)=>n.closeTooltip&&n.closeTooltip(...c))}," Close ")])])])):d("",!0),e("div",{class:b(["col-md mb-3 d-flex",i.isMobileCheck>576?"justify-content-end":"justify-content-center"])},[h.userDetailsStore.subscriptionTier!="free"?(r(),l("button",{key:0,class:"btn primary-btn",onClick:t[2]||(t[2]=c=>n.loadPortal())}," Manage billing ")):d("",!0)],2)]),O,e("div",B,[e("div",{class:b(["col-md mb-3",{"text-center":i.isMobileCheck<576}])},[N,e("p",null,[Y,p(" "+u(n.formattedFreePlanTokenLimit),1)]),h.userDetailsStore.subscriptionTier=="free"?(r(),l("button",J," current plan ")):i.subscription&&i.subscription.cancel_at_period_end==!1?(r(),l("button",{key:1,onClick:t[3]||(t[3]=c=>n.cancelPlan()),class:"btn primary-btn mt-1 mb-3"}," downgrade ")):d("",!0)],2),e("div",{class:b(["col-md mb-3",{"text-center":i.isMobileCheck<576}])},[R,E,W,e("p",null,[z,p(" "+u(n.formattedBasicPlanTokenLimit),1)]),h.userDetailsStore.subscriptionTier=="free"?(r(),l("button",{key:0,onClick:t[4]||(t[4]=c=>n.checkout("basic")),class:"btn primary-btn mt-1"}," buy ")):i.subscription&&h.userDetailsStore.subscriptionTier=="infinite"&&i.nextSubSchedulePhasePlan!="Basic"?(r(),l("button",{key:1,onClick:t[5]||(t[5]=c=>n.downgradePlan()),class:"btn primary-btn mt-1"}," downgrade ")):this.userDetailsStore.subscriptionTier=="basic"?(r(),l("button",V," current plan ")):d("",!0)],2),e("div",{class:b(["col-md mb-3",{"text-center":i.isMobileCheck<576}])},[Z,H,K,q,h.userDetailsStore.subscriptionTier=="free"?(r(),l("button",{key:0,onClick:t[6]||(t[6]=c=>n.checkout("infinite")),class:"btn primary-btn mt-1"}," buy ")):h.userDetailsStore.subscriptionTier=="basic"?(r(),l("button",{key:1,onClick:t[7]||(t[7]=c=>n.upgradePlan()),class:"btn primary-btn mt-1"}," upgrade (incomplete) ")):this.userDetailsStore.subscriptionTier=="infinite"?(r(),l("button",G," current plan ")):d("",!0)],2)])])}const $=m(k,[["render",Q],["__scopeId","data-v-2e6b60f8"]]);export{$ as default};
