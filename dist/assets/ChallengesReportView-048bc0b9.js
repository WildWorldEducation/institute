import{_ as f,e as _,r as d,o as l,c as m,a as o,f as S,j as u,b as g,F as v}from"./main-7ffa34c9.js";import{u as y}from"./AnalyticsStore-1085d889.js";import"./transform-af9a74a2.js";import{l as $,c as x,b as C}from"./linear-5b188edc.js";import{m as B,b}from"./continuous-7328829e.js";import{s as D}from"./sort-ed61f96d.js";import{s as k}from"./string-dd82ab4a.js";import{D as A}from"./downloadCSVBtn-5bc3d2dc.js";import{F as T}from"./FailedAssessmentsHorizontalBarChart-049f11e4.js";const F={name:"TenantFailedAssessmentsHorizontalBarChart",props:["data","colour"],data(){return{}},mounted(){this.data;const i=document.getElementById("failed-assessments-chart-container").clientWidth,c=document.getElementById("failed-assessments-chart-container").clientHeight,a=$().domain([0,B(this.data,e=>e.quantity)]).range([200,i-0]),r=b().domain(D(this.data,e=>-e.quantity).map(e=>e.name)).rangeRound([0,c-10]).padding(.1);a.tickFormat(20);const p=k("#failed-assessments-chart-container").append("svg").attr("width",i).attr("height",c).attr("viewBox",[0,0,i,c]).attr("style","max-width: 100%; height: 100%; font: 14px sans-serif;");p.append("g").attr("fill","darkred").selectAll().data(this.data).join("rect").attr("x",a(0)).attr("y",e=>r(e.name)).attr("width",e=>a(e.quantity)-a(0)).attr("height",r.bandwidth()),p.append("g").attr("fill","white").attr("text-anchor","end").selectAll().data(this.data).join("text").attr("x",e=>a(e.quantity)).attr("y",e=>r(e.name)+r.bandwidth()/2).attr("dy","0.35em").attr("dx",-4).text(e=>e.quantity).call(e=>e.filter(w=>a(w.quantity)-a(0)<20).attr("dx",4).attr("fill","black").attr("text-anchor","start")),p.append("g").attr("transform","translate(0,0)").call(x(a).ticks(0)).call(e=>e.select(".domain").remove()),p.append("g").attr("transform","translate(200,0)").call(C(r).tickSizeOuter(0))}};function R(t,s,h,n,i,c){return null}const z=f(F,[["render",R]]);const H={setup(){const t=_(),s=y();return{userDetailsStore:t,analyticsStore:s}},components:{TenantFailedAssessmentsHorizontalBarChart:z,DownloadCSVBtn:A},data(){return{studentId:this.$route.params.studentId}},async created(){this.analyticsStore.failedAssessments.length==0&&await this.getFailedAssessments()},methods:{async getFailedAssessments(){try{const t=await fetch(`/student-analytics/failed-assessments/tenant/${this.userDetailsStore.tenantId}`);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);this.analyticsStore.failedAssessments=await t.json()}catch(t){console.error("Error fetching cohort mastered assessments:",t),this.analyticsStore.failedAssessments=[]}}}},L={class:"container chart-page"},I={class:"row h-100"},V={class:"col-md position-relative"},j={id:"failed-assessments-chart-container"},E={key:1};function q(t,s,h,n,i,c){const a=d("DownloadCSVBtn"),r=d("TenantFailedAssessmentsHorizontalBarChart");return l(),m("div",L,[o("div",I,[o("div",V,[s[0]||(s[0]=o("h3",{class:"heading h4"},"School-wide assessments failed",-1)),o("div",j,[S(a,{data:n.analyticsStore.failedAssessments,fileName:"Assessments-failed",toolTip:"Download CSV",class:"download-btn position-absolute"},null,8,["data"]),n.analyticsStore.failedAssessments.length>0?(l(),u(r,{key:0,data:n.analyticsStore.failedAssessments},null,8,["data"])):(l(),m("p",E,"No data yet"))])])])])}const Q=f(H,[["render",q],["__scopeId","data-v-98f997f0"]]);const N={setup(){const t=_(),s=y();return{userDetailsStore:t,analyticsStore:s}},components:{FailedAssessmentsHorizontalBarChart:T,DownloadCSVBtn:A},data(){return{failedAssessmentQuantities:[],failedAssessmentQuantitiesDownloadData:[]}},async created(){this.getAllStudentsFailedAssessments()},methods:{async getAllStudentsFailedAssessments(){try{const t=await fetch(`/student-analytics/failed-assessments/all-students/${this.userDetailsStore.userId}`);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const s=await t.json();this.failedAssessmentQuantities=Array.isArray(s)?s:[]}catch(t){console.error("Error fetching all students failed assessments:",t),this.failedAssessmentQuantities=[]}}}},M={class:"container chart-page"},P={class:"row h-100"},O={class:"col-md position-relative"},U={id:"fails-by-skill-chart-container"},W={key:1};function G(t,s,h,n,i,c){const a=d("FailedAssessmentsHorizontalBarChart");return l(),m("div",M,[o("div",P,[o("div",O,[s[2]||(s[2]=o("h3",{class:"heading h4"},"Assessments failed",-1)),o("div",U,[o("button",{class:"position-absolute download-btn btn",onClick:s[0]||(s[0]=r=>t.downloadData(n.analyticsStore.rootSubjectsFailedAssessments,"Subjects-failed"))},s[1]||(s[1]=[o("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",width:"18",height:"18"},[o("path",{d:"M0 64C0 28.7 28.7 0 64 0L213.5 0c17 0 33.3 6.7 45.3 18.7L365.3 125.3c12 12 18.7 28.3 18.7 45.3L384 448c0 35.3-28.7 64-64 64L64 512c-35.3 0-64-28.7-64-64L0 64zm208-5.5l0 93.5c0 13.3 10.7 24 24 24L325.5 176 208 58.5zM175 441c9.4 9.4 24.6 9.4 33.9 0l64-64c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0l-23 23 0-86.1c0-13.3-10.7-24-24-24s-24 10.7-24 24l0 86.1-23-23c-9.4-9.4-24.6-9.4-33.9 0s-9.4 24.6 0 33.9l64 64z"})],-1)])),i.failedAssessmentQuantities.length>0?(l(),u(a,{key:0,data:i.failedAssessmentQuantities},null,8,["data"])):(l(),m("p",W,"Students have not failed any assessments more than once yet"))])])])])}const J=f(N,[["render",G],["__scopeId","data-v-1eb1a053"]]),K={name:"Dashboard",setup(){return{userDetailsStore:_()}},data(){return{}},components:{SchoolAdminChallengesReport:Q,TeacherChallengesReport:J},async created(){}};function X(t,s,h,n,i,c){const a=d("SchoolAdminChallengesReport"),r=d("TeacherChallengesReport");return l(),m(v,null,[n.userDetailsStore.role=="school_admin"?(l(),u(a,{key:0})):g("",!0),n.userDetailsStore.role=="instructor"||n.userDetailsStore.role=="partner"?(l(),u(r,{key:1})):g("",!0)],64)}const it=f(K,[["render",X]]);export{it as default};
