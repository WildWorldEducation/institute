import{_ as E,r as M,o as a,c as h,d as e,b as u,e as x,j as y,x as n,l as q,m as k,T as P,p as j,f as U,y as Z,F as H,t as I,i as A}from"./main-7ed17017.js";import{d as C}from"./dayjs.min-d6bc37a0.js";import{c as J,g as K,d as p}from"./index.es6-593402c1.js";var Y={exports:{}};(function(t,l){(function(i,v){t.exports=v()})(J,function(){return function(i,v,s){i=i||{};var r=v.prototype,d={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function c(m,f,R,L){return r.fromToBase(m,f,R,L)}s.en.relativeTime=d,r.fromToBase=function(m,f,R,L,F){for(var S,z,T,N=R.$locale().relativeTime||d,B=i.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],W=B.length,b=0;b<W;b+=1){var g=B[b];g.d&&(S=L?s(m).diff(R,g.d,!0):R.diff(m,g.d,!0));var w=(i.rounding||Math.round)(Math.abs(S));if(T=S>0,w<=g.r||!g.r){w<=1&&b>0&&(g=B[b-1]);var O=N[g.l];F&&(w=F(""+w)),z=typeof O=="string"?O.replace("%d",w):O(w,f,g.l,T);break}}if(f)return z;var V=T?N.future:N.past;return typeof V=="function"?V(z):V.replace("%s",z)},r.to=function(m,f){return c(m,f,this,!0)},r.from=function(m,f){return c(m,f,this)};var o=function(m){return m.$u?s.utc():s()};r.toNow=function(m){return this.to(o(this),m)},r.fromNow=function(m){return this.from(o(this),m)}}})})(Y);var Q=Y.exports;const G=K(Q);const X={setup(){},data(){return{hoverOn:!1,dateFromNow:"",added:0,removed:0,changed:{name:!1,description:!1,mastery_requirements:!1}}},props:["revision","skill"],methods:{extractContent(t){return new DOMParser().parseFromString(t,"text/html").documentElement.textContent},countDiff(){var r,d,c;const t=this.extractContent(this.revision.mastery_requirements),l=this.extractContent((r=this.revision.lastRevision)==null?void 0:r.mastery_requirements),i=p(l,t),v=p((d=this.revision.lastRevision)==null?void 0:d.name,this.revision.name),s=p((c=this.revision.lastRevision)==null?void 0:c.description,this.revision.description);i.forEach(o=>{o.added&&(this.added=this.added+1,this.changed.mastery_requirements=!0),o.removed&&(this.removed=this.removed+1,this.changed.mastery_requirements=!0)}),v.forEach(o=>{o.added&&(this.added=this.added+1,this.changed.name=!0),o.removed&&(this.removed=this.removed+1,this.changed.name=!0)}),s.forEach(o=>{o.added&&(this.added=this.added+1,this.changed.description=!0),o.removed&&(this.removed=this.removed+1,this.changed.description=!0)})}},async mounted(){C.extend(G),this.dateFromNow=C(this.revision.timeStamp).fromNow(),this.revision.lastRevision&&this.countDiff()}},D=t=>(j("data-v-e85489e1"),t=t(),U(),t),$={class:"revision-header"},ee={class:"row-header-circle"},se={key:0,class:"inner-row-header-circle"},ie={class:"d-flex"},te={class:"d-flex align-items-start"},ne={class:"me-1 edit-date"},oe={class:"revision-comment"},re={key:0,class:"current-badge d-flex gap-1 align-items-center ms-2"},de=D(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",heigh:"15",width:"15",fill:"white"},[e("path",{d:"M448 256A192 192 0 1 0 64 256a192 192 0 1 0 384 0zM0 256a256 256 0 1 1 512 0A256 256 0 1 1 0 256zm256 80a80 80 0 1 0 0-160 80 80 0 1 0 0 160zm0-224a144 144 0 1 1 0 288 144 144 0 1 1 0-288zM224 256a32 32 0 1 1 64 0 32 32 0 1 1 -64 0z"})],-1)),le=D(()=>e("div",null,"Current Version",-1)),ae=[de,le],ce={class:"by-user"},he={class:"position-relative"},me={class:"d-flex align-items-center px-2"},ve=D(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",width:"15",height:"15",class:"primary-icon"},[e("path",{d:"M406.5 399.6C387.4 352.9 341.5 320 288 320l-64 0c-53.5 0-99.4 32.9-118.5 79.6C69.9 362.2 48 311.7 48 256C48 141.1 141.1 48 256 48s208 93.1 208 208c0 55.7-21.9 106.2-57.5 143.6zm-40.1 32.7C334.4 452.4 296.6 464 256 464s-78.4-11.6-110.5-31.7c7.3-36.7 39.7-64.3 78.5-64.3l64 0c38.8 0 71.2 27.6 78.5 64.3zM256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zm0-272a40 40 0 1 1 0-80 40 40 0 1 1 0 80zm-88-40a88 88 0 1 0 176 0 88 88 0 1 0 -176 0z"})],-1)),ue={class:"mx-1 d-flex align-items-center"},_e={class:"d-flex align-items-center"},fe=D(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",width:"12",height:"12",class:"mx-1 primary-icon"},[e("path",{d:"M75 75L41 41C25.9 25.9 0 36.6 0 57.9L0 168c0 13.3 10.7 24 24 24l110.1 0c21.4 0 32.1-25.9 17-41l-30.8-30.8C155 85.5 203 64 256 64c106 0 192 86 192 192s-86 192-192 192c-40.8 0-78.6-12.7-109.7-34.4c-14.5-10.1-34.4-6.6-44.6 7.9s-6.6 34.4 7.9 44.6C151.2 495 201.7 512 256 512c141.4 0 256-114.6 256-256S397.4 0 256 0C185.3 0 121.3 28.7 75 75zm181 53c-13.3 0-24 10.7-24 24l0 104c0 6.4 2.5 12.5 7 17l72 72c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-65-65 0-94.1c0-13.3-10.7-24-24-24z"})],-1)),ge={class:"mt-2 px-2 break-line"},we={class:"hover-sub-info px-2"},xe={class:"hover-sub-info px-2 break-line"},ye={class:"insert","b-on-hoover":"",title:"number of words added"},ke={class:"removed ms-1","b-on-hoover":"",title:"number of words removed"};function pe(t,l,i,v,s,r){const d=M("router-link");return a(),h("div",{onMouseover:l[0]||(l[0]=c=>s.hoverOn=!0),onMouseleave:l[1]||(l[1]=c=>s.hoverOn=!1),class:"d-flex"},[e("div",$,[e("div",ee,[s.hoverOn?(a(),h("div",se)):u("",!0)])]),e("div",ie,[x(d,{class:"d-flex flex-column ms-3 revision-data",to:`/skills/${i.skill.url}/revision/${i.revision.version_number}`},{default:y(()=>[e("div",te,[e("div",ne,n(i.revision.edited_date),1),e("div",oe," - "+n(i.revision.comment?i.revision.comment:"no comment"),1),i.revision.isCurrentRevision?(a(),h("div",re,ae)):u("",!0)]),e("div",ce,"By "+n(i.revision.username),1)]),_:1},8,["to"]),e("div",null,[e("div",he,[x(P,{name:"appear"},{default:y(()=>[s.hoverOn?(a(),h("div",{key:0,class:q(["revision-hover-detail",{"appear-top":i.revision.isCurrentRevision,"appear-center":!i.revision.isCurrentRevision&&i.revision.lastRevision,"appear-bottom":i.revision.isOrigin}])},[e("div",{class:q(["bubble",{"triangle-top":i.revision.isCurrentRevision,"triangle-center":!i.revision.isCurrentRevision&&i.revision.lastRevision,"triangle-bottom":!i.revision.lastRevision&&!i.revision.isCurrentRevision}])},[e("div",me,[ve,e("div",ue,[k(n(i.revision.username)+", ",1),e("div",_e,[fe,e("div",null,n(s.dateFromNow),1)]),k(" ("+n(i.revision.edited_date)+") ",1)])]),e("div",ge,n(i.revision.isOrigin?"Origin created by admin.":i.revision.comment?i.revision.comment:"No Comment"),1),e("div",we," Changed: "+n(s.changed.name?s.changed.description?"name,":"name":"")+" "+n(s.changed.description?s.changed.mastery_requirements?"description, ":"description":"")+" "+n(s.changed.mastery_requirements?"mastery requirements":""),1),e("div",xe,[e("span",ye,"+"+n(s.added)+" insertion,",1),e("span",ke,"-"+n(s.removed)+" deletion",1)]),x(d,{class:"ms-2",to:`/skills/${i.skill.url}/revision/${i.revision.version_number}`},{default:y(()=>[k("see this edited version")]),_:1},8,["to"])],2)],2)):u("",!0)]),_:1})])])])],32)}const Re=E(X,[["render",pe],["__scopeId","data-v-e85489e1"]]);const be={setup(){},data(){return{dateFromNow:"",added:0,showDetail:!1,removed:0,shortDate:"",changed:{name:!1,description:!1,mastery_requirements:!1}}},props:["revision","skill"],methods:{extractContent(t){return new DOMParser().parseFromString(t,"text/html").documentElement.textContent},countDiff(){var r,d,c;const t=this.extractContent(this.revision.mastery_requirements),l=this.extractContent((r=this.revision.lastRevision)==null?void 0:r.mastery_requirements),i=p(l,t),v=p((d=this.revision.lastRevision)==null?void 0:d.name,this.revision.name),s=p((c=this.revision.lastRevision)==null?void 0:c.description,this.revision.description);i.forEach(o=>{o.added&&(this.added=this.added+1,this.changed.mastery_requirements=!0),o.removed&&(this.removed=this.removed+1,this.changed.mastery_requirements=!0)}),v.forEach(o=>{o.added&&(this.added=this.added+1,this.changed.name=!0),o.removed&&(this.removed=this.removed+1,this.changed.name=!0)}),s.forEach(o=>{o.added&&(this.added=this.added+1,this.changed.description=!0),o.removed&&(this.removed=this.removed+1,this.changed.description=!0)})}},async mounted(){C.extend(G),this.dateFromNow=C(this.revision.timeStamp).fromNow(),this.shortDate=C(this.revision.timeStamp).format("DD-MM-YYYY"),this.revision.lastRevision&&this.countDiff()}},_=t=>(j("data-v-4ed32742"),t=t(),U(),t),Ce={class:"d-flex"},ze={class:"revision-header"},Me={class:"row-header-circle"},De={key:0,class:"inner-row-header-circle"},Le={class:"d-flex"},Se={class:"d-flex flex-column ms-3 revision-data"},Te={class:"revision-comment"},Ne={key:0,class:"current-badge d-flex gap-1 align-items-center ms-2 d-none"},Be=_(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",heigh:"15",width:"15",fill:"white"},[e("path",{d:"M448 256A192 192 0 1 0 64 256a192 192 0 1 0 384 0zM0 256a256 256 0 1 1 512 0A256 256 0 1 1 0 256zm256 80a80 80 0 1 0 0-160 80 80 0 1 0 0 160zm0-224a144 144 0 1 1 0 288 144 144 0 1 1 0-288zM224 256a32 32 0 1 1 64 0 32 32 0 1 1 -64 0z"})],-1)),Oe=_(()=>e("div",null,"Current Version",-1)),Ve=[Be,Oe],qe={key:1,class:"origin-badge d-flex gap-1 align-items-center ms-2 d-none"},Ee=_(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",fill:"white",height:"15",width:"15"},[e("path",{d:"M502.3 159.7l-234-156c-8-4.9-16.5-5-24.6 0l-234 156C3.7 163.7 0 170.8 0 178v156c0 7.1 3.7 14.3 9.7 18.3l234 156c8 4.9 16.5 5 24.6 0l234-156c6-4 9.7-11.1 9.7-18.3V178c0-7.1-3.7-14.3-9.7-18.3zM278 63.1l172.3 114.9-76.9 51.4L278 165.7V63.1zm-44 0v102.6l-95.4 63.7-76.9-51.4L234 63.1zM44 219.1l55.1 36.9L44 292.8v-73.7zm190 229.7L61.7 334l76.9-51.4L234 346.3v102.6zm22-140.9l-77.7-52 77.7-52 77.7 52-77.7 52zm22 140.9V346.3l95.4-63.7 76.9 51.4L278 448.8zm190-156l-55.1-36.9L468 219.1v73.7z"})],-1)),Fe=_(()=>e("div",null,"Origin",-1)),He=[Ee,Fe],Ie=_(()=>e("path",{d:"M233.4 105.4c12.5-12.5 32.8-12.5 45.3 0l192 192c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L256 173.3 86.6 342.6c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3l192-192z"},null,-1)),Ae=[Ie],Pe={class:"by-user"},je={class:"position-relative"},Ue={key:0,class:"d-flex flex-column details-div triangle-upper"},Ye={class:"d-flex flex-column flex-md-row align-items-md-center px-2 align-items-start"},Ge={class:"d-flex align-items-center justify-content-start"},We=_(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",width:"15",height:"15",fill:"#64748b",class:"me-1"},[e("path",{d:"M406.5 399.6C387.4 352.9 341.5 320 288 320l-64 0c-53.5 0-99.4 32.9-118.5 79.6C69.9 362.2 48 311.7 48 256C48 141.1 141.1 48 256 48s208 93.1 208 208c0 55.7-21.9 106.2-57.5 143.6zm-40.1 32.7C334.4 452.4 296.6 464 256 464s-78.4-11.6-110.5-31.7c7.3-36.7 39.7-64.3 78.5-64.3l64 0c38.8 0 71.2 27.6 78.5 64.3zM256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zm0-272a40 40 0 1 1 0-80 40 40 0 1 1 0 80zm-88-40a88 88 0 1 0 176 0 88 88 0 1 0 -176 0z"})],-1)),Ze={class:"ms-0 ms-md-1 d-flex flex-column flex-md-row align-items-md-center align-items-start"},Je={class:"d-flex align-items-center"},Ke=_(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",width:"12",height:"12",class:"mx-md-1 me-1",fill:"#64748b"},[e("path",{d:"M75 75L41 41C25.9 25.9 0 36.6 0 57.9L0 168c0 13.3 10.7 24 24 24l110.1 0c21.4 0 32.1-25.9 17-41l-30.8-30.8C155 85.5 203 64 256 64c106 0 192 86 192 192s-86 192-192 192c-40.8 0-78.6-12.7-109.7-34.4c-14.5-10.1-34.4-6.6-44.6 7.9s-6.6 34.4 7.9 44.6C151.2 495 201.7 512 256 512c141.4 0 256-114.6 256-256S397.4 0 256 0C185.3 0 121.3 28.7 75 75zm181 53c-13.3 0-24 10.7-24 24l0 104c0 6.4 2.5 12.5 7 17l72 72c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-65-65 0-94.1c0-13.3-10.7-24-24-24z"})],-1)),Qe={class:"ms-0 ms-md-1"},Xe={class:"mt-2 px-2 break-line"},$e={class:"hover-sub-info px-2"},es={class:"hover-sub-info px-2 break-line"},ss={class:"insert","b-on-hoover":"",title:"number of words added"},is={class:"removed ms-1","b-on-hoover":"",title:"number of words removed"},ts={class:"d-flex"},ns={key:0,class:"current-badge d-flex gap-1 align-items-center ms-2 d-md-none"},os=_(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",heigh:"15",width:"15",fill:"white"},[e("path",{d:"M448 256A192 192 0 1 0 64 256a192 192 0 1 0 384 0zM0 256a256 256 0 1 1 512 0A256 256 0 1 1 0 256zm256 80a80 80 0 1 0 0-160 80 80 0 1 0 0 160zm0-224a144 144 0 1 1 0 288 144 144 0 1 1 0-288zM224 256a32 32 0 1 1 64 0 32 32 0 1 1 -64 0z"})],-1)),rs=_(()=>e("div",null,"Current Version",-1)),ds=[os,rs],ls={key:1,class:"origin-badge d-flex gap-1 align-items-center ms-2 d-md-none"},as=_(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",fill:"white",height:"15",width:"15"},[e("path",{d:"M502.3 159.7l-234-156c-8-4.9-16.5-5-24.6 0l-234 156C3.7 163.7 0 170.8 0 178v156c0 7.1 3.7 14.3 9.7 18.3l234 156c8 4.9 16.5 5 24.6 0l234-156c6-4 9.7-11.1 9.7-18.3V178c0-7.1-3.7-14.3-9.7-18.3zM278 63.1l172.3 114.9-76.9 51.4L278 165.7V63.1zm-44 0v102.6l-95.4 63.7-76.9-51.4L234 63.1zM44 219.1l55.1 36.9L44 292.8v-73.7zm190 229.7L61.7 334l76.9-51.4L234 346.3v102.6zm22-140.9l-77.7-52 77.7-52 77.7 52-77.7 52zm22 140.9V346.3l95.4-63.7 76.9 51.4L278 448.8zm190-156l-55.1-36.9L468 219.1v73.7z"})],-1)),cs=_(()=>e("div",null,"Origin",-1)),hs=[as,cs];function ms(t,l,i,v,s,r){const d=M("router-link");return a(),h("div",Ce,[e("div",ze,[e("div",Me,[s.showDetail?(a(),h("div",De)):u("",!0)])]),e("div",Le,[e("div",Se,[e("div",{class:"d-flex align-items-start",onClick:l[0]||(l[0]=c=>s.showDetail=!s.showDetail)},[x(d,{to:`/skills/${i.skill.url}/revision/${i.revision.version_number}`,class:"me-1 edit-date"},{default:y(()=>[k(n(s.shortDate),1)]),_:1},8,["to"]),e("div",Te," - "+n(i.revision.comment?i.revision.comment:"no comment"),1),i.revision.isCurrentRevision?(a(),h("div",Ne,Ve)):u("",!0),i.revision.isOrigin?(a(),h("div",qe,He)):u("",!0),(a(),h("svg",{class:q(["ms-1 my-auto chevron-icon",{"chevron-down":s.showDetail,"chevron-up":!s.showDetail}]),width:"14",height:"14",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},Ae,2))]),e("div",Pe,"By "+n(i.revision.username),1),e("div",je,[x(P,{name:"appear"},{default:y(()=>[s.showDetail?(a(),h("div",Ue,[e("div",Ye,[e("div",Ge,[We,k(" "+n(i.revision.username)+", ",1)]),e("div",Ze,[e("div",Je,[Ke,e("div",null,n(s.dateFromNow),1)]),e("div",Qe," ("+n(i.revision.edited_date)+") ",1)])]),e("div",Xe,n(i.revision.isOrigin?"Origin created by admin.":i.revision.comment?i.revision.comment:"No Comment"),1),e("div",$e," Changed: "+n(s.changed.name?s.changed.description?"name,":"name":"")+" "+n(s.changed.description?s.changed.mastery_requirements?"description, ":"description":"")+" "+n(s.changed.mastery_requirements?"mastery requirements":""),1),e("div",es,[e("span",ss,"+"+n(s.added)+" insertion,",1),e("span",is,"-"+n(s.removed)+" deletion",1)]),e("div",ts,[i.revision.isCurrentRevision?(a(),h("div",ns,ds)):u("",!0),i.revision.isOrigin?(a(),h("div",ls,hs)):u("",!0),x(d,{class:"ms-2",to:`/skills/${i.skill.url}/revision/${i.revision.version_number}`},{default:y(()=>[k("see this edited version")]),_:1},8,["to"])])])):u("",!0)]),_:1})])])])])}const vs=E(be,[["render",ms],["__scopeId","data-v-4ed32742"]]),us={setup(){return{usersStore:Z()}},data(){return{skillUrl:this.$route.params.skillUrl,skill:{},skillRevisions:[],currentVersionNumber:null,isLoaded:!1}},components:{HistoryRow:Re,HistoryRowTabletPhone:vs},async created(){this.usersStore.usersIncludingDeleted.length<1&&await this.usersStore.getUsersIncludingDeleted(),await this.getSkill()},async mounted(){},methods:{async getSkill(){const t=await fetch("/skills/url/"+this.skillUrl);this.skill=await t.json(),this.currentVersionNumber=this.skill.version_number,await this.getRevisions()},async getRevisions(){const t=await fetch("/skill-history/"+this.skill.id+"/list");this.skillRevisions=await t.json();for(let s=0;s<this.skillRevisions.length;s++){this.skillRevisions[s].timeStamp=this.skillRevisions[s].edited_date;var l=this.skillRevisions[s].edited_date.replace("T"," ");l=l.replace("Z"," ");let r=l.split(/[- :]/);var i=new Date(Date.UTC(r[0],r[1]-1,r[2],r[3],r[4],r[5])),v={weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"};this.skillRevisions[s].edited_date=i.toLocaleDateString("en-US",v);let d=this.usersStore.usersIncludingDeleted.find(c=>c.id===this.skillRevisions[s].user_id);this.skillRevisions[s].username=d.username,this.skillRevisions[s].isCurrentRevision=!1,this.skillRevisions[s].version_number==this.currentVersionNumber&&(this.skillRevisions[s].isCurrentRevision=!0),s+1===this.skillRevisions.length&&s>0?this.skillRevisions[s].isOrigin=!0:this.skillRevisions[s].lastRevision=this.skillRevisions[s+1]}this.isLoaded=!0}}},_s={class:"container bg-light rounded p-3"},fs={class:"heading"},gs=e("hr",null,null,-1),ws={class:"d-none d-lg-flex flex-column"},xs={class:"d-flex d-lg-none flex-column"};function ys(t,l,i,v,s,r){const d=M("HistoryRow"),c=M("HistoryRowTabletPhone");return a(),h("div",_s,[e("h1",fs,n(s.skill.name)+": Revision history",1),gs,e("div",ws,[s.isLoaded?(a(!0),h(H,{key:0},I(s.skillRevisions,o=>(a(),A(d,{revision:o,skill:s.skill},null,8,["revision","skill"]))),256)):u("",!0)]),e("div",xs,[s.isLoaded?(a(!0),h(H,{key:0},I(s.skillRevisions,o=>(a(),A(c,{revision:o,skill:s.skill},null,8,["revision","skill"]))),256)):u("",!0)])])}const bs=E(us,[["render",ys]]);export{bs as default};
