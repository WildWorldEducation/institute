import{_ as g,g as C,r as v,o as i,c as n,a as t,F as f,x,j as d,t as r,p,b as c,k as b,l as h,f as m,y as U,e as D,T as S}from"./main-ae7b1a19.js";import{u as T,a as I,b as j}from"./EssayQuestionsStore-73a99feb.js";const A={props:["userId"],setup(){const l=C(),s=T(),u=I(),_=j();return{skillsStore:l,resourcesStore:s,mcQuestionsStore:u,essayQuestionsStore:_}},data(){return{contentFlags:[],rows:[],currentChooseSkill:"",showActionWarnModal:!1,showSkillWarnModal:!1}},components:{},async created(){},async mounted(){await this.getContentFlagLogs(),this.contentFlags.forEach(l=>{const s=JSON.parse(l.content_obj),u=new Date(l.create_date),_=u.toLocaleString("en-gb",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),a={date:u.toLocaleTimeString()+` (${_})`,action:l.action,question:s.question,questionName:s.question_name,skillName:s.name,skillUrl:s.skill_url,id:l.id,skill_deleted:s.skill_deleted,is_deleted:l.is_deleted};switch(l.flag_type){case"mc_question":a.type="mc_question",a.questionId=s.question_id,a.skillId=s.skill_id,a.skillUrl=s.skill_url;break;case"resource":a.type="resource",a.skillId=s.skill_id,a.skillUrl=s.skill_url;break;case"skill":a.type="skill",a.skillId=s.skill_id,a.skillUrl=s.skill_url;break;case"essay_question":a.type="essay_question",a.skillId=s.skill_id,a.skillUrl=s.skill_url;break;case"image_question":a.type="image_question",a.questionId=s.question_id,a.skillId=s.skill_id,a.skillUrl=s.skill_url;break;default:a.type="delete";break}this.rows.push(a)})},methods:{async getContentFlagLogs(){const l=await fetch(`/user-actions/${this.userId}/flag`);this.contentFlags=await l.json()},actionColor(l){switch(l){case"create":return"create-action";case"update":return"update-action";default:return"delete-action"}},handleNoneLinkClick(l,s){l==="delete"?this.showActionWarnModal=!0:(this.showSkillWarnModal=!0,this.currentChooseSkill=s)}}},W={key:0,class:"container-md main-container"},L={class:"d-flex flex-column gap-3"},Q={key:0},q={key:0},O=["onClick"],B={key:3,class:"text-danger"},R={key:1},E=["onClick"],K={key:2,class:"text-danger"},z={key:2},H=["onClick"],J={key:2,class:"text-danger"},V={key:3},P=["onClick"],G={key:2,class:"text-danger"},X={key:4},Y=["onClick"],Z={key:2,class:"text-danger"},F={key:5},ss={key:0,class:"text-danger"},es={key:1,class:"shake"},ts={key:2},os={id:"myModal",class:"modal"},ls={class:"modal-content skill-modal"},is={class:"mb-4"},ns={class:"modal-label"},rs={class:"skill-modal-text"},as={class:"d-flex justify-content-center"},ds={key:3},cs={id:"myModal",class:"modal"},us={class:"modal-content skill-modal"},ks={class:"mb-4"},_s={class:"modal-label"},hs={class:"skill-modal-text"},ms={class:"d-flex justify-content-center"},ps={key:4},ws={id:"myModal",class:"modal"},fs={class:"modal-content"},vs={class:"d-flex justify-content-center"};function ys(l,s,u,_,o,a){const k=v("router-link");return i(),n(f,null,[o.rows.length?(i(),n("div",W,[t("div",L,[(i(!0),n(f,null,x(o.rows,e=>(i(),n("div",null,[d(r(e.date)+" ",1),e.type==="skill"?(i(),n("span",Q,[t("span",{class:p(a.actionColor(e.action))}," - "+r(e.action),3),e.action=="delete"?(i(),n("span",q," flag with id: "+r(e.id),1)):c("",!0),s[3]||(s[3]=d(" flag on skill: ",-1)),e.action==="delete"||e.skill_deleted===1?(i(),n("span",{key:1,class:"skill-link",onClick:y=>a.handleNoneLinkClick(e.action,e.skillName)},r(e.skillName),9,O)):(i(),b(k,{key:2,class:"skill-link",target:"_blank",to:`/skills/${e.skillUrl}`},{default:h(()=>[d(r(e.skillName),1)]),_:2},1032,["to"])),e.is_deleted?(i(),n("span",B,"[Flag deleted]")):c("",!0)])):c("",!0),e.type==="resource"?(i(),n("span",R,[t("span",{class:p(a.actionColor(e.action))}," - "+r(e.action),3),s[4]||(s[4]=d(" flag on resource of skill: ",-1)),e.action==="delete"||e.skill_deleted===1?(i(),n("span",{key:0,class:"skill-link",onClick:y=>a.handleNoneLinkClick(e.action,e.skillName)},r(e.skillName),9,E)):(i(),b(k,{key:1,class:"skill-link",target:"_blank",to:`/skills/${e.skillUrl}`},{default:h(()=>[d(r(e.skillName),1)]),_:2},1032,["to"])),e.is_deleted?(i(),n("span",K,"[Flag deleted]")):c("",!0)])):c("",!0),e.type==="mc_question"?(i(),n("span",z,[t("span",{class:p(a.actionColor(e.action))}," - "+r(e.action),3),d(" flag on mc_question "+r('"'+e.questionName+'"')+": ",1),m(k,{class:"question-link",target:"_blank",to:`/skills/${e.skillId}/question-bank`},{default:h(()=>[d(r(e.question),1)]),_:2},1032,["to"]),s[5]||(s[5]=d(" on skill: ",-1)),e.action==="delete"||e.skill_deleted===1?(i(),n("span",{key:0,class:"skill-link",onClick:y=>a.handleNoneLinkClick(e.action,e.skillName)},r(e.skillName),9,H)):(i(),b(k,{key:1,class:"skill-link",target:"_blank",to:`/skills/${e.skillUrl}`},{default:h(()=>[d(r(e.skillName),1)]),_:2},1032,["to"])),e.is_deleted?(i(),n("span",J,"[Flag deleted]")):c("",!0)])):c("",!0),e.type==="essay_question"?(i(),n("span",V,[t("span",{class:p(a.actionColor(e.action))}," - "+r(e.action),3),d(" flag on essay question "+r('"'+e.questionName+'"')+": ",1),m(k,{class:"question-link",target:"_blank",to:`/skills/${e.skillId}/question-bank`},{default:h(()=>[d(r(e.question),1)]),_:2},1032,["to"]),s[6]||(s[6]=d(" on skill: ",-1)),e.action==="delete"||e.skill_deleted===1?(i(),n("span",{key:0,class:"skill-link",onClick:y=>a.handleNoneLinkClick(e.action,e.skillName)},r(e.skillName),9,P)):(i(),b(k,{key:1,class:"skill-link",target:"_blank",to:`/skills/${e.skillUrl}`},{default:h(()=>[d(r(e.skillName),1)]),_:2},1032,["to"])),e.is_deleted?(i(),n("span",G,"[Flag deleted]")):c("",!0)])):c("",!0),e.type==="image_question"?(i(),n("span",X,[t("span",{class:p(a.actionColor(e.action))}," - "+r(e.action),3),d(" flag on image question "+r('"'+e.questionName+'"')+": ",1),m(k,{class:"question-link",target:"_blank",to:`/skills/${e.skillId}/question-bank`},{default:h(()=>[d(r(e.question),1)]),_:2},1032,["to"]),s[7]||(s[7]=d(" on skill: ",-1)),e.action==="delete"||e.skill_deleted===1?(i(),n("span",{key:0,class:"skill-link",onClick:y=>a.handleNoneLinkClick(e.action,e.skillName)},r(e.skillName),9,Y)):(i(),b(k,{key:1,class:"skill-link",target:"_blank",to:`/skills/${e.skillUrl}`},{default:h(()=>[d(r(e.skillName),1)]),_:2},1032,["to"])),e.is_deleted?(i(),n("span",Z,"[Flag deleted]")):c("",!0)])):c("",!0),e.type==="delete"?(i(),n("span",F,[t("span",{class:p(a.actionColor(e.action))}," - "+r(e.action),3),d(" flag with id "+r(e.id)+" ",1),e.is_deleted?(i(),n("span",ss,"[Flag deleted]")):c("",!0)])):c("",!0)]))),256))])])):(i(),n("div",es,"The user has no action on flags")),o.showSkillWarnModal?(i(),n("div",ts,[t("div",os,[t("div",ls,[t("div",is,[t("div",ns,[s[8]||(s[8]=d(" Skill ",-1)),t("span",rs,r(o.currentChooseSkill),1),s[9]||(s[9]=d(" is deleted !! ",-1))])]),t("div",as,[t("button",{type:"button",class:"btn green-btn w-fit",onClick:s[0]||(s[0]=e=>o.showSkillWarnModal=!1)},s[10]||(s[10]=[t("div",null,"OK",-1)]))])])])])):c("",!0),o.showSkillWarnModal?(i(),n("div",ds,[t("div",cs,[t("div",us,[t("div",ks,[t("div",_s,[s[11]||(s[11]=d(" Skill ",-1)),t("span",hs,r(o.currentChooseSkill),1),s[12]||(s[12]=d(" is deleted !! ",-1))])]),t("div",ms,[t("button",{type:"button",class:"btn green-btn w-fit",onClick:s[1]||(s[1]=e=>o.showSkillWarnModal=!1)},s[13]||(s[13]=[t("div",null,"OK",-1)]))])])])])):c("",!0),o.showActionWarnModal?(i(),n("div",ps,[t("div",ws,[t("div",fs,[s[15]||(s[15]=t("div",{class:"d-flex gap-4 justify-content-center mb-4"},[t("div",{class:"modal-label"},"this flag is deleted !!")],-1)),t("div",vs,[t("button",{type:"button",class:"btn green-btn w-fit",onClick:s[2]||(s[2]=e=>o.showActionWarnModal=!1)},s[14]||(s[14]=[t("div",null,"OK",-1)]))])])])])):c("",!0)],64)}const bs=g(A,[["render",ys]]),gs={props:["userId"],data(){return{resourcesData:[],rows:[],showWarnModal:!1,currentChooseSkill:"",showActionWarnModal:!1,showSkillWarnModal:!1}},components:{},async created(){await this.getResourceLogs(),this.resourcesData.forEach(l=>{const s=JSON.parse(l.content_obj),u=new Date(l.create_date),_=u.toLocaleString("en-gb",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),o=u.toLocaleTimeString();this.rows.push({skillName:s.skill_name,resourceId:l.content_id,action:l.action,date:_,time:o,id:l.id,skillDeleted:s.skill_deleted,skillUrl:s.skill_url,resourceDeleted:s.resource_deleted})})},methods:{async getResourceLogs(){const l=await fetch(`/user-actions/${this.userId}/resource`);this.resourcesData=await l.json()},actionColor(l){switch(l){case"create":return"create-action";case"update":return"update-action";default:return"delete-action"}},handleNoneLinkClick(l,s,u){l==="delete"?this.showActionWarnModal=!0:u?this.showActionWarnModal=!0:(this.showSkillWarnModal=!0,this.currentChooseSkill=s)}}},Ss={key:0,class:"container-md main-container"},xs={class:"d-flex flex-column"},Cs=["onClick"],Ms={key:1,class:"shake"},$s={key:2},Ns={id:"myModal",class:"modal"},Us={class:"modal-content skill-modal"},Ds={class:"modal-label"},Ts={class:"skill-modal-text"},Is={class:"d-flex justify-content-center"},js={key:3},As={id:"myModal",class:"modal"},Ws={class:"modal-content"},Ls={class:"d-flex justify-content-center"};function Qs(l,s,u,_,o,a){const k=v("router-link");return i(),n(f,null,[o.rows.length?(i(),n("div",Ss,[t("div",xs,[(i(!0),n(f,null,x(o.rows,e=>(i(),n("div",null,[d(r(e.time)+" ("+r(e.date)+") - ",1),t("span",{class:p(a.actionColor(e.action))},r(e.action),3),s[4]||(s[4]=d("Â  ",-1)),t("span",null,[m(k,{class:"skill-link",target:"_blank",to:"/users/"+u.userId+"/activity-report/source/"+e.id},{default:h(()=>s[2]||(s[2]=[d("source",-1)])),_:2,__:[2]},1032,["to"]),s[3]||(s[3]=d(" in forum of skill: ",-1))]),e.action==="delete"||e.skillDeleted===1||e.resourceDeleted===1?(i(),n("span",{key:0,class:"skill-link",onClick:y=>a.handleNoneLinkClick(e.action,e.skillName,e.resourceDeleted)},r(e.skillName),9,Cs)):(i(),b(k,{key:1,class:"skill-link",target:"_blank",to:`/skills/${e.skillUrl}`},{default:h(()=>[d(r(e.skillName),1)]),_:2},1032,["to"]))]))),256))])])):(i(),n("div",Ms,"The user has no action on resource")),o.showSkillWarnModal?(i(),n("div",$s,[t("div",Ns,[t("div",Us,[t("div",Ds,[s[5]||(s[5]=d(" Skill ",-1)),t("span",Ts,r(o.currentChooseSkill),1),s[6]||(s[6]=d(" is deleted !! ",-1))]),t("div",Is,[t("button",{type:"button",class:"btn green-btn w-fit",onClick:s[0]||(s[0]=e=>o.showSkillWarnModal=!1)},s[7]||(s[7]=[t("div",null,"OK",-1)]))])])])])):c("",!0),o.showActionWarnModal?(i(),n("div",js,[t("div",As,[t("div",Ws,[s[9]||(s[9]=t("div",{class:"d-flex gap-4 justify-content-center mb-4"},[t("div",{class:"modal-label"},"Resource is deleted !!")],-1)),t("div",Ls,[t("button",{type:"button",class:"btn green-btn w-fit",onClick:s[1]||(s[1]=e=>o.showActionWarnModal=!1)},s[8]||(s[8]=[t("div",null,"OK",-1)]))])])])])):c("",!0)],64)}const qs=g(gs,[["render",Qs]]),Os={props:["userId"],data(){return{questionsData:[],rows:[],showSkillWarnModal:!1,showActionWarnModal:!1,currentChooseSkill:""}},components:{},async created(){await this.getMcQuestionsLog(),this.questionsData.forEach(l=>{const s=JSON.parse(l.content_obj),u=new Date(l.create_date),_=u.toLocaleString("en-gb",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),o=u.toLocaleTimeString();this.rows.push({question_name:s.question_name,skillName:s.skill_name,resourceId:l.content_id,action:l.action,date:_,time:o,id:l.id,studentName:s.student_name,studentId:s.student_id,type:l.content_type,skillDeleted:s.skill_deleted,skillUrl:s.skill_url,questionDeleted:s.question_deleted})})},methods:{async getMcQuestionsLog(){const l=await fetch(`/user-actions/${this.userId}/question`);this.questionsData=await l.json(),console.log("QUESTION ACTION: "),console.log(this.questionsData)},handleNoneLinkClick(l,s,u){l==="delete"||u?this.showActionWarnModal=!0:(this.showSkillWarnModal=!0,this.currentChooseSkill=s)},actionColor(l){switch(l){case"create":return"create-action";case"update":return"update-action";case"bulk-create":return"bulk-create-action";case"submit_update_for_review":return"submit_update_for_review";case"approve":return"approve-action";case"edit_and_approve":return"edit-and-approve-action";default:return"delete-action"}}}},Bs={key:0,class:"container-md main-container"},Rs={class:"d-flex flex-column"},Es={key:0},Ks={key:1},zs={key:2},Hs=["onClick"],Js={key:1,class:"shake"},Vs={key:2},Ps={id:"myModal",class:"modal"},Gs={class:"modal-content skill-modal"},Xs={class:"mb-4"},Ys={class:"modal-label"},Zs={class:"skill-modal-text"},Fs={class:"d-flex justify-content-center"},se={key:3},ee={id:"myModal",class:"modal"},te={class:"modal-content"},oe={class:"d-flex justify-content-center"};function le(l,s,u,_,o,a){const k=v("router-link");return i(),n(f,null,[o.rows.length>0?(i(),n("div",Bs,[t("div",Rs,[(i(!0),n(f,null,x(o.rows,e=>(i(),n("div",null,[d(r(e.time)+" ("+r(e.date)+") ",1),t("span",{class:p(a.actionColor(e.action))}," - "+r(e.action.replace(/_/g," ")),3),e.type==="mc_question"?(i(),n("span",Es,r(' "'+e.question_name+'"')+" in question bank of skill: ",1)):c("",!0),e.type==="essay_question"?(i(),n("span",Ks," essay question "+r(' "'+e.question_name+'"')+" in question bank of skill: ",1)):c("",!0),e.type==="image_question"?(i(),n("span",zs," image question "+r(' "'+e.question_name+'"')+" in question bank of skill: ",1)):c("",!0),e.action==="delete"||e.skillDeleted===1||e.questionDeleted===1?(i(),n("span",{key:3,class:"skill-link",onClick:y=>a.handleNoneLinkClick(e.action,e.skillName,e.questionDeleted)},r(e.skillName),9,Hs)):(i(),b(k,{key:4,class:"skill-link",target:"_blank",to:`/skills/${e.skillUrl}`},{default:h(()=>[d(r(e.skillName),1)]),_:2},1032,["to"]))]))),256))])])):(i(),n("div",Js," The user has no action on multiple-choice questions ")),o.showSkillWarnModal?(i(),n("div",Vs,[t("div",Ps,[t("div",Gs,[t("div",Xs,[t("div",Ys,[s[2]||(s[2]=d(" Skill ",-1)),t("span",Zs,r(o.currentChooseSkill),1),s[3]||(s[3]=d(" is deleted !! ",-1))])]),t("div",Fs,[t("button",{type:"button",class:"btn green-btn w-fit",onClick:s[0]||(s[0]=e=>o.showSkillWarnModal=!1)},s[4]||(s[4]=[t("div",null,"OK",-1)]))])])])])):c("",!0),o.showActionWarnModal?(i(),n("div",se,[t("div",ee,[t("div",te,[s[6]||(s[6]=t("div",{class:"d-flex gap-4 justify-content-center mb-4"},[t("div",{class:"modal-label"},"Question is deleted !!")],-1)),t("div",oe,[t("button",{type:"button",class:"btn green-btn w-fit",onClick:s[1]||(s[1]=e=>o.showActionWarnModal=!1)},s[5]||(s[5]=[t("div",null,"OK",-1)]))])])])])):c("",!0)],64)}const ie=g(Os,[["render",le]]),ne={props:["userId"],data(){return{skillsData:[],rows:[],showWarnModal:!1,currentChooseSkill:""}},components:{},async created(){await this.getSkillLogs(),this.skillsData.forEach(l=>{const s=JSON.parse(l.content_obj),u=new Date(l.create_date),_=u.toLocaleString("en-gb",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),o=u.toLocaleTimeString();this.rows.push({skillName:s.skill_name,resourceId:l.content_id,action:l.action,date:_,time:o,id:l.id,skillUrl:s.skill_url,is_deleted:s.is_deleted})})},methods:{async getSkillLogs(){const l=await fetch(`/user-actions/${this.userId}/skill`);this.skillsData=await l.json()},actionColor(l){switch(l){case"create":return"create-action";case"update":return"update-action";default:return"delete-action"}}}},re={key:0,class:"container-md main-container"},ae={class:"d-flex flex-column"},de=["onClick"],ce={key:1,class:"shake"},ue={key:2},ke={id:"myModal",class:"modal"},_e={class:"modal-content skill-modal"},he={class:"modal-label"},me={class:"skill-modal-text"},pe={class:"d-flex justify-content-center"};function we(l,s,u,_,o,a){const k=v("router-link");return i(),n(f,null,[o.rows.length?(i(),n("div",re,[t("div",ae,[(i(!0),n(f,null,x(o.rows,e=>(i(),n("div",null,[d(r(e.time)+" ("+r(e.date)+") - ",1),t("span",{class:p(a.actionColor(e.action))},r(e.action),3),s[1]||(s[1]=t("span",null," skill: ",-1)),e.action==="delete"||e.is_deleted===1?(i(),n("span",{key:0,class:"skill-link",onClick:y=>{o.showWarnModal=!0,o.currentChooseSkill=e.skillName}},r(e.skillName),9,de)):(i(),b(k,{key:1,class:"skill-link",target:"_blank",to:`/skills/${e.skillUrl}`},{default:h(()=>[d(r(e.skillName),1)]),_:2},1032,["to"]))]))),256))])])):(i(),n("div",ce,"The user has no recorded actions on skills")),o.showWarnModal?(i(),n("div",ue,[t("div",ke,[t("div",_e,[t("div",he,[s[2]||(s[2]=d(" Skill ",-1)),t("span",me,r(o.currentChooseSkill),1),s[3]||(s[3]=d(" is deleted !! ",-1))]),t("div",pe,[t("button",{type:"button",class:"btn green-btn w-fit",onClick:s[0]||(s[0]=e=>o.showWarnModal=!1)},s[4]||(s[4]=[t("div",null,"OK",-1)]))])])])])):c("",!0)],64)}const fe=g(ne,[["render",we]]),ve={props:["userId","deleteMcQuestion"],data(){return{questionsData:[],rows:[],showWarnModal:!1}},components:{},async created(){await this.getMcQuestionsLog(),this.questionsData.forEach(l=>{const s=JSON.parse(l.content_obj),u=new Date(l.create_date),_=u.toLocaleString("en-gb",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),o=u.toLocaleTimeString();this.rows.push({skillName:s.skill_name,skillUrl:s.skill_url,resourceId:l.content_id,action:l.action,date:_,time:o,id:l.id,studentName:s.student_name,studentId:s.student_id,skill_deleted:s.skill_deleted})})},methods:{async getMcQuestionsLog(){const l=await fetch(`/user-actions/${this.userId}/student_mc_question`);this.questionsData=await l.json()},actionColor(l){switch(l){case"create":return"create-action";case"update":return"update-action";default:return"delete-action"}}}},ye={key:0,class:"container-md main-container"},be={class:"d-flex flex-column"},ge={key:0},Se={key:1},xe={key:2},Ce={key:1,class:"shake"},Me={key:2},$e={id:"myModal",class:"modal"},Ne={class:"modal-content"},Ue={class:"d-flex justify-content-center"};function De(l,s,u,_,o,a){const k=v("router-link");return i(),n(f,null,[o.rows.length>0?(i(),n("div",ye,[t("div",be,[(i(!0),n(f,null,x(o.rows,e=>(i(),n("div",null,[d(r(e.time)+" ("+r(e.date)+") ",1),t("span",{class:p(a.actionColor(e.action))}," - "+r(e.action),3),e.action==="delete"?(i(),n("span",ge," student mc_question with id "+r(e.id),1)):e.action==="create"?(i(),n("span",Se," student mc_question for skill: ")):(i(),n("span",xe,[s[2]||(s[2]=d(" mc question of student ",-1)),m(k,{class:"user-link",target:"_blank",to:"/users"},{default:h(()=>[d(r(e.studentName),1)]),_:2},1024),s[3]||(s[3]=d(" on skill: ",-1))])),e.action==="delete"||e.skill_deleted===1?(i(),n("span",{key:3,class:"skill-link",onClick:s[0]||(s[0]=y=>o.showWarnModal=!0)},r(e.skillName),1)):(i(),b(k,{key:4,class:"skill-link",target:"_blank",to:`/skills/${e.skillUrl}`},{default:h(()=>[d(r(e.skillName),1)]),_:2},1032,["to"]))]))),256))])])):(i(),n("div",Ce," The user has no recorded actions on multiple-choice questions ")),o.showWarnModal?(i(),n("div",Me,[t("div",$e,[t("div",Ne,[s[5]||(s[5]=t("div",{class:"d-flex gap-4 justify-content-center mb-4"},[t("div",{class:"modal-label"},"This skill is deleted !!")],-1)),t("div",Ue,[t("button",{type:"button",class:"btn green-btn w-25",onClick:s[1]||(s[1]=e=>o.showWarnModal=!1)},s[4]||(s[4]=[t("div",null,"OK",-1)]))])])])])):c("",!0)],64)}const Te=g(ve,[["render",De]]);const Ie={props:["userId"],setup(){return{skillsStore:C()}},data(){return{skillsData:[],rows:[],showWarnModal:!1,currentChooseSkill:""}},components:{},async created(){await this.getSubmittedSkillLogs();const l=[];this.skillsData.forEach(s=>{s.action==="approve"?l.push(this.getApproveSkillData(s)):l.push(this.getStillAwaitingData(s))}),Promise.all(l)},methods:{async getSubmittedSkillLogs(){const l=await fetch(`/user-actions/${this.userId}/new-skill`);this.skillsData=await l.json()},async getApproveSkillData(l){const s=new Date(l.create_date),u=s.toLocaleString("en-gb",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),_=s.toLocaleTimeString(),o=await this.skillsStore.findSkillById(l.content_id);this.rows.push({resourceId:l.content_id,action:l.action,date:u,time:_,id:l.id,skillName:o&&o.name,skillUrl:o.url&&o.url})},async getStillAwaitingData(l){const s=new Date(l.create_date),u=s.toLocaleString("en-gb",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),_=s.toLocaleTimeString(),a=await(await fetch(`/new-skills-awaiting-approval/show/${l.content_id}`)).json(),k=a.name&&a.name;this.rows.push({resourceId:l.content_id,action:l.action,date:u,time:_,id:l.id,skillName:k})},actionColor(l){switch(l){case"create":return"create-action";case"update":return"update-action";default:return"delete-action"}}}},je={key:0,class:"container-md main-container"},Ae={class:"d-flex flex-column"},We={key:0,class:"ms-1"},Le={key:1,class:"shake"},Qe={key:2},qe={id:"myModal",class:"modal"},Oe={class:"modal-content skill-modal"},Be={class:"d-flex justify-content-center"};function Re(l,s,u,_,o,a){const k=v("router-link");return i(),n(f,null,[o.rows.length?(i(),n("div",je,[t("div",Ae,[(i(!0),n(f,null,x(o.rows,e=>(i(),n("div",null,[d(r(e.time)+" ("+r(e.date)+") - ",1),t("span",{class:p(a.actionColor(e.action))},r(e.action),3),e.skillName&&e.action!=="approve"?(i(),n("span",We," skill: "+r(e.skillName),1)):c("",!0),e.skillName&&e.action==="approve"?(i(),b(k,{key:1,class:"skill-link ms-1",target:"_blank",to:`/skills/${e.skillUrl}`},{default:h(()=>[d(r(e.skillName)+".",1)]),_:2},1032,["to"])):c("",!0),e.skillName?c("",!0):(i(),n("span",{key:2,onClick:s[0]||(s[0]=y=>o.showWarnModal=!0),class:"no-skill-text ms-1"},"skill deleted."))]))),256))])])):(i(),n("div",Le,"The user has no recorded actions on skills")),o.showWarnModal?(i(),n("div",Qe,[t("div",qe,[t("div",Oe,[s[3]||(s[3]=t("div",{class:"modal-label"},"Skill is deleted !!",-1)),t("div",Be,[t("button",{type:"button",class:"btn green-btn w-fit",onClick:s[1]||(s[1]=e=>o.showWarnModal=!1)},s[2]||(s[2]=[t("div",null,"OK",-1)]))])])])])):c("",!0)],64)}const Ee=g(Ie,[["render",Re]]);const Ke={setup(){const l=U(),s=D();return{usersStore:l,userDetailsStore:s}},data(){return{user:{id:this.$route.params.id,firstName:null,lastName:null,username:null,role:null,avatar:null},showFlags:!1,showSources:!1,showMcQuestions:!1,showStudentMcQuestions:!1,showSkills:!1,showSkillSubmittedByUsers:!1,mcQuestions:[],resources:[],flags:[],skillEdits:[],isTutorialComplete:!1,showTutorialTip1:!1}},components:{UserFlagActions:bs,UserResourceActions:qs,UserQuestionActions:ie,UserStudentMcQuestionActions:Te,UserSkillActions:fe,UserSkillAwaitingForApprovalActions:Ee},async created(){await this.getUserDetails(),this.checkIfTutorialComplete()},methods:{async getUserDetails(){this.usersStore.users.length<1&&await this.usersStore.getUsers();for(let l=0;l<this.usersStore.users.length;l++)this.usersStore.users[l].id==this.user.id&&(this.user.firstName=this.usersStore.users[l].first_name,this.user.lastName=this.usersStore.users[l].last_name,this.user.username=this.usersStore.users[l].username,this.user.role=this.usersStore.users[l].role,this.user.avatar=this.usersStore.users[l].avatar)},async checkIfTutorialComplete(){const s=await(await fetch("/users/check-tutorial-progress/user-activity-report/"+this.userDetailsStore.userId)).json();s==0?(this.isTutorialComplete=!1,this.showTutorialTip1=!0):s==1&&(this.isTutorialComplete=!0)},progressTutorial(l){l==1&&(this.showTutorialTip1=!1,this.markTutorialComplete())},restartTutorial(){this.showTutorialTip1=!0,this.isTutorialComplete=!1},markTutorialComplete(){let l="/users/mark-tutorial-complete/user-activity-report/"+this.userDetailsStore.userId;fetch(l,{method:"PUT",headers:{"Content-Type":"application/json"}})}}},ze={class:"container bg-light rounded p-3"},He={class:"d-flex justify-content-between"},Je={class:"row"},Ve={class:"d-flex flex-column flex-md-row gap-3"},Pe=["src"],Ge={class:"d-flex flex-column"},Xe={id:"user-name"},Ye={id:"role"},Ze={class:"d-flex flex-column"},Fe={class:"d-flex flex-row justify-content-between"},st=["title"],et={class:"secondary-heading h4"},tt={key:0},ot={class:"d-flex flex-column"},lt={class:"d-flex flex-row justify-content-between"},it=["title"],nt={class:"secondary-heading h4"},rt={key:0},at={key:0,class:"mt-5 mb-3"},dt={class:"d-flex flex-column"},ct={class:"d-flex flex-row justify-content-between"},ut=["title"],kt={class:"secondary-heading h4"},_t={key:0},ht={class:"d-flex flex-column"},mt={class:"d-flex flex-row justify-content-between"},pt=["title"],wt={class:"secondary-heading h4"},ft={key:0},vt={class:"d-flex flex-column"},yt={class:"d-flex flex-row justify-content-between"},bt=["title"],gt={class:"secondary-heading h4"},St={key:0},xt={class:"d-flex flex-column mb-3"},Ct={class:"d-flex flex-row justify-content-between"},Mt=["title"],$t={class:"secondary-heading h4"},Nt={key:0},Ut={key:0,class:"modal"},Dt={class:"modal-content"},Tt={key:0};function It(l,s,u,_,o,a){const k=v("UserFlagActions"),e=v("UserQuestionActions"),y=v("UserStudentMcQuestionActions"),M=v("UserResourceActions"),$=v("UserSkillActions"),N=v("UserSkillAwaitingForApprovalActions");return i(),n(f,null,[t("div",ze,[t("div",He,[s[15]||(s[15]=t("h1",{class:"heading mb-2"},"User Activity Report",-1)),t("button",{class:"btn primary-btn",onClick:s[0]||(s[0]=(...w)=>a.restartTutorial&&a.restartTutorial(...w))},s[14]||(s[14]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 192 512",width:"20",height:"20",fill:"white"},[t("path",{d:"M48 80a48 48 0 1 1 96 0A48 48 0 1 1 48 80zM0 224c0-17.7 14.3-32 32-32l64 0c17.7 0 32 14.3 32 32l0 224 32 0c17.7 0 32 14.3 32 32s-14.3 32-32 32L32 512c-17.7 0-32-14.3-32-32s14.3-32 32-32l32 0 0-192-32 0c-17.7 0-32-14.3-32-32z"})],-1)]))]),t("div",Je,[t("div",Ve,[t("img",{id:"activity-report-user-avatar",src:o.user.avatar},null,8,Pe),t("div",Ge,[t("div",Xe,r(o.user.username),1),t("div",Ye,r(o.user.role),1)])])]),t("div",null,[t("div",Ze,[t("div",Fe,[t("div",{class:"log-type",onClick:s[1]||(s[1]=w=>o.showFlags=!o.showFlags),"b-on-hover":"",title:o.showFlags?"collapse":"expand"},[t("h2",et,[s[17]||(s[17]=d(" Flags ",-1)),(i(),n("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 320 512",width:"22",height:"22",fill:"#667085",class:p([o.showFlags?"arrow-point-down mb-2":"arrow-point-up "])},s[16]||(s[16]=[t("path",{d:"M182.6 137.4c-12.5-12.5-32.8-12.5-45.3 0l-128 128c-9.2 9.2-11.9 22.9-6.9 34.9s16.6 19.8 29.6 19.8H288c12.9 0 24.6-7.8 29.6-19.8s2.2-25.7-6.9-34.9l-128-128z"},null,-1)]),2))])],8,st)]),m(S,{name:"dropdown"},{default:h(()=>[o.showFlags?(i(),n("div",tt,[m(k,{ref:"contentFlagsPerUser",userId:o.user.id,onCloseFlagDiv:s[2]||(s[2]=w=>o.showFlags=!1)},null,8,["userId"])])):c("",!0)]),_:1})]),t("div",ot,[t("div",lt,[t("div",{class:"log-type",onClick:s[3]||(s[3]=w=>o.showMcQuestions=!o.showMcQuestions),"b-on-hover":"",title:o.showMcQuestions?"collapse":"expand"},[t("h2",nt,[s[19]||(s[19]=d(" Questions ",-1)),(i(),n("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 320 512",width:"22",height:"22",fill:"#667085",class:p([o.showMcQuestions?"arrow-point-down mb-2":"arrow-point-up"])},s[18]||(s[18]=[t("path",{d:"M182.6 137.4c-12.5-12.5-32.8-12.5-45.3 0l-128 128c-9.2 9.2-11.9 22.9-6.9 34.9s16.6 19.8 29.6 19.8H288c12.9 0 24.6-7.8 29.6-19.8s2.2-25.7-6.9-34.9l-128-128z"},null,-1)]),2))])],8,it)]),m(S,{name:"dropdown"},{default:h(()=>[o.showMcQuestions?(i(),n("div",rt,[m(e,{userId:o.user.id,onCloseMcQuestionDiv:s[4]||(s[4]=w=>o.showMcQuestions=!1)},null,8,["userId"])])):c("",!0)]),_:1})]),o.user.role==="platform_admin"?(i(),n("hr",at)):c("",!0),t("div",dt,[t("div",ct,[t("div",{class:"log-type",onClick:s[5]||(s[5]=w=>o.showStudentMcQuestions=!o.showStudentMcQuestions),"b-on-hover":"",title:o.showStudentMcQuestions?"collapse":"expand"},[t("h2",kt,[s[21]||(s[21]=d(" Student Suggested MC Questions ",-1)),(i(),n("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 320 512",width:"22",height:"22",fill:"#667085",class:p([o.showStudentMcQuestions?"arrow-point-down mb-2":"arrow-point-up"])},s[20]||(s[20]=[t("path",{d:"M182.6 137.4c-12.5-12.5-32.8-12.5-45.3 0l-128 128c-9.2 9.2-11.9 22.9-6.9 34.9s16.6 19.8 29.6 19.8H288c12.9 0 24.6-7.8 29.6-19.8s2.2-25.7-6.9-34.9l-128-128z"},null,-1)]),2))])],8,ut)]),m(S,{name:"dropdown"},{default:h(()=>[o.showStudentMcQuestions?(i(),n("div",_t,[m(y,{userId:o.user.id,onCloseMcQuestionDiv:s[6]||(s[6]=w=>o.showStudentMcQuestions=!1)},null,8,["userId"])])):c("",!0)]),_:1})]),t("div",ht,[t("div",mt,[t("div",{class:"log-type",onClick:s[7]||(s[7]=w=>o.showSources=!o.showSources),"b-on-hover":"",title:o.showSources?"collapse":"expand"},[t("h2",wt,[s[23]||(s[23]=d(" Sources ",-1)),(i(),n("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 320 512",width:"22",height:"22",fill:"#667085",class:p([o.showSources?"arrow-point-down mb-2":"arrow-point-up "])},s[22]||(s[22]=[t("path",{d:"M182.6 137.4c-12.5-12.5-32.8-12.5-45.3 0l-128 128c-9.2 9.2-11.9 22.9-6.9 34.9s16.6 19.8 29.6 19.8H288c12.9 0 24.6-7.8 29.6-19.8s2.2-25.7-6.9-34.9l-128-128z"},null,-1)]),2))])],8,pt)]),m(S,{name:"dropdown"},{default:h(()=>[o.showSources?(i(),n("div",ft,[m(M,{userId:o.user.id,onCloseResourceDiv:s[8]||(s[8]=w=>o.showSources=!1)},null,8,["userId"])])):c("",!0)]),_:1})]),t("div",vt,[t("div",yt,[t("div",{class:"log-type",onClick:s[9]||(s[9]=w=>o.showSkills=!o.showSkills),"b-on-hover":"",title:o.showSkills?"collapse":"expand"},[t("h2",gt,[s[25]||(s[25]=d(" Skills ",-1)),(i(),n("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 320 512",width:"22",height:"22",fill:"#667085",class:p([o.showSkills?"arrow-point-down mb-2":"arrow-point-up "])},s[24]||(s[24]=[t("path",{d:"M182.6 137.4c-12.5-12.5-32.8-12.5-45.3 0l-128 128c-9.2 9.2-11.9 22.9-6.9 34.9s16.6 19.8 29.6 19.8H288c12.9 0 24.6-7.8 29.6-19.8s2.2-25.7-6.9-34.9l-128-128z"},null,-1)]),2))])],8,bt)]),m(S,{name:"dropdown"},{default:h(()=>[o.showSkills?(i(),n("div",St,[m($,{userId:o.user.id,onCloseResourceDiv:s[10]||(s[10]=w=>o.showSkills=!1)},null,8,["userId"])])):c("",!0)]),_:1})]),t("div",xt,[t("div",Ct,[t("div",{class:"log-type",onClick:s[11]||(s[11]=w=>o.showSkillSubmittedByUsers=!o.showSkillSubmittedByUsers),"b-on-hover":"",title:o.showSkillSubmittedByUsers?"collapse":"expand"},[t("h2",$t,[s[27]||(s[27]=d(" User Suggested New Skills ",-1)),(i(),n("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 320 512",width:"22",height:"22",fill:"#667085",class:p([o.showSkillSubmittedByUsers?"arrow-point-down mb-2":"arrow-point-up "])},s[26]||(s[26]=[t("path",{d:"M182.6 137.4c-12.5-12.5-32.8-12.5-45.3 0l-128 128c-9.2 9.2-11.9 22.9-6.9 34.9s16.6 19.8 29.6 19.8H288c12.9 0 24.6-7.8 29.6-19.8s2.2-25.7-6.9-34.9l-128-128z"},null,-1)]),2))])],8,Mt)]),m(S,{name:"dropdown"},{default:h(()=>[o.showSkillSubmittedByUsers?(i(),n("div",Nt,[m(N,{userId:o.user.id,onCloseResourceDiv:s[12]||(s[12]=w=>o.showSkillSubmittedByUsers=!1)},null,8,["userId"])])):c("",!0)]),_:1})])])]),o.showTutorialTip1?(i(),n("div",Ut,[t("div",Dt,[o.showTutorialTip1?(i(),n("div",Tt,[s[28]||(s[28]=t("p",null,"This is the User Activity List page.",-1)),s[29]||(s[29]=t("p",null,"It shows what editors have been up to on the site.",-1)),t("button",{class:"btn primary-btn",onClick:s[13]||(s[13]=w=>a.progressTutorial(1))}," close ")])):c("",!0)])])):c("",!0)],64)}const Wt=g(Ke,[["render",It]]);export{Wt as default};
