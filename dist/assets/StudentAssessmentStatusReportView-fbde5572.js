import{_ as y,A,K as w,r as u,o as m,c as h,a as n,t as x,k as f,g as b,p as B,d as k}from"./main-560ee53d.js";import{u as D}from"./AnalyticsStore-efb7ce9b.js";import"./transform-4d0f7c8f.js";import{l as v,a as j,b as C}from"./linear-d9b6cbf2.js";import{m as I}from"./continuous-93813e6c.js";import{b as N}from"./band-2263c9e7.js";import{s as R}from"./sort-fcaf8f38.js";import{s as g}from"./string-c67ea49d.js";import{A as $}from"./AttemptedAssessmentsTimelineChart-d8d23640.js";import{D as T}from"./downloadCSVBtn-794c12ec.js";import"./main-43736e37.js";import"./time-3c9385c3.js";const V={name:"StudentAttemptedAssessmentsByRootSubjectHorizontalBarChart",props:["data"],data(){return{}},mounted(){console.log(this.data),g("#assessment-comparison-chart-container");const e=0,s=10,c=10,i=200,o=document.getElementById("assessment-comparison-chart-container").clientWidth,l=document.getElementById("assessment-comparison-chart-container").clientHeight,a=v().domain([0,I(this.data,t=>t.quantity)]).range([i,o-s]),r=N().domain(R(this.data,t=>-t.quantity).map(t=>t.name)).rangeRound([e,l-c]).padding(.2),p=a.tickFormat(20),d=g("#assessment-comparison-chart-container").append("svg").attr("width","100%").attr("height","100%").attr("viewBox",[0,0,"100%","100%"]).attr("style","max-width: 100%; height: 100%; font: 14px sans-serif;");d.append("g").selectAll().data(this.data).join("rect").attr("x",a(0)).attr("y",t=>r(t.name)).attr("width",t=>a(t.quantity)-a(0)).attr("height",r.bandwidth()).attr("fill",function(t){return t.name=="Language"?"DarkMagenta":t.name=="Mathematics"?"blue":t.name=="Science & Invention"?"purple":t.name=="Computer Science"?"deeppink":t.name=="Dangerous Ideas"?"brown":t.name=="History"?"cyan":t.name=="Life"?"magenta":"#ff7f0e"}),d.append("g").attr("fill","white").attr("text-anchor","end").selectAll().data(this.data).join("text").attr("x",t=>a(t.quantity)).attr("y",t=>r(t.name)+r.bandwidth()/2).attr("dy","0.35em").attr("dx",-4).text(t=>p(t.quantity)).call(t=>t.filter(S=>a(S.quantity)-a(0)<20).attr("dx",4).attr("fill","black").attr("text-anchor","start")),d.append("g").attr("transform",`translate(0,${e})`).call(j(a).ticks(0)).call(t=>t.select(".domain").remove()),d.append("g").attr("transform",`translate(${i},0)`).attr("style","font-size: 16px").call(C(r).tickSizeOuter(0))},computed:{}};function q(e,s,c,i,o,l){return null}const z=y(V,[["render",q]]);const H={setup(){const e=A(),s=w(),c=D();return{usersStore:e,userSkillsStore:s,analyticsStore:c}},components:{AttemptedAssessmentsTimelineChart:$,StudentAttemptedAssessmentsByRootSubjectHorizontalBarChart:z,DownloadCSVBtn:T},data(){return{studentId:this.$route.params.studentId,studentName:null,assessmentAttempts:[],assessmentAttemptsDownloadData:[]}},async created(){this.usersStore.users.length<1&&await this.usersStore.getUsers();const e=this.usersStore.users.find(s=>s.id===this.studentId);e&&(this.studentName=e.username),await this.getAssessmentAttempts(),await this.analyticsStore.getStudentAttemptedAssessmentsBySubject(this.studentId)},methods:{async getAssessmentAttempts(){fetch(`/student-analytics/started-unmastered-assessments/${this.studentId}`).then(e=>e.json()).then(e=>{this.assessmentAttempts=e.map(s=>({...s,url:`/skills/${s.url}`,labelName:`${s.name}`})),this.assessmentAttemptsDownloadData=this.assessmentAttempts.map(s=>({skill:s.name,date:this.assessmentDate(s.date)}))}).catch(e=>{console.error("Error fetching last visited skills:",e)})},assessmentDate(e){return new Date(e).toLocaleString("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})}}},_=e=>(B("data-v-e2c3eaae"),e=e(),k(),e),L={class:"container-fluid chart-page"},E={class:"d-flex justify-content-between w-100"},U=_(()=>n("h1",{class:"heading h4"},"Attempted assessments",-1)),M={class:"tertiary-heading h4"},O={class:"row chart-row"},F=_(()=>n("h3",{class:"secondary-heading h5"},"Subject Comparison",-1)),K={id:"assessment-comparison-chart-container",class:"position-relative h-100"},W={key:1},G={class:"row mt-5 chart-row"},J=_(()=>n("h3",{class:"secondary-heading h5"},"Timeline",-1)),P={id:"assessment-timeline-chart-container",class:"position-relative"},Q={key:1};function X(e,s,c,i,o,l){const a=u("StudentAttemptedAssessmentsByRootSubjectHorizontalBarChart"),r=u("DownloadCSVBtn"),p=u("AttemptedAssessmentsTimelineChart");return m(),h("div",L,[n("span",E,[U,n("h2",M,x(o.studentName),1)]),n("div",O,[F,n("div",K,[i.analyticsStore.studentRootSubjectsAttemptedAssessments.length>0?(m(),f(a,{key:0,data:i.analyticsStore.studentRootSubjectsAttemptedAssessments},null,8,["data"])):(m(),h("p",W,"No data yet"))])]),n("div",G,[J,n("div",P,[b(r,{data:o.assessmentAttemptsDownloadData,fileName:`Attempted Assessments - ${o.studentName}`,toolTip:"Download attempted assessments data as CSV",class:"position-absolute download-btn"},null,8,["data","fileName"]),o.assessmentAttempts.length>0?(m(),f(p,{key:0,data:o.assessmentAttempts},null,8,["data"])):(m(),h("p",Q," This student has not attempted any assessments yet. "))])])])}const dt=y(H,[["render",X],["__scopeId","data-v-e2c3eaae"]]);export{dt as default};
