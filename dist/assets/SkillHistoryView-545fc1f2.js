import{_ as V,r as z,o as a,c,a as e,b as u,f as w,k as x,t as n,m as O,p as y,T as A,y as I,F as E,x as F,j as H}from"./main-a5607f73.js";import{d as b}from"./dayjs.min-d6bc37a0.js";import{c as Y,g as G,d as k}from"./index.es6-593402c1.js";var P={exports:{}};(function(d,t){(function(s,h){d.exports=h()})(Y,function(){return function(s,h,i){s=s||{};var r=h.prototype,l={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function m(v,f,p,M){return r.fromToBase(v,f,p,M)}i.en.relativeTime=l,r.fromToBase=function(v,f,p,M,q){for(var D,C,L,S=p.$locale().relativeTime||l,T=s.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],U=T.length,R=0;R<U;R+=1){var _=T[R];_.d&&(D=M?i(v).diff(p,_.d,!0):p.diff(v,_.d,!0));var g=(s.rounding||Math.round)(Math.abs(D));if(L=D>0,g<=_.r||!_.r){g<=1&&R>0&&(_=T[R-1]);var N=S[_.l];q&&(g=q(""+g)),C=typeof N=="string"?N.replace("%d",g):N(g,f,_.l,L);break}}if(f)return C;var B=L?S.future:S.past;return typeof B=="function"?B(C):B.replace("%s",C)},r.to=function(v,f){return m(v,f,this,!0)},r.from=function(v,f){return m(v,f,this)};var o=function(v){return v.$u?i.utc():i()};r.toNow=function(v){return this.to(o(this),v)},r.fromNow=function(v){return this.from(o(this),v)}}})})(P);var W=P.exports;const j=G(W);const Z={setup(){},data(){return{hoverOn:!1,dateFromNow:"",added:0,removed:0,changed:{name:!1,description:!1,mastery_requirements:!1}}},props:["revision","skill"],methods:{extractContent(d){return new DOMParser().parseFromString(d,"text/html").documentElement.textContent},countDiff(){var r,l,m;const d=this.extractContent(this.revision.mastery_requirements),t=this.extractContent((r=this.revision.lastRevision)==null?void 0:r.mastery_requirements),s=k(t,d),h=k((l=this.revision.lastRevision)==null?void 0:l.name,this.revision.name),i=k((m=this.revision.lastRevision)==null?void 0:m.description,this.revision.description);s.forEach(o=>{o.added&&(this.added=this.added+1,this.changed.mastery_requirements=!0),o.removed&&(this.removed=this.removed+1,this.changed.mastery_requirements=!0)}),h.forEach(o=>{o.added&&(this.added=this.added+1,this.changed.name=!0),o.removed&&(this.removed=this.removed+1,this.changed.name=!0)}),i.forEach(o=>{o.added&&(this.added=this.added+1,this.changed.description=!0),o.removed&&(this.removed=this.removed+1,this.changed.description=!0)})}},async mounted(){b.extend(j),this.dateFromNow=b(this.revision.timeStamp).fromNow(),this.revision.lastRevision&&this.countDiff()}},J={class:"revision-header"},K={class:"row-header-circle"},Q={key:0,class:"inner-row-header-circle"},X={class:"d-flex"},$={class:"d-flex align-items-start"},ee={class:"me-1 edit-date"},ie={class:"revision-comment"},se={key:0,class:"current-badge d-flex gap-1 align-items-center ms-2"},te={class:"by-user"},ne={class:"position-relative"},oe={class:"d-flex align-items-center px-2"},re={class:"mx-1 d-flex align-items-center"},le={class:"d-flex align-items-center"},de={class:"mt-2 px-2 break-line"},ae={class:"hover-sub-info px-2"},me={class:"hover-sub-info px-2 break-line"},ce={class:"insert","b-on-hoover":"",title:"number of words added"},ve={class:"removed ms-1","b-on-hoover":"",title:"number of words removed"};function he(d,t,s,h,i,r){const l=z("router-link");return a(),c("div",{onMouseover:t[0]||(t[0]=m=>i.hoverOn=!0),onMouseleave:t[1]||(t[1]=m=>i.hoverOn=!1),class:"d-flex"},[e("div",J,[e("div",K,[i.hoverOn?(a(),c("div",Q)):u("",!0)])]),e("div",X,[w(l,{class:"d-flex flex-column ms-3 revision-data",to:`/skills/${s.skill.url}/revision/${s.revision.version_number}`},{default:x(()=>[e("div",$,[e("div",ee,n(s.revision.edited_date),1),e("div",ie," - "+n(s.revision.comment?s.revision.comment:"no comment"),1),s.revision.isCurrentRevision?(a(),c("div",se,t[2]||(t[2]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",heigh:"15",width:"15",fill:"white"},[e("path",{d:"M448 256A192 192 0 1 0 64 256a192 192 0 1 0 384 0zM0 256a256 256 0 1 1 512 0A256 256 0 1 1 0 256zm256 80a80 80 0 1 0 0-160 80 80 0 1 0 0 160zm0-224a144 144 0 1 1 0 288 144 144 0 1 1 0-288zM224 256a32 32 0 1 1 64 0 32 32 0 1 1 -64 0z"})],-1),e("div",null,"Current Version",-1)]))):u("",!0)]),e("div",te,"By "+n(s.revision.username),1)]),_:1},8,["to"]),e("div",null,[e("div",ne,[w(A,{name:"appear"},{default:x(()=>[i.hoverOn?(a(),c("div",{key:0,class:O(["revision-hover-detail",{"appear-top":s.revision.isCurrentRevision,"appear-center":!s.revision.isCurrentRevision&&s.revision.lastRevision,"appear-bottom":s.revision.isOrigin}])},[e("div",{class:O(["bubble",{"triangle-top":s.revision.isCurrentRevision,"triangle-center":!s.revision.isCurrentRevision&&s.revision.lastRevision,"triangle-bottom":!s.revision.lastRevision&&!s.revision.isCurrentRevision}])},[e("div",oe,[t[4]||(t[4]=e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",width:"15",height:"15",class:"primary-icon"},[e("path",{d:"M406.5 399.6C387.4 352.9 341.5 320 288 320l-64 0c-53.5 0-99.4 32.9-118.5 79.6C69.9 362.2 48 311.7 48 256C48 141.1 141.1 48 256 48s208 93.1 208 208c0 55.7-21.9 106.2-57.5 143.6zm-40.1 32.7C334.4 452.4 296.6 464 256 464s-78.4-11.6-110.5-31.7c7.3-36.7 39.7-64.3 78.5-64.3l64 0c38.8 0 71.2 27.6 78.5 64.3zM256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zm0-272a40 40 0 1 1 0-80 40 40 0 1 1 0 80zm-88-40a88 88 0 1 0 176 0 88 88 0 1 0 -176 0z"})],-1)),e("div",re,[y(n(s.revision.username)+", ",1),e("div",le,[t[3]||(t[3]=e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",width:"12",height:"12",class:"mx-1 primary-icon"},[e("path",{d:"M75 75L41 41C25.9 25.9 0 36.6 0 57.9L0 168c0 13.3 10.7 24 24 24l110.1 0c21.4 0 32.1-25.9 17-41l-30.8-30.8C155 85.5 203 64 256 64c106 0 192 86 192 192s-86 192-192 192c-40.8 0-78.6-12.7-109.7-34.4c-14.5-10.1-34.4-6.6-44.6 7.9s-6.6 34.4 7.9 44.6C151.2 495 201.7 512 256 512c141.4 0 256-114.6 256-256S397.4 0 256 0C185.3 0 121.3 28.7 75 75zm181 53c-13.3 0-24 10.7-24 24l0 104c0 6.4 2.5 12.5 7 17l72 72c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-65-65 0-94.1c0-13.3-10.7-24-24-24z"})],-1)),e("div",null,n(i.dateFromNow),1)]),y(" ("+n(s.revision.edited_date)+") ",1)])]),e("div",de,n(s.revision.isOrigin?"Origin created by platform admin.":s.revision.comment?s.revision.comment:"No Comment"),1),e("div",ae," Changed: "+n(i.changed.name?i.changed.description?"name,":"name":"")+" "+n(i.changed.description?i.changed.mastery_requirements?"description, ":"description":"")+" "+n(i.changed.mastery_requirements?"mastery requirements":""),1),e("div",me,[e("span",ce,"+"+n(i.added)+" insertion,",1),e("span",ve,"-"+n(i.removed)+" deletion",1)]),w(l,{class:"ms-2",to:`/skills/${s.skill.url}/revision/${s.revision.version_number}`},{default:x(()=>t[5]||(t[5]=[y("see this edited version",-1)])),_:1,__:[5]},8,["to"])],2)],2)):u("",!0)]),_:1})])])])],32)}const ue=V(Z,[["render",he],["__scopeId","data-v-10e575e2"]]);const fe={setup(){},data(){return{dateFromNow:"",added:0,showDetail:!1,removed:0,shortDate:"",changed:{name:!1,description:!1,mastery_requirements:!1}}},props:["revision","skill"],methods:{extractContent(d){return new DOMParser().parseFromString(d,"text/html").documentElement.textContent},countDiff(){var r,l,m;const d=this.extractContent(this.revision.mastery_requirements),t=this.extractContent((r=this.revision.lastRevision)==null?void 0:r.mastery_requirements),s=k(t,d),h=k((l=this.revision.lastRevision)==null?void 0:l.name,this.revision.name),i=k((m=this.revision.lastRevision)==null?void 0:m.description,this.revision.description);s.forEach(o=>{o.added&&(this.added=this.added+1,this.changed.mastery_requirements=!0),o.removed&&(this.removed=this.removed+1,this.changed.mastery_requirements=!0)}),h.forEach(o=>{o.added&&(this.added=this.added+1,this.changed.name=!0),o.removed&&(this.removed=this.removed+1,this.changed.name=!0)}),i.forEach(o=>{o.added&&(this.added=this.added+1,this.changed.description=!0),o.removed&&(this.removed=this.removed+1,this.changed.description=!0)})}},async mounted(){b.extend(j),this.dateFromNow=b(this.revision.timeStamp).fromNow(),this.shortDate=b(this.revision.timeStamp).format("DD-MM-YYYY"),this.revision.lastRevision&&this.countDiff()}},_e={class:"d-flex"},ge={class:"revision-header"},we={class:"row-header-circle"},xe={key:0,class:"inner-row-header-circle"},ye={class:"d-flex"},ke={class:"d-flex flex-column ms-3 revision-data"},pe={class:"revision-comment"},Re={key:0,class:"current-badge d-flex gap-1 align-items-center ms-2 d-none"},be={key:1,class:"origin-badge d-flex gap-1 align-items-center ms-2 d-none"},Ce={class:"by-user"},ze={class:"position-relative"},Me={key:0,class:"d-flex flex-column details-div triangle-upper"},De={class:"d-flex flex-column flex-md-row align-items-md-center px-2 align-items-start"},Le={class:"d-flex align-items-center justify-content-start"},Se={class:"ms-0 ms-md-1 d-flex flex-column flex-md-row align-items-md-center align-items-start"},Te={class:"d-flex align-items-center"},Ne={class:"ms-0 ms-md-1"},Be={class:"mt-2 px-2 break-line"},Oe={class:"hover-sub-info px-2"},Ve={class:"hover-sub-info px-2 break-line"},qe={class:"insert","b-on-hoover":"",title:"number of words added"},Ee={class:"removed ms-1","b-on-hoover":"",title:"number of words removed"},Fe={class:"d-flex"},He={key:0,class:"current-badge d-flex gap-1 align-items-center ms-2 d-md-none"},Ae={key:1,class:"origin-badge d-flex gap-1 align-items-center ms-2 d-md-none"};function Pe(d,t,s,h,i,r){const l=z("router-link");return a(),c("div",_e,[e("div",ge,[e("div",we,[i.showDetail?(a(),c("div",xe)):u("",!0)])]),e("div",ye,[e("div",ke,[e("div",{class:"d-flex align-items-start",onClick:t[0]||(t[0]=m=>i.showDetail=!i.showDetail)},[w(l,{to:`/skills/${s.skill.url}/revision/${s.revision.version_number}`,class:"me-1 edit-date"},{default:x(()=>[y(n(i.shortDate),1)]),_:1},8,["to"]),e("div",pe," - "+n(s.revision.comment?s.revision.comment:"no comment"),1),s.revision.isCurrentRevision?(a(),c("div",Re,t[1]||(t[1]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",heigh:"15",width:"15",fill:"white"},[e("path",{d:"M448 256A192 192 0 1 0 64 256a192 192 0 1 0 384 0zM0 256a256 256 0 1 1 512 0A256 256 0 1 1 0 256zm256 80a80 80 0 1 0 0-160 80 80 0 1 0 0 160zm0-224a144 144 0 1 1 0 288 144 144 0 1 1 0-288zM224 256a32 32 0 1 1 64 0 32 32 0 1 1 -64 0z"})],-1),e("div",null,"Current Version",-1)]))):u("",!0),s.revision.isOrigin?(a(),c("div",be,t[2]||(t[2]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",fill:"white",height:"15",width:"15"},[e("path",{d:"M502.3 159.7l-234-156c-8-4.9-16.5-5-24.6 0l-234 156C3.7 163.7 0 170.8 0 178v156c0 7.1 3.7 14.3 9.7 18.3l234 156c8 4.9 16.5 5 24.6 0l234-156c6-4 9.7-11.1 9.7-18.3V178c0-7.1-3.7-14.3-9.7-18.3zM278 63.1l172.3 114.9-76.9 51.4L278 165.7V63.1zm-44 0v102.6l-95.4 63.7-76.9-51.4L234 63.1zM44 219.1l55.1 36.9L44 292.8v-73.7zm190 229.7L61.7 334l76.9-51.4L234 346.3v102.6zm22-140.9l-77.7-52 77.7-52 77.7 52-77.7 52zm22 140.9V346.3l95.4-63.7 76.9 51.4L278 448.8zm190-156l-55.1-36.9L468 219.1v73.7z"})],-1),e("div",null,"Origin",-1)]))):u("",!0),(a(),c("svg",{class:O(["ms-1 my-auto chevron-icon",{"chevron-down":i.showDetail,"chevron-up":!i.showDetail}]),width:"14",height:"14",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},t[3]||(t[3]=[e("path",{d:"M233.4 105.4c12.5-12.5 32.8-12.5 45.3 0l192 192c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L256 173.3 86.6 342.6c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3l192-192z"},null,-1)]),2))]),e("div",Ce,"By "+n(s.revision.username),1),e("div",ze,[w(A,{name:"appear"},{default:x(()=>[i.showDetail?(a(),c("div",Me,[e("div",De,[e("div",Le,[t[4]||(t[4]=e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",width:"15",height:"15",fill:"#64748b",class:"me-1"},[e("path",{d:"M406.5 399.6C387.4 352.9 341.5 320 288 320l-64 0c-53.5 0-99.4 32.9-118.5 79.6C69.9 362.2 48 311.7 48 256C48 141.1 141.1 48 256 48s208 93.1 208 208c0 55.7-21.9 106.2-57.5 143.6zm-40.1 32.7C334.4 452.4 296.6 464 256 464s-78.4-11.6-110.5-31.7c7.3-36.7 39.7-64.3 78.5-64.3l64 0c38.8 0 71.2 27.6 78.5 64.3zM256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zm0-272a40 40 0 1 1 0-80 40 40 0 1 1 0 80zm-88-40a88 88 0 1 0 176 0 88 88 0 1 0 -176 0z"})],-1)),y(" "+n(s.revision.username)+", ",1)]),e("div",Se,[e("div",Te,[t[5]||(t[5]=e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",width:"12",height:"12",class:"mx-md-1 me-1",fill:"#64748b"},[e("path",{d:"M75 75L41 41C25.9 25.9 0 36.6 0 57.9L0 168c0 13.3 10.7 24 24 24l110.1 0c21.4 0 32.1-25.9 17-41l-30.8-30.8C155 85.5 203 64 256 64c106 0 192 86 192 192s-86 192-192 192c-40.8 0-78.6-12.7-109.7-34.4c-14.5-10.1-34.4-6.6-44.6 7.9s-6.6 34.4 7.9 44.6C151.2 495 201.7 512 256 512c141.4 0 256-114.6 256-256S397.4 0 256 0C185.3 0 121.3 28.7 75 75zm181 53c-13.3 0-24 10.7-24 24l0 104c0 6.4 2.5 12.5 7 17l72 72c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-65-65 0-94.1c0-13.3-10.7-24-24-24z"})],-1)),e("div",null,n(i.dateFromNow),1)]),e("div",Ne," ("+n(s.revision.edited_date)+") ",1)])]),e("div",Be,n(s.revision.isOrigin?"Origin created by platform admin.":s.revision.comment?s.revision.comment:"No Comment"),1),e("div",Oe," Changed: "+n(i.changed.name?i.changed.description?"name,":"name":"")+" "+n(i.changed.description?i.changed.mastery_requirements?"description, ":"description":"")+" "+n(i.changed.mastery_requirements?"mastery requirements":""),1),e("div",Ve,[e("span",qe,"+"+n(i.added)+" insertion,",1),e("span",Ee,"-"+n(i.removed)+" deletion",1)]),e("div",Fe,[s.revision.isCurrentRevision?(a(),c("div",He,t[6]||(t[6]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",heigh:"15",width:"15",fill:"white"},[e("path",{d:"M448 256A192 192 0 1 0 64 256a192 192 0 1 0 384 0zM0 256a256 256 0 1 1 512 0A256 256 0 1 1 0 256zm256 80a80 80 0 1 0 0-160 80 80 0 1 0 0 160zm0-224a144 144 0 1 1 0 288 144 144 0 1 1 0-288zM224 256a32 32 0 1 1 64 0 32 32 0 1 1 -64 0z"})],-1),e("div",null,"Current Version",-1)]))):u("",!0),s.revision.isOrigin?(a(),c("div",Ae,t[7]||(t[7]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",fill:"white",height:"15",width:"15"},[e("path",{d:"M502.3 159.7l-234-156c-8-4.9-16.5-5-24.6 0l-234 156C3.7 163.7 0 170.8 0 178v156c0 7.1 3.7 14.3 9.7 18.3l234 156c8 4.9 16.5 5 24.6 0l234-156c6-4 9.7-11.1 9.7-18.3V178c0-7.1-3.7-14.3-9.7-18.3zM278 63.1l172.3 114.9-76.9 51.4L278 165.7V63.1zm-44 0v102.6l-95.4 63.7-76.9-51.4L234 63.1zM44 219.1l55.1 36.9L44 292.8v-73.7zm190 229.7L61.7 334l76.9-51.4L234 346.3v102.6zm22-140.9l-77.7-52 77.7-52 77.7 52-77.7 52zm22 140.9V346.3l95.4-63.7 76.9 51.4L278 448.8zm190-156l-55.1-36.9L468 219.1v73.7z"})],-1),e("div",null,"Origin",-1)]))):u("",!0),w(l,{class:"ms-2",to:`/skills/${s.skill.url}/revision/${s.revision.version_number}`},{default:x(()=>t[8]||(t[8]=[y("see this edited version",-1)])),_:1,__:[8]},8,["to"])])])):u("",!0)]),_:1})])])])])}const je=V(fe,[["render",Pe],["__scopeId","data-v-0781a82d"]]),Ue={setup(){return{usersStore:I()}},data(){return{skillUrl:this.$route.params.skillUrl,skill:{},skillRevisions:[],currentVersionNumber:null,isLoaded:!1}},components:{HistoryRow:ue,HistoryRowTabletPhone:je},async created(){this.usersStore.usersIncludingDeleted.length<1&&await this.usersStore.getUsersIncludingDeleted(),await this.getSkill()},async mounted(){},methods:{async getSkill(){const d=await fetch("/skills/url/"+this.skillUrl);this.skill=await d.json(),this.currentVersionNumber=this.skill.version_number,await this.getRevisions()},async getRevisions(){const d=await fetch("/skill-history/"+this.skill.id+"/list");this.skillRevisions=await d.json();for(let i=0;i<this.skillRevisions.length;i++){this.skillRevisions[i].timeStamp=this.skillRevisions[i].edited_date;var t=this.skillRevisions[i].edited_date.replace("T"," ");t=t.replace("Z"," ");let r=t.split(/[- :]/);var s=new Date(Date.UTC(r[0],r[1]-1,r[2],r[3],r[4],r[5])),h={weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"};this.skillRevisions[i].edited_date=s.toLocaleDateString("en-US",h);let l=this.usersStore.usersIncludingDeleted.find(m=>m.id===this.skillRevisions[i].user_id);this.skillRevisions[i].username=l.username,this.skillRevisions[i].isCurrentRevision=!1,this.skillRevisions[i].version_number==this.currentVersionNumber&&(this.skillRevisions[i].isCurrentRevision=!0),i+1===this.skillRevisions.length&&i>0?this.skillRevisions[i].isOrigin=!0:this.skillRevisions[i].lastRevision=this.skillRevisions[i+1]}this.isLoaded=!0}}},Ie={class:"container bg-light rounded p-3"},Ye={class:"heading"},Ge={class:"d-none d-lg-flex flex-column"},We={class:"d-flex d-lg-none flex-column"};function Ze(d,t,s,h,i,r){const l=z("HistoryRow"),m=z("HistoryRowTabletPhone");return a(),c("div",Ie,[e("h1",Ye,n(i.skill.name)+": Revision history",1),t[0]||(t[0]=e("hr",null,null,-1)),e("div",Ge,[i.isLoaded?(a(!0),c(E,{key:0},F(i.skillRevisions,o=>(a(),H(l,{revision:o,skill:i.skill},null,8,["revision","skill"]))),256)):u("",!0)]),e("div",We,[i.isLoaded?(a(!0),c(E,{key:0},F(i.skillRevisions,o=>(a(),H(m,{revision:o,skill:i.skill},null,8,["revision","skill"]))),256)):u("",!0)])])}const Xe=V(Ue,[["render",Ze]]);export{Xe as default};
