import{_ as u,e as h,L as m,o as l,c,a as t,t as i,s as r,b as p}from"./main-06b8cce1.js";const d={setup(){const s=h(),e=m();return{userDetailsStore:s,settingsStore:e}},data(){return{monthlyTokenUsage:null,year:0,month:"",isAITokenLimitReached:!1,tokenLimit:0}},async mounted(){let s=document.createElement("script");s.setAttribute("src","https://js.stripe.com/v3/"),document.head.appendChild(s),this.settingsStore.freePlanTokenLimit==0&&await this.settingsStore.getSettings(),await this.userDetailsStore.getUserDetails(),this.userDetailsStore.subscriptionTier=="free"?(this.settingsStore.freePlanTokenLimit<=this.userDetailsStore.monthlyTokenUsage&&(this.isAITokenLimitReached=!0),this.tokenLimit=this.settingsStore.freePlanTokenLimit.toLocaleString()):this.userDetailsStore.subscriptionTier=="capped"&&(this.settingsStore.cappedPlanTokenLimit<=this.userDetailsStore.monthlyTokenUsage&&(this.isAITokenLimitReached=!0),this.tokenLimit=this.settingsStore.cappedPlanTokenLimit.toLocaleString()),this.year=new Date().getFullYear();const e=["January","February","March","April","May","June","July","August","September","October","November","December"],o=new Date;this.month=e[o.getMonth()],this.userDetailsStore.subscriptionTier=="free"||(this.userDetailsStore.subscriptionTier=="capped"?this.tokenLimit=this.settingsStore.cappedPlanTokenLimit:this.userDetailsStore.subscriptionTier=="infinite")},methods:{checkout(s){fetch("/subscriptions/create-checkout-session",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:this.userDetailsStore.userId,planType:s})}).then(e=>e.ok?e.json():e.json().then(o=>Promise.reject(o))).then(({url:e})=>{console.log("add tokens"),window.location=e}).catch(e=>{console.error(e.error)})}}},S={class:"container"},g=t("h1",{class:"heading"},"Subscription",-1),k={class:"secondary-heading h4 mb-4"},f=t("strong",null,"Your subscription tier:",-1),T=t("strong",null,"Plan token limit:",-1),_=t("strong",null,"Current usage:",-1),y={key:0,class:"alert alert-warning",role:"alert"};function L(s,e,o,a,n,b){return l(),c("div",S,[g,t("h2",k," Monthly AI usage: "+i(n.month)+", "+i(n.year),1),t("ul",null,[t("li",null,[t("p",null,[f,r(" "+i(a.userDetailsStore.subscriptionTier.toLocaleString()),1)])]),t("li",null,[t("p",null,[T,r(" "+i(n.tokenLimit),1)])]),t("li",null,[t("p",null,[_,r(" "+i(a.userDetailsStore.monthlyTokenUsage.toLocaleString()),1)])])]),n.isAITokenLimitReached?(l(),c("div",y," You are over the monthly free limit. You can't use the AI features until next month. ")):p("",!0)])}const A=u(d,[["render",L]]);export{A as default};
