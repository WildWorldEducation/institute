import{_ as A,A as b,f as v,o,c as l,F as q,z as M,a as d,b as w,q as H,t as B,J as N,r as _,k as y,p as R,d as T,g as k}from"./main-138df8f6.js";import{u as I}from"./TeacherAnalyticsStore-a6e91721.js";import{u as L}from"./AnalyticsStore-85b92399.js";import{S as U}from"./StudentProgressLineChart-f677c690.js";import{S as E}from"./StudentSkillActivityChart-72cef5b4.js";import{P as V,A as O}from"./AttemptedAssessmentsTimelineChart-b75c5bb8.js";import{F as Q}from"./FailedAssessmentsHorizontalBarChart-dbf0e59c.js";import{S as W}from"./StudentDurationPerDayLineChart-672d28b3.js";import{s as f}from"./transform-35b9fb9e.js";import{l as $,m as x,a as C,b as D}from"./linear-c968f95f.js";import{b as P}from"./band-18e9f0c1.js";import{s as j}from"./sort-855cf5d1.js";import"./line-8aa3dac8.js";import"./time-962c8065.js";import"./point-ea70dc51.js";const J={setup(){const t=b(),s=v();return{usersStore:t,userDetailsStore:s}},data(){return{selectedItemId:null}},created(){this.selectedItemId=this.usersStore.selectedUserId},methods:{selectUser(t){this.selectedItemId=t.id,this.usersStore.selectedUserId!==t.id&&(this.usersStore.selectedUserId=t.id,this.$parent&&this.$parent.updateUserDetails&&this.$parent.updateUserDetails(t))}}},Z={class:"container mt-1"},G={class:"d-flex bg-light rounded p-2"},K=["src"],X=["onClick"];function Y(t,s,i,a,r,h){return o(),l("div",Z,[(o(!0),l(q,null,M(a.usersStore.studentsPerTenant,c=>(o(),l("div",{key:c.id},[d("div",G,[c.avatar!=null?(o(),l("img",{key:0,class:"user-avatars",src:c.avatar},null,8,K)):w("",!0),d("button",{class:H(c.id===r.selectedItemId?"isCurrentlyChoose":"user-buttons"),onClick:n=>h.selectUser(c)},B(c.username),11,X)])]))),128))])}const tt=A(J,[["render",Y],["__scopeId","data-v-68d8cb62"]]),et={name:"StudentAttemptedAssessmentsByRootSubjectHorizontalBarChart",props:["data","colour"],data(){return{padding:60}},mounted(){f("#student-attempted-assessments-by-root-subject-chart-container");const t=25,s=0,i=0,a=10,r=300,h=700,c=Math.ceil((this.data.length+.1)*t)+s+a,n=$().domain([0,x(this.data,e=>e.quantity)]).range([r,h-i]),u=P().domain(j(this.data,e=>-e.quantity).map(e=>e.name)).rangeRound([s,c-a]).padding(.1),S=n.tickFormat(20),m=f("#student-attempted-assessments-by-root-subject-chart-container").append("svg").attr("width",h).attr("height",c).attr("viewBox",[0,0,h,c]).attr("style","max-width: 100%; height: 100%; font: 14px sans-serif;");m.append("g").attr("fill",this.colour).selectAll().data(this.data).join("rect").attr("x",n(0)).attr("y",e=>u(e.name)).attr("width",e=>n(e.quantity)-n(0)).attr("height",u.bandwidth()),m.append("g").attr("fill","white").attr("text-anchor","end").selectAll().data(this.data).join("text").attr("x",e=>n(e.quantity)).attr("y",e=>u(e.name)+u.bandwidth()/2).attr("dy","0.35em").attr("dx",-4).text(e=>S(e.quantity)).call(e=>e.filter(g=>n(g.quantity)-n(0)<20).attr("dx",4).attr("fill","black").attr("text-anchor","start")),m.append("g").attr("transform",`translate(0,${s})`).call(C(n).ticks(0)).call(e=>e.select(".domain").remove()),m.append("g").attr("transform",`translate(${r},0)`).attr("style","font-size: 16px").call(D(u).tickSizeOuter(0))},computed:{}},st={id:"student-attempted-assessments-by-root-subject-chart-container"};function at(t,s,i,a,r,h){return o(),l("div",st)}const nt=A(et,[["render",at]]),it={name:"StudentFailedAssessmentsByRootSubjectHorizontalBarChart",props:["data","colour"],data(){return{}},mounted(){f("#student-failed-assessments-by-root-subject-chart-container");const t=25,s=0,i=0,a=10,r=300,h=700,c=Math.ceil((this.data.length+.1)*t)+s+a,n=$().domain([0,x(this.data,e=>e.quantity)]).range([r,h-i]),u=P().domain(j(this.data,e=>-e.quantity).map(e=>e.name)).rangeRound([s,c-a]).padding(.1),S=n.tickFormat(20),m=f("#student-failed-assessments-by-root-subject-chart-container").append("svg").attr("width",h).attr("height",c).attr("viewBox",[0,0,h,c]).attr("style","max-width: 100%; height: 100%; font: 14px sans-serif;");m.append("g").attr("fill",this.colour).selectAll().data(this.data).join("rect").attr("x",n(0)).attr("y",e=>u(e.name)).attr("width",e=>n(e.quantity)-n(0)).attr("height",u.bandwidth()),m.append("g").attr("fill","white").attr("text-anchor","end").selectAll().data(this.data).join("text").attr("x",e=>n(e.quantity)).attr("y",e=>u(e.name)+u.bandwidth()/2).attr("dy","0.35em").attr("dx",-4).text(e=>S(e.quantity)).call(e=>e.filter(g=>n(g.quantity)-n(0)<20).attr("dx",4).attr("fill","white").attr("text-anchor","start")),m.append("g").attr("transform",`translate(0,${s})`).call(C(n).ticks(0)).call(e=>e.select(".domain").remove()),m.append("g").attr("transform",`translate(${r},0)`).attr("style","font-size: 16px").call(D(u).tickSizeOuter(0))}},rt={id:"student-failed-assessments-by-root-subject-chart-container"};function ot(t,s,i,a,r,h){return o(),l("div",rt)}const dt=A(it,[["render",ot]]),ct={name:"StudentPassedAssessmentsByRootSubjectHorizontalBarChart",props:["data","colour"],data(){return{}},mounted(){f("#student-passed-assessments-by-root-subject-chart-container");const t=25,s=0,i=0,a=10,r=300,h=700,c=Math.ceil((this.data.length+.1)*t)+s+a,n=$().domain([0,x(this.data,e=>e.quantity)]).range([r,h-i]),u=P().domain(j(this.data,e=>-e.quantity).map(e=>e.name)).rangeRound([s,c-a]).padding(.1),S=n.tickFormat(20),m=f("#student-passed-assessments-by-root-subject-chart-container").append("svg").attr("width",h).attr("height",c).attr("viewBox",[0,0,h,c]).attr("style","max-width: 100%; height: 100%; font: 14px sans-serif;");m.append("g").attr("fill",this.colour).selectAll().data(this.data).join("rect").attr("x",n(0)).attr("y",e=>u(e.name)).attr("width",e=>n(e.quantity)-n(0)).attr("height",u.bandwidth()),m.append("g").attr("fill","white").attr("text-anchor","end").selectAll().data(this.data).join("text").attr("x",e=>n(e.quantity)).attr("y",e=>u(e.name)+u.bandwidth()/2).attr("dy","0.35em").attr("dx",-4).text(e=>S(e.quantity)).call(e=>e.filter(g=>n(g.quantity)-n(0)<20).attr("dx",4).attr("fill","black").attr("text-anchor","start")),m.append("g").attr("transform",`translate(0,${s})`).call(C(n).ticks(0)).call(e=>e.select(".domain").remove()),m.append("g").attr("transform",`translate(${r},0)`).attr("style","font-size: 16px").call(D(u).tickSizeOuter(0))},computed:{}},lt={id:"student-passed-assessments-by-root-subject-chart-container"};function ut(t,s,i,a,r,h){return o(),l("div",lt)}const ht=A(ct,[["render",ut]]);const mt={props:["userId"],components:{StudentProgressLineChart:U,StudentSkillActivityChart:E,PassedAssessmentsTimelineChart:V,AttemptedAssessmentsTimelineChart:O,FailedAssessmentsHorizontalBarChart:Q,StudentDurationPerDayLineChart:W,StudentAttemptedAssessmentsByRootSubjectHorizontalBarChart:nt,StudentFailedAssessmentsByRootSubjectHorizontalBarChart:dt,StudentPassedAssessmentsByRootSubjectHorizontalBarChart:ht},setup(){const t=b(),s=v(),i=I(),a=N(),r=L();return t.users.length<1&&t.getUsers(),{usersStore:t,userDetailsStore:s,teacherAnalyticsStore:i,userSkillsStore:a,analyticsStore:r}},data(){return{isMobileCheck:window.innerWidth,studentProgress:[],assessmentPasses:[],assessmentAttempts:[],skillDurations:[],durationsPerDay:[],visitedSkills:[]}},async created(){await this.getStudentDurationPerDay(),await this.getTenantStudentProgress(),await this.getAssessmentPasses(),await this.getAssessmentAttempts(),this.teacherAnalyticsStore.studentMultipleFails.length==0&&await this.teacherAnalyticsStore.getStudentMultipleFails(this.$parent.user.id),this.teacherAnalyticsStore.skillActivities.length==0&&await this.teacherAnalyticsStore.getSkillActivityReport(this.$parent.user.id),this.teacherAnalyticsStore.skillActivities=this.teacherAnalyticsStore.skillActivities.map(t=>({...t,formattedQuantity:this.millisToMinutesAndSeconds(t.quantity)})),await this.analyticsStore.getStudentFailedAssessmentsBySubject(this.$parent.user.id),await this.analyticsStore.getStudentPassedAssessmentsBySubject(this.$parent.user.id),await this.analyticsStore.getStudentAttemptedAssessmentsBySubject(this.$parent.user.id)},computed:{studentName(){return`${this.$parent.user.username}`.trim()}},methods:{async getTenantStudentProgress(){fetch(`/student-analytics/student-progress/${this.$parent.user.id}`).then(t=>t.json()).then(t=>{for(let s=0;s<t.length;s++)t[s].date=new Date(t[s].date);t.sort((s,i)=>s.date-i.date),this.studentProgress=t}).catch(t=>{console.error("Error fetching student progress:",t)})},async getAssessmentAttempts(){fetch(`/student-analytics/started-unmastered-assessments/${this.$parent.user.id}`).then(t=>t.json()).then(t=>{this.assessmentAttempts=t.map(s=>({...s,url:`/skills/${s.url}`,labelName:`${s.name}`}))}).catch(t=>{console.error("Error fetching last visited skills:",t)})},async getAssessmentPasses(){await this.userSkillsStore.getMasteredSkills(this.$parent.user.id),this.assessmentPasses=this.userSkillsStore.masteredSkills.map(t=>({...t,url:`/skills/${t.url}`,labelName:`${t.name}`}))},async getStudentDurationPerDay(){fetch(`/student-analytics/student-duration-per-day/${this.$parent.user.id}`).then(t=>t.json()).then(t=>{for(let s=0;s<t.length;s++)t[s].formattedQuantity=t[s].quantity/(1e3*60),t[s].date=new Date(t[s].date);t.sort((s,i)=>s.date-i.date),this.durationsPerDay=t}).catch(t=>{console.error("Error fetching student duration per day:",t)})},millisToMinutesAndSeconds(t){var s=Math.floor(t/6e4),i=(t%6e4/1e3).toFixed(0);return s+":"+(i<10?"0":"")+i}}},p=t=>(R("data-v-d1555610"),t=t(),T(),t),pt={id:"user-information",class:"container mt-1 bg-light p-2"},_t=p(()=>d("div",{id:"close-popup-btn"},[d("svg",{width:"18",height:"18",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[d("path",{d:"M0.312625 14.5205L4.83312 9.99999L0.312625 5.49218C0.111396 5.29025 -0.00159545 5.0168 -0.00159545 4.73172C-0.00159545 4.44665 0.111396 4.17319 0.312625 3.97126L3.96282 0.312625C4.16474 0.111396 4.4382 -0.00159545 4.72327 -0.00159545C5.00835 -0.00159545 5.2818 0.111396 5.48373 0.312625L9.99999 4.83312L14.5205 0.312625C14.6204 0.21056 14.7397 0.12947 14.8714 0.0741101C15.003 0.0187502 15.1444 -0.00976563 15.2873 -0.00976562C15.4301 -0.00976563 15.5715 0.0187502 15.7032 0.0741101C15.8349 0.12947 15.9541 0.21056 16.0541 0.312625L19.6874 3.96282C19.8886 4.16474 20.0016 4.4382 20.0016 4.72327C20.0016 5.00835 19.8886 5.2818 19.6874 5.48373L15.1669 9.99999L19.6874 14.5205C19.8883 14.7217 20.0012 14.9944 20.0012 15.2788C20.0012 15.5632 19.8883 15.836 19.6874 16.0372L16.0541 19.6874C15.8529 19.8883 15.5801 20.0012 15.2957 20.0012C15.0113 20.0012 14.7386 19.8883 14.5374 19.6874L9.99999 15.1669L5.49218 19.6874C5.29025 19.8886 5.0168 20.0016 4.73172 20.0016C4.44665 20.0016 4.17319 19.8886 3.97126 19.6874L0.312625 16.0541C0.21056 15.9541 0.12947 15.8349 0.0741101 15.7032C0.0187502 15.5715 -0.00976563 15.4301 -0.00976562 15.2873C-0.00976563 15.1444 0.0187502 15.003 0.0741101 14.8714C0.12947 14.7397 0.21056 14.6204 0.312625 14.5205Z",fill:"white"})])],-1)),yt=[_t],St={class:"row"},gt={class:"col-12 col-md-7"},ft={key:0,class:"secondary-heading h3"},At={class:"row"},kt={class:"d-flex flex-column"},bt=p(()=>d("h1",{class:"heading"},"Student Reports",-1)),vt=p(()=>d("h2",{class:"secondary-heading"},"Engagement",-1)),wt=p(()=>d("h4",null,"Total time on platform",-1)),$t={key:1},xt=p(()=>d("h4",{class:"mt-4"},"Skills visited",-1)),Ct={key:3},Dt=p(()=>d("h2",{class:"secondary-heading mt-5"},"Academics",-1)),Pt=p(()=>d("h4",null,"Skill mastery progress",-1)),jt={key:5},Bt=p(()=>d("h3",{class:"secondary-heading mt-4"},"By subject",-1)),Rt=p(()=>d("h4",{class:""},"Failed more than once",-1)),Tt={key:7},It=p(()=>d("h4",{class:""},"Passed",-1)),Lt={key:9},Ft=p(()=>d("h4",{class:""},"Attempted",-1)),zt={key:11},qt=p(()=>d("h3",{class:"secondary-heading mt-4"},"By skill",-1)),Mt=p(()=>d("h4",null,"Assessments failed",-1)),Ht={key:13},Nt=p(()=>d("h4",{class:"mt-4"},"Assessments passed",-1)),Ut={key:15},Et=p(()=>d("h4",{class:"mt-4"},"Assessments attempted",-1)),Vt={key:17,class:"mb-5"};function Ot(t,s,i,a,r,h){const c=_("StudentDurationPerDayLineChart"),n=_("StudentSkillActivityChart"),u=_("StudentProgressLineChart"),S=_("StudentFailedAssessmentsByRootSubjectHorizontalBarChart"),m=_("StudentPassedAssessmentsByRootSubjectHorizontalBarChart"),e=_("StudentAttemptedAssessmentsByRootSubjectHorizontalBarChart"),g=_("FailedAssessmentsHorizontalBarChart"),F=_("PassedAssessmentsTimelineChart"),z=_("AttemptedAssessmentsTimelineChart");return o(),l("div",pt,[d("div",{class:"flex-row-reverse d-flex d-md-none align-items-end mb-2",onClick:s[0]||(s[0]=re=>this.$parent.showDetails=!1)},yt),d("div",St,[d("div",gt,[r.isMobileCheck<576?(o(),l("h1",ft,B(this.$parent.user.username),1)):w("",!0)])]),d("div",At,[d("div",kt,[bt,vt,wt,r.durationsPerDay.length>1?(o(),y(c,{key:0,data:r.durationsPerDay},null,8,["data"])):(o(),l("p",$t,"There is no data to show yet.")),xt,a.teacherAnalyticsStore.skillActivities.length>0?(o(),y(n,{key:2,data:a.teacherAnalyticsStore.skillActivities},null,8,["data"])):(o(),l("p",Ct,"No skills visited by this student.")),Dt,Pt,r.studentProgress.length>0?(o(),y(u,{key:4,data:r.studentProgress,colour:"#5f31dd"},null,8,["data"])):(o(),l("p",jt,"No data to show yet.")),Bt,Rt,a.analyticsStore.studentRootSubjectsFailedAssessments.length>0?(o(),y(S,{key:6,data:a.analyticsStore.studentRootSubjectsFailedAssessments,colour:"darkred",class:"mb-5"},null,8,["data"])):(o(),l("p",Tt,"No data yet")),It,a.analyticsStore.studentRootSubjectsPassedAssessments.length>0?(o(),y(m,{key:8,data:a.analyticsStore.studentRootSubjectsPassedAssessments,colour:"darkgreen",class:"mb-5"},null,8,["data"])):(o(),l("p",Lt,"No data yet")),Ft,a.analyticsStore.studentRootSubjectsAttemptedAssessments.length>0?(o(),y(e,{key:10,data:a.analyticsStore.studentRootSubjectsAttemptedAssessments,colour:"darkblue",class:"mb-5"},null,8,["data"])):(o(),l("p",zt,"No data yet")),qt,Mt,a.teacherAnalyticsStore.studentMultipleFails.length>0?(o(),y(g,{key:12,data:a.teacherAnalyticsStore.studentMultipleFails,colour:"darkred"},null,8,["data"])):(o(),l("p",Ht," This student has not failed any assessments more than once yet. ")),Nt,r.assessmentPasses.length>0?(o(),y(F,{key:14,data:r.assessmentPasses},null,8,["data"])):(o(),l("p",Ut," This student has not completed any assessments yet. ")),Et,r.assessmentAttempts.length>0?(o(),y(z,{key:16,class:"mb-5",data:r.assessmentAttempts},null,8,["data"])):(o(),l("p",Vt," This student has attempted any assessments yet. "))])])])}const Qt=A(mt,[["render",Ot],["__scopeId","data-v-d1555610"]]);const Wt={setup(){const t=b(),s=v(),i=I(),a=L();return{usersStore:t,userDetailsStore:s,teacherAnalyticsStore:i,analyticsStore:a}},data(){return{user:{id:null,firstName:null,lastName:null,username:null,avatar:null},showDetails:!1,tenantStudents:[],showUserInfo:!0,isLoading:!0,currentUserId:"",isInitializing:!0}},components:{TenantStudentList:tt,TenantStudentDetails:Qt},async created(){await this.usersStore.getStudentsPerTenant(this.userDetailsStore.tenantId),this.isLoading=!1,this.initializeSelectedUser(),this.$nextTick(()=>{this.isInitializing=!1})},methods:{initializeSelectedUser(){const t=this.usersStore.selectedUserId;let s=!1;if(t){const i=this.usersStore.studentsPerTenant.find(a=>a.id===t);i&&(s=!0,this.updateUserDetails(i,!0))}s||(this.updateUserDetails(this.usersStore.studentsPerTenant[0],!0),this.$refs.usersListRef&&(this.$refs.usersListRef.selectedItemId=this.usersStore.studentsPerTenant[0].id))},async updateUserDetails(t,s=!1){if(!t)return;this.user.id=t.id,this.user.firstName=t.first_name,this.user.lastName=t.last_name,this.user.username=t.username,this.user.email=t.email,this.user.avatar=t.avatar,this.user.role=t.role,t.isSkillsLocked!==void 0&&(this.user.isSkillsLocked=t.isSkillsLocked),s?this.usersStore.selectedUserId=t.id:this.usersStore.setSelectedUser(t.id),window.innerWidth<769&&(this.showDetails=!0);let i=this.userDetailsStore.tenantId;this.usersStore.studentsPerTenant.length<1&&await this.usersStore.getStudentsPerTenant(i),this.$refs.tenantStudentDetailsRef&&(this.$refs.tenantStudentDetailsRef.studentProgress=[],this.$refs.tenantStudentDetailsRef.getTenantStudentProgress(),this.$refs.tenantStudentDetailsRef.assessmentPasses=[],this.$refs.tenantStudentDetailsRef.getAssessmentPasses(),this.$refs.tenantStudentDetailsRef.assessmentAttempts=[],this.$refs.tenantStudentDetailsRef.getAssessmentAttempts(),this.teacherAnalyticsStore.studentMultipleFails=[],await this.teacherAnalyticsStore.getStudentMultipleFails(this.user.id),this.$refs.tenantStudentDetailsRef.durationsPerDay=[],this.$refs.tenantStudentDetailsRef.getStudentDurationPerDay(),this.teacherAnalyticsStore.skillActivities=[],await this.teacherAnalyticsStore.getSkillActivityReport(this.user.id),this.teacherAnalyticsStore.skillActivities=this.teacherAnalyticsStore.skillActivities.map(a=>({...a,formattedQuantity:this.millisToMinutesAndSeconds(a.quantity)})),this.analyticsStore.studentRootSubjectsFailedAssessments=[],this.analyticsStore.getStudentFailedAssessmentsBySubject(this.user.id),this.analyticsStore.studentRootSubjectsPassedAssessments=[],this.analyticsStore.getStudentPassedAssessmentsBySubject(this.user.id),this.analyticsStore.studentRootSubjectsAttemptedAssessments=[],this.analyticsStore.getStudentAttemptedAssessmentsBySubject(this.user.id))},updateShowUserDetails(t){this.usersStore.selectedUserId=t.id},millisToMinutesAndSeconds(t){var s=Math.floor(t/6e4),i=(t%6e4/1e3).toFixed(0);return s+":"+(i<10?"0":"")+i}}},Jt=t=>(R("data-v-83cca371"),t=t(),T(),t),Zt={key:0,class:"loading-animation d-flex justify-content-center align-items-center py-4"},Gt=Jt(()=>d("span",{class:"loader"},null,-1)),Kt=[Gt],Xt={key:1,id:"user-container",class:"container-fluid"},Yt={class:"row position-relative"},te={class:"col-lg-4 col-md-5"},ee={class:"col-lg-8 col-md-7 d-none d-md-block"},se={class:"row user-form-data-row"},ae={key:0,class:"col-md-7 d-block d-md-none",id:"user-detail-section"},ne={class:"row"};function ie(t,s,i,a,r,h){const c=_("TenantStudentList"),n=_("TenantStudentDetails");return r.isLoading==!0?(o(),l("div",Zt,Kt)):(o(),l("div",Xt,[d("div",Yt,[d("div",te,[k(c,{ref:"usersListRef"},null,512)]),d("div",ee,[d("div",se,[k(n,{ref:"tenantStudentDetailsRef",userId:r.user.id},null,8,["userId"])])]),r.showDetails?(o(),l("div",ae,[d("div",ne,[k(n,{userId:r.user.id},null,8,["userId"])])])):w("",!0)])]))}const be=A(Wt,[["render",ie],["__scopeId","data-v-83cca371"]]);export{be as default};
