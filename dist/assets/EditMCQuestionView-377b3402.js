import{_ as v,e as b,o as n,c as r,a as s,w as u,A as h,b as l,F as q,x as _,v as k,t as y,Q as g,p as f,N as S,r as p,f as x,j as V}from"./main-53559ef3.js";import{S as D}from"./SkillTimeTracker-ef578da8.js";const C={setup(){return{userDetailsStore:b()}},data(){return{questionId:this.$route.params.questionId,question:{},answers:[],validate:{validated:!1,name:!1,question:!1,answer:!1,explanation:!1},originalQuestion:{},originalAnswers:[],comment:"",isLoaded:!1}},async created(){await this.getQuestion(),this.isLoaded=!0},methods:{async getQuestion(){await fetch("/questions/mc/show/"+this.questionId).then(function(o){return o.json()}).then(o=>{this.question=o.question,this.answers=o.answers,this.answers[0].show=1,this.answers[1].show=1,this.originalQuestion={...o.question},this.originalAnswers=JSON.parse(JSON.stringify(o.answers))})},Submit(){const o={method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:this.question,answers:this.answers})};var e="/questions/mc/"+this.questionId+"/edit";fetch(e,o).then(()=>{let m=this.$route.query.dismissFlagId;m?fetch("/content-flags/"+m,{method:"DELETE"}).finally(()=>{alert("Question edited successfully."),this.$router.back()}):(alert("Question edited successfully."),this.$router.back())})},SubmitForReview(){const o={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:this.userDetailsStore.userId,question:this.question,answers:this.answers,comment:this.comment})};var e="/questions/mc/"+this.questionId+"/edit-for-review";fetch(e,o).then(()=>{alert(`This edit is being submitted for review.
We do this to prevent misinformation and sloppy wording from being added. If you would like to become an editor and help with this, please reach out.`),this.$router.back()})},ValidateForm(o){this.validate.validated=!1,(this.question.name===""||this.question.name===null)&&(this.validate.name=!0,this.validate.validated=!0),(this.question.text===""||this.question.text===null)&&(this.validate.question=!0,this.validate.validated=!0),this.answers.forEach(e=>{e.text==""&&(this.validate.validated=!0)}),(this.question.explanation===""||this.question.explanation===null)&&(this.validate.explanation=!0,this.validate.validated=!0),!this.validate.validated&&(o=="submission"?this.Submit():o=="submissionForReview"&&this.SubmitForReview())},setFormUpdated(){this.formUpdated=!0},cancel(){this.$router.back()},addAnswer(){(this.userDetailsStore.role=="platform_admin"||this.userDetailsStore.role=="editor")&&(this.answers[2].show==0?this.answers[2].show=1:this.answers[3].show==0?this.answers[3].show=1:this.answers[4].show==0&&(this.answers[4].show=1))},removeAnswer(){(this.userDetailsStore.role=="platform_admin"||this.userDetailsStore.role=="editor")&&(this.answers[4].show==1?(this.answers[4].show=0,this.question.correct_answer==5&&(this.question.correct_answer=4)):this.answers[3].show==1?(this.answers[3].show=0,this.question.correct_answer==4&&(this.question.correct_answer=3)):this.answers[2].show==1&&(this.answers[2].show=0,this.question.correct_answer==3&&(this.question.correct_answer=2)))}},computed:{isFormChanged(){return JSON.stringify(this.originalQuestion)!=JSON.stringify(this.question)||JSON.stringify(this.originalAnswers)!=JSON.stringify(this.answers)}}},I={class:"container p-3 bg-light rounded"},T={class:"container-fluid mt-2"},Q={class:"row p-0"},F={id:"form-container",class:"col p-4"},L={class:"mb-3"},M={key:0,class:"form-validate"},N={class:"mb-3"},A={key:0,class:"form-validate"},O={class:"form-label"},E={class:"d-flex answer-option"},z=["onUpdate:modelValue","id"],U={key:0,class:"form-validate"},H={class:"form-check"},J=["id","value"],B=["for"],R={key:0,class:"mb-3"},j={class:"mb-3 form-check"},P={class:"mb-3"},W={key:0,class:"form-validate"},G={key:1,class:"mb-3"},K={class:"d-flex justify-content-end gap-4"},X=["disabled"],Y=["disabled"];function Z(o,e,m,c,t,a){return n(),r("div",I,[e[19]||(e[19]=s("h1",{class:"heading"},"Edit Question",-1)),e[20]||(e[20]=s("p",{class:"mt-2"},[s("em",{class:"secondary-text"},"Note: blank answer options will not display in the quiz.")],-1)),s("div",T,[s("div",Q,[s("div",F,[s("div",L,[e[11]||(e[11]=s("label",{for:"question_name",class:"form-label"},"Question Name",-1)),u(s("input",{"onUpdate:modelValue":e[0]||(e[0]=i=>t.question.name=i),type:"text",class:"form-control",id:"question_name"},null,512),[[h,t.question.name]]),t.validate.name&&(t.question.name===""||t.question.name===null)?(n(),r("div",M," please enter a question name ! ")):l("",!0)]),s("div",N,[e[12]||(e[12]=s("label",{for:"last_name",class:"form-label"},"Question",-1)),u(s("textarea",{"onUpdate:modelValue":e[1]||(e[1]=i=>t.question.text=i),rows:"2",class:"form-control"},"                        ",512),[[h,t.question.text]]),t.validate.question&&(t.question.text===""||t.question.text===null)?(n(),r("div",A," please enter a question ! ")):l("",!0)]),(n(!0),r(q,null,_(t.answers,(i,d)=>u((n(),r("div",{key:d,class:"mb-3"},[s("label",O,"Answer "+y(d+1)+":",1),s("div",E,[u(s("input",{"onUpdate:modelValue":w=>i.text=w,id:"answer"+(d+1),placeholder:"Enter answer option",type:"text",class:"form-control"},null,8,z),[[h,i.text]])]),t.validate.validated&&i.text===""?(n(),r("div",U," please enter a correct answer ! ")):l("",!0),s("div",H,[u(s("input",{class:"form-check-input",type:"radio",id:"correct"+(d+1),name:"correctAnswer",value:d+1,"onUpdate:modelValue":e[2]||(e[2]=w=>t.question.correct_answer=w)},null,8,J),[[g,t.question.correct_answer]]),s("label",{for:"correct"+(d+1),class:""},"Set as correct",8,B)])])),[[k,i.show]])),128)),t.isLoaded&&(this.userDetailsStore.role=="platform_admin"||this.userDetailsStore.role=="editor")?(n(),r("div",R,[t.answers[2].show==!0?(n(),r("button",{key:0,onClick:e[3]||(e[3]=i=>a.removeAnswer()),"data-v-ea3cd1bf":"",type:"button",class:"btn red-btn p-2 mb-2",title:"Delete answer"},e[13]||(e[13]=[s("svg",{"data-v-ea3cd1bf":"",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",width:"15",height:"15",fill:"white"},[s("path",{"data-v-ea3cd1bf":"",d:"M170.5 51.6L151.5 80h145l-19-28.4c-1.5-2.2-4-3.6-6.7-3.6H177.1c-2.7 0-5.2 1.3-6.7 3.6zm147-26.6L354.2 80H368h48 8c13.3 0 24 10.7 24 24s-10.7 24-24 24h-8V432c0 44.2-35.8 80-80 80H112c-44.2 0-80-35.8-80-80V128H24c-13.3 0-24-10.7-24-24S10.7 80 24 80h8H80 93.8l36.7-55.1C140.9 9.4 158.4 0 177.1 0h93.7c18.7 0 36.2 9.4 46.6 24.9zM80 128V432c0 17.7 14.3 32 32 32H336c17.7 0 32-14.3 32-32V128H80zm80 64V400c0 8.8-7.2 16-16 16s-16-7.2-16-16V192c0-8.8 7.2-16 16-16s16 7.2 16 16zm80 0V400c0 8.8-7.2 16-16 16s-16-7.2-16-16V192c0-8.8 7.2-16 16-16s16 7.2 16 16zm80 0V400c0 8.8-7.2 16-16 16s-16-7.2-16-16V192c0-8.8 7.2-16 16-16s16 7.2 16 16z"})],-1),f(" Â Remove Answer ",-1)]))):l("",!0),t.answers[4].show==!1?(n(),r("button",{key:1,onClick:e[4]||(e[4]=(...i)=>a.addAnswer&&a.addAnswer(...i)),class:"btn primary-btn"},e[14]||(e[14]=[s("svg",{width:"20",height:"20",fill:"#ffffff",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512"},[s("path",{d:"M256 80c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 144L48 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l144 0 0 144c0 17.7 14.3 32 32 32s32-14.3 32-32l0-144 144 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-144 0 0-144z"})],-1),f(" Add Answer ",-1)]))):l("",!0)])):l("",!0),s("div",j,[u(s("input",{type:"checkbox",id:"randomOrder","onUpdate:modelValue":e[5]||(e[5]=i=>t.question.is_random=i),class:"form-check-input"},null,512),[[S,t.question.is_random]]),e[15]||(e[15]=s("label",{for:"randomOrder",class:"form-check-label"},"Show answers in random order",-1))]),s("div",P,[e[16]||(e[16]=s("label",{class:"form-label"},"Explanation",-1)),u(s("textarea",{"onUpdate:modelValue":e[6]||(e[6]=i=>t.question.explanation=i),class:"form-control",rows:"3"},null,512),[[h,t.question.explanation]]),t.validate.explanation&&(t.question.explanation===""||t.question.explanation===null)?(n(),r("div",W," please enter an explanation ! ")):l("",!0)]),c.userDetailsStore.role=="instructor"||c.userDetailsStore.role=="student"?(n(),r("div",G,[e[17]||(e[17]=s("label",{class:"form-label"},"Optional: explain this edit",-1)),u(s("textarea",{"onUpdate:modelValue":e[7]||(e[7]=i=>t.comment=i),class:"form-control",rows:"3"},null,512),[[h,t.comment]])])):l("",!0),s("div",K,[s("button",{class:"btn red-btn",onClick:e[8]||(e[8]=i=>a.cancel())}," Cancel "),c.userDetailsStore.role=="platform_admin"||c.userDetailsStore.role=="editor"?(n(),r("button",{key:0,class:"btn primary-btn",onClick:e[9]||(e[9]=i=>a.ValidateForm("submission")),disabled:!a.isFormChanged}," Submit ",8,X)):c.userDetailsStore.role=="instructor"||c.userDetailsStore.role=="student"?(n(),r("button",{key:1,class:"btn primary-btn",onClick:e[10]||(e[10]=i=>a.ValidateForm("submissionForReview")),disabled:!a.isFormChanged},e[18]||(e[18]=[s("div",{class:"d-none d-md-block"}," Submit for review ",-1),s("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",fill:"white",height:"20",width:"20",class:"d-md-none"},[s("path",{d:"M441 58.9L453.1 71c9.4 9.4 9.4 24.6 0 33.9L424 134.1 377.9 88 407 58.9c9.4-9.4 24.6-9.4 33.9 0zM209.8 256.2L344 121.9 390.1 168 255.8 302.2c-2.9 2.9-6.5 5-10.4 6.1l-58.5 16.7 16.7-58.5c1.1-3.9 3.2-7.5 6.1-10.4zM373.1 25L175.8 222.2c-8.7 8.7-15 19.4-18.3 31.1l-28.6 100c-2.4 8.4-.1 17.4 6.1 23.6s15.2 8.5 23.6 6.1l100-28.6c11.8-3.4 22.5-9.7 31.1-18.3L487 138.9c28.1-28.1 28.1-73.7 0-101.8L474.9 25C446.8-3.1 401.2-3.1 373.1 25zM88 64C39.4 64 0 103.4 0 152V424c0 48.6 39.4 88 88 88H360c48.6 0 88-39.4 88-88V312c0-13.3-10.7-24-24-24s-24 10.7-24 24V424c0 22.1-17.9 40-40 40H88c-22.1 0-40-17.9-40-40V152c0-22.1 17.9-40 40-40H200c13.3 0 24-10.7 24-24s-10.7-24-24-24H88z"})],-1)]),8,Y)):l("",!0)])])])])])}const $=v(C,[["render",Z],["__scopeId","data-v-104e390c"]]),ee={setup(){return{userDetailsStore:b()}},data(){return{questionId:this.$route.params.questionId,skillId:null}},components:{EditMCQuestion:$,SkillTimeTracker:D},async created(){const e=await(await fetch("/questions/mc/"+this.questionId+"/get-skill-id/")).json();this.skillId=e.skillId},beforeRouteLeave(o,e,m){this.$refs.skillTimeTracker.saveDuration(),m()}};function se(o,e,m,c,t,a){const i=p("EditMCQuestion"),d=p("SkillTimeTracker");return n(),r(q,null,[x(i),t.skillId?(n(),V(d,{key:0,ref:"skillTimeTracker"},null,512)):l("",!0)],64)}const oe=v(ee,[["render",se]]);export{oe as default};
