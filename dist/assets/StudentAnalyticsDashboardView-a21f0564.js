import{u as P}from"./AnalyticsStore-ab45414f.js";import{u as B}from"./TeacherAnalyticsStore-c789e4d2.js";import{_ as T,o as l,c as m,f as M,r as D,a as s,g as S,l as y,s as f,b as j,k as w,F as q,z as H,t as v,p as L,d as R}from"./main-3705768a.js";import{c as N,S as V}from"./StudentProgressChart-4f0b302d.js";import"./transform-af9a74a2.js";import{u as F,l as z}from"./line-85f04100.js";import{e as U}from"./extent-4cf1c809.js";import{l as A,a as E,b as I,c as O}from"./linear-5b188edc.js";import{m as $,o as Y,b as Q}from"./continuous-7328829e.js";import{s as b}from"./string-dd82ab4a.js";import{s as W}from"./sort-ed61f96d.js";import"./colors-98f238a0.js";import"./time-0457d93b.js";import"./point-ea70dc51.js";const G={name:"SchoolTimeChart",props:[],data(){return{axisData:[]}},mounted(){},methods:{createChart(t){if(t.student.length==0)this.axisData=t.tenant;else if(t.tenant.length==0)this.axisData=t.student;else{const a=t.student.reduce((x,C)=>Math.max(x,C.quantity),-1/0),k=t.tenant.reduce((x,C)=>Math.max(x,C.quantity),-1/0);a>=k?this.axisData=t.student:this.axisData=t.tenant}const p=Object.entries(t).map(([a,k])=>({name:a,values:k})),o=document.getElementById("time-chart-container").clientWidth,n=document.getElementById("time-chart-container").clientHeight,r=5,_=0,c=25,g=25,i=F(U(this.axisData,a=>a.date),[g,o-_]),d=A([0,$(this.axisData,a=>a.formattedQuantity)],[n-c,r]);Y().domain(p.map(a=>a.name)).range(N);const u=z().x(a=>i(a.date)).y(a=>d(a.formattedQuantity)),e=b("#time-chart-container").append("svg").attr("width","100%").attr("height","100%").attr("viewBox",[0,0,+Math.min(o,n),+Math.min(o,n)]).attr("preserveAspectRatio","xMinYMin");e.append("g").attr("transform",`translate(0,${n-c})`).call(E(i).ticks(7).tickSizeOuter(0)),e.append("g").attr("transform",`translate(${g},0)`).call(I(d).ticks(n/40)).call(a=>a.select(".domain").remove()).call(a=>a.selectAll(".tick line").clone().attr("x2",o-g-_).attr("stroke-opacity",.2)).call(a=>a.append("text").attr("x",-g).attr("y",10).attr("fill","currentColor").attr("text-anchor","start")),e.selectAll(".line").data(p).join("path").attr("fill","none").attr("stroke",a=>a.name=="student"?"RoyalBlue":"#ff7f0e").attr("stroke-width",a=>a.name=="student"?3:2).attr("d",a=>u(a.values))}}};function J(t,p,o,n,r,_){return null}const K=T(G,[["render",J]]),X={name:"StudentComparisonChart",props:["data","colour"],data(){return{}},mounted(){},methods:{createChart(t){b("#student-comparison-container");const p=25,o=0,n=20,r=10,_=200,c=700,g=Math.ceil((t.length+.1)*p)+o+r,i=A().domain([0,$(t,e=>e.quantity)]).range([_,c-n]),d=Q().domain(W(t,e=>-e.quantity).map(e=>e.name)).rangeRound([o,g-r]).padding(.1);i.tickFormat(20);const u=b("#student-comparison-container").append("svg").attr("width","100%").attr("height","100%").attr("viewBox",[0,0,c,g]).attr("style","max-width: 100%; height: 100%; font: 14px sans-serif;");u.append("g").selectAll().data(t).join("rect").attr("x",i(0)).attr("y",e=>d(e.name)).attr("width",e=>i(e.quantity)-i(0)).attr("height",d.bandwidth()).attr("fill",function(e){return e.name=="Language"?"DarkMagenta":e.name=="Mathematics"?"blue":e.name=="Science & Invention"?"purple":e.name=="Computer Science"?"deeppink":e.name=="Dangerous Ideas"?"brown":e.name=="History"?"cyan":e.name=="Life"?"magenta":"#ff7f0e"}),u.append("g").attr("fill","white").attr("text-anchor","end").selectAll().data(t).join("text").attr("x",e=>i(e.quantity)).attr("y",e=>d(e.name)+d.bandwidth()/2).attr("dy","0.35em").attr("dx",-4).text(e=>e.quantity).call(e=>e.filter(a=>i(a.quantity)-i(0)<20).attr("dx",4).attr("fill","black").attr("text-anchor","start")),u.append("g").attr("transform",`translate(0,${o})`).call(O(i).ticks(0)).call(e=>e.select(".domain").remove()),u.append("g").attr("transform",`translate(${_},0)`).attr("style","font-size: 16px").call(I(d).tickSizeOuter(0))}}},Z={id:"student-comparison-container"};function tt(t,p,o,n,r,_){return l(),m("div",Z)}const et=T(X,[["render",tt]]);const st={name:"Student-Dashboard",setup(){const t=M(),p=P(),o=B();return{userDetailsStore:t,analyticsStore:p,teacherAnalyticsStore:o}},data(){return{showSidebar:!0,screenWidth:screen.width,isStudentData:!0,isSchoolData:!0,isLanguageData:!1,isMathData:!1,isHistoryData:!1,isLifeData:!1,isCSData:!1,isSAndIData:!1,isDIData:!1,progressData:{student:[],average:[]},isAboveTheCurve:!1,totalSkillsPassed:null,totalTimeSpent:null,totalAIUsage:null}},components:{StudentProgressChart:V,StudentComparisonChart:et,StudentTimeChart:K},async created(){console.log(this.userDetailsStore.userId),await this.analyticsStore.getStudentProgress(this.userDetailsStore.userId,this.userDetailsStore.tenantId),await this.analyticsStore.getStudentTotalTimeSpent(this.userDetailsStore.userId),this.totalTimeSpent=this.analyticsStore.studentTotalTimeSpent+" hrs",await this.analyticsStore.getStudentTotalSubjectsPassedAssessments(this.userDetailsStore.userId),this.totalSkillsPassed=this.analyticsStore.studentTotalSubjectsPassedAssessments,await this.analyticsStore.getStudentPassedAssessmentsBySubject(this.userDetailsStore.userId),await this.analyticsStore.getStudentTime(this.userDetailsStore.userId,this.userDetailsStore.tenantId),await this.analyticsStore.getStudentTotalTokensSpent(this.userDetailsStore.userId),this.totalAIUsage=this.analyticsStore.studentTotalTokensSpent+" tokens",await this.teacherAnalyticsStore.getStudentMultipleFails(this.userDetailsStore.userId),(this.analyticsStore.progress.student.length>0||this.analyticsStore.progress.tenant.length>0)&&this.analyticsStore.progress.student[this.analyticsStore.progress.student.length-1].quantity>this.analyticsStore.progress.tenant[this.analyticsStore.progress.tenant.length-1].quantity&&(this.isAboveTheCurve=!0),await this.HandleProgressData(),await this.HandleComparisonData(),await this.HandleTimeData()},methods:{async HandleProgressData(){if(this.isStudentData){this.progressData.student=[];for(let t=0;t<this.analyticsStore.progress.student.length;t++)this.progressData.student.push(this.analyticsStore.progress.student[t])}else this.progressData.student=[];if(this.isSchoolData){this.progressData.average=[];for(let t=0;t<this.analyticsStore.progress.tenant.length;t++)this.progressData.average.push(this.analyticsStore.progress.tenant[t])}else this.progressData.average=[];this.$nextTick(()=>{this.$refs.progressChart&&this.$refs.progressChart.createChart(this.progressData)})},async HandleComparisonData(){this.$nextTick(()=>{this.$refs.comparisonChart&&this.$refs.comparisonChart.createChart(this.analyticsStore.studentRootSubjectsPassedAssessments)})},async HandleTimeData(){this.$nextTick(()=>{this.$refs.timeChart&&this.$refs.timeChart.createChart(this.analyticsStore.time)})},toggleSidebar(){this.showSidebar=!this.showSidebar}}},h=t=>(L("data-v-d3067a06"),t=t(),R(),t),at={class:"dashboard"},nt={class:"main"},rt={class:"content container-fluid"},ot={class:"dash-row row"},it={class:"col-md-6 h-100 position-relative"},lt=h(()=>s("h2",{class:"heading h5"},"Progress over time",-1)),ct={key:0,class:""},ht=h(()=>s("span",{style:{color:"green"}},"You",-1)),dt=h(()=>s("span",{style:{color:"#ff7f0e"}},"school average",-1)),ut={id:"progress-chart-container"},mt={key:1},pt={class:"col-md-6"},gt={id:"comparison-chart-container"},_t=h(()=>s("h2",{class:"heading h5 mt-1"},"Progress comparison",-1)),ft={key:1},St={class:"dash-row row"},yt={class:"col-md h-100 position-relative"},Dt=h(()=>s("h2",{class:"heading h5"},"Study time",-1)),vt=h(()=>s("figcaption",null,[s("span",{style:{color:"blue"}},"You"),f(" vs "),s("span",{style:{color:"#ff7f0e"}},"school average")],-1)),kt={id:"time-chart-container"},xt={key:1},Ct={class:"col-md position-relative"},wt={class:"row"},bt={class:"col-md"},Tt=h(()=>s("h2",{class:"h5 heading"}," Consider asking for help ",-1)),At={key:0},It={key:1},$t={class:"col-md"},Pt=h(()=>s("h2",{class:"h5 heading"},"Stats",-1)),Bt=h(()=>s("strong",null,"Skills passed:",-1)),Mt=h(()=>s("strong",null,"Total time spent:",-1)),jt=h(()=>s("strong",null,"AI usage:",-1));function qt(t,p,o,n,r,_){const c=D("RouterLink"),g=D("StudentProgressChart"),i=D("StudentComparisonChart"),d=D("StudentTimeChart");return l(),m("div",at,[s("div",nt,[s("div",rt,[s("div",ot,[s("div",it,[S(c,{to:"/my-progress/skills",class:"",target:"_blank"},{default:y(()=>[lt]),_:1}),r.progressData.student.length>0||r.progressData.average.length>0?(l(),m("figcaption",ct,[ht,f(" vs "),dt])):j("",!0),s("div",ut,[r.progressData.student.length>0||r.progressData.average.length>0?(l(),w(g,{key:0,ref:"progressChart"},null,512)):(l(),m("p",mt,"No progress yet"))])]),s("div",pt,[s("div",gt,[_t,n.analyticsStore.studentRootSubjectsPassedAssessments.length>0?(l(),w(i,{key:0,ref:"comparisonChart",data:n.analyticsStore.studentRootSubjectsPassedAssessments,colour:"#5f31dd"},null,8,["data"])):(l(),m("p",ft,"No progress yet"))])])]),s("div",St,[s("div",yt,[S(c,{to:"/my-progress/time",target:"_blank"},{default:y(()=>[Dt]),_:1}),vt,s("div",kt,[n.analyticsStore.time.student.length>0||n.analyticsStore.time.tenant.length>0?(l(),w(d,{key:0,ref:"timeChart"},null,512)):(l(),m("p",xt,"No data available"))])]),s("div",Ct,[s("div",wt,[s("div",bt,[S(c,{to:"/my-progress/super-challenging",class:"col",target:"_blank"},{default:y(()=>[Tt]),_:1}),n.teacherAnalyticsStore.studentMultipleFails.length>0?(l(),m("ul",At,[(l(!0),m(q,null,H(n.teacherAnalyticsStore.studentMultipleFails,u=>(l(),m("li",{class:"failed-skills",key:u.id},[S(c,{to:"/skills/"+u.url,target:"_blank"},{default:y(()=>[f(v(u.name),1)]),_:2},1032,["to"])]))),128))])):(l(),m("p",It,"Nothing to worry about yet"))]),s("div",$t,[Pt,s("ul",null,[s("li",null,[Bt,f(" "+v(r.totalSkillsPassed),1)]),s("li",null,[Mt,f(" "+v(r.totalTimeSpent),1)]),s("li",null,[S(c,{to:"/my-progress/tokens",target:"_blank"},{default:y(()=>[jt,f(" "+v(r.totalAIUsage),1)]),_:1})])])])])])])])])])}const Jt=T(st,[["render",qt],["__scopeId","data-v-d3067a06"]]);export{Jt as default};
