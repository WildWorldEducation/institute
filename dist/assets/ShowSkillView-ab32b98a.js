import{u as Wt,a as Kt}from"./TagsStore-572b2476.js";import{_ as O,h as pt,r as y,o as l,c as a,d as n,x as b,b as u,l as k,e as E,j as T,i as m,T as ot,m as x,F as S,t as V,G as Gt,w as $,v as Yt,p as N,f as z,a as W,H as Jt,I as xt,u as St,A as nt,J as rt,g as Zt,K as Qt,L as Xt}from"./main-4f93ff9e.js";import{u as te}from"./ShowSkillStore-be185085.js";import{F as Lt}from"./FlagModals-f6979787.js";import{T as Mt}from"./tutorLoadingSymbol-11403133.js";import{T as ee}from"./TooltipBtn-737609cc.js";const se="/images/source-avatars/source-default-avatar.png";const ie={setup(){return{sessionDetailsStore:pt()}},props:["post","user"],data(){return{showActionBtns:!1,currentClickId:0}},mounted(){},computed:{},methods:{handleClickActionBtns(s){this.showActionBtns=!this.showActionBtns,this.currentClickId=s},showWarningModal(s){this.$parent.showWarningModal(s,"resource")},voteUp(s,t){t?fetch("/user-votes/"+this.user.userId+"/"+s+"/edit/cancel",{method:"PUT",headers:{"Content-Type":"content/type"},body:{}}).then(()=>this.$parent.getSourceVotes(s)):fetch("/user-votes/"+this.user.userId+"/"+s+"/edit/up",{method:"PUT",headers:{"Content-Type":"content/type"},body:{}}).then(()=>this.$parent.getSourceVotes(s))},voteDown(s,t){t?fetch("/user-votes/"+this.user.userId+"/"+s+"/edit/cancel",{method:"PUT",headers:{"Content-Type":"content/type"},body:{}}).then(()=>{this.$parent.getSourceVotes(s,this.post.type)}):fetch("/user-votes/"+this.user.userId+"/"+s+"/edit/down",{method:"PUT",headers:{"Content-Type":"content/type"},body:{}}).then(()=>{this.$parent.getSourceVotes(s,this.post.type)})},handleOpenFlagModal(s){this.$parent.handleOpenFlagModal(s,"resource")}}},oe={class:"row mt-4 forum-container source"},ne={class:"d-flex align-items-center justify-content-between mb-2"},re={class:"w-100"},le={class:"col post-user-row"},ae={class:"user-avatar"},ce=["src"],he={key:1,src:se,class:"user-avatar-img",alt:"user avatar"},ue={class:"user-name-div d-flex justify-content-between w-100"},de={class:"user-name-text"},pe={key:0,"b-tooltip.hover":"",title:"This source was created or edited by a human",class:"author-icon me-4",style:{height:"50px"}},fe={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 320 512",height:"22",style:{opacity:"0.5"},class:"primary-icon"},ge=n("path",{d:"M112 48a48 48 0 1 1 96 0 48 48 0 1 1 -96 0zm40 304l0 128c0 17.7-14.3 32-32 32s-32-14.3-32-32l0-223.1L59.4 304.5c-9.1 15.1-28.8 20-43.9 10.9s-20-28.8-10.9-43.9l58.3-97c17.4-28.9 48.6-46.6 82.3-46.6l29.7 0c33.7 0 64.9 17.7 82.3 46.6l58.3 97c9.1 15.1 4.2 34.8-10.9 43.9s-34.8 4.2-43.9-10.9L232 256.9 232 480c0 17.7-14.3 32-32 32s-32-14.3-32-32l0-128-16 0z"},null,-1),_e=[ge],me={key:1,"b-tooltip.hover":"",title:"This post was created by an AI",class:"author-icon me-4",style:{height:"50px"}},ye={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 640 512",height:"22",style:{opacity:"0.5"},class:"primary-icon"},we=n("path",{d:"M320 0c17.7 0 32 14.3 32 32l0 64 120 0c39.8 0 72 32.2 72 72l0 272c0 39.8-32.2 72-72 72l-304 0c-39.8 0-72-32.2-72-72l0-272c0-39.8 32.2-72 72-72l120 0 0-64c0-17.7 14.3-32 32-32zM208 384c-8.8 0-16 7.2-16 16s7.2 16 16 16l32 0c8.8 0 16-7.2 16-16s-7.2-16-16-16l-32 0zm96 0c-8.8 0-16 7.2-16 16s7.2 16 16 16l32 0c8.8 0 16-7.2 16-16s-7.2-16-16-16l-32 0zm96 0c-8.8 0-16 7.2-16 16s7.2 16 16 16l32 0c8.8 0 16-7.2 16-16s-7.2-16-16-16l-32 0zM264 256a40 40 0 1 0 -80 0 40 40 0 1 0 80 0zm152 40a40 40 0 1 0 0-80 40 40 0 1 0 0 80zM48 224l16 0 0 192-16 0c-26.5 0-48-21.5-48-48l0-96c0-26.5 21.5-48 48-48zm544 0c26.5 0 48 21.5 48 48l0 96c0 26.5-21.5 48-48 48l-16 0 0-192 16 0z"},null,-1),ve=[we],ke={class:"source"},be=["innerHTML"],Te={class:"d-flex align-items-center justify-content-end mt-3"},Ce={class:"first-post-row"},xe={class:"d-flex flex-row justify-content-end gap-1"},Se={key:0,width:"34",height:"27",fill:"#36c1af",class:"vote-icon upvote-icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},Le=n("path",{d:"M23,10C23,8.89 22.1,8 21,8H14.68L15.64,3.43C15.66,3.33 15.67,3.22 15.67,3.11C15.67,2.7 15.5,2.32 15.23,2.05L14.17,1L7.59,7.58C7.22,7.95 7,8.45 7,9V19A2,2 0 0,0 9,21H18C18.83,21 19.54,20.5 19.84,19.78L22.86,12.73C22.95,12.5 23,12.26 23,12V10M1,21H5V9H1V21Z"},null,-1),Me=[Le],Ae={key:1,width:"34",height:"27",fill:"#36c1af",class:"vote-icon upvote-icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},Ie=n("path",{d:"M5,9V21H1V9H5M9,21A2,2 0 0,1 7,19V9C7,8.45 7.22,7.95 7.59,7.59L14.17,1L15.23,2.06C15.5,2.33 15.67,2.7 15.67,3.11L15.64,3.43L14.69,8H21C22.11,8 23,8.9 23,10V12C23,12.26 22.95,12.5 22.86,12.73L19.84,19.78C19.54,20.5 18.83,21 18,21H9M9,19H18.03L21,12V10H12.21L13.34,4.68L9,9.03V19Z"},null,-1),Pe=[Ie],Oe={key:0,width:"34",height:"27",fill:"#FC6E68",class:"vote-icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},De=n("path",{d:"M19,15H23V3H19M15,3H6C5.17,3 4.46,3.5 4.16,4.22L1.14,11.27C1.05,11.5 1,11.74 1,12V14A2,2 0 0,0 3,16H9.31L8.36,20.57C8.34,20.67 8.33,20.77 8.33,20.88C8.33,21.3 8.5,21.67 8.77,21.94L9.83,23L16.41,16.41C16.78,16.05 17,15.55 17,15V5C17,3.89 16.1,3 15,3Z"},null,-1),Be=[De],Ee={key:1,width:"34",height:"27",fill:"#FC6E68",class:"vote-icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},Re=n("path",{d:"M19,15V3H23V15H19M15,3A2,2 0 0,1 17,5V15C17,15.55 16.78,16.05 16.41,16.41L9.83,23L8.77,21.94C8.5,21.67 8.33,21.3 8.33,20.88L8.36,20.57L9.31,16H3C1.89,16 1,15.1 1,14V12C1,11.74 1.05,11.5 1.14,11.27L4.16,4.22C4.46,3.5 5.17,3 6,3H15M15,5H5.97L3,12V14H11.78L10.65,19.32L15,14.97V5Z"},null,-1),Ve=[Re],He={key:2,class:"position-relative"},Ne=n("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",fill:"grey",class:"more-icon"},[n("path",{d:"M8 256a56 56 0 1 1 112 0A56 56 0 1 1 8 256zm160 0a56 56 0 1 1 112 0 56 56 0 1 1 -112 0zm216-56a56 56 0 1 1 0 112 56 56 0 1 1 0-112z"})],-1),ze=[Ne],Fe={key:0,class:"action-btns-div"},je=n("svg",{width:"19",height:"20",viewBox:"0 0 19 20",class:"primary-icon",xmlns:"http://www.w3.org/2000/svg"},[n("path",{d:"M0.75558 19.3181C0.77635 19.5132 0.87137 19.6928 1.02096 19.8198C1.17055 19.9468 1.36325 20.0114 1.55915 20.0002L5.27701 19.8288L0.398438 15.6145L0.75558 19.3181Z"}),n("path",{d:"M11.8467 2.24484L0.801758 15.0315L5.6802 19.2454L16.7251 6.45877L11.8467 2.24484Z",fill:"#857D99"}),n("path",{d:"M18.2555 3.11796L14.934 0.260817C14.832 0.172259 14.7134 0.104756 14.5852 0.0621907C14.4569 0.0196256 14.3215 0.00283902 14.1868 0.0127967C14.052 0.0227543 13.9205 0.0592596 13.7999 0.120212C13.6793 0.181165 13.572 0.265362 13.484 0.36796L12.4805 1.50725L17.359 5.71439L18.3519 4.56082C18.5289 4.35602 18.6181 4.08969 18.6 3.81958C18.582 3.54948 18.4582 3.29738 18.2555 3.11796Z",fill:"#857D99"})],-1),Ue=n("svg",{width:"18",height:"18",viewBox:"0 0 20 20",class:"primary-icon",xmlns:"http://www.w3.org/2000/svg"},[n("path",{d:"M0.312625 14.5205L4.83312 9.99999L0.312625 5.49218C0.111396 5.29025 -0.00159545 5.0168 -0.00159545 4.73172C-0.00159545 4.44665 0.111396 4.17319 0.312625 3.97126L3.96282 0.312625C4.16474 0.111396 4.4382 -0.00159545 4.72327 -0.00159545C5.00835 -0.00159545 5.2818 0.111396 5.48373 0.312625L9.99999 4.83312L14.5205 0.312625C14.6204 0.21056 14.7397 0.12947 14.8714 0.0741101C15.003 0.0187502 15.1444 -0.00976563 15.2873 -0.00976562C15.4301 -0.00976563 15.5715 0.0187502 15.7032 0.0741101C15.8349 0.12947 15.9541 0.21056 16.0541 0.312625L19.6874 3.96282C19.8886 4.16474 20.0016 4.4382 20.0016 4.72327C20.0016 5.00835 19.8886 5.2818 19.6874 5.48373L15.1669 9.99999L19.6874 14.5205C19.8883 14.7217 20.0012 14.9944 20.0012 15.2788C20.0012 15.5632 19.8883 15.836 19.6874 16.0372L16.0541 19.6874C15.8529 19.8883 15.5801 20.0012 15.2957 20.0012C15.0113 20.0012 14.7386 19.8883 14.5374 19.6874L9.99999 15.1669L5.49218 19.6874C5.29025 19.8886 5.0168 20.0016 4.73172 20.0016C4.44665 20.0016 4.17319 19.8886 3.97126 19.6874L0.312625 16.0541C0.21056 15.9541 0.12947 15.8349 0.0741101 15.7032C0.0187502 15.5715 -0.00976563 15.4301 -0.00976562 15.2873C-0.00976563 15.1444 0.0187502 15.003 0.0741101 14.8714C0.12947 14.7397 0.21056 14.6204 0.312625 14.5205Z"})],-1),qe=[Ue],$e={class:"d-flex flex-row-reverse"},We={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",style:{opacity:"0.5"},height:"20",width:"20",class:"primary-icon"},Ke=n("path",{d:"M64 32C64 14.3 49.7 0 32 0S0 14.3 0 32V64 368 480c0 17.7 14.3 32 32 32s32-14.3 32-32V352l64.3-16.1c41.1-10.3 84.6-5.5 122.5 13.4c44.2 22.1 95.5 24.8 141.7 7.4l34.7-13c12.5-4.7 20.8-16.6 20.8-30V66.1c0-23-24.2-38-44.8-27.7l-9.6 4.8c-46.3 23.2-100.8 23.2-147.1 0c-35.1-17.6-75.4-22-113.5-12.5L64 48V32z"},null,-1),Ge=[Ke];function Ye(s,t,e,i,o,r){const c=y("router-link");return l(),a("div",oe,[n("div",ne,[n("div",re,[n("div",le,[n("div",ae,[i.sessionDetailsStore.isLoggedIn?(l(),a("img",{key:0,src:e.post.avatar,class:"user-avatar-img",alt:"user avatar"},null,8,ce)):(l(),a("img",he))]),n("div",ue,[n("span",de,b(e.post.username),1)]),e.post.is_human_edited?(l(),a("div",pe,[(l(),a("svg",fe,_e))])):(l(),a("div",me,[(l(),a("svg",ye,ve))]))])])]),n("div",ke,[n("div",{class:"forum-post w-auto",innerHTML:e.post.content},null,8,be)]),n("div",Te,[n("div",Ce,[n("div",xe,[i.sessionDetailsStore.isLoggedIn?(l(),a("button",{key:0,class:"vote-btn",onClick:t[0]||(t[0]=h=>r.voteUp(e.post.id,e.post.userUpVote)),"b-tooltip.hover":"",title:"I Like This "},[e.post.userUpVote?(l(),a("svg",Se,Me)):(l(),a("svg",Ae,Pe))])):u("",!0),n("span",{"b-on-hover":"",title:"number of votes this source received",class:k({"text-danger":e.post.voteCount<0,"primary-color":e.post.voteCount>0,"vote-count":!0})},b(e.post.voteCount),3),i.sessionDetailsStore.isLoggedIn?(l(),a("button",{key:1,class:"vote-btn","b-tooltip.hover":"",title:"I Dislike This ",onClick:t[1]||(t[1]=h=>r.voteDown(e.post.id,e.post.userDownVote))},[e.post.userDownVote?(l(),a("svg",Oe,Be)):(l(),a("svg",Ee,Ve))])):u("",!0),i.sessionDetailsStore.isLoggedIn?(l(),a("div",He,[n("button",{class:"toggle-actions-bnt",onClick:t[2]||(t[2]=h=>r.handleClickActionBtns(e.post.id)),"b-tooltip.hover":"",title:"More Actions For This Source"},ze),E(ot,{name:"dropdown"},{default:T(()=>[o.showActionBtns&&e.post.id==o.currentClickId?(l(),a("div",Fe,[e.post.user_id==e.user.userId||e.user.role=="admin"||e.user.role=="editor"?(l(),m(c,{key:0,to:"/resources/edit/"+e.post.id,class:"btn dropdown-btn",role:"button","b-tooltip.hover":"",title:"Edit This Source"},{default:T(()=>[je]),_:1},8,["to"])):u("",!0),e.post.user_id==e.user.userId||e.user.role=="admin"||e.user.role=="editor"?(l(),a("button",{key:1,"b-tooltip.hover":"",title:"Delete This Source",type:"button",class:"btn dropdown-btn",onClick:t[3]||(t[3]=h=>r.showWarningModal(e.post))},qe)):u("",!0),n("button",{"b-tooltip.hover":"",title:"Flag This Source For Review",type:"button",class:"btn dropdown-btn",onClick:t[4]||(t[4]=h=>r.handleOpenFlagModal(e.post.id,e.post.type))},[n("div",$e,[(l(),a("svg",We,Ge))])])])):u("",!0)]),_:1})])):u("",!0)])])])])}const At=O(ie,[["render",Ye]]);const Je={props:["resourcePosts","user","skillId"],data(){return{showActionBtns:!1,currentClickId:0,isAlreadyTutoring:this.$parent.isAlreadyTutoring,showWarnModal:!1,currentPost:null}},components:{ResourcePostCard:At},mounted(){},computed:{orderedAndNamedPosts(){var s=this.resourcePosts.sort((t,e)=>e.voteCount===t.voteCount?new Date(e.created_at)-new Date(t.created_at):e.voteCount-t.voteCount);return s}},methods:{deletePost(){this.$parent.deletePost(this.currentPost),this.showWarnModal=!1},showWarningModal(s){this.currentPost=s,this.showWarnModal=!0},handleOpenFlagModal(s){this.$parent.flagPost=s,this.$parent.showFlaggingModal=!0,this.showActionBtns=!1,this.$parent.flagType="resource"},getSourceVotes(s){this.$parent.getSourceVotes(s)}}},Ze={class:"d-flex flex-column mt-4"},Qe={class:"d-flex flex-column flex-lg-row"},Xe={class:"ms-0 me-auto ms-lg-auto me-lg-0"},ts={class:"d-flex flex-column align-items-baseline"},es=n("svg",{width:"18",height:"18",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[n("path",{d:"M6.34811 20.0423L6.34811 13.6494L-0.0358702 13.6583C-0.320945 13.6579 -0.594203 13.5444 -0.795782 13.3428C-0.997361 13.1412 -1.11082 12.868 -1.11132 12.5829L-1.11729 7.41477C-1.1168 7.1297 -1.00334 6.85644 -0.801757 6.65486C-0.600179 6.45328 -0.326921 6.33982 -0.0418461 6.33933L6.3481 6.34231L6.3481 -0.0506238C6.34659 -0.193451 6.3736 -0.335145 6.42756 -0.467396C6.48152 -0.599646 6.56134 -0.719794 6.66234 -0.820794C6.76334 -0.921794 6.88349 -1.00161 7.01574 -1.05557C7.14799 -1.10953 7.28969 -1.13655 7.43251 -1.13503L12.5827 -1.12308C12.8678 -1.12259 13.141 -1.00913 13.3426 -0.807549C13.5442 -0.60597 13.6577 -0.332713 13.6582 -0.047637L13.6552 6.34231L20.0481 6.34231C20.3325 6.34248 20.6052 6.45552 20.8063 6.65661C21.0074 6.8577 21.1204 7.13039 21.1206 7.41477L21.1325 12.565C21.1324 12.8494 21.0193 13.122 20.8182 13.3231C20.6171 13.5242 20.3444 13.6373 20.0601 13.6374L13.6552 13.6494L13.6641 20.0334C13.6636 20.3184 13.5502 20.5917 13.3486 20.7933C13.147 20.9948 12.8738 21.1083 12.5887 21.1088L7.43252 21.1267C7.28969 21.1282 7.148 21.1012 7.01575 21.0473C6.88349 20.9933 6.76335 20.9135 6.66235 20.8125C6.56135 20.7115 6.48153 20.5913 6.42757 20.4591C6.37361 20.3268 6.34659 20.1851 6.34811 20.0423Z",fill:"white"})],-1),ss={id:"posts-big-container"},is={key:0},os={id:"myModal",class:"modal"},ns={class:"modal-content"},rs=n("p",null,"Are you sure you want to delete this source?",-1),ls={style:{display:"flex",gap:"10px"}};function as(s,t,e,i,o,r){const c=y("router-link"),h=y("ResourcePostCard");return l(),a(S,null,[n("div",Ze,[n("div",Qe,[n("div",Xe,[n("div",ts,[E(c,{to:"/resources/add/"+e.skillId,class:"btn primary-btn",role:"button"},{default:T(()=>[x("Add source   "),es]),_:1},8,["to"])])])])]),n("div",ss,[(l(!0),a(S,null,V(r.orderedAndNamedPosts,g=>(l(),m(h,{post:g,user:e.user},null,8,["post","user"]))),256))]),o.showWarnModal?(l(),a("div",is,[n("div",os,[n("div",ns,[rs,n("div",ls,[n("button",{type:"button",class:"btn btn-danger",onClick:t[0]||(t[0]=g=>r.deletePost())}," Yes "),n("button",{type:"button",class:"btn btn-dark",onClick:t[1]||(t[1]=g=>o.showWarnModal=!1)}," No ")])])])])):u("",!0)],64)}const cs=O(Je,[["render",as]]);const hs={props:["post","user"],data(){return{showActionBtns:!1,currentClickId:0,isAlreadyTutoring:this.$parent.isAlreadyTutoring,expandPost:!1,showActionButton:!1,showContactDetails:!1}},mounted(){},computed:{},methods:{showWarningModal(s){this.$parent.showWarningModal(s,"tutorPost")},voteUp(s,t){t?fetch("/tutor-votes/"+this.user.userId+"/"+s+"/edit/cancel",{method:"PUT",headers:{"Content-Type":"content/type"},body:{}}).then(()=>this.$parent.getTutorPostVotes(s)):fetch("/tutor-votes/"+this.user.userId+"/"+s+"/edit/up",{method:"PUT",headers:{"Content-Type":"content/type"},body:{}}).then(()=>this.$parent.getTutorPostVotes(s))},voteDown(s,t){t?fetch("/tutor-votes/"+this.user.userId+"/"+s+"/edit/cancel",{method:"PUT",headers:{"Content-Type":"content/type"},body:{}}).then(()=>this.$parent.getTutorPostVotes(s)):fetch("/tutor-votes/"+this.user.userId+"/"+s+"/edit/down",{method:"PUT",headers:{"Content-Type":"content/type"},body:{}}).then(()=>this.$parent.getTutorPostVotes(s))},handleOpenFlagModal(s){this.$parent.handleOpenFlagModal(s,"tutor_post")},deleteTutorPost(s){this.$parent.deleteTutorPost(s,"tutorPost")},toPlainText(s){return s==null?void 0:s.replace(/<\/?[^>]+(>|$)/g,"")},showContactAdviceModal(){this.showContactDetails=!this.showContactDetails,document.getElementById("myModal").addEventListener("click",s=>{s.target.classList.contains("modal-content")||(this.showContactDetails=!1)}),document.getElementById("modal-content").addEventListener("click",function(s){s.stopPropagation()},!1)}}},D=s=>(N("data-v-ff392076"),s=s(),z(),s),us={class:"d-flex justify-content-center ms-3 ms-md-0 tutor-avatar-div"},ds=["src"],ps={class:"d-flex flex-column w-100"},fs={class:"d-flex flex-row justify-content-between"},gs={class:"tutor-user-name text-capitalize"},_s=D(()=>n("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",heigh:"15",width:"15",fill:"grey"},[n("path",{d:"M201.4 137.4c12.5-12.5 32.8-12.5 45.3 0l160 160c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L224 205.3 86.6 342.6c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3l160-160z"})],-1)),ms=[_s],ys={class:"d-flex mt-4 tutor-post"},ws=D(()=>n("span",{class:"cover-letter-word"},"cover letter - ",-1)),vs={key:0,class:"d-flex flex-column"},ks=["innerHTML"],bs={class:"d-flex align-items-center justify-content-end mt-3"},Ts={class:"first-post-row"},Cs={class:"d-flex flex-row justify-content-end gap-1"},xs={key:0,width:"34",height:"27",fill:"#36c1af",class:"vote-icon upvote-icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},Ss=D(()=>n("path",{d:"M23,10C23,8.89 22.1,8 21,8H14.68L15.64,3.43C15.66,3.33 15.67,3.22 15.67,3.11C15.67,2.7 15.5,2.32 15.23,2.05L14.17,1L7.59,7.58C7.22,7.95 7,8.45 7,9V19A2,2 0 0,0 9,21H18C18.83,21 19.54,20.5 19.84,19.78L22.86,12.73C22.95,12.5 23,12.26 23,12V10M1,21H5V9H1V21Z"},null,-1)),Ls=[Ss],Ms={key:1,width:"34",height:"27",fill:"#36c1af",class:"vote-icon upvote-icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},As=D(()=>n("path",{d:"M5,9V21H1V9H5M9,21A2,2 0 0,1 7,19V9C7,8.45 7.22,7.95 7.59,7.59L14.17,1L15.23,2.06C15.5,2.33 15.67,2.7 15.67,3.11L15.64,3.43L14.69,8H21C22.11,8 23,8.9 23,10V12C23,12.26 22.95,12.5 22.86,12.73L19.84,19.78C19.54,20.5 18.83,21 18,21H9M9,19H18.03L21,12V10H12.21L13.34,4.68L9,9.03V19Z"},null,-1)),Is=[As],Ps={key:0,width:"34",height:"27",fill:"#FC6E68",class:"vote-icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},Os=D(()=>n("path",{d:"M19,15H23V3H19M15,3H6C5.17,3 4.46,3.5 4.16,4.22L1.14,11.27C1.05,11.5 1,11.74 1,12V14A2,2 0 0,0 3,16H9.31L8.36,20.57C8.34,20.67 8.33,20.77 8.33,20.88C8.33,21.3 8.5,21.67 8.77,21.94L9.83,23L16.41,16.41C16.78,16.05 17,15.55 17,15V5C17,3.89 16.1,3 15,3Z"},null,-1)),Ds=[Os],Bs={key:1,width:"34",height:"27",fill:"#FC6E68",class:"vote-icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},Es=D(()=>n("path",{d:"M19,15V3H23V15H19M15,3A2,2 0 0,1 17,5V15C17,15.55 16.78,16.05 16.41,16.41L9.83,23L8.77,21.94C8.5,21.67 8.33,21.3 8.33,20.88L8.36,20.57L9.31,16H3C1.89,16 1,15.1 1,14V12C1,11.74 1.05,11.5 1.14,11.27L4.16,4.22C4.46,3.5 5.17,3 6,3H15M15,5H5.97L3,12V14H11.78L10.65,19.32L15,14.97V5Z"},null,-1)),Rs=[Es],Vs={class:"position-relative"},Hs=D(()=>n("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",fill:"grey",class:"more-icon"},[n("path",{d:"M8 256a56 56 0 1 1 112 0A56 56 0 1 1 8 256zm160 0a56 56 0 1 1 112 0 56 56 0 1 1 -112 0zm216-56a56 56 0 1 1 0 112 56 56 0 1 1 0-112z"})],-1)),Ns=[Hs],zs={key:0,class:"action-btns-div"},Fs=D(()=>n("svg",{width:"19",height:"20",viewBox:"0 0 19 20",class:"primary-icon",xmlns:"http://www.w3.org/2000/svg"},[n("path",{d:"M0.75558 19.3181C0.77635 19.5132 0.87137 19.6928 1.02096 19.8198C1.17055 19.9468 1.36325 20.0114 1.55915 20.0002L5.27701 19.8288L0.398438 15.6145L0.75558 19.3181Z"}),n("path",{d:"M11.8467 2.24484L0.801758 15.0315L5.6802 19.2454L16.7251 6.45877L11.8467 2.24484Z",fill:"#857D99"}),n("path",{d:"M18.2555 3.11796L14.934 0.260817C14.832 0.172259 14.7134 0.104756 14.5852 0.0621907C14.4569 0.0196256 14.3215 0.00283902 14.1868 0.0127967C14.052 0.0227543 13.9205 0.0592596 13.7999 0.120212C13.6793 0.181165 13.572 0.265362 13.484 0.36796L12.4805 1.50725L17.359 5.71439L18.3519 4.56082C18.5289 4.35602 18.6181 4.08969 18.6 3.81958C18.582 3.54948 18.4582 3.29738 18.2555 3.11796Z",fill:"#857D99"})],-1)),js=D(()=>n("svg",{width:"18",height:"18",viewBox:"0 0 20 20",class:"primary-icon",xmlns:"http://www.w3.org/2000/svg"},[n("path",{d:"M0.312625 14.5205L4.83312 9.99999L0.312625 5.49218C0.111396 5.29025 -0.00159545 5.0168 -0.00159545 4.73172C-0.00159545 4.44665 0.111396 4.17319 0.312625 3.97126L3.96282 0.312625C4.16474 0.111396 4.4382 -0.00159545 4.72327 -0.00159545C5.00835 -0.00159545 5.2818 0.111396 5.48373 0.312625L9.99999 4.83312L14.5205 0.312625C14.6204 0.21056 14.7397 0.12947 14.8714 0.0741101C15.003 0.0187502 15.1444 -0.00976563 15.2873 -0.00976562C15.4301 -0.00976563 15.5715 0.0187502 15.7032 0.0741101C15.8349 0.12947 15.9541 0.21056 16.0541 0.312625L19.6874 3.96282C19.8886 4.16474 20.0016 4.4382 20.0016 4.72327C20.0016 5.00835 19.8886 5.2818 19.6874 5.48373L15.1669 9.99999L19.6874 14.5205C19.8883 14.7217 20.0012 14.9944 20.0012 15.2788C20.0012 15.5632 19.8883 15.836 19.6874 16.0372L16.0541 19.6874C15.8529 19.8883 15.5801 20.0012 15.2957 20.0012C15.0113 20.0012 14.7386 19.8883 14.5374 19.6874L9.99999 15.1669L5.49218 19.6874C5.29025 19.8886 5.0168 20.0016 4.73172 20.0016C4.44665 20.0016 4.17319 19.8886 3.97126 19.6874L0.312625 16.0541C0.21056 15.9541 0.12947 15.8349 0.0741101 15.7032C0.0187502 15.5715 -0.00976563 15.4301 -0.00976562 15.2873C-0.00976563 15.1444 0.0187502 15.003 0.0741101 14.8714C0.12947 14.7397 0.21056 14.6204 0.312625 14.5205Z"})],-1)),Us=[js],qs=["title"],$s={class:"d-flex flex-row-reverse"},Ws={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",style:{opacity:"0.5"},height:"20",width:"20",class:"primary-icon"},Ks=D(()=>n("path",{d:"M64 32C64 14.3 49.7 0 32 0S0 14.3 0 32V64 368 480c0 17.7 14.3 32 32 32s32-14.3 32-32V352l64.3-16.1c41.1-10.3 84.6-5.5 122.5 13.4c44.2 22.1 95.5 24.8 141.7 7.4l34.7-13c12.5-4.7 20.8-16.6 20.8-30V66.1c0-23-24.2-38-44.8-27.7l-9.6 4.8c-46.3 23.2-100.8 23.2-147.1 0c-35.1-17.6-75.4-22-113.5-12.5L64 48V32z"},null,-1)),Gs=[Ks],Ys={id:"myModal",class:"modal"},Js={id:"modal-content",class:"modal-content contact-modal-content"},Zs=D(()=>n("span",{"aria-hidden":"true"},[n("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",width:"25",height:"25"},[n("path",{d:"M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z",fill:"black"})])],-1)),Qs=[Zs],Xs=["innerHTML"];function ti(s,t,e,i,o,r){const c=y("router-link");return l(),a(S,null,[n("div",Gt(s.$attrs,{class:"tutor d-flex w-100 p-3 flex-column flex-lg-row mt-4"}),[n("div",us,[n("img",{src:e.post.avatar,class:"tutor-img rounded",alt:"user avatar"},null,8,ds)]),n("div",ps,[n("div",fs,[n("div",gs,b(e.post.username),1),n("div",{"b-on-hover":"",title:"expand cover letter",style:{cursor:"pointer"},onClick:t[0]||(t[0]=h=>o.expandPost=!o.expandPost),class:k([o.expandPost?"arrow-up":"arrow-down"])},ms,2)]),n("div",ys,[o.expandPost?u("",!0):(l(),a("p",{key:0,class:"tutor-post-content","b-on-hover":"",title:"expand this cover letter",onClick:t[1]||(t[1]=h=>o.expandPost=!0)},[ws,x(b(r.toPlainText(e.post.description)),1)])),E(ot,{name:"dropdown"},{default:T(()=>[o.expandPost?(l(),a("div",vs,[n("p",{innerHTML:e.post.description},null,8,ks),n("button",{class:"btn green-btn mt-2 me-0 ms-auto w-auto mb-3",onClick:t[2]||(t[2]=h=>r.showContactAdviceModal())}," Contact details ")])):u("",!0)]),_:1})]),n("div",bs,[n("div",Ts,[n("div",Cs,[e.post.user_id!=e.user.userId?(l(),a("button",{key:0,class:"vote-btn",onClick:t[3]||(t[3]=h=>r.voteUp(e.post.id,e.post.userUpVote,e.post.type)),"b-tooltip.hover":"",title:"I Vote This User "},[e.post.userUpVote?(l(),a("svg",xs,Ls)):(l(),a("svg",Ms,Is))])):u("",!0),n("span",{"b-on-hover":"",title:"number of votes this tutor post received",class:k({"text-danger":e.post.voteCount<0,"primary-color":e.post.voteCount>0,"vote-count":!0})},b(e.post.voteCount),3),e.post.user_id!=e.user.userId?(l(),a("button",{key:1,class:"vote-btn","b-tooltip.hover":"",title:"I Dislike This ",onClick:t[4]||(t[4]=h=>r.voteDown(e.post.id,e.post.userDownVote,e.post.type))},[e.post.userDownVote?(l(),a("svg",Ps,Ds)):(l(),a("svg",Bs,Rs))])):u("",!0),n("div",Vs,[n("button",{class:"toggle-actions-bnt",onClick:t[5]||(t[5]=h=>o.showActionBtns=!o.showActionBtns),"b-tooltip.hover":"",title:"More Actions For This Tutor Offer"},Ns),E(ot,{name:"dropdown"},{default:T(()=>[o.showActionBtns?(l(),a("div",zs,[e.post.user_id==e.user.userId||e.user.role=="admin"||e.user.role=="editor"?(l(),m(c,{key:0,to:"/tutor/edit/"+e.post.id,class:"btn dropdown-btn",role:"button","b-tooltip.hover":"",title:"Edit This Tutor Post"},{default:T(()=>[Fs]),_:1},8,["to"])):u("",!0),e.post.user_id==e.user.userId||e.user.role=="admin"||e.user.role=="editor"?(l(),a("button",{key:1,"b-tooltip.hover":"",title:"'Delete This Tutor Post'",type:"button",class:"btn dropdown-btn",onClick:t[6]||(t[6]=h=>r.showWarningModal(e.post))},Us)):u("",!0),n("button",{"b-tooltip.hover":"",title:e.post.type!="tutor"?"Flag This Source For Review":"Flag This Tutor Post For Review",type:"button",class:"btn dropdown-btn",onClick:t[7]||(t[7]=h=>r.handleOpenFlagModal(e.post.id,e.post.type))},[n("div",$s,[(l(),a("svg",Ws,Gs))])],8,qs)])):u("",!0)]),_:1})])])])])])],16),$(n("div",null,[n("div",Ys,[n("div",Js,[n("button",{type:"button",class:"close closeBtn",onClick:t[8]||(t[8]=h=>r.showContactAdviceModal()),"aria-label":"Close"},Qs),n("div",{innerHTML:e.post.contact_preference},null,8,Xs)])])],512),[[Yt,o.showContactDetails]])],64)}const It=O(hs,[["render",ti],["__scopeId","data-v-ff392076"]]);const ei={props:["tutorPosts","user","skillId"],data(){return{showWarnModal:!1,currentPost:null,isLoading:!0,isAlreadyTutoring:!1}},mounted(){},components:{TutorPostCard:It},computed:{orderedAndNamedPosts(){var s=this.tutorPosts.sort((t,e)=>e.voteCount===t.voteCount?new Date(e.created_at)-new Date(t.created_at):e.voteCount-t.voteCount);for(let t=0;t<s.length;t++)s[t].user_id==this.user.userId&&(this.isAlreadyTutoring=!0);return this.isLoading=!1,s}},methods:{showWarningModal(s){this.currentPost=s,this.showWarnModal=!0},getTutorPostVotes(s){this.$parent.getTutorPostVotes(s)},handleOpenFlagModal(s){this.$parent.flagPost=s,this.$parent.showFlaggingModal=!0,this.showActionBtns=!1,this.$parent.flagType="tutor_post"},handleExpandPost(s){this.expandPostId!==1/0?this.expandPostId=1/0:this.expandPostId=s},deleteTutorPost(s){this.$parent.deleteTutorPost(s),this.isAlreadyTutoring=!1,this.showWarnModal=!1},toPlainText(s){return s.replace(/<\/?[^>]+(>|$)/g,"")}}},si={class:"d-flex flex-column flex-md-row justify-content-between my-4"},ii={class:"ms-0 me-auto ms-lg-auto me-lg-0"},oi={key:0,class:"d-flex flex-column align-items-baseline"},ni=n("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",width:"18",height:"20"},[n("path",{d:"M32 32C32 14.3 46.3 0 64 0S96 14.3 96 32V240H32V32zM224 192c0-17.7 14.3-32 32-32s32 14.3 32 32v64c0 17.7-14.3 32-32 32s-32-14.3-32-32V192zm-64-64c17.7 0 32 14.3 32 32v48c0 17.7-14.3 32-32 32s-32-14.3-32-32V160c0-17.7 14.3-32 32-32zm160 96c0-17.7 14.3-32 32-32s32 14.3 32 32v64c0 17.7-14.3 32-32 32s-32-14.3-32-32V224zm-96 88l0-.6c9.4 5.4 20.3 8.6 32 8.6c13.2 0 25.4-4 35.6-10.8c8.7 24.9 32.5 42.8 60.4 42.8c11.7 0 22.6-3.1 32-8.6V352c0 88.4-71.6 160-160 160H162.3c-42.4 0-83.1-16.9-113.1-46.9L37.5 453.5C13.5 429.5 0 396.9 0 363V336c0-35.3 28.7-64 64-64h88c22.1 0 40 17.9 40 40s-17.9 40-40 40H96c-8.8 0-16 7.2-16 16s7.2 16 16 16h56c39.8 0 72-32.2 72-72z",fill:"white"})],-1),ri={id:""},li={key:0},ai={id:"myModal",class:"modal"},ci={class:"modal-content"},hi=n("p",null,"Are you sure you want to remove this offer?",-1),ui={style:{display:"flex",gap:"10px"}};function di(s,t,e,i,o,r){const c=y("router-link"),h=y("TutorPostCard");return l(),a(S,null,[n("div",si,[n("div",ii,[o.isLoading==!1?(l(),a("div",oi,[e.user.role=="student"&&o.isAlreadyTutoring==!1?(l(),m(c,{key:0,to:"/tutor/add/"+e.skillId,class:"btn primary-btn mt-2",role:"button"},{default:T(()=>[x("Offer to tutor  "),ni]),_:1},8,["to"])):u("",!0)])):u("",!0)])]),n("div",ri,[(l(!0),a(S,null,V(r.orderedAndNamedPosts,g=>(l(),m(h,{post:g,user:e.user},null,8,["post","user"]))),256))]),o.showWarnModal?(l(),a("div",li,[n("div",ai,[n("div",ci,[hi,n("div",ui,[n("button",{type:"button",class:"btn btn-danger",onClick:t[0]||(t[0]=g=>r.deleteTutorPost(o.currentPost))}," Yes "),n("button",{type:"button",class:"btn btn-dark",onClick:t[1]||(t[1]=g=>o.showWarnModal=!1)}," No ")])])])])):u("",!0)],64)}const pi=O(ei,[["render",di]]);const fi={setup(){return{sessionDetailsStore:pt()}},emits:["progressTutorial"],props:["posts","user","skillId","showTutorialTip6","userRole"],data(){return{showActionBtns:!1,currentClickId:0,isAlreadyTutoring:this.$parent.isAlreadyTutoring,showWarnModal:!1,currentPost:null,warnText:"",deletePostType:"",isLoading:!0,isAlreadyTutoring:!1}},components:{TutorPostCard:It,ResourcePostCard:At},mounted(){this.showTutorialTip6&&this.scrollToTooltip()},watch:{showTutorialTip6(s){s&&this.$nextTick(()=>{this.scrollToTooltip()})}},computed:{orderedAndNamedPosts(){var s=this.posts.sort((t,e)=>e.voteCount===t.voteCount?new Date(e.created_at)-new Date(t.created_at):e.voteCount-t.voteCount);for(let t=0;t<this.posts.length;t++)this.posts[t].type=="tutor-post"&&s[t].user_id==this.sessionDetailsStore.userId&&(this.isAlreadyTutoring=!0);return this.isLoading=!1,s},tutorialTipContent(){return this.userRole==="editor"||this.userRole==="instructor"?"You can also share resources that you have personally used to learn about this topic. Your contributions can help others in their learning journey.":"You can also volunteer to tutor others on this subject and share resources you, personally, have used to learn about this topic"}},methods:{deletePost(s,t){switch(this.deletePostType){case"tutorPost":this.$parent.deleteTutorPost(this.currentPost),this.isAlreadyTutoring=!1;break;default:this.$parent.deletePost(this.currentPost);break}this.showWarnModal=!1},showWarningModal(s,t){switch(t){case"tutorPost":this.warnText="Are you sure you want to remove this tutor offer?",this.deletePostType="tutorPost";break;default:this.deletePostType="resource",this.warnText="Are you sure you want to delete this source?";break}this.currentPost=s,this.showWarnModal=!0},handleOpenFlagModal(s,t){this.$parent.flagPost=s,this.$parent.showFlaggingModal=!0,this.showActionBtns=!1,this.$parent.flagType=t},getSourceVotes(s){this.$parent.getSourceVotes(s)},getTutorPostVotes(s){this.$parent.getTutorPostVotes(s)},scrollToTooltip(){this.$nextTick(()=>{var s;(s=this.$refs.tutorialTip7)==null||s.scrollIntoView({behavior:"smooth",block:"center"})})}}},Pt=s=>(N("data-v-2eeef3ff"),s=s(),z(),s),gi={key:0,class:"d-flex flex-column mt-4"},_i={class:"d-flex flex-column w-100"},mi={class:"d-flex justify-content-xl-end justify-content-between"},yi=Pt(()=>n("svg",{width:"18",height:"18",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[n("path",{d:"M6.34811 20.0423L6.34811 13.6494L-0.0358702 13.6583C-0.320945 13.6579 -0.594203 13.5444 -0.795782 13.3428C-0.997361 13.1412 -1.11082 12.868 -1.11132 12.5829L-1.11729 7.41477C-1.1168 7.1297 -1.00334 6.85644 -0.801757 6.65486C-0.600179 6.45328 -0.326921 6.33982 -0.0418461 6.33933L6.3481 6.34231L6.3481 -0.0506238C6.34659 -0.193451 6.3736 -0.335145 6.42756 -0.467396C6.48152 -0.599646 6.56134 -0.719794 6.66234 -0.820794C6.76334 -0.921794 6.88349 -1.00161 7.01574 -1.05557C7.14799 -1.10953 7.28969 -1.13655 7.43251 -1.13503L12.5827 -1.12308C12.8678 -1.12259 13.141 -1.00913 13.3426 -0.807549C13.5442 -0.60597 13.6577 -0.332713 13.6582 -0.047637L13.6552 6.34231L20.0481 6.34231C20.3325 6.34248 20.6052 6.45552 20.8063 6.65661C21.0074 6.8577 21.1204 7.13039 21.1206 7.41477L21.1325 12.565C21.1324 12.8494 21.0193 13.122 20.8182 13.3231C20.6171 13.5242 20.3444 13.6373 20.0601 13.6374L13.6552 13.6494L13.6641 20.0334C13.6636 20.3184 13.5502 20.5917 13.3486 20.7933C13.147 20.9948 12.8738 21.1083 12.5887 21.1088L7.43252 21.1267C7.28969 21.1282 7.148 21.1012 7.01575 21.0473C6.88349 20.9933 6.76335 20.9135 6.66235 20.8125C6.56135 20.7115 6.48153 20.5913 6.42757 20.4591C6.37361 20.3268 6.34659 20.1851 6.34811 20.0423Z",fill:"white"})],-1)),wi=Pt(()=>n("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",width:"18",height:"20"},[n("path",{d:"M32 32C32 14.3 46.3 0 64 0S96 14.3 96 32V240H32V32zM224 192c0-17.7 14.3-32 32-32s32 14.3 32 32v64c0 17.7-14.3 32-32 32s-32-14.3-32-32V192zm-64-64c17.7 0 32 14.3 32 32v48c0 17.7-14.3 32-32 32s-32-14.3-32-32V160c0-17.7 14.3-32 32-32zm160 96c0-17.7 14.3-32 32-32s32 14.3 32 32v64c0 17.7-14.3 32-32 32s-32-14.3-32-32V224zm-96 88l0-.6c9.4 5.4 20.3 8.6 32 8.6c13.2 0 25.4-4 35.6-10.8c8.7 24.9 32.5 42.8 60.4 42.8c11.7 0 22.6-3.1 32-8.6V352c0 88.4-71.6 160-160 160H162.3c-42.4 0-83.1-16.9-113.1-46.9L37.5 453.5C13.5 429.5 0 396.9 0 363V336c0-35.3 28.7-64 64-64h88c22.1 0 40 17.9 40 40s-17.9 40-40 40H96c-8.8 0-16 7.2-16 16s7.2 16 16 16h56c39.8 0 72-32.2 72-72z",fill:"white"})],-1)),vi={key:0,ref:"tutorialTip7",class:"tool-tip-base d-flex justify-content-end"},ki={class:"explain-tool-tip triangle-top-right hovering-info-panel"},bi={class:"tool-tip-text"},Ti={id:"posts-big-container"},Ci={key:1},xi={id:"myModal",class:"modal"},Si={class:"modal-content"},Li={style:{display:"flex",gap:"10px"}};function Mi(s,t,e,i,o,r){const c=y("router-link"),h=y("ResourcePostCard"),g=y("TutorPostCard");return l(),a(S,null,[i.sessionDetailsStore.isLoggedIn?(l(),a("div",gi,[n("div",_i,[n("div",mi,[E(c,{to:"/resources/add/"+e.skillId,class:"btn primary-btn me-2",role:"button"},{default:T(()=>[x("Add source   "),yi]),_:1},8,["to"]),e.user.role=="student"&&o.isAlreadyTutoring==!1?(l(),m(c,{key:0,to:"/tutor/add/"+e.skillId,class:"btn primary-btn",role:"button"},{default:T(()=>[x("Offer to tutor   "),wi]),_:1},8,["to"])):u("",!0)]),e.showTutorialTip6?(l(),a("div",vi,[n("div",ki,[n("div",bi,[n("p",null,b(r.tutorialTipContent),1),n("button",{class:"btn primary-btn",onClick:t[0]||(t[0]=d=>s.$emit("progressTutorial",6))}," Close ")])])],512)):u("",!0)])])):u("",!0),n("div",Ti,[(l(!0),a(S,null,V(r.orderedAndNamedPosts,d=>(l(),a("div",null,[d.type==="source"?(l(),m(h,{key:0,post:d,user:e.user},null,8,["post","user"])):u("",!0),d.type==="tutor-post"?(l(),m(g,{key:1,post:d,user:e.user,class:"my-4"},null,8,["post","user"])):u("",!0)]))),256))]),o.showWarnModal?(l(),a("div",Ci,[n("div",xi,[n("div",Si,[n("p",null,b(o.warnText),1),n("div",Li,[n("button",{type:"button",class:"btn btn-danger",onClick:t[1]||(t[1]=d=>r.deletePost())}," Yes "),n("button",{type:"button",class:"btn btn-dark",onClick:t[2]||(t[2]=d=>o.showWarnModal=!1)}," No ")])])])])):u("",!0)],64)}const Ai=O(fi,[["render",Mi],["__scopeId","data-v-2eeef3ff"]]);const Ii={setup(){return{userDetailsStore:W()}},emits:["progressTutorial"],props:["skillId","showTutorialTip6","userRole"],data(){return{sourcePosts:[],tutorPosts:[],user:{},showModal:!1,resourceId:null,showFlaggingModal:!1,flagPost:"",flagType:"",showActionBtns:!1,currentClickId:"",source:null,activeTab:"allPost"}},components:{FlagModals:Lt,ForumResource:cs,ForumTutorPost:pi,ForumAllPost:Ai},computed:{posts(){let s=this.sourcePosts;return s=s.concat(this.tutorPosts),s}},async created(){await this.getUserId(),await this.getSourcePosts(this.skillId);for(let s=0;s<this.sourcePosts.length;s++)await this.getSourceVotes(this.sourcePosts[s].id);if(this.$parent.sessionDetailsStore.isLoggedIn==!0){await this.getTutorPosts(this.skillId);for(let s=0;s<this.tutorPosts.length;s++)await this.getTutorPostVotes(this.tutorPosts[s].id)}},methods:{async getUserId(){fetch("/get-session-details").then(function(s){return s.json()}).then(s=>this.user=s)},async getSourcePosts(s){await fetch("/skills/"+s+"/resources").then(function(t){return t.json()}).then(t=>{t.forEach(function(e){e.type="source"}),this.sourcePosts=t})},async getSourceVotes(s){await fetch("/user-votes/"+s).then(t=>t.json()).then(t=>{var e=t,i=0;let o=!1,r=!1;for(let c=0;c<e.length;c++)e[c].user_id==this.user.userId&&(e[c].vote==1?o=!0:e[c].vote==-1&&(r=!0)),i=i+e[c].vote;for(let c=0;c<this.sourcePosts.length;c++)this.sourcePosts[c].id==s&&(this.sourcePosts[c].voteCount=i,this.sourcePosts[c].userUpVote=o,this.sourcePosts[c].userDownVote=r)})},async getTutorPosts(s){await fetch("/tutor-posts/"+s+"/list").then(function(t){return t.json()}).then(t=>{t.forEach(e=>{e.type="tutor-post",e.contact_preference==null&&(e.contact_preference=e.email)});for(let e=0;e<t.length;e++)t[e].skill_id==this.skillId&&this.tutorPosts.push(t[e])})},async getTutorPostVotes(s){await fetch("/tutor-votes/"+s).then(t=>t.json()).then(t=>{var e=t,i=0;let o=!1,r=!1;for(let c=0;c<e.length;c++)e[c].user_id==this.user.userId&&(e[c].vote==1?o=!0:e[c].vote==-1&&(r=!0)),i=i+e[c].vote;for(let c=0;c<this.tutorPosts.length;c++)this.tutorPosts[c].id==s&&(this.tutorPosts[c].voteCount=i,this.tutorPosts[c].userUpVote=o,this.tutorPosts[c].userDownVote=r)})},deletePost(s){switch(this.showModal=!1,s.type){case"tutor-post":fetch("/tutor-posts/delete/"+s.id,{method:"DELETE"}).then(()=>{this.isAlreadyTutoring=!1}),this.tutorPosts=this.tutorPosts.filter(t=>t.id!==s.id);break;case"source":fetch("/resources/delete/"+s.id,{method:"DELETE"}),this.sourcePosts=this.sourcePosts.filter(t=>t.id!==s.id);break}},deleteTutorPost(s){this.showModal=!1,fetch("/tutor-posts/delete/"+s.id,{method:"DELETE"}).then(()=>{this.getS,this.isAlreadyTutoring=!1}),this.tutorPosts=this.tutorPosts.filter(t=>t.id!=s.id)},showWarningModal(s){this.source=s,this.showModal=!0},closeWarningModal(){this.showModal=!1},handleTabClick(s){switch(s){case"tutorPost":this.activeTab="tutorPost";break;case"resource":this.activeTab="resource";break;default:this.activeTab="allPost";break}}}},Pi=s=>(N("data-v-0b6b0c4b"),s=s(),z(),s),Oi={class:"container-fluid mt-4"},Di={class:"forum-header"},Bi=Pi(()=>n("h2",{class:"secondary-heading"},"Other Places To Learn This",-1)),Ei={key:0,class:"nav nav-tabs border-3"};function Ri(s,t,e,i,o,r){const c=y("ForumResource"),h=y("ForumTutorPost"),g=y("ForumAllPost"),d=y("FlagModals");return l(),a(S,null,[n("div",Oi,[n("div",Di,[Bi,s.$parent.sessionDetailsStore.isLoggedIn?(l(),a("ul",Ei,[n("li",{"b-on-hover":"",title:"All posts related to this skill",onClick:t[0]||(t[0]=w=>r.handleTabClick("allPost"))},[n("div",{class:k(["nav-link",o.activeTab==="allPost"&&"active"])}," All ",2)]),n("li",{"b-on-hover":"",title:"Only sources",onClick:t[1]||(t[1]=w=>r.handleTabClick("resource"))},[n("div",{class:k(["nav-link",o.activeTab==="resource"&&"active"])}," Sources ",2)]),n("li",{"b-on-hover":"",title:"Only potential tutors",onClick:t[2]||(t[2]=w=>r.handleTabClick("tutorPost"))},[n("div",{class:k(["nav-link",o.activeTab==="tutorPost"&&"active"])}," Tutors ",2)])])):u("",!0)]),o.activeTab==="resource"?(l(),m(c,{key:0,resourcePosts:o.sourcePosts,user:o.user,skillId:e.skillId},null,8,["resourcePosts","user","skillId"])):u("",!0),o.activeTab==="tutorPost"?(l(),m(h,{key:1,tutorPosts:o.tutorPosts,user:o.user,skillId:e.skillId},null,8,["tutorPosts","user","skillId"])):u("",!0),o.activeTab==="allPost"?(l(),m(g,{key:2,posts:r.posts,user:o.user,skillId:e.skillId,showTutorialTip6:e.showTutorialTip6,userRole:i.userDetailsStore.role,onProgressTutorial:t[3]||(t[3]=w=>s.$emit("progressTutorial",w))},null,8,["posts","user","skillId","showTutorialTip6","userRole"])):u("",!0)]),o.showFlaggingModal?(l(),m(d,{key:0,userId:i.userDetailsStore.userId,contentType:o.flagType,contentId:o.flagPost},null,8,["userId","contentType","contentId"])):u("",!0)],64)}const Vi=O(Ii,[["render",Ri],["__scopeId","data-v-0b6b0c4b"]]);const Hi={setup(){return{userDetailsStore:W()}},props:["tutorType","skill","skillLevel","learningObjectives"],data(){return{constraints:{audio:!0},chunks:[],micAllowed:!1,mediaRecorder:{},recording:!1,isLoading:!1}},methods:{allowMic(){navigator.mediaDevices&&navigator.mediaDevices.getUserMedia(this.constraints).then(s=>{this.mediaRecorder=new MediaRecorder(s),this.micAllowed=!0})},recordSpeech(){this.recording==!1?(this.mediaRecorder.start(),this.recording=!0):(this.mediaRecorder.stop(),this.recording=!1,this.isLoading=!0,this.mediaRecorder.ondataavailable=s=>{this.chunks.push(s.data);const t=new Blob(this.chunks,{type:"audio/webm; codecs=opus"});this.chunks=[];var e=new FileReader;e.readAsDataURL(t),e.onloadend=()=>{var i=e.result;this.sendAudioDataToServer(i)}})},async sendAudioDataToServer(s){try{const t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:this.userDetailsStore.userId,skillUrl:this.skill.url,skillName:this.skill.name,skillLevel:this.englishSkillLevel,learningObjectives:this.learningObjectives,audioData:s,tutorType:this.tutorType})};let i=await fetch("/ai-tutor/stt/convert",t);if(this.isLoading=!1,this.$parent.getChatHistory(),i.status===500){alert("The tutor can`t answer !!"),this.waitForAIresponse=!1;return}}catch(t){console.error(t)}}}},Ot=s=>(N("data-v-1502ef5d"),s=s(),z(),s),Ni={class:"d-flex justify-content-end"},zi={key:0},Fi=Ot(()=>n("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",width:"18",height:"18",fill:"black"},[n("path",{d:"M192 0C139 0 96 43 96 96l0 160c0 53 43 96 96 96s96-43 96-96l0-160c0-53-43-96-96-96zM64 216c0-13.3-10.7-24-24-24s-24 10.7-24 24l0 40c0 89.1 66.2 162.7 152 174.4l0 33.6-48 0c-13.3 0-24 10.7-24 24s10.7 24 24 24l72 0 72 0c13.3 0 24-10.7 24-24s-10.7-24-24-24l-48 0 0-33.6c85.8-11.7 152-85.3 152-174.4l0-40c0-13.3-10.7-24-24-24s-24 10.7-24 24l0 40c0 70.7-57.3 128-128 128s-128-57.3-128-128l0-40z"})],-1)),ji=[Fi],Ui={key:1},qi={key:2,class:"d-flex"},$i=Ot(()=>n("span",{class:"speech-loader"},null,-1)),Wi=[$i];function Ki(s,t,e,i,o,r){return l(),a("span",Ni,[n("span",null,[o.micAllowed?(l(),a("button",{key:1,class:k(["btn",{recording:o.recording==!0,"loader-background":o.isLoading==!0}]),onClick:t[1]||(t[1]=c=>r.recordSpeech())},[!o.recording&&!o.isLoading?(l(),a("span",zi,ji)):o.recording?(l(),a("span",Ui,"send")):o.isLoading?(l(),a("div",qi,Wi)):u("",!0)],2)):(l(),a("button",{key:0,class:"btn",onClick:t[0]||(t[0]=c=>r.allowMic())}," allow microphone "))])])}const Gi=O(Hi,[["render",Ki],["__scopeId","data-v-1502ef5d"]]),R=Object.create(null);R.open="0";R.close="1";R.ping="2";R.pong="3";R.message="4";R.upgrade="5";R.noop="6";const Y=Object.create(null);Object.keys(R).forEach(s=>{Y[R[s]]=s});const lt={type:"error",data:"parser error"},Dt=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",Bt=typeof ArrayBuffer=="function",Et=s=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(s):s&&s.buffer instanceof ArrayBuffer,ft=({type:s,data:t},e,i)=>Dt&&t instanceof Blob?e?i(t):vt(t,i):Bt&&(t instanceof ArrayBuffer||Et(t))?e?i(t):vt(new Blob([t]),i):i(R[s]+(t||"")),vt=(s,t)=>{const e=new FileReader;return e.onload=function(){const i=e.result.split(",")[1];t("b"+(i||""))},e.readAsDataURL(s)};function kt(s){return s instanceof Uint8Array?s:s instanceof ArrayBuffer?new Uint8Array(s):new Uint8Array(s.buffer,s.byteOffset,s.byteLength)}let et;function Yi(s,t){if(Dt&&s.data instanceof Blob)return s.data.arrayBuffer().then(kt).then(t);if(Bt&&(s.data instanceof ArrayBuffer||Et(s.data)))return t(kt(s.data));ft(s,!1,e=>{et||(et=new TextEncoder),t(et.encode(e))})}const bt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",q=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let s=0;s<bt.length;s++)q[bt.charCodeAt(s)]=s;const Ji=s=>{let t=s.length*.75,e=s.length,i,o=0,r,c,h,g;s[s.length-1]==="="&&(t--,s[s.length-2]==="="&&t--);const d=new ArrayBuffer(t),w=new Uint8Array(d);for(i=0;i<e;i+=4)r=q[s.charCodeAt(i)],c=q[s.charCodeAt(i+1)],h=q[s.charCodeAt(i+2)],g=q[s.charCodeAt(i+3)],w[o++]=r<<2|c>>4,w[o++]=(c&15)<<4|h>>2,w[o++]=(h&3)<<6|g&63;return d},Zi=typeof ArrayBuffer=="function",gt=(s,t)=>{if(typeof s!="string")return{type:"message",data:Rt(s,t)};const e=s.charAt(0);return e==="b"?{type:"message",data:Qi(s.substring(1),t)}:Y[e]?s.length>1?{type:Y[e],data:s.substring(1)}:{type:Y[e]}:lt},Qi=(s,t)=>{if(Zi){const e=Ji(s);return Rt(e,t)}else return{base64:!0,data:s}},Rt=(s,t)=>{switch(t){case"blob":return s instanceof Blob?s:new Blob([s]);case"arraybuffer":default:return s instanceof ArrayBuffer?s:s.buffer}},Vt=String.fromCharCode(30),Xi=(s,t)=>{const e=s.length,i=new Array(e);let o=0;s.forEach((r,c)=>{ft(r,!1,h=>{i[c]=h,++o===e&&t(i.join(Vt))})})},to=(s,t)=>{const e=s.split(Vt),i=[];for(let o=0;o<e.length;o++){const r=gt(e[o],t);if(i.push(r),r.type==="error")break}return i};function eo(){return new TransformStream({transform(s,t){Yi(s,e=>{const i=e.length;let o;if(i<126)o=new Uint8Array(1),new DataView(o.buffer).setUint8(0,i);else if(i<65536){o=new Uint8Array(3);const r=new DataView(o.buffer);r.setUint8(0,126),r.setUint16(1,i)}else{o=new Uint8Array(9);const r=new DataView(o.buffer);r.setUint8(0,127),r.setBigUint64(1,BigInt(i))}s.data&&typeof s.data!="string"&&(o[0]|=128),t.enqueue(o),t.enqueue(e)})}})}let st;function K(s){return s.reduce((t,e)=>t+e.length,0)}function G(s,t){if(s[0].length===t)return s.shift();const e=new Uint8Array(t);let i=0;for(let o=0;o<t;o++)e[o]=s[0][i++],i===s[0].length&&(s.shift(),i=0);return s.length&&i<s[0].length&&(s[0]=s[0].slice(i)),e}function so(s,t){st||(st=new TextDecoder);const e=[];let i=0,o=-1,r=!1;return new TransformStream({transform(c,h){for(e.push(c);;){if(i===0){if(K(e)<1)break;const g=G(e,1);r=(g[0]&128)===128,o=g[0]&127,o<126?i=3:o===126?i=1:i=2}else if(i===1){if(K(e)<2)break;const g=G(e,2);o=new DataView(g.buffer,g.byteOffset,g.length).getUint16(0),i=3}else if(i===2){if(K(e)<8)break;const g=G(e,8),d=new DataView(g.buffer,g.byteOffset,g.length),w=d.getUint32(0);if(w>Math.pow(2,53-32)-1){h.enqueue(lt);break}o=w*Math.pow(2,32)+d.getUint32(4),i=3}else{if(K(e)<o)break;const g=G(e,o);h.enqueue(gt(r?g:st.decode(g),t)),i=0}if(o===0||o>s){h.enqueue(lt);break}}}})}const Ht=4;function v(s){if(s)return io(s)}function io(s){for(var t in v.prototype)s[t]=v.prototype[t];return s}v.prototype.on=v.prototype.addEventListener=function(s,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+s]=this._callbacks["$"+s]||[]).push(t),this};v.prototype.once=function(s,t){function e(){this.off(s,e),t.apply(this,arguments)}return e.fn=t,this.on(s,e),this};v.prototype.off=v.prototype.removeListener=v.prototype.removeAllListeners=v.prototype.removeEventListener=function(s,t){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var e=this._callbacks["$"+s];if(!e)return this;if(arguments.length==1)return delete this._callbacks["$"+s],this;for(var i,o=0;o<e.length;o++)if(i=e[o],i===t||i.fn===t){e.splice(o,1);break}return e.length===0&&delete this._callbacks["$"+s],this};v.prototype.emit=function(s){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),e=this._callbacks["$"+s],i=1;i<arguments.length;i++)t[i-1]=arguments[i];if(e){e=e.slice(0);for(var i=0,o=e.length;i<o;++i)e[i].apply(this,t)}return this};v.prototype.emitReserved=v.prototype.emit;v.prototype.listeners=function(s){return this._callbacks=this._callbacks||{},this._callbacks["$"+s]||[]};v.prototype.hasListeners=function(s){return!!this.listeners(s).length};const X=(()=>typeof Promise=="function"&&typeof Promise.resolve=="function"?t=>Promise.resolve().then(t):(t,e)=>e(t,0))(),M=(()=>typeof self<"u"?self:typeof window<"u"?window:Function("return this")())(),oo="arraybuffer";function Nt(s,...t){return t.reduce((e,i)=>(s.hasOwnProperty(i)&&(e[i]=s[i]),e),{})}const no=M.setTimeout,ro=M.clearTimeout;function tt(s,t){t.useNativeTimers?(s.setTimeoutFn=no.bind(M),s.clearTimeoutFn=ro.bind(M)):(s.setTimeoutFn=M.setTimeout.bind(M),s.clearTimeoutFn=M.clearTimeout.bind(M))}const lo=1.33;function ao(s){return typeof s=="string"?co(s):Math.ceil((s.byteLength||s.size)*lo)}function co(s){let t=0,e=0;for(let i=0,o=s.length;i<o;i++)t=s.charCodeAt(i),t<128?e+=1:t<2048?e+=2:t<55296||t>=57344?e+=3:(i++,e+=4);return e}function zt(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function ho(s){let t="";for(let e in s)s.hasOwnProperty(e)&&(t.length&&(t+="&"),t+=encodeURIComponent(e)+"="+encodeURIComponent(s[e]));return t}function uo(s){let t={},e=s.split("&");for(let i=0,o=e.length;i<o;i++){let r=e[i].split("=");t[decodeURIComponent(r[0])]=decodeURIComponent(r[1])}return t}class po extends Error{constructor(t,e,i){super(t),this.description=e,this.context=i,this.type="TransportError"}}class _t extends v{constructor(t){super(),this.writable=!1,tt(this,t),this.opts=t,this.query=t.query,this.socket=t.socket,this.supportsBinary=!t.forceBase64}onError(t,e,i){return super.emitReserved("error",new po(t,e,i)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(t){this.readyState==="open"&&this.write(t)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(t){const e=gt(t,this.socket.binaryType);this.onPacket(e)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed",super.emitReserved("close",t)}pause(t){}createUri(t,e={}){return t+"://"+this._hostname()+this._port()+this.opts.path+this._query(e)}_hostname(){const t=this.opts.hostname;return t.indexOf(":")===-1?t:"["+t+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(t){const e=ho(t);return e.length?"?"+e:""}}class fo extends _t{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(t){this.readyState="pausing";const e=()=>{this.readyState="paused",t()};if(this._polling||!this.writable){let i=0;this._polling&&(i++,this.once("pollComplete",function(){--i||e()})),this.writable||(i++,this.once("drain",function(){--i||e()}))}else e()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(t){const e=i=>{if(this.readyState==="opening"&&i.type==="open"&&this.onOpen(),i.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(i)};to(t,this.socket.binaryType).forEach(e),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const t=()=>{this.write([{type:"close"}])};this.readyState==="open"?t():this.once("open",t)}write(t){this.writable=!1,Xi(t,e=>{this.doWrite(e,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const t=this.opts.secure?"https":"http",e=this.query||{};return this.opts.timestampRequests!==!1&&(e[this.opts.timestampParam]=zt()),!this.supportsBinary&&!e.sid&&(e.b64=1),this.createUri(t,e)}}let Ft=!1;try{Ft=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const go=Ft;function _o(){}class mo extends fo{constructor(t){if(super(t),typeof location<"u"){const e=location.protocol==="https:";let i=location.port;i||(i=e?"443":"80"),this.xd=typeof location<"u"&&t.hostname!==location.hostname||i!==t.port}}doWrite(t,e){const i=this.request({method:"POST",data:t});i.on("success",e),i.on("error",(o,r)=>{this.onError("xhr post error",o,r)})}doPoll(){const t=this.request();t.on("data",this.onData.bind(this)),t.on("error",(e,i)=>{this.onError("xhr poll error",e,i)}),this.pollXhr=t}}class B extends v{constructor(t,e,i){super(),this.createRequest=t,tt(this,i),this._opts=i,this._method=i.method||"GET",this._uri=e,this._data=i.data!==void 0?i.data:null,this._create()}_create(){var t;const e=Nt(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");e.xdomain=!!this._opts.xd;const i=this._xhr=this.createRequest(e);try{i.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){i.setDisableHeaderCheck&&i.setDisableHeaderCheck(!0);for(let o in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(o)&&i.setRequestHeader(o,this._opts.extraHeaders[o])}}catch{}if(this._method==="POST")try{i.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{i.setRequestHeader("Accept","*/*")}catch{}(t=this._opts.cookieJar)===null||t===void 0||t.addCookies(i),"withCredentials"in i&&(i.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(i.timeout=this._opts.requestTimeout),i.onreadystatechange=()=>{var o;i.readyState===3&&((o=this._opts.cookieJar)===null||o===void 0||o.parseCookies(i.getResponseHeader("set-cookie"))),i.readyState===4&&(i.status===200||i.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof i.status=="number"?i.status:0)},0))},i.send(this._data)}catch(o){this.setTimeoutFn(()=>{this._onError(o)},0);return}typeof document<"u"&&(this._index=B.requestsCount++,B.requests[this._index]=this)}_onError(t){this.emitReserved("error",t,this._xhr),this._cleanup(!0)}_cleanup(t){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=_o,t)try{this._xhr.abort()}catch{}typeof document<"u"&&delete B.requests[this._index],this._xhr=null}}_onLoad(){const t=this._xhr.responseText;t!==null&&(this.emitReserved("data",t),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}B.requestsCount=0;B.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",Tt);else if(typeof addEventListener=="function"){const s="onpagehide"in M?"pagehide":"unload";addEventListener(s,Tt,!1)}}function Tt(){for(let s in B.requests)B.requests.hasOwnProperty(s)&&B.requests[s].abort()}const yo=function(){const s=jt({xdomain:!1});return s&&s.responseType!==null}();class wo extends mo{constructor(t){super(t);const e=t&&t.forceBase64;this.supportsBinary=yo&&!e}request(t={}){return Object.assign(t,{xd:this.xd},this.opts),new B(jt,this.uri(),t)}}function jt(s){const t=s.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!t||go))return new XMLHttpRequest}catch{}if(!t)try{return new M[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const Ut=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class vo extends _t{get name(){return"websocket"}doOpen(){const t=this.uri(),e=this.opts.protocols,i=Ut?{}:Nt(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(i.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(t,e,i)}catch(o){return this.emitReserved("error",o)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t}),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let e=0;e<t.length;e++){const i=t[e],o=e===t.length-1;ft(i,this.supportsBinary,r=>{try{this.doWrite(i,r)}catch{}o&&X(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const t=this.opts.secure?"wss":"ws",e=this.query||{};return this.opts.timestampRequests&&(e[this.opts.timestampParam]=zt()),this.supportsBinary||(e.b64=1),this.createUri(t,e)}}const it=M.WebSocket||M.MozWebSocket;class ko extends vo{createSocket(t,e,i){return Ut?new it(t,e,i):e?new it(t,e):new it(t)}doWrite(t,e){this.ws.send(e)}}class bo extends _t{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(t){return this.emitReserved("error",t)}this._transport.closed.then(()=>{this.onClose()}).catch(t=>{this.onError("webtransport error",t)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(t=>{const e=so(Number.MAX_SAFE_INTEGER,this.socket.binaryType),i=t.readable.pipeThrough(e).getReader(),o=eo();o.readable.pipeTo(t.writable),this._writer=o.writable.getWriter();const r=()=>{i.read().then(({done:h,value:g})=>{h||(this.onPacket(g),r())}).catch(h=>{})};r();const c={type:"open"};this.query.sid&&(c.data=`{"sid":"${this.query.sid}"}`),this._writer.write(c).then(()=>this.onOpen())})})}write(t){this.writable=!1;for(let e=0;e<t.length;e++){const i=t[e],o=e===t.length-1;this._writer.write(i).then(()=>{o&&X(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var t;(t=this._transport)===null||t===void 0||t.close()}}const To={websocket:ko,webtransport:bo,polling:wo},Co=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,xo=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function at(s){if(s.length>8e3)throw"URI too long";const t=s,e=s.indexOf("["),i=s.indexOf("]");e!=-1&&i!=-1&&(s=s.substring(0,e)+s.substring(e,i).replace(/:/g,";")+s.substring(i,s.length));let o=Co.exec(s||""),r={},c=14;for(;c--;)r[xo[c]]=o[c]||"";return e!=-1&&i!=-1&&(r.source=t,r.host=r.host.substring(1,r.host.length-1).replace(/;/g,":"),r.authority=r.authority.replace("[","").replace("]","").replace(/;/g,":"),r.ipv6uri=!0),r.pathNames=So(r,r.path),r.queryKey=Lo(r,r.query),r}function So(s,t){const e=/\/{2,9}/g,i=t.replace(e,"/").split("/");return(t.slice(0,1)=="/"||t.length===0)&&i.splice(0,1),t.slice(-1)=="/"&&i.splice(i.length-1,1),i}function Lo(s,t){const e={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(i,o,r){o&&(e[o]=r)}),e}const ct=typeof addEventListener=="function"&&typeof removeEventListener=="function",J=[];ct&&addEventListener("offline",()=>{J.forEach(s=>s())},!1);class H extends v{constructor(t,e){if(super(),this.binaryType=oo,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,t&&typeof t=="object"&&(e=t,t=null),t){const i=at(t);e.hostname=i.host,e.secure=i.protocol==="https"||i.protocol==="wss",e.port=i.port,i.query&&(e.query=i.query)}else e.host&&(e.hostname=at(e.host).host);tt(this,e),this.secure=e.secure!=null?e.secure:typeof location<"u"&&location.protocol==="https:",e.hostname&&!e.port&&(e.port=this.secure?"443":"80"),this.hostname=e.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=e.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},e.transports.forEach(i=>{const o=i.prototype.name;this.transports.push(o),this._transportsByName[o]=i}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},e),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=uo(this.opts.query)),ct&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},J.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(t){const e=Object.assign({},this.opts.query);e.EIO=Ht,e.transport=t,this.id&&(e.sid=this.id);const i=Object.assign({},this.opts,{query:e,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[t]);return new this._transportsByName[t](i)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const t=this.opts.rememberUpgrade&&H.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const e=this.createTransport(t);e.open(),this.setTransport(e)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",e=>this._onClose("transport close",e))}onOpen(){this.readyState="open",H.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const e=new Error("server error");e.code=t.data,this._onError(e);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data);break}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this._pingInterval=t.pingInterval,this._pingTimeout=t.pingTimeout,this._maxPayload=t.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const t=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+t,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},t),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const t=this._getWritablePackets();this.transport.send(t),this._prevBufferLen=t.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let e=1;for(let i=0;i<this.writeBuffer.length;i++){const o=this.writeBuffer[i].data;if(o&&(e+=ao(o)),i>0&&e>this._maxPayload)return this.writeBuffer.slice(0,i);e+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const t=Date.now()>this._pingTimeoutTime;return t&&(this._pingTimeoutTime=0,X(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),t}write(t,e,i){return this._sendPacket("message",t,e,i),this}send(t,e,i){return this._sendPacket("message",t,e,i),this}_sendPacket(t,e,i,o){if(typeof e=="function"&&(o=e,e=void 0),typeof i=="function"&&(o=i,i=null),this.readyState==="closing"||this.readyState==="closed")return;i=i||{},i.compress=i.compress!==!1;const r={type:t,data:e,options:i};this.emitReserved("packetCreate",r),this.writeBuffer.push(r),o&&this.once("flush",o),this.flush()}close(){const t=()=>{this._onClose("forced close"),this.transport.close()},e=()=>{this.off("upgrade",e),this.off("upgradeError",e),t()},i=()=>{this.once("upgrade",e),this.once("upgradeError",e)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?i():t()}):this.upgrading?i():t()),this}_onError(t){if(H.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",t),this._onClose("transport error",t)}_onClose(t,e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),ct&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const i=J.indexOf(this._offlineEventListener);i!==-1&&J.splice(i,1)}this.readyState="closed",this.id=null,this.emitReserved("close",t,e),this.writeBuffer=[],this._prevBufferLen=0}}}H.protocol=Ht;class Mo extends H{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let t=0;t<this._upgrades.length;t++)this._probe(this._upgrades[t])}_probe(t){let e=this.createTransport(t),i=!1;H.priorWebsocketSuccess=!1;const o=()=>{i||(e.send([{type:"ping",data:"probe"}]),e.once("packet",I=>{if(!i)if(I.type==="pong"&&I.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",e),!e)return;H.priorWebsocketSuccess=e.name==="websocket",this.transport.pause(()=>{i||this.readyState!=="closed"&&(w(),this.setTransport(e),e.send([{type:"upgrade"}]),this.emitReserved("upgrade",e),e=null,this.upgrading=!1,this.flush())})}else{const p=new Error("probe error");p.transport=e.name,this.emitReserved("upgradeError",p)}}))};function r(){i||(i=!0,w(),e.close(),e=null)}const c=I=>{const p=new Error("probe error: "+I);p.transport=e.name,r(),this.emitReserved("upgradeError",p)};function h(){c("transport closed")}function g(){c("socket closed")}function d(I){e&&I.name!==e.name&&r()}const w=()=>{e.removeListener("open",o),e.removeListener("error",c),e.removeListener("close",h),this.off("close",g),this.off("upgrading",d)};e.once("open",o),e.once("error",c),e.once("close",h),this.once("close",g),this.once("upgrading",d),this._upgrades.indexOf("webtransport")!==-1&&t!=="webtransport"?this.setTimeoutFn(()=>{i||e.open()},200):e.open()}onHandshake(t){this._upgrades=this._filterUpgrades(t.upgrades),super.onHandshake(t)}_filterUpgrades(t){const e=[];for(let i=0;i<t.length;i++)~this.transports.indexOf(t[i])&&e.push(t[i]);return e}}let Ao=class extends Mo{constructor(t,e={}){const i=typeof t=="object"?t:e;(!i.transports||i.transports&&typeof i.transports[0]=="string")&&(i.transports=(i.transports||["polling","websocket","webtransport"]).map(o=>To[o]).filter(o=>!!o)),super(t,i)}};function Io(s,t="",e){let i=s;e=e||typeof location<"u"&&location,s==null&&(s=e.protocol+"//"+e.host),typeof s=="string"&&(s.charAt(0)==="/"&&(s.charAt(1)==="/"?s=e.protocol+s:s=e.host+s),/^(https?|wss?):\/\//.test(s)||(typeof e<"u"?s=e.protocol+"//"+s:s="https://"+s),i=at(s)),i.port||(/^(http|ws)$/.test(i.protocol)?i.port="80":/^(http|ws)s$/.test(i.protocol)&&(i.port="443")),i.path=i.path||"/";const r=i.host.indexOf(":")!==-1?"["+i.host+"]":i.host;return i.id=i.protocol+"://"+r+":"+i.port+t,i.href=i.protocol+"://"+r+(e&&e.port===i.port?"":":"+i.port),i}const Po=typeof ArrayBuffer=="function",Oo=s=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(s):s.buffer instanceof ArrayBuffer,qt=Object.prototype.toString,Do=typeof Blob=="function"||typeof Blob<"u"&&qt.call(Blob)==="[object BlobConstructor]",Bo=typeof File=="function"||typeof File<"u"&&qt.call(File)==="[object FileConstructor]";function mt(s){return Po&&(s instanceof ArrayBuffer||Oo(s))||Do&&s instanceof Blob||Bo&&s instanceof File}function Z(s,t){if(!s||typeof s!="object")return!1;if(Array.isArray(s)){for(let e=0,i=s.length;e<i;e++)if(Z(s[e]))return!0;return!1}if(mt(s))return!0;if(s.toJSON&&typeof s.toJSON=="function"&&arguments.length===1)return Z(s.toJSON(),!0);for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e)&&Z(s[e]))return!0;return!1}function Eo(s){const t=[],e=s.data,i=s;return i.data=ht(e,t),i.attachments=t.length,{packet:i,buffers:t}}function ht(s,t){if(!s)return s;if(mt(s)){const e={_placeholder:!0,num:t.length};return t.push(s),e}else if(Array.isArray(s)){const e=new Array(s.length);for(let i=0;i<s.length;i++)e[i]=ht(s[i],t);return e}else if(typeof s=="object"&&!(s instanceof Date)){const e={};for(const i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=ht(s[i],t));return e}return s}function Ro(s,t){return s.data=ut(s.data,t),delete s.attachments,s}function ut(s,t){if(!s)return s;if(s&&s._placeholder===!0){if(typeof s.num=="number"&&s.num>=0&&s.num<t.length)return t[s.num];throw new Error("illegal attachments")}else if(Array.isArray(s))for(let e=0;e<s.length;e++)s[e]=ut(s[e],t);else if(typeof s=="object")for(const e in s)Object.prototype.hasOwnProperty.call(s,e)&&(s[e]=ut(s[e],t));return s}const Vo=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],Ho=5;var _;(function(s){s[s.CONNECT=0]="CONNECT",s[s.DISCONNECT=1]="DISCONNECT",s[s.EVENT=2]="EVENT",s[s.ACK=3]="ACK",s[s.CONNECT_ERROR=4]="CONNECT_ERROR",s[s.BINARY_EVENT=5]="BINARY_EVENT",s[s.BINARY_ACK=6]="BINARY_ACK"})(_||(_={}));class No{constructor(t){this.replacer=t}encode(t){return(t.type===_.EVENT||t.type===_.ACK)&&Z(t)?this.encodeAsBinary({type:t.type===_.EVENT?_.BINARY_EVENT:_.BINARY_ACK,nsp:t.nsp,data:t.data,id:t.id}):[this.encodeAsString(t)]}encodeAsString(t){let e=""+t.type;return(t.type===_.BINARY_EVENT||t.type===_.BINARY_ACK)&&(e+=t.attachments+"-"),t.nsp&&t.nsp!=="/"&&(e+=t.nsp+","),t.id!=null&&(e+=t.id),t.data!=null&&(e+=JSON.stringify(t.data,this.replacer)),e}encodeAsBinary(t){const e=Eo(t),i=this.encodeAsString(e.packet),o=e.buffers;return o.unshift(i),o}}function Ct(s){return Object.prototype.toString.call(s)==="[object Object]"}class yt extends v{constructor(t){super(),this.reviver=t}add(t){let e;if(typeof t=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");e=this.decodeString(t);const i=e.type===_.BINARY_EVENT;i||e.type===_.BINARY_ACK?(e.type=i?_.EVENT:_.ACK,this.reconstructor=new zo(e),e.attachments===0&&super.emitReserved("decoded",e)):super.emitReserved("decoded",e)}else if(mt(t)||t.base64)if(this.reconstructor)e=this.reconstructor.takeBinaryData(t),e&&(this.reconstructor=null,super.emitReserved("decoded",e));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+t)}decodeString(t){let e=0;const i={type:Number(t.charAt(0))};if(_[i.type]===void 0)throw new Error("unknown packet type "+i.type);if(i.type===_.BINARY_EVENT||i.type===_.BINARY_ACK){const r=e+1;for(;t.charAt(++e)!=="-"&&e!=t.length;);const c=t.substring(r,e);if(c!=Number(c)||t.charAt(e)!=="-")throw new Error("Illegal attachments");i.attachments=Number(c)}if(t.charAt(e+1)==="/"){const r=e+1;for(;++e&&!(t.charAt(e)===","||e===t.length););i.nsp=t.substring(r,e)}else i.nsp="/";const o=t.charAt(e+1);if(o!==""&&Number(o)==o){const r=e+1;for(;++e;){const c=t.charAt(e);if(c==null||Number(c)!=c){--e;break}if(e===t.length)break}i.id=Number(t.substring(r,e+1))}if(t.charAt(++e)){const r=this.tryParse(t.substr(e));if(yt.isPayloadValid(i.type,r))i.data=r;else throw new Error("invalid payload")}return i}tryParse(t){try{return JSON.parse(t,this.reviver)}catch{return!1}}static isPayloadValid(t,e){switch(t){case _.CONNECT:return Ct(e);case _.DISCONNECT:return e===void 0;case _.CONNECT_ERROR:return typeof e=="string"||Ct(e);case _.EVENT:case _.BINARY_EVENT:return Array.isArray(e)&&(typeof e[0]=="number"||typeof e[0]=="string"&&Vo.indexOf(e[0])===-1);case _.ACK:case _.BINARY_ACK:return Array.isArray(e)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class zo{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){const e=Ro(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const Fo=Object.freeze(Object.defineProperty({__proto__:null,Decoder:yt,Encoder:No,get PacketType(){return _},protocol:Ho},Symbol.toStringTag,{value:"Module"}));function P(s,t,e){return s.on(t,e),function(){s.off(t,e)}}const jo=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class $t extends v{constructor(t,e,i){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=e,i&&i.auth&&(this.auth=i.auth),this._opts=Object.assign({},i),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const t=this.io;this.subs=[P(t,"open",this.onopen.bind(this)),P(t,"packet",this.onpacket.bind(this)),P(t,"error",this.onerror.bind(this)),P(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...e){var i,o,r;if(jo.hasOwnProperty(t))throw new Error('"'+t.toString()+'" is a reserved event name');if(e.unshift(t),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(e),this;const c={type:_.EVENT,data:e};if(c.options={},c.options.compress=this.flags.compress!==!1,typeof e[e.length-1]=="function"){const w=this.ids++,I=e.pop();this._registerAckCallback(w,I),c.id=w}const h=(o=(i=this.io.engine)===null||i===void 0?void 0:i.transport)===null||o===void 0?void 0:o.writable,g=this.connected&&!(!((r=this.io.engine)===null||r===void 0)&&r._hasPingExpired());return this.flags.volatile&&!h||(g?(this.notifyOutgoingListeners(c),this.packet(c)):this.sendBuffer.push(c)),this.flags={},this}_registerAckCallback(t,e){var i;const o=(i=this.flags.timeout)!==null&&i!==void 0?i:this._opts.ackTimeout;if(o===void 0){this.acks[t]=e;return}const r=this.io.setTimeoutFn(()=>{delete this.acks[t];for(let h=0;h<this.sendBuffer.length;h++)this.sendBuffer[h].id===t&&this.sendBuffer.splice(h,1);e.call(this,new Error("operation has timed out"))},o),c=(...h)=>{this.io.clearTimeoutFn(r),e.apply(this,h)};c.withError=!0,this.acks[t]=c}emitWithAck(t,...e){return new Promise((i,o)=>{const r=(c,h)=>c?o(c):i(h);r.withError=!0,e.push(r),this.emit(t,...e)})}_addToQueue(t){let e;typeof t[t.length-1]=="function"&&(e=t.pop());const i={id:this._queueSeq++,tryCount:0,pending:!1,args:t,flags:Object.assign({fromQueue:!0},this.flags)};t.push((o,...r)=>i!==this._queue[0]?void 0:(o!==null?i.tryCount>this._opts.retries&&(this._queue.shift(),e&&e(o)):(this._queue.shift(),e&&e(null,...r)),i.pending=!1,this._drainQueue())),this._queue.push(i),this._drainQueue()}_drainQueue(t=!1){if(!this.connected||this._queue.length===0)return;const e=this._queue[0];e.pending&&!t||(e.pending=!0,e.tryCount++,this.flags=e.flags,this.emit.apply(this,e.args))}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){typeof this.auth=="function"?this.auth(t=>{this._sendConnectPacket(t)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(t){this.packet({type:_.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},t):t})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t,e){this.connected=!1,delete this.id,this.emitReserved("disconnect",t,e),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(t=>{if(!this.sendBuffer.some(i=>String(i.id)===t)){const i=this.acks[t];delete this.acks[t],i.withError&&i.call(this,new Error("socket has been disconnected"))}})}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case _.CONNECT:t.data&&t.data.sid?this.onconnect(t.data.sid,t.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case _.EVENT:case _.BINARY_EVENT:this.onevent(t);break;case _.ACK:case _.BINARY_ACK:this.onack(t);break;case _.DISCONNECT:this.ondisconnect();break;case _.CONNECT_ERROR:this.destroy();const i=new Error(t.data.message);i.data=t.data.data,this.emitReserved("connect_error",i);break}}onevent(t){const e=t.data||[];t.id!=null&&e.push(this.ack(t.id)),this.connected?this.emitEvent(e):this.receiveBuffer.push(Object.freeze(e))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const e=this._anyListeners.slice();for(const i of e)i.apply(this,t)}super.emit.apply(this,t),this._pid&&t.length&&typeof t[t.length-1]=="string"&&(this._lastOffset=t[t.length-1])}ack(t){const e=this;let i=!1;return function(...o){i||(i=!0,e.packet({type:_.ACK,id:t,data:o}))}}onack(t){const e=this.acks[t.id];typeof e=="function"&&(delete this.acks[t.id],e.withError&&t.data.unshift(null),e.apply(this,t.data))}onconnect(t,e){this.id=t,this.recovered=e&&this._pid===e,this._pid=e,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(t=>this.emitEvent(t)),this.receiveBuffer=[],this.sendBuffer.forEach(t=>{this.notifyOutgoingListeners(t),this.packet(t)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(t=>t()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:_.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}timeout(t){return this.flags.timeout=t,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){const e=this._anyListeners;for(let i=0;i<e.length;i++)if(t===e[i])return e.splice(i,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(t),this}prependAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(t),this}offAnyOutgoing(t){if(!this._anyOutgoingListeners)return this;if(t){const e=this._anyOutgoingListeners;for(let i=0;i<e.length;i++)if(t===e[i])return e.splice(i,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const e=this._anyOutgoingListeners.slice();for(const i of e)i.apply(this,t.data)}}}function F(s){s=s||{},this.ms=s.min||100,this.max=s.max||1e4,this.factor=s.factor||2,this.jitter=s.jitter>0&&s.jitter<=1?s.jitter:0,this.attempts=0}F.prototype.duration=function(){var s=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),e=Math.floor(t*this.jitter*s);s=Math.floor(t*10)&1?s+e:s-e}return Math.min(s,this.max)|0};F.prototype.reset=function(){this.attempts=0};F.prototype.setMin=function(s){this.ms=s};F.prototype.setMax=function(s){this.max=s};F.prototype.setJitter=function(s){this.jitter=s};class dt extends v{constructor(t,e){var i;super(),this.nsps={},this.subs=[],t&&typeof t=="object"&&(e=t,t=void 0),e=e||{},e.path=e.path||"/socket.io",this.opts=e,tt(this,e),this.reconnection(e.reconnection!==!1),this.reconnectionAttempts(e.reconnectionAttempts||1/0),this.reconnectionDelay(e.reconnectionDelay||1e3),this.reconnectionDelayMax(e.reconnectionDelayMax||5e3),this.randomizationFactor((i=e.randomizationFactor)!==null&&i!==void 0?i:.5),this.backoff=new F({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(e.timeout==null?2e4:e.timeout),this._readyState="closed",this.uri=t;const o=e.parser||Fo;this.encoder=new o.Encoder,this.decoder=new o.Decoder,this._autoConnect=e.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,t||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(t){return t===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var e;return t===void 0?this._reconnectionDelay:(this._reconnectionDelay=t,(e=this.backoff)===null||e===void 0||e.setMin(t),this)}randomizationFactor(t){var e;return t===void 0?this._randomizationFactor:(this._randomizationFactor=t,(e=this.backoff)===null||e===void 0||e.setJitter(t),this)}reconnectionDelayMax(t){var e;return t===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,(e=this.backoff)===null||e===void 0||e.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new Ao(this.uri,this.opts);const e=this.engine,i=this;this._readyState="opening",this.skipReconnect=!1;const o=P(e,"open",function(){i.onopen(),t&&t()}),r=h=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",h),t?t(h):this.maybeReconnectOnOpen()},c=P(e,"error",r);if(this._timeout!==!1){const h=this._timeout,g=this.setTimeoutFn(()=>{o(),r(new Error("timeout")),e.close()},h);this.opts.autoUnref&&g.unref(),this.subs.push(()=>{this.clearTimeoutFn(g)})}return this.subs.push(o),this.subs.push(c),this}connect(t){return this.open(t)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const t=this.engine;this.subs.push(P(t,"ping",this.onping.bind(this)),P(t,"data",this.ondata.bind(this)),P(t,"error",this.onerror.bind(this)),P(t,"close",this.onclose.bind(this)),P(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){try{this.decoder.add(t)}catch(e){this.onclose("parse error",e)}}ondecoded(t){X(()=>{this.emitReserved("packet",t)},this.setTimeoutFn)}onerror(t){this.emitReserved("error",t)}socket(t,e){let i=this.nsps[t];return i?this._autoConnect&&!i.active&&i.connect():(i=new $t(this,t,e),this.nsps[t]=i),i}_destroy(t){const e=Object.keys(this.nsps);for(const i of e)if(this.nsps[i].active)return;this._close()}_packet(t){const e=this.encoder.encode(t);for(let i=0;i<e.length;i++)this.engine.write(e[i],t.options)}cleanup(){this.subs.forEach(t=>t()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(t,e){var i;this.cleanup(),(i=this.engine)===null||i===void 0||i.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t,e),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const e=this.backoff.duration();this._reconnecting=!0;const i=this.setTimeoutFn(()=>{t.skipReconnect||(this.emitReserved("reconnect_attempt",t.backoff.attempts),!t.skipReconnect&&t.open(o=>{o?(t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",o)):t.onreconnect()}))},e);this.opts.autoUnref&&i.unref(),this.subs.push(()=>{this.clearTimeoutFn(i)})}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}}const U={};function Q(s,t){typeof s=="object"&&(t=s,s=void 0),t=t||{};const e=Io(s,t.path||"/socket.io"),i=e.source,o=e.id,r=e.path,c=U[o]&&r in U[o].nsps,h=t.forceNew||t["force new connection"]||t.multiplex===!1||c;let g;return h?g=new dt(i,t):(U[o]||(U[o]=new dt(i,t)),g=U[o]),e.query&&!t.query&&(t.query=e.queryKey),g.socket(e.path,t)}Object.assign(Q,{Manager:dt,Socket:$t,io:Q,connect:Q});const C=Jt({connected:!1,assistantData:[],streamingMessage:"",isStreaming:!1,isRunJustEnded:!1,isStudentMasteredSkill:!1,streamType:"aiTutor"}),Uo=void 0,A=Q(Uo);A.on("connect",()=>{C.connected=!0,console.log("Connect to server")});A.on("disconnect",()=>{C.connected=!1,console.log("Disconnect from server")});A.on("stream-message",(...s)=>{C.isRunJustEnded=!1,C.isStreaming=!0,C.streamingMessage=C.streamingMessage+s[0].value,C.streamType=s[1]});A.on("run-end",(...s)=>{C.isStreaming=!1,C.isRunJustEnded=!0});const qo={setup(){const s=W(),t=xt(),e=St();return{stateOfSocket:C,userDetailsStore:s,userSkillsStore:t,skillTreeStore:e}},props:["skill"],components:{TutorLoadingSymbol:Mt,TooltipBtn:ee,SpeechRecorder:Gi},data(){return{message:"",socraticTutorChatHistory:[],assessingTutorChatHistory:[],transcriptForAssessment:[],chatHistory:[],waitForAIresponse:!1,mode:"big",englishSkillLevel:"",learningObjectives:[],tutorType:"socratic",showChat:!0,isTextToSpeech:!0,threadID:"",audio:null,isAudioPlaying:!1,isSuggestedInteraction:!1,assistantData:{assistantId:null,threadId:null}}},async created(){this.connectToSocketSever()},async mounted(){this.learningObjectives=this.skill.learningObjectives.map(s=>s.objective),this.englishSkillLevel=this.skill.level.replace("_"," "),await this.getChatHistory()},methods:{handleKeyDown(s){s.shiftKey||(s.preventDefault(),this.sendMessage())},async changeTutorType(s){this.tutorType=s,await this.getChatHistory(),s=="socratic"?this.chatHistory=this.socraticTutorChatHistory:s=="assessing"&&(this.chatHistory=this.assessingTutorChatHistory),console.log(this.chatHistory)},async getChatHistory(){try{const s={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:this.userDetailsStore.userId,skillName:this.skill.name,skillUrl:this.skill.url,skillLevel:this.englishSkillLevel,learningObjectives:this.learningObjectives})};let t="";this.tutorType=="socratic"?t="/ai-tutor/socratic/messages-list":this.tutorType=="assessing"&&(t="/ai-tutor/assessing/messages-list");const i=await(await fetch(t,s)).json();this.assistantData.assistantId=i.assistantData.assistantId,this.assistantData.threadId=i.assistantData.threadId,this.tutorType=="socratic"?(this.socraticTutorChatHistory=i.messages,this.chatHistory=this.socraticTutorChatHistory):this.tutorType=="assessing"&&(this.assessingTutorChatHistory=i.messages,this.chatHistory=this.assessingTutorChatHistory,this.chatHistory.length>=this.learningObjectives.length*2&&this.assessMastery()),this.chatHistory.length>0&&(this.threadID=this.chatHistory[0].thread_id)}catch(s){console.error(s)}},async generateAudio(s,t){for(let r=0;r<this.chatHistory.length;r++)this.chatHistory[r].index==s&&(this.chatHistory[r].isAudioGenerating=!0);const e={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:t,messageNumber:s,threadID:this.threadID})};let i="";this.tutorType=="socratic"?i="/ai-tutor/socratic/generate-tts":i="/ai-tutor/assessing/generate-tts",await(await fetch(i,e)).json();for(let r=0;r<this.chatHistory.length;r++)this.chatHistory[r].index==s&&(this.chatHistory[r].isAudioGenerating=!1,this.chatHistory[r].hasAudio=!0);this.getChatHistory()},playAudio(s){if(this.isAudioPlaying==!0)this.isAudioPlaying=!1,this.audio.pause();else{let t=`https://institute-${this.tutorType}-tutor-tts-urls.s3.us-east-1.amazonaws.com/${this.threadID}-${s}.mp3`;this.audio=new Audio(t),this.isAudioPlaying=!0,this.audio.play()}},async sendMessage(){if(this.waitForAIresponse)return;function s(t){return t===null||t.match(/^ *$/)!==null}if(s(this.message)){this.askQuestion();return}this.waitForAIresponse=!0;try{let t="";this.isSuggestedInteraction==!1&&(t="Please keep all responses succinct."),this.isSuggestedInteraction=!1;let e="new-message";const i={role:"user",content:[{text:{value:this.message}}]};typeof this.chatHistory.length>"u"?(this.chatHistory=[],this.chatHistory.push(i)):this.chatHistory.unshift(i);const o={threadId:this.assistantData.threadId,assistantId:this.assistantData.assistantId,tutorType:this.tutorType,skillName:this.skill.name,skillLevel:this.skillLevel,learningObjectives:this.learningObjectives,responseLength:t,message:this.message};this.message="",A.emit(e,o)}catch(t){console.error(t),this.waitForAIresponse=!1}},async askQuestion(){if(!this.waitForAIresponse){this.waitForAIresponse=!0;try{let s="ask-question";const t={tutorType:this.tutorType,skillLevel:this.skill.level,learningObjectives:this.learningObjectives,threadId:this.assistantData.threadId,assistantId:this.assistantData.assistantId,message:""};A.emit(s,t),this.message=""}catch(s){console.error(s),this.waitForAIresponse=!1}}},async assessMastery(){for(let s=0;s<this.assessingTutorChatHistory.length;s++){let t=this.assessingTutorChatHistory[s];if(t.role=="assistant"){let i={examiner:t.content[0].text.value};this.transcriptForAssessment.push(i)}else if(t.role=="user"){let i={student:t.content[0].text.value};this.transcriptForAssessment.push(i)}}this.transcriptForAssessment=this.transcriptForAssessment.reverse();try{const s={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:this.userDetailsStore.userId,skillName:this.skill.name,skillUrl:this.skill.url,skillLevel:this.englishSkillLevel,learningObjectives:this.learningObjectives,transcriptForAssessment:this.transcriptForAssessment})},e=await fetch("/ai-tutor/assessing/assess",s);if(e.status===500)return;(await e.json()).result.result>=70&&this.makeMastered(),this.waitForAIresponse=!1}catch(s){console.error(s),this.waitForAIresponse=!1}},applyMarkDownFormatting(s){return window.markdownit({breaks:!0}).use(window.texmath,{engine:katex,delimiters:["brackets","dollars"],katexOptions:{macros:{"\\RR":"\\mathbb{R}"}}}).render(s)},scrollToMessageInput(){let s=this.$refs.messageInputDiv;s.scrollTop=s.scrollHeight},async makeMastered(){alert("Congratulations, you have mastered this skill!"),await this.userSkillsStore.MakeMastered(this.userDetailsStore.userId,this.skill.id,this.skill.name,this.skill.level,this.skill.url,s=>{})},connectToSocketSever(){A.connect()},disconnectToSocketSever(){console.log("disconnect"),A.disconnect()},createChatStream(){console.log("create-stream"),A.emit("create-stream",this.userDetailsStore.userId,this.skill.id,this.skill.name,this.skill.level,this.skill.url,s=>{})},removeStreamMessage(){C.streamType="pause",C.streamingMessage=""}},watch:{stateOfSocket:{async handler(s,t){if(s.streamType==="aiTutor"&&(s.isStreaming&&(this.waitForAIresponse=!1),!s.isStreaming&&s.isRunJustEnded)){const e={role:"assistant",content:[{text:{value:this.stateOfSocket.streamingMessage},type:"text"}]};this.removeStreamMessage(),typeof this.chatHistory.length>"u"?(this.chatHistory=[],this.chatHistory.push(e)):this.chatHistory.unshift(e);let i=this.chatHistory.reverse();for(let o=0;o<i.length;o++)i[o].index=o;this.chatHistory=i.reverse(),this.getChatHistory()}},deep:!0}}},L=s=>(N("data-v-8b19381f"),s=s(),z(),s),$o={class:"d-flex flex-column flex-md-row gap-2 align-items-baseline mb-1"},Wo={class:"d-flex flex-row w-100 justify-content-between"},Ko={class:"d-flex gap-2"},Go=L(()=>n("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",class:"primary-icon",width:"17",height:"17"},[n("path",{d:"M32 32C32 14.3 46.3 0 64 0L320 0c17.7 0 32 14.3 32 32s-14.3 32-32 32l-29.5 0 11.4 148.2c36.7 19.9 65.7 53.2 79.5 94.7l1 3c3.3 9.8 1.6 20.5-4.4 28.8s-15.7 13.3-26 13.3L32 352c-10.3 0-19.9-4.9-26-13.3s-7.7-19.1-4.4-28.8l1-3c13.8-41.5 42.8-74.8 79.5-94.7L93.5 64 64 64C46.3 64 32 49.7 32 32zM160 384l64 0 0 96c0 17.7-14.3 32-32 32s-32-14.3-32-32l0-96z"})],-1)),Yo=[Go],Jo=L(()=>n("h2",{class:"secondary-heading"},"AI tutor",-1)),Zo={class:"d-flex gap-2"},Qo={tile:"Expand chat component","b-tooltip.hover":""},Xo=L(()=>n("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",height:"25",width:"25",fill:"#5f31dd"},[n("path",{d:"M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zm11.3-395.3l112 112c4.6 4.6 5.9 11.5 3.5 17.4s-8.3 9.9-14.8 9.9l-64 0 0 96c0 17.7-14.3 32-32 32l-32 0c-17.7 0-32-14.3-32-32l0-96-64 0c-6.5 0-12.3-3.9-14.8-9.9s-1.1-12.9 3.5-17.4l112-112c6.2-6.2 16.4-6.2 22.6 0z"})],-1)),tn=[Xo],en={tile:"Hide chat component","b-tooltip.hover":""},sn=L(()=>n("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",fill:"#5f31dd",height:"25",width:"25"},[n("path",{d:"M256 0a256 256 0 1 0 0 512A256 256 0 1 0 256 0zM244.7 395.3l-112-112c-4.6-4.6-5.9-11.5-3.5-17.4s8.3-9.9 14.8-9.9l64 0 0-96c0-17.7 14.3-32 32-32l32 0c17.7 0 32 14.3 32 32l0 96 64 0c6.5 0 12.3 3.9 14.8 9.9s1.1 12.9-3.5 17.4l-112 112c-6.2 6.2-16.4 6.2-22.6 0z"})],-1)),on=[sn],nn={key:0,class:"d-flex justify-content-between"},rn={class:"d-flex justify-content-end"},ln={key:0,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",width:"18",height:"18"},an=L(()=>n("path",{d:"M256 80c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 144L48 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l144 0 0 144c0 17.7 14.3 32 32 32s32-14.3 32-32l0-144 144 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-144 0 0-144z"},null,-1)),cn=[an],hn={key:1,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",width:"18",height:"18"},un=L(()=>n("path",{d:"M432 256c0 17.7-14.3 32-32 32L48 288c-17.7 0-32-14.3-32-32s14.3-32 32-32l352 0c17.7 0 32 14.3 32 32z"},null,-1)),dn=[un],pn={key:1,class:"d-flex mt-1"},fn={"b-tooltip.hover":"",tile:"send message",class:"d-flex flex-row-reverse"},gn=L(()=>n("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",width:"18",height:"18",fill:"white"},[n("path",{d:"M256 448c141.4 0 256-93.1 256-208S397.4 32 256 32S0 125.1 0 240c0 45.1 17.7 86.8 47.7 120.9c-1.9 24.5-11.4 46.3-21.4 62.9c-5.5 9.2-11.1 16.6-15.2 21.6c-2.1 2.5-3.7 4.4-4.9 5.7c-.6 .6-1 1.1-1.3 1.4l-.3 .3c0 0 0 0 0 0c0 0 0 0 0 0s0 0 0 0s0 0 0 0c-4.6 4.6-5.9 11.4-3.4 17.4c2.5 6 8.3 9.9 14.8 9.9c28.7 0 57.6-8.9 81.6-19.3c22.9-10 42.4-21.9 54.3-30.6c31.8 11.5 67 17.9 104.1 17.9zM128 208a32 32 0 1 1 0 64 32 32 0 1 1 0-64zm128 0a32 32 0 1 1 0 64 32 32 0 1 1 0-64zm96 32a32 32 0 1 1 64 0 32 32 0 1 1 -64 0z"})],-1)),_n=[gn],mn={key:2,class:"ai-tutor-processing mt-1"},yn=L(()=>n("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 640 512",width:"18",height:"18",fill:"black"},[n("path",{d:"M320 0c17.7 0 32 14.3 32 32l0 64 120 0c39.8 0 72 32.2 72 72l0 272c0 39.8-32.2 72-72 72l-304 0c-39.8 0-72-32.2-72-72l0-272c0-39.8 32.2-72 72-72l120 0 0-64c0-17.7 14.3-32 32-32zM208 384c-8.8 0-16 7.2-16 16s7.2 16 16 16l32 0c8.8 0 16-7.2 16-16s-7.2-16-16-16l-32 0zm96 0c-8.8 0-16 7.2-16 16s7.2 16 16 16l32 0c8.8 0 16-7.2 16-16s-7.2-16-16-16l-32 0zm96 0c-8.8 0-16 7.2-16 16s7.2 16 16 16l32 0c8.8 0 16-7.2 16-16s-7.2-16-16-16l-32 0zM264 256a40 40 0 1 0 -80 0 40 40 0 1 0 80 0zm152 40a40 40 0 1 0 0-80 40 40 0 1 0 0 80zM48 224l16 0 0 192-16 0c-26.5 0-48-21.5-48-48l0-96c0-26.5 21.5-48 48-48zm544 0c26.5 0 48 21.5 48 48l0 96c0 26.5-21.5 48-48 48l-16 0 0-192 16 0z"})],-1)),wn={key:3,class:"d-flex flex-row suggested-interactions-wrapper mt-1 mb-1"},vn=["innerHTML"],kn={key:0,class:"user-conversation"},bn={key:1,class:"d-flex justify-content-between w-100"},Tn=["innerHTML"],Cn={key:0,class:"d-flex"},xn=L(()=>n("span",{class:"speech-loader"},null,-1)),Sn=[xn],Ln=["onClick"],Mn=["onClick"],An={key:0,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",fill:"yellow",height:"18",width:"18"},In=L(()=>n("path",{d:"M464 256A208 208 0 1 0 48 256a208 208 0 1 0 416 0zM0 256a256 256 0 1 1 512 0A256 256 0 1 1 0 256zM188.3 147.1c7.6-4.2 16.8-4.1 24.3 .5l144 88c7.1 4.4 11.5 12.1 11.5 20.5s-4.4 16.1-11.5 20.5l-144 88c-7.4 4.5-16.7 4.7-24.3 .5s-12.3-12.2-12.3-20.9l0-176c0-8.7 4.7-16.7 12.3-20.9z"},null,-1)),Pn=[In],On={key:1,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",fill:"yellow",height:"18",width:"18"},Dn=L(()=>n("path",{d:"M464 256A208 208 0 1 0 48 256a208 208 0 1 0 416 0zM0 256a256 256 0 1 1 512 0A256 256 0 1 1 0 256zm192-96l128 0c17.7 0 32 14.3 32 32l0 128c0 17.7-14.3 32-32 32l-128 0c-17.7 0-32-14.3-32-32l0-128c0-17.7 14.3-32 32-32z"},null,-1)),Bn=[Dn],En={key:5,class:k("mini-user-chat-div")},Rn={"b-tooltip.hover":"",tile:"send message",class:"d-flex flex-row-reverse"},Vn=L(()=>n("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",width:"18",height:"18",fill:"white"},[n("path",{d:"M256 448c141.4 0 256-93.1 256-208S397.4 32 256 32S0 125.1 0 240c0 45.1 17.7 86.8 47.7 120.9c-1.9 24.5-11.4 46.3-21.4 62.9c-5.5 9.2-11.1 16.6-15.2 21.6c-2.1 2.5-3.7 4.4-4.9 5.7c-.6 .6-1 1.1-1.3 1.4l-.3 .3c0 0 0 0 0 0c0 0 0 0 0 0s0 0 0 0s0 0 0 0c-4.6 4.6-5.9 11.4-3.4 17.4c2.5 6 8.3 9.9 14.8 9.9c28.7 0 57.6-8.9 81.6-19.3c22.9-10 42.4-21.9 54.3-30.6c31.8 11.5 67 17.9 104.1 17.9zM128 208a32 32 0 1 1 0 64 32 32 0 1 1 0-64zm128 0a32 32 0 1 1 0 64 32 32 0 1 1 0-64zm96 32a32 32 0 1 1 64 0 32 32 0 1 1 -64 0z"})],-1)),Hn=[Vn],Nn=L(()=>n("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",fill:"white",width:"26",height:"26"},[n("path",{d:"M256 448c141.4 0 256-93.1 256-208S397.4 32 256 32S0 125.1 0 240c0 45.1 17.7 86.8 47.7 120.9c-1.9 24.5-11.4 46.3-21.4 62.9c-5.5 9.2-11.1 16.6-15.2 21.6c-2.1 2.5-3.7 4.4-4.9 5.7c-.6 .6-1 1.1-1.3 1.4l-.3 .3c0 0 0 0 0 0c0 0 0 0 0 0s0 0 0 0s0 0 0 0c-4.6 4.6-5.9 11.4-3.4 17.4c2.5 6 8.3 9.9 14.8 9.9c28.7 0 57.6-8.9 81.6-19.3c22.9-10 42.4-21.9 54.3-30.6c31.8 11.5 67 17.9 104.1 17.9zM128 208a32 32 0 1 1 0 64 32 32 0 1 1 0-64zm128 0a32 32 0 1 1 0 64 32 32 0 1 1 0-64zm96 32a32 32 0 1 1 64 0 32 32 0 1 1 -64 0z"})],-1)),zn=[Nn];function Fn(s,t,e,i,o,r){const c=y("TooltipBtn"),h=y("SpeechRecorder"),g=y("TutorLoadingSymbol");return o.mode!=="hide"?(l(),a("div",{key:0,class:k({"container mt-3":o.mode==="big","minimize-chat-container":o.mode==="mini"})},[n("div",$o,[n("div",Wo,[n("div",Ko,[o.mode==="big"?(l(),a("button",{key:0,class:"btn",title:"Minimize and pin the chat","b-tooltip.hover":"",onClick:t[0]||(t[0]=d=>o.mode="mini")},Yo)):u("",!0),Jo,o.mode==="big"?(l(),m(c,{key:1,class:"d-none d-md-block",toolTipText:"Press the 'generate audio' button to hear the tutor speak with AI generated speech.",bubbleWidth:"350px",trianglePosition:"left",absoluteTop:"37px"})):u("",!0),o.mode==="big"?(l(),m(c,{key:2,class:"d-md-none",toolTipText:"Chat with ours AI Tutor about the subjects",bubbleWidth:"100px",trianglePosition:"left",absoluteTop:"37px"})):u("",!0)]),n("div",Zo,[n("div",Qo,[o.mode==="mini"?(l(),a("button",{key:0,class:"symbol-btn",onClick:t[1]||(t[1]=d=>o.mode="big")},tn)):u("",!0)]),n("div",en,[o.mode==="mini"?(l(),a("button",{key:0,class:"symbol-btn",onClick:t[2]||(t[2]=d=>o.mode="hide")},on)):u("",!0)])])])]),o.mode==="big"?(l(),a("span",nn,[n("span",null,[n("button",{class:k(["btn suggested-interactions ms-1 socratic-btn",{underline:o.tutorType==="socratic"}]),onClick:t[3]||(t[3]=d=>r.changeTutorType("socratic"))}," Socratic Tutor ",2),n("button",{class:k(["btn suggested-interactions ms-1 assessing-btn",{underline:o.tutorType==="assessing"}]),onClick:t[4]||(t[4]=d=>r.changeTutorType("assessing"))}," Assessment Tutor ",2)]),n("span",rn,[o.mode=="big"?(l(),m(h,{key:0,tutorType:o.tutorType,skill:e.skill,skillLevel:o.englishSkillLevel,learningObjectives:o.learningObjectives},null,8,["tutorType","skill","skillLevel","learningObjectives"])):u("",!0),n("button",{class:"btn plus-btn ms-1",onClick:t[5]||(t[5]=d=>o.showChat=!o.showChat)},[o.showChat?(l(),a("svg",hn,dn)):(l(),a("svg",ln,cn))])])])):u("",!0),o.mode==="big"?(l(),a("div",pn,[$(n("textarea",{ref:"messageInput",class:"chat-text-area rounded border border-dark me-1","onUpdate:modelValue":t[6]||(t[6]=d=>o.message=d),type:"text",onKeydown:t[7]||(t[7]=rt((...d)=>r.handleKeyDown&&r.handleKeyDown(...d),["enter"]))},`
            `,544),[[nt,o.message]]),n("div",fn,[n("button",{class:k(["btn send-btn",{"socratic-btn":o.tutorType==="socratic","assessing-btn":o.tutorType==="assessing"}]),onClick:t[8]||(t[8]=d=>r.sendMessage())},_n,2)])])):u("",!0),o.waitForAIresponse?(l(),a("div",mn,[yn,x(" Thinking "),E(g)])):u("",!0),o.tutorType==="socratic"?(l(),a("span",wn,[n("button",{class:"btn suggested-interactions ms-1 socratic-btn-dark",onClick:t[9]||(t[9]=d=>{this.message="Tell me something interesting about this subject!",this.isSuggestedInteraction=!0,r.sendMessage()})}," Tell me something interesting about this subject! "),n("button",{class:"btn suggested-interactions ms-1 socratic-btn-dark",onClick:t[10]||(t[10]=d=>{this.message="Why does this subject matter?",this.isSuggestedInteraction=!0,r.sendMessage()})}," Why does this subject matter? "),n("button",{class:"btn suggested-interactions ms-1 socratic-btn-dark",onClick:t[11]||(t[11]=d=>{this.message="How might I use knowledge of this topic in everyday life?",this.isSuggestedInteraction=!0,r.sendMessage()})}," How might I use knowledge of this topic in everyday life? "),n("button",{class:"btn suggested-interactions ms-1 socratic-btn-dark",onClick:t[12]||(t[12]=d=>{this.message="What is the most important thing for me to understand about this subject?",this.isSuggestedInteraction=!0,r.sendMessage()})}," What is the most important thing for me to understand about this subject? ")])):u("",!0),o.showChat?(l(),a("div",{key:4,class:k(["d-flex flex-column mx-auto chat-history",{"chat-history":o.mode==="big","mini-chat-history":o.mode==="mini","socratic-chat":o.tutorType==="socratic","assessing-chat":o.tutorType==="assessing"}]),ref:"messageInputDiv"},[i.stateOfSocket.isStreaming&&i.stateOfSocket.streamType==="aiTutor"?(l(),a("div",{key:0,class:"d-flex my-3 tutor-conversation streamed-message",innerHTML:r.applyMarkDownFormatting(i.stateOfSocket.streamingMessage)},null,8,vn)):u("",!0),(l(!0),a(S,null,V(o.chatHistory,d=>(l(),a("div",{class:k(["d-flex my-3",{"justify-content-end":d.role==="user"}])},[d.role==="user"?(l(),a("div",kn,[n("em",null,b(d.content[0].text.value),1)])):d.role==="assistant"&&d.content[0].type=="text"?(l(),a("span",bn,[n("div",{class:"tutor-conversation",innerHTML:r.applyMarkDownFormatting(d.content[0].text.value)},null,8,Tn),d.isAudioGenerating&&d.role==="assistant"?(l(),a("div",Cn,Sn)):!d.hasAudio&&!d.isAudioGenerating&&d.role==="assistant"?(l(),a("button",{key:1,onClick:w=>r.generateAudio(d.index,d.content[0].text.value),class:"btn speechButton"}," generate speech ",8,Ln)):!d.isAudioGenerating&&d.role==="assistant"?(l(),a("button",{key:2,onClick:w=>r.playAudio(d.index),class:"btn speechButton"},[o.isAudioPlaying==!1?(l(),a("svg",An,Pn)):(l(),a("svg",On,Bn))],8,Mn)):u("",!0)])):u("",!0)],2))),256))],2)):u("",!0),o.mode==="mini"?(l(),a("div",En,[$(n("textarea",{ref:"messageInput",class:"chat-text-area","onUpdate:modelValue":t[13]||(t[13]=d=>o.message=d),type:"text",onKeydown:t[14]||(t[14]=rt((...d)=>r.handleKeyDown&&r.handleKeyDown(...d),["enter"]))},`
            `,544),[[nt,o.message]]),n("div",Rn,[n("button",{class:"btn primary-btn send-btn",onClick:t[15]||(t[15]=d=>r.sendMessage())},Hn)])])):u("",!0)],2)):(l(),a("div",{key:1,class:"hidden-chat-symbol",onClick:t[16]||(t[16]=d=>o.mode="mini")},zn))}const jn=O(qo,[["render",Fn],["__scopeId","data-v-8b19381f"]]);const Un={setup(){return{userDetailsStore:W(),stateOfSocket:C}},props:["skillName","skillUrl","skillLevel","learningObjective","learningObjectiveId"],components:{TutorLoadingSymbol:Mt},data(){return{message:"",messageList:[],waitForAIresponse:!1,isGotMessages:!1,englishSkillLevel:"",threadID:"",isAudioPlaying:!1,assistantData:null}},async mounted(){this.englishSkillLevel=this.skillLevel.replace("_"," "),await this.getMessages()},async created(){this.connectToSocketSever()},methods:{handleKeyDown(s){s.shiftKey||(s.preventDefault(),this.sendMessage())},async getMessages(){this.message="";try{const s=`/ai-tutor/learning-objective/messages-list?userId=${encodeURIComponent(this.userDetailsStore.userId)}&learningObjectiveId=${encodeURIComponent(this.learningObjectiveId)}&learningObjective=${encodeURIComponent(this.learningObjective)}&skillLevel=${encodeURIComponent(this.englishSkillLevel)}`,e=await(await fetch(s)).json();this.messageList=e.messages,this.assistantData=e.assistantData,this.isGotMessages=!0,this.messageList.length>0&&(this.threadID=this.messageList[0].thread_id)}catch(s){console.error(s)}},async generateAudio(s,t){for(let c=0;c<this.messageList.length;c++)this.messageList[c].index==s&&(this.messageList[c].isAudioGenerating=!0);const e={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:t,messageNumber:s,threadID:this.threadID})},r=await(await fetch("/ai-tutor/learning-objective/generate-tts",e)).json();console.log(r.status);for(let c=0;c<this.messageList.length;c++)this.messageList[c].index==s&&(this.messageList[c].isAudioGenerating=!1,this.messageList[c].hasAudio=!0);this.getMessages()},playAudio(s){if(this.isAudioPlaying==!0)this.isAudioPlaying=!1,this.audio.pause();else{let t=`https://institute-learning-objective-tutor-tts-urls.s3.us-east-1.amazonaws.com/${this.threadID}-${s}.mp3`;this.audio=new Audio(t),this.isAudioPlaying=!0,this.audio.play()}},async sendMessage(){if(!this.waitForAIresponse){this.waitForAIresponse=!0;try{const s={role:"user",content:[{text:{value:this.message}}]};this.messageList.unshift(s);const t={threadId:this.assistantData.threadId,assistantId:this.assistantData.assistantId,message:this.message,learningObjective:this.learningObjective,userId:this.userDetailsStore.userId,skillName:this.skillName,skillLevel:this.englishSkillLevel};A.emit("new-learning-objective-message",t),this.message=""}catch(s){console.error(s),this.waitForAIresponse=!1}}},async requestTutoring(){if(!this.waitForAIresponse){this.waitForAIresponse=!0;try{const t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({learningObjective:this.learningObjective,learningObjectiveId:this.learningObjectiveId,userName:this.userDetailsStore.userName,userId:this.userDetailsStore.userId,skillName:this.skillName,skillLevel:this.englishSkillLevel})};var s="/ai-tutor/learning-objective/request-tutoring";if((await fetch(s,t)).status===500){alert("The tutor can`t answer !!"),this.waitForAIresponse=!1;return}this.getMessages(),this.waitForAIresponse=!1}catch(t){console.error(t),this.waitForAIresponse=!1}}},async requestQuestion(){if(!this.waitForAIresponse){this.waitForAIresponse=!0;try{const t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({learningObjective:this.learningObjective,learningObjectiveId:this.learningObjectiveId,userName:this.userDetailsStore.userName,userId:this.userDetailsStore.userId,skillName:this.skillName,skillLevel:this.englishSkillLevel})};var s="/ai-tutor/learning-objective/ask-question";if((await fetch(s,t)).status===500){alert("The tutor can`t answer !!"),this.waitForAIresponse=!1;return}this.getMessages(),this.waitForAIresponse=!1}catch(t){console.error(t),this.waitForAIresponse=!1}}},applyMarkDownFormatting(s){return window.markdownit({breaks:!0}).use(window.texmath,{engine:katex,delimiters:["brackets","dollars"],katexOptions:{macros:{"\\RR":"\\mathbb{R}"}}}).render(s)},connectToSocketSever(){A.connect()},disconnectToSocketSever(){A.disconnect()},removeStreamMessage(){C.streamType="pause",C.streamingMessage=""}},watch:{stateOfSocket:{async handler(s,t){if(s.streamType==="learningObjective"&&(s.isStreaming&&(this.waitForAIresponse=!1),!s.isStreaming&&s.isRunJustEnded)){const e={role:"assistant",content:[{text:{value:this.stateOfSocket.streamingMessage},type:"text"}]};this.removeStreamMessage(),this.messageList.unshift(e);let i=this.messageList.reverse();for(let o=0;o<i.length;o++)i[o].index=o;this.messageList=i.reverse()}},deep:!0}}},j=s=>(N("data-v-c3fdf47b"),s=s(),z(),s),qn={key:0,class:"loading-animation d-flex justify-content-center align-items-center py-4"},$n=j(()=>n("span",{class:"spinning-loader"},null,-1)),Wn=[$n],Kn={key:1},Gn={class:"d-flex justify-content-end mt-2"},Yn={class:"d-flex mt-1"},Jn=["disabled"],Zn=j(()=>n("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",width:"18",height:"18",fill:"black"},[n("path",{d:"M256 448c141.4 0 256-93.1 256-208S397.4 32 256 32S0 125.1 0 240c0 45.1 17.7 86.8 47.7 120.9c-1.9 24.5-11.4 46.3-21.4 62.9c-5.5 9.2-11.1 16.6-15.2 21.6c-2.1 2.5-3.7 4.4-4.9 5.7c-.6 .6-1 1.1-1.3 1.4l-.3 .3c0 0 0 0 0 0c0 0 0 0 0 0s0 0 0 0s0 0 0 0c-4.6 4.6-5.9 11.4-3.4 17.4c2.5 6 8.3 9.9 14.8 9.9c28.7 0 57.6-8.9 81.6-19.3c22.9-10 42.4-21.9 54.3-30.6c31.8 11.5 67 17.9 104.1 17.9zM128 208a32 32 0 1 1 0 64 32 32 0 1 1 0-64zm128 0a32 32 0 1 1 0 64 32 32 0 1 1 0-64zm96 32a32 32 0 1 1 64 0 32 32 0 1 1 -64 0z"})],-1)),Qn=[Zn],Xn={key:0,class:"ai-tutor-processing mt-2"},tr=j(()=>n("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 640 512",width:"18",height:"18",fill:"black"},[n("path",{d:"M320 0c17.7 0 32 14.3 32 32l0 64 120 0c39.8 0 72 32.2 72 72l0 272c0 39.8-32.2 72-72 72l-304 0c-39.8 0-72-32.2-72-72l0-272c0-39.8 32.2-72 72-72l120 0 0-64c0-17.7 14.3-32 32-32zM208 384c-8.8 0-16 7.2-16 16s7.2 16 16 16l32 0c8.8 0 16-7.2 16-16s-7.2-16-16-16l-32 0zm96 0c-8.8 0-16 7.2-16 16s7.2 16 16 16l32 0c8.8 0 16-7.2 16-16s-7.2-16-16-16l-32 0zm96 0c-8.8 0-16 7.2-16 16s7.2 16 16 16l32 0c8.8 0 16-7.2 16-16s-7.2-16-16-16l-32 0zM264 256a40 40 0 1 0 -80 0 40 40 0 1 0 80 0zm152 40a40 40 0 1 0 0-80 40 40 0 1 0 0 80zM48 224l16 0 0 192-16 0c-26.5 0-48-21.5-48-48l0-96c0-26.5 21.5-48 48-48zm544 0c26.5 0 48 21.5 48 48l0 96c0 26.5-21.5 48-48 48l-16 0 0-192 16 0z"})],-1)),er={class:"d-flex flex-column mx-auto chat-component socratic-chat"},sr=["innerHTML"],ir={key:0,class:"user-conversation"},or=["innerHTML"],nr={key:2,class:"d-flex"},rr=j(()=>n("span",{class:"speech-loader"},null,-1)),lr=[rr],ar=["onClick"],cr=["onClick"],hr={key:0,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",fill:"yellow",height:"18",width:"18"},ur=j(()=>n("path",{d:"M464 256A208 208 0 1 0 48 256a208 208 0 1 0 416 0zM0 256a256 256 0 1 1 512 0A256 256 0 1 1 0 256zM188.3 147.1c7.6-4.2 16.8-4.1 24.3 .5l144 88c7.1 4.4 11.5 12.1 11.5 20.5s-4.4 16.1-11.5 20.5l-144 88c-7.4 4.5-16.7 4.7-24.3 .5s-12.3-12.2-12.3-20.9l0-176c0-8.7 4.7-16.7 12.3-20.9z"},null,-1)),dr=[ur],pr={key:1,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",fill:"yellow",height:"18",width:"18"},fr=j(()=>n("path",{d:"M464 256A208 208 0 1 0 48 256a208 208 0 1 0 416 0zM0 256a256 256 0 1 1 512 0A256 256 0 1 1 0 256zm192-96l128 0c17.7 0 32 14.3 32 32l0 128c0 17.7-14.3 32-32 32l-128 0c-17.7 0-32-14.3-32-32l0-128c0-17.7 14.3-32 32-32z"},null,-1)),gr=[fr];function _r(s,t,e,i,o,r){const c=y("TutorLoadingSymbol");return o.isGotMessages==!1?(l(),a("div",qn,Wn)):(l(),a("div",Kn,[n("span",Gn,[o.isGotMessages?(l(),a("button",{key:0,class:"btn border border-dark",onClick:t[0]||(t[0]=h=>r.requestTutoring())}," tutor me on this ")):u("",!0),n("button",{class:"btn border border-dark ms-1",onClick:t[1]||(t[1]=h=>r.requestQuestion())}," ask me a question ")]),n("span",Yn,[$(n("textarea",{class:"chat-input border border-dark rounded","onUpdate:modelValue":t[2]||(t[2]=h=>o.message=h),type:"text",onKeydown:t[3]||(t[3]=rt((...h)=>r.handleKeyDown&&r.handleKeyDown(...h),["enter"]))},null,544),[[nt,o.message]]),n("button",{class:"btn border border-dark ms-1 message-btn",onClick:t[4]||(t[4]=h=>r.sendMessage()),disabled:this.message==""||this.message==" "},Qn,8,Jn)]),o.waitForAIresponse?(l(),a("div",Xn,[tr,x(" Thinking "),E(c)])):u("",!0),n("div",er,[i.stateOfSocket.isStreaming?(l(),a("div",{key:0,class:"d-flex my-3 tutor-conversation streamed-message p-2",innerHTML:r.applyMarkDownFormatting(i.stateOfSocket.streamingMessage)},null,8,sr)):u("",!0),(l(!0),a(S,null,V(o.messageList,h=>(l(),a("div",{class:k(["d-flex my-3",{"justify-content-end":h.role==="user"}])},[h.role==="user"?(l(),a("div",ir,[n("em",null,b(h.content[0].text.value),1)])):h.role==="assistant"&&h.content[0].type=="text"?(l(),a("div",{key:1,class:"tutor-conversation p-2",innerHTML:r.applyMarkDownFormatting(h.content[0].text.value)},null,8,or)):u("",!0),h.isAudioGenerating&&h.role==="assistant"?(l(),a("div",nr,lr)):!h.hasAudio&&!h.isAudioGenerating&&h.role==="assistant"?(l(),a("button",{key:3,onClick:g=>r.generateAudio(h.index,h.content[0].text.value),class:"btn speechButton"}," generate speech ",8,ar)):!h.isAudioGenerating&&h.role==="assistant"?(l(),a("button",{key:4,onClick:g=>r.playAudio(h.index),class:"btn speechButton"},[o.isAudioPlaying==!1?(l(),a("svg",hr,dr)):(l(),a("svg",pr,gr))],8,cr)):u("",!0)],2))),256))])]))}const mr=O(Un,[["render",_r],["__scopeId","data-v-c3fdf47b"]]);const yr={setup(){const s=Wt(),t=Kt(),e=W(),i=Zt(),o=St(),r=xt(),c=pt(),h=te();return s.tagsList.length==0&&s.getTagsList(),{tagsStore:s,skillTagsStore:t,userDetailsStore:e,skillsStore:i,skillTreeStore:o,userSkillsStore:r,sessionDetailsStore:c,showSkillStore:h}},data(){return{skillUrl:this.$route.params.skillUrl,skillId:null,skill:{learningObjectives:[]},userSkills:[],isMastered:!1,isUnlocked:!1,isGoal:!1,filters:[],showFlaggingModal:!1,ancestor:this.$route.params.id,accessibleSkills:[],showAncestorLink:!1,isMobileCheck:window.innerWidth,showConfirmModal:!1,isSkillLoaded:!1,randomNum:0,goalSteps:[],goals:[],toggleModal:!1,selectedSkill:null,isTutorialComplete:!1,showTutorialTip1:!1,showTutorialTip2:!1,showTutorialTip3:!1,showTutorialTip4:!1,showTutorialTip5:!1,showTutorialTip6:!1,showCategoryCompletedModal:!1,nextSkillsInBranch:[],showLearningObjectives:!0}},components:{Forum:Vi,FlagModals:Lt,AITutor:jn,LearningObjectiveAITutor:mr},async created(){await this.getSkill(),this.isSkillLoaded=!0,this.sessionDetailsStore.isLoggedIn&&await this.getUserSkills(),this.sessionDetailsStore.isLoggedIn==!0&&this.checkIfTutorialComplete(),this.isUnlocked||this.nearestAccessibleAncestor(this.skill)},methods:{async getSkill(){this.randomNum=Math.random(),await this.showSkillStore.findSkill(this.skillUrl),this.skill=this.showSkillStore.skill,this.skillId=this.skill.id,this.skill.name.includes("Vocabulary Test")&&(this.showLearningObjectives=!1),this.skill.learningObjectives=[],await this.getLearningObjectives(),document.title=this.skill.name+" - The Collins Institute",this.getSkillFilters();const s=document.getElementsByTagName("svg");s.length>0&&(s[0].style.height="50px"),this.userDetailsStore.role=="student"&&this.recordSkillVisit(this.skillId)},async getLearningObjectives(){const s=await fetch("/skill-learning-objectives/"+this.skillId+"/list");this.skill.learningObjectives=await s.json();for(let t=0;t<this.skill.learningObjectives.length;t++)this.skill.learningObjectives[t].showAI=!1},recordSkillVisit(s){fetch("/skills/record-visit/"+s)},async getSkillFilters(){this.skillTagsStore.skillTagsList.length==0&&await this.skillTagsStore.getSkillTagsList();for(let s=0;s<this.skillTagsStore.skillTagsList.length;s++)this.skillTagsStore.skillTagsList[s].skill_id==this.skillId&&this.filters.push(this.skillTagsStore.skillTagsList[s].tag_id)},async getUserSkills(){const t=await(await fetch("/user-skills/filtered-unnested-list/"+this.userDetailsStore.userId)).json();this.userSkills=t;for(let e=0;e<this.userSkills.length;e++)this.userSkills[e].id==this.skill.id&&(this.userSkills[e].is_mastered==1&&(this.isMastered=!0),this.userSkills[e].is_accessible==1&&(this.isUnlocked=!0),this.userSkills[e].is_goal==1&&(this.isGoal=!0)),this.userSkills[e].is_accessible==1&&this.accessibleSkills.push(this.userSkills[e])},async MakeMastered(){await this.userSkillsStore.MakeMastered(this.userDetailsStore.userId,this.skill),this.isMastered=!0,await this.getUserSkills(),await this.getNextSkillsInBranch(),this.showCategoryCompletedModal=!0},async getNextSkillsInBranch(){const s=await fetch("/user-skills/get-next-accessible-in-branch/"+this.userDetailsStore.userId+"/"+this.skillId);this.nextSkillsInBranch=await s.json()},closeFlagModal(){this.showModal=!1},nearestAccessibleAncestor(s){if(this.accessibleSkills.find(i=>i.id==s.id)){this.ancestor=s.url,this.showAncestorLink=!0;return}let e=[];if(s.type=="super")for(let i=0;i<this.accessibleSkills.length;i++)this.accessibleSkills[i].type=="sub"&&this.accessibleSkills[i].parent==s.id&&this.accessibleSkills[i].is_mastered!=1&&e.push(this.accessibleSkills[i]);if(e.length>0){this.ancestor=e[0].url,this.showAncestorLink=!0;return}fetch("/skills/show/"+s.parent).then(function(i){return i.json()}).then(i=>this.nearestAccessibleAncestor(i))},copyShareableURLToClipBoard(){navigator.clipboard.writeText(window.location.href),this.showConfirmModal=!0},imageUrlAlternative(s){s.target.src="/images/skill-avatar/recurso.png"},openModal(s){this.selectedSkill=s,this.toggleModal=!0},closeModal(){this.toggleModal=!1,this.selectedSkill=null},async confirmCreateGoal(){this.selectedSkill&&(await this.userSkillsStore.getFilteredUnnestedList(this.userDetailsStore.userId),this.createGoal(this.selectedSkill),this.closeModal())},createGoal(s){s.type!="domain"&&this.goalSteps.push(s);let t=!1;if(s.type=="super")for(let i=0;i<this.userSkillsStore.filteredUnnestedList.length;i++)this.userSkillsStore.filteredUnnestedList[i].type=="sub"&&this.userSkillsStore.filteredUnnestedList[i].parent==s.id&&this.userSkillsStore.filteredUnnestedList[i].is_mastered!=1&&(this.goalSteps.push(this.userSkillsStore.filteredUnnestedList[i]),this.userSkillsStore.filteredUnnestedList[i].is_accessible&&(t=!0));if(this.accessibleSkills.find(i=>i.id==s.id)||t){this.populateGoalSteps();return}fetch("/skills/show/"+s.parent).then(i=>i.json()).then(i=>this.createGoal(i))},populateGoalSteps(){const s={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({goalSteps:this.goalSteps})},t="/user-skills/set-goal/"+this.userDetailsStore.userId+"/"+this.skillId;fetch(t,s).then(()=>{alert("A goal for this skill has been added on the Hub page."),this.$router.push(`/goals/${this.userDetailsStore.userId}/${this.skillId}`)})},async checkIfTutorialComplete(){const t=await(await fetch("/users/check-tutorial-progress/skill/"+this.userDetailsStore.userId)).json();t==0?(this.isTutorialComplete=!1,this.showTutorialTip1=!0):t==1&&(this.isTutorialComplete=!0)},progressTutorial(s){s==1?(this.showTutorialTip1=!1,this.isMastered?this.showTutorialTip3=!0:this.showTutorialTip2=!0):s==2?(this.showTutorialTip2=!1,this.showTutorialTip3=!0):s==3?(this.showTutorialTip3=!1,this.showTutorialTip4=!0):s==4?(this.showTutorialTip4=!1,this.showTutorialTip5=!0):s==5?(this.showTutorialTip5=!1,this.showTutorialTip6=!0,(this.userDetailsStore.role==="editor"||this.userDetailsStore.role==="instructor")&&(this.showTutorialTip7=!0)):s==6&&(this.showTutorialTip6=!1,(this.userDetailsStore.role==="editor"||this.userDetailsStore.role==="instructor")&&(this.showTutorialTip7=!1),this.markTutorialComplete())},restartTutorial(){this.showTutorialTip1=!0,this.showTutorialTip2=!1,this.showTutorialTip3=!1,this.showTutorialTip4=!1,this.showTutorialTip5=!1,this.showTutorialTip6=!1,this.showTutorialTip7=!1,this.showInstructorEditorTutorialTip=!1,this.isTutorialComplete=!1},markTutorialComplete(){let s="/users/mark-tutorial-complete/skill/"+this.userDetailsStore.userId;fetch(s,{method:"PUT",headers:{"Content-Type":"application/json"}})}},watch:{async $route(s,t){this.skillUrl=s.params.skillUrl,await this.getSkill(),await this.getUserSkills()}}},f=s=>(N("data-v-599a21d4"),s=s(),z(),s),wr={class:"container"},vr={class:"d-flex justify-content-between top-row"},kr={class:"heading"},br=f(()=>n("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",width:"20",fill:"white"},[n("path",{d:"M144 144l0 48 160 0 0-48c0-44.2-35.8-80-80-80s-80 35.8-80 80zM80 192l0-48C80 64.5 144.5 0 224 0s144 64.5 144 144l0 48 16 0c35.3 0 64 28.7 64 64l0 192c0 35.3-28.7 64-64 64L64 512c-35.3 0-64-28.7-64-64L0 256c0-35.3 28.7-64 64-64l16 0z"})],-1)),Tr=f(()=>n("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 576 512",width:"22",fill:"white"},[n("path",{d:"M288 0c-12.2 .1-23.3 7-28.6 18L195 150.3 51.4 171.5c-12 1.8-22 10.2-25.7 21.7s-.7 24.2 7.9 32.7L137.8 329 113.2 474.7c-2 12 3 24.2 12.9 31.3s23 8 33.8 2.3L288 439.8 288 0zM429.9 512c1.1 .1 2.1 .1 3.2 0l-3.2 0z"})],-1)),Cr=f(()=>n("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 576 512",width:"22",fill:"white"},[n("path",{d:"m 169.24356,0 c 12.2,0.1 23.3,7 28.6,18 l 64.4,132.3 143.6,21.2 c 12,1.8 22,10.2 25.7,21.7 3.7,11.5 0.7,24.2 -7.9,32.7 l -104.2,103.1 24.6,145.7 c 2,12 -3,24.2 -12.9,31.3 -9.9,7.1 -23,8 -33.8,2.3 l -128.1,-68.5 z M 27.343555,512 c -1.1,0.1 -2.1,0.1 -3.2,0 z",id:"path17"})],-1)),xr=f(()=>n("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 576 512",width:"22",fill:"white"},[n("path",{d:"M288 0c-12.2 .1-23.3 7-28.6 18L195 150.3 51.4 171.5c-12 1.8-22 10.2-25.7 21.7s-.7 24.2 7.9 32.7L137.8 329 113.2 474.7c-2 12 3 24.2 12.9 31.3s23 8 33.8 2.3L288 439.8 288 0zM429.9 512c1.1 .1 2.1 .1 3.2 0l-3.2 0z"})],-1)),Sr=f(()=>n("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 576 512",width:"22",fill:"white"},[n("path",{d:"m 169.24356,0 c 12.2,0.1 23.3,7 28.6,18 l 64.4,132.3 143.6,21.2 c 12,1.8 22,10.2 25.7,21.7 3.7,11.5 0.7,24.2 -7.9,32.7 l -104.2,103.1 24.6,145.7 c 2,12 -3,24.2 -12.9,31.3 -9.9,7.1 -23,8 -33.8,2.3 l -128.1,-68.5 z M 27.343555,512 c -1.1,0.1 -2.1,0.1 -3.2,0 z",id:"path17"})],-1)),Lr=f(()=>n("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 576 512",width:"22",fill:"white"},[n("path",{d:"M288 0c-12.2 .1-23.3 7-28.6 18L195 150.3 51.4 171.5c-12 1.8-22 10.2-25.7 21.7s-.7 24.2 7.9 32.7L137.8 329 113.2 474.7c-2 12 3 24.2 12.9 31.3s23 8 33.8 2.3L288 439.8 288 0zM429.9 512c1.1 .1 2.1 .1 3.2 0l-3.2 0z"})],-1)),Mr={key:0},Ar={key:1},Ir=f(()=>n("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 576 512",width:"22",fill:"white"},[n("path",{d:"m 169.24356,0 c 12.2,0.1 23.3,7 28.6,18 l 64.4,132.3 143.6,21.2 c 12,1.8 22,10.2 25.7,21.7 3.7,11.5 0.7,24.2 -7.9,32.7 l -104.2,103.1 24.6,145.7 c 2,12 -3,24.2 -12.9,31.3 -9.9,7.1 -23,8 -33.8,2.3 l -128.1,-68.5 z M 27.343555,512 c -1.1,0.1 -2.1,0.1 -3.2,0 z",id:"path17"})],-1)),Pr={key:0,class:"tool-tip-base d-flex justify-content-end"},Or={class:"tool-tip-text"},Dr=f(()=>n("p",null," This is where you can take an assessment for this skill, if it is unlocked. ",-1)),Br=f(()=>n("p",null," If it's locked, this button will instead take you to the closest unlocked skill. ",-1)),Er={key:1,class:"row pe-4 ps-4 ps-md-0 skill-description"},Rr=f(()=>n("hr",{class:"border border-2 opacity-100 hr"},null,-1)),Vr={class:"row mb-2"},Hr={class:"col d-flex justify-content-between"},Nr={key:0},zr=f(()=>n("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",width:"20",height:"20",fill:"white"},[n("path",{d:"M441 58.9L453.1 71c9.4 9.4 9.4 24.6 0 33.9L424 134.1 377.9 88 407 58.9c9.4-9.4 24.6-9.4 33.9 0zM209.8 256.2L344 121.9 390.1 168 255.8 302.2c-2.9 2.9-6.5 5-10.4 6.1l-58.5 16.7 16.7-58.5c1.1-3.9 3.2-7.5 6.1-10.4zM373.1 25L175.8 222.2c-8.7 8.7-15 19.4-18.3 31.1l-28.6 100c-2.4 8.4-.1 17.4 6.1 23.6s15.2 8.5 23.6 6.1l100-28.6c11.8-3.4 22.5-9.7 31.1-18.3L487 138.9c28.1-28.1 28.1-73.7 0-101.8L474.9 25C446.8-3.1 401.2-3.1 373.1 25zM88 64C39.4 64 0 103.4 0 152V424c0 48.6 39.4 88 88 88H360c48.6 0 88-39.4 88-88V312c0-13.3-10.7-24-24-24s-24 10.7-24 24V424c0 22.1-17.9 40-40 40H88c-22.1 0-40-17.9-40-40V152c0-22.1 17.9-40 40-40H200c13.3 0 24-10.7 24-24s-10.7-24-24-24H88z"})],-1)),Fr={key:0},jr=f(()=>n("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",width:"18",height:"20",fill:"white"},[n("path",{d:"M75 75L41 41C25.9 25.9 0 36.6 0 57.9L0 168c0 13.3 10.7 24 24 24l110.1 0c21.4 0 32.1-25.9 17-41l-30.8-30.8C155 85.5 203 64 256 64c106 0 192 86 192 192s-86 192-192 192c-40.8 0-78.6-12.7-109.7-34.4c-14.5-10.1-34.4-6.6-44.6 7.9s-6.6 34.4 7.9 44.6C151.2 495 201.7 512 256 512c141.4 0 256-114.6 256-256S397.4 0 256 0C185.3 0 121.3 28.7 75 75zm181 53c-13.3 0-24 10.7-24 24l0 104c0 6.4 2.5 12.5 7 17l72 72c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-65-65 0-94.1c0-13.3-10.7-24-24-24z"})],-1)),Ur=f(()=>n("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",fill:"white",width:"20",height:"20"},[n("path",{d:"M448 256A192 192 0 1 0 64 256a192 192 0 1 0 384 0zM0 256a256 256 0 1 1 512 0A256 256 0 1 1 0 256zm256 80a80 80 0 1 0 0-160 80 80 0 1 0 0 160zm0-224a144 144 0 1 1 0 288 144 144 0 1 1 0-288zM224 256a32 32 0 1 1 64 0 32 32 0 1 1 -64 0z"})],-1)),qr={class:"modal-content"},$r={style:{color:"var(--primary-color)"}},Wr={class:"modal-btns d-flex justify-content-between mt-3"},Kr={class:"d-flex justify-content-end"},Gr=f(()=>n("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",width:"20",heigth:"20"},[n("path",{class:"primary-icon",d:"M352 224c53 0 96-43 96-96s-43-96-96-96s-96 43-96 96c0 4 .2 8 .7 11.9l-94.1 47C145.4 170.2 121.9 160 96 160c-53 0-96 43-96 96s43 96 96 96c25.9 0 49.4-10.2 66.6-26.9l94.1 47c-.5 3.9-.7 7.8-.7 11.9c0 53 43 96 96 96s96-43 96-96s-43-96-96-96c-25.9 0-49.4 10.2-66.6 26.9l-94.1-47c.5-3.9 .7-7.8 .7-11.9s-.2-8-.7-11.9l94.1-47C302.6 213.8 326.1 224 352 224z"})],-1)),Yr=[Gr],Jr=f(()=>n("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",class:"flag-icon"},[n("path",{class:"primary-icon",d:"M64 32C64 14.3 49.7 0 32 0S0 14.3 0 32V64 368 480c0 17.7 14.3 32 32 32s32-14.3 32-32V352l64.3-16.1c41.1-10.3 84.6-5.5 122.5 13.4c44.2 22.1 95.5 24.8 141.7 7.4l34.7-13c12.5-4.7 20.8-16.6 20.8-30V66.1c0-23-24.2-38-44.8-27.7l-9.6 4.8c-46.3 23.2-100.8 23.2-147.1 0c-35.1-17.6-75.4-22-113.5-12.5L64 48V32z"})],-1)),Zr=[Jr],Qr=f(()=>n("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 192 512",width:"20",height:"20",fill:"white"},[n("path",{d:"M48 80a48 48 0 1 1 96 0A48 48 0 1 1 48 80zM0 224c0-17.7 14.3-32 32-32l64 0c17.7 0 32 14.3 32 32l0 224 32 0c17.7 0 32 14.3 32 32s-14.3 32-32 32L32 512c-17.7 0-32-14.3-32-32s14.3-32 32-32l32 0 0-192-32 0c-17.7 0-32-14.3-32-32z"})],-1)),Xr=[Qr],tl={key:0,class:"tool-tip-base"},el={class:"explain-tool-tip triangle-top-left hovering-info-panel narrow-info-panel"},sl={class:"tool-tip-text"},il=f(()=>n("p",null," Suggesting edits to this page or its test can increase your reputation score. ",-1)),ol=f(()=>n("p",null," If this skill is marked as locked, you can also bookmark this skill by marking it as a goal. ",-1)),nl={key:1,class:"tool-tip-base d-flex justify-content-end"},rl={class:"explain-tool-tip triangle-top-right hovering-info-panel narrow-info-panel"},ll={class:"tool-tip-text"},al=f(()=>n("p",null," Here you can share a link to this skill with a friend, or flag this page as unhelpful or incorrect. ",-1)),cl={key:2,class:"tool-tip-base"},hl={class:"explain-tool-tip triangle-top-left hovering-info-panel"},ul={class:"tool-tip-text"},dl=f(()=>n("p",null,' The "Edit" button allows you to edit this skill page or its assessment. ',-1)),pl={key:3,class:"tool-tip-base d-flex justify-content-end"},fl={class:"explain-tool-tip triangle-top-right narrow-info-panel hovering-info-panel"},gl={class:"tool-tip-text"},_l=f(()=>n("p",null," Here you can share a link to this skill with a friend, or flag this page as unhelpful or incorrect. ",-1)),ml={key:4,class:"tool-tip-base"},yl={class:"explain-tool-tip triangle-top-left narrow-info-panel hovering-info-panel"},wl={class:"tool-tip-text"},vl=f(()=>n("p",null," Here you can suggest an edit to this skill page. ",-1)),kl={key:5,class:"tool-tip-base d-flex justify-content-end"},bl={class:"explain-tool-tip triangle-top-right narrow-info-panel hovering-info-panel"},Tl={class:"tool-tip-text"},Cl=f(()=>n("p",null," Here you can share a link to this skill with a friend, or flag this page as unhelpful or incorrect. ",-1)),xl=f(()=>n("hr",{class:"border border-1 opacity-100 hr mt-2"},null,-1)),Sl={class:"row"},Ll={class:"col-md-8 order-2 order-md-1"},Ml={class:""},Al=f(()=>n("h2",{class:"h4 secondary-heading"},"Introduction",-1)),Il=["innerHTML"],Pl={key:0,class:"mt-4"},Ol=f(()=>n("h2",{class:"h4 secondary-heading"}," Requirements for Mastery ",-1)),Dl=["innerHTML"],Bl={class:"col-md-4 order-1 order-md-2"},El={class:"info-box p-2 mb-2"},Rl=["href"],Vl=["src"],Hl={class:"mt-2"},Nl=f(()=>n("h2",{class:"h4 secondary-heading"},"Level",-1)),zl={key:0},Fl={key:1},jl={key:2},Ul={key:3},ql={key:4},$l={class:"mt-2"},Wl=f(()=>n("h2",{class:"h4 secondary-heading"},"Author",-1)),Kl={key:0,"b-tooltip.hover":"",title:"This page was written or edited by a human",style:{height:"50px"}},Gl=f(()=>n("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 320 512",height:"22"},[n("path",{d:"M112 48a48 48 0 1 1 96 0 48 48 0 1 1 -96 0zm40 304l0 128c0 17.7-14.3 32-32 32s-32-14.3-32-32l0-223.1L59.4 304.5c-9.1 15.1-28.8 20-43.9 10.9s-20-28.8-10.9-43.9l58.3-97c17.4-28.9 48.6-46.6 82.3-46.6l29.7 0c33.7 0 64.9 17.7 82.3 46.6l58.3 97c9.1 15.1 4.2 34.8-10.9 43.9s-34.8 4.2-43.9-10.9L232 256.9 232 480c0 17.7-14.3 32-32 32s-32-14.3-32-32l0-128-16 0z",fill:"black"})],-1)),Yl=[Gl],Jl={key:1,"b-tooltip.hover":"",title:"This page was written by an AI",style:{height:"50px"}},Zl=f(()=>n("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 640 512",height:"22"},[n("path",{d:"M320 0c17.7 0 32 14.3 32 32l0 64 120 0c39.8 0 72 32.2 72 72l0 272c0 39.8-32.2 72-72 72l-304 0c-39.8 0-72-32.2-72-72l0-272c0-39.8 32.2-72 72-72l120 0 0-64c0-17.7 14.3-32 32-32zM208 384c-8.8 0-16 7.2-16 16s7.2 16 16 16l32 0c8.8 0 16-7.2 16-16s-7.2-16-16-16l-32 0zm96 0c-8.8 0-16 7.2-16 16s7.2 16 16 16l32 0c8.8 0 16-7.2 16-16s-7.2-16-16-16l-32 0zm96 0c-8.8 0-16 7.2-16 16s7.2 16 16 16l32 0c8.8 0 16-7.2 16-16s-7.2-16-16-16l-32 0zM264 256a40 40 0 1 0 -80 0 40 40 0 1 0 80 0zm152 40a40 40 0 1 0 0-80 40 40 0 1 0 0 80zM48 224l16 0 0 192-16 0c-26.5 0-48-21.5-48-48l0-96c0-26.5 21.5-48 48-48zm544 0c26.5 0 48 21.5 48 48l0 96c0 26.5-21.5 48-48 48l-16 0 0-192 16 0z",fill:"black"})],-1)),Ql=[Zl],Xl={key:0,class:"mt-4"},ta=f(()=>n("h2",{class:"h4 secondary-heading"},"Learning Objectives",-1)),ea={class:"bg-white rounded p-2"},sa={class:"d-flex mb-3 justify-content-between"},ia=f(()=>n("div",null,[n("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",width:"6",height:"6"},[n("path",{d:"M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512z"})])],-1)),oa={class:"ms-2 w-100"},na={class:"mb-0"},ra={key:0},la=["onClick"],aa={key:0,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",width:"18",height:"18"},ca=f(()=>n("path",{d:"M256 80c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 144L48 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l144 0 0 144c0 17.7 14.3 32 32 32s32-14.3 32-32l0-144 144 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-144 0 0-144z"},null,-1)),ha=[ca],ua={key:1,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",width:"18",height:"18"},da=f(()=>n("path",{d:"M432 256c0 17.7-14.3 32-32 32L48 288c-17.7 0-32-14.3-32-32s14.3-32 32-32l352 0c17.7 0 32 14.3 32 32z"},null,-1)),pa=[da],fa={key:1},ga=f(()=>n("div",{class:"row"},[n("div",{class:"col col-md-8 p-4 p-md-0"},[n("hr",{class:"border border-2 opacity-100 hr"})])],-1)),_a={class:"row mt-3"},ma=f(()=>n("div",{class:"h1-title"},"Filter",-1)),ya={class:"control control-checkbox"},wa={class:"my-auto mx-2 me-4"},va=["value"],ka=f(()=>n("div",{class:"control_indicator"},null,-1)),ba={key:0,class:"row mt-3 mb-3"},Ta={key:1},Ca={class:"row mt-3 mb-3"},xa=f(()=>n("p",null," ",-1)),Sa={class:"modal-content asking-modal"},La=f(()=>n("p",null,"URL copied to clipboard",-1)),Ma={class:"d-flex justify-content-end gap-2"},Aa=f(()=>n("span",{class:"d-none d-md-block"}," OK ",-1)),Ia=f(()=>n("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",width:"18",height:"18",fill:"white",class:"d-md-none"},[n("path",{d:"M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM369 209L241 337c-9.4 9.4-24.6 9.4-33.9 0l-64-64c-9.4-9.4-9.4-24.6 0-33.9s24.6-9.4 33.9 0l47 47L335 175c9.4-9.4 24.6-9.4 33.9 0s9.4 24.6 0 33.9z"})],-1)),Pa=[Aa,Ia],Oa={key:1,class:"modal"},Da={class:"modal-content"},Ba={class:"heading h5"},Ea=f(()=>n("p",null,"The next skills in this branch are:",-1)),Ra={key:3,class:"modal"},Va={class:"modal-content"},Ha={key:0},Na=f(()=>n("p",null," Here is where you can learn about a subject, find resources for mastering it, and take a test to demonstrate your mastery. ",-1)),za={key:1},Fa=f(()=>n("p",null,' The "Requirements for Mastery" and "Learning Objectives" sections explain everything one needs to learn to master the skill. ',-1)),ja={key:4,class:"modal"},Ua={class:"modal-content"},qa={key:0},$a=f(()=>n("p",null," Here is where you can learn about a subject, find resources for mastering it, and take a test to demonstrate your mastery. ",-1)),Wa={key:1},Ka=f(()=>n("p",null,' The "Requirements for mastery" section explains everything a student needs to learn to master the skill. ',-1)),Ga={key:2},Ya=f(()=>n("p",null,' At the bottom of the page, in the "Best Places To Learn This" section, students can find various sites and resources to learn about this topic. ',-1)),Ja=f(()=>n("p",null,"You can add more, vote on these, or edit them.",-1)),Za={key:5,class:"modal"},Qa={class:"modal-content"},Xa={key:0},tc=f(()=>n("p",null," This page is where students can learn about, and take a test to try to master, this skill. ",-1)),ec={key:1},sc=f(()=>n("p",null,' The "Requirements for mastery" section explains everything a student needs to learn to master the skill. ',-1)),ic={key:2},oc=f(()=>n("p",null,' At the bottom of the page, in the "Best Places To Learn This" section, students can find various sites and resources to learn about this topic. ',-1)),nc=f(()=>n("p",null,"You can add more and vote on these.",-1));function rc(s,t,e,i,o,r){var I;const c=y("router-link"),h=y("LearningObjectiveAITutor"),g=y("AITutor"),d=y("Forum"),w=y("FlagModals");return l(),a(S,null,[n("div",wr,[n("div",{id:"skill-info-container",class:k({domain:o.skill.type=="domain"})},[n("div",null,[n("div",vr,[n("h1",kr,b(o.skill.name),1),i.userDetailsStore.isSkillsLocked==1&&i.userDetailsStore.role=="student"&&!o.isUnlocked&&!o.isMastered&&o.showAncestorLink?(l(),m(c,{key:0,to:"/skills/"+o.ancestor,class:"btn assessment-btn me-1"},{default:T(()=>[br,x("   Go to Nearest Unlocked Skill ")]),_:1},8,["to"])):i.userDetailsStore.role=="student"&&!o.isMastered&&o.skill.type!="domain"&&o.skill.id?(l(),m(c,{key:1,class:"btn me-1 assessment-btn",to:o.skill.id+"/assessment"},{default:T(()=>[Tr,x(" Take the Test "),Cr]),_:1},8,["to"])):i.userDetailsStore.role=="student"&&!o.isMastered&&o.skill.type=="domain"?(l(),a("button",{key:2,onClick:t[0]||(t[0]=p=>r.MakeMastered()),class:"btn me-1 assessment-btn"},[xr,x(" Mark complete "),Sr])):i.sessionDetailsStore.isLoggedIn?u("",!0):(l(),m(c,{key:3,class:"btn me-1 assessment-btn",to:"/login"},{default:T(()=>[Lr,o.skill.type!="domain"?(l(),a("span",Mr,"Take the Test")):(l(),a("span",Ar,"Mark Complete")),Ir]),_:1}))]),i.userDetailsStore.role=="student"&&o.showTutorialTip2?(l(),a("div",Pr,[n("div",{class:k(["explain-tool-tip hovering-info-panel",o.isMobileCheck>576?"triangle-top-right":"triangle-top-left"])},[n("div",Or,[Dr,Br,n("button",{class:"btn primary-btn",onClick:t[1]||(t[1]=p=>r.progressTutorial(2))}," next ")])],2)])):u("",!0),i.userDetailsStore.role=="admin"?(l(),a("div",Er,[n("p",null,b(o.skill.description),1)])):u("",!0),Rr]),n("div",Vr,[n("div",Hr,[n("div",{class:k(["d-flex",{"justify-content-center":o.isMobileCheck<576}])},[i.sessionDetailsStore.isLoggedIn?(l(),m(c,{key:0,to:"/skills/edit/"+o.skillUrl,class:"edit-btn btn primary-btn me-1"},{default:T(()=>[o.isMobileCheck>576?(l(),a("span",Nr,"Edit  ")):u("",!0),zr]),_:1},8,["to"])):u("",!0),i.userDetailsStore.role=="admin"||i.userDetailsStore.role=="editor"?(l(),m(c,{key:1,to:"/skills/history/"+this.skillUrl,class:"btn primary-btn me-1"},{default:T(()=>[o.isMobileCheck>576?(l(),a("span",Fr,"History ")):u("",!0),jr]),_:1},8,["to"])):u("",!0),o.skill.type!="domain"&&i.sessionDetailsStore.isLoggedIn&&o.isMastered==!1&&o.isUnlocked==!1&&o.isGoal==!1&&i.userDetailsStore.role=="student"?(l(),a("button",{key:2,class:"btn primary-btn",onClick:t[2]||(t[2]=p=>r.openModal(o.skill))},[x(" Create goal  "),Ur])):u("",!0),o.toggleModal?(l(),a("div",{key:3,onClick:t[5]||(t[5]=Qt((...p)=>r.closeModal&&r.closeModal(...p),["self"])),class:"modal"},[n("div",qr,[n("p",null,[x(" Are you sure you want to create a goal for "),n("span",$r,b((I=o.selectedSkill)==null?void 0:I.name),1),x("? ")]),n("div",Wr,[n("button",{class:"btn red-btn",onClick:t[3]||(t[3]=(...p)=>r.closeModal&&r.closeModal(...p))}," No "),n("button",{class:"btn primary-btn",onClick:t[4]||(t[4]=(...p)=>r.confirmCreateGoal&&r.confirmCreateGoal(...p))}," Yes ")])])])):u("",!0)],2),n("div",Kr,[n("button",{onClick:t[6]||(t[6]=(...p)=>r.copyShareableURLToClipBoard&&r.copyShareableURLToClipBoard(...p)),class:"btn me-1"},Yr),i.sessionDetailsStore.isLoggedIn?(l(),a("button",{key:0,onClick:t[7]||(t[7]=p=>o.showFlaggingModal=!0),class:"btn","b-tooltip.hover":"",title:"Report this skill to the admin if it has errors"},Zr)):u("",!0),n("button",{class:"btn primary-btn me-1",onClick:t[8]||(t[8]=(...p)=>r.restartTutorial&&r.restartTutorial(...p))},Xr)])]),i.userDetailsStore.role=="student"&&o.showTutorialTip3?(l(),a("div",tl,[n("div",el,[n("div",sl,[il,ol,n("button",{class:"btn primary-btn",onClick:t[9]||(t[9]=p=>r.progressTutorial(3))}," next ")])])])):u("",!0),i.userDetailsStore.role=="student"&&o.showTutorialTip4?(l(),a("div",nl,[n("div",rl,[n("div",ll,[al,n("button",{class:"btn primary-btn",onClick:t[10]||(t[10]=p=>r.progressTutorial(4))}," next ")])])])):u("",!0),i.userDetailsStore.role=="editor"&&o.showTutorialTip2?(l(),a("div",cl,[n("div",hl,[n("div",ul,[dl,n("button",{class:"btn primary-btn",onClick:t[11]||(t[11]=p=>r.progressTutorial(2))}," next ")])])])):u("",!0),i.userDetailsStore.role=="editor"&&o.showTutorialTip3?(l(),a("div",pl,[n("div",fl,[n("div",gl,[_l,n("button",{class:"btn primary-btn",onClick:t[12]||(t[12]=p=>r.progressTutorial(3))}," next ")])])])):u("",!0),i.userDetailsStore.role=="instructor"&&o.showTutorialTip2?(l(),a("div",ml,[n("div",yl,[n("div",wl,[vl,n("button",{class:"btn primary-btn",onClick:t[13]||(t[13]=p=>r.progressTutorial(2))}," next ")])])])):u("",!0),i.userDetailsStore.role=="instructor"&&o.showTutorialTip3?(l(),a("div",kl,[n("div",bl,[n("div",Tl,[Cl,n("button",{class:"btn primary-btn",onClick:t[14]||(t[14]=p=>r.progressTutorial(3))}," next ")])])])):u("",!0),xl]),n("div",Sl,[n("div",Ll,[n("div",Ml,[Al,n("div",{class:"bg-white rounded p-2",innerHTML:o.skill.introduction},null,8,Il)]),o.skill.type!="domain"?(l(),a("div",Pl,[Ol,n("div",{class:"bg-white rounded p-2 mastery-requirements-section",innerHTML:o.skill.mastery_requirements},null,8,Dl)])):u("",!0)]),n("div",Bl,[n("div",El,[n("a",{href:o.skill.image_url},[n("img",{src:o.skill.image_thumbnail_url,onError:t[15]||(t[15]=(...p)=>r.imageUrlAlternative&&r.imageUrlAlternative(...p)),class:"rounded img-fluid"},null,40,Vl)],8,Rl),n("div",Hl,[Nl,o.skill.level=="grade_school"?(l(),a("span",zl,"Grade School")):o.skill.level=="middle_school"?(l(),a("span",Fl,"Middle School")):o.skill.level=="high_school"?(l(),a("span",jl,"High School")):o.skill.level=="college"?(l(),a("span",Ul,"College")):o.skill.level=="phd"?(l(),a("span",ql,"PHD")):u("",!0)]),n("div",$l,[Wl,o.skill.is_human_edited?(l(),a("div",Kl,Yl)):(l(),a("div",Jl,Ql))])])])]),o.skill.type!="domain"&&o.showLearningObjectives?(l(),a("div",Xl,[ta,n("div",ea,[(l(!0),a(S,null,V(o.skill.learningObjectives,p=>(l(),a("div",sa,[ia,n("div",oa,[n("p",na,b(p.objective),1),p.showAI?(l(),a("div",ra,[E(h,{learningObjective:p.objective,learningObjectiveId:p.id,skillName:o.skill.name,skillUrl:o.skill.url,skillLevel:o.skill.level},null,8,["learningObjective","learningObjectiveId","skillName","skillUrl","skillLevel"])])):u("",!0)]),i.sessionDetailsStore.isLoggedIn?(l(),a("button",{key:0,class:"btn plus-btn",onClick:wt=>p.showAI=!p.showAI},[p.showAI?(l(),a("svg",ua,pa)):(l(),a("svg",aa,ha))],8,la)):u("",!0)]))),256))])])):u("",!0),i.userDetailsStore.role=="admin"?(l(),a("div",fa,[ga,n("div",_a,[ma,(l(!0),a(S,null,V(i.tagsStore.tagsList,p=>(l(),a("label",ya,[n("span",wa,b(p.name),1),$(n("input",{type:"checkbox",value:p.id,"onUpdate:modelValue":t[16]||(t[16]=wt=>o.filters=wt),disabled:""},null,8,va),[[Xt,o.filters]]),ka]))),256))])])):u("",!0)],2),i.sessionDetailsStore.isLoggedIn?(l(),a("div",ba,[o.isSkillLoaded&&i.userDetailsStore.role==="student"&&o.skill.type!=="domain"?(l(),m(g,{key:0,skill:o.skill},null,8,["skill"])):u("",!0)])):u("",!0),o.skill.type!="domain"?(l(),a("div",Ta,[n("div",Ca,[o.isSkillLoaded?(l(),m(d,{key:0,skillId:o.skill.id,showTutorialTip6:o.showTutorialTip6,userRole:i.userDetailsStore.role,onProgressTutorial:r.progressTutorial},null,8,["skillId","showTutorialTip6","userRole","onProgressTutorial"])):u("",!0)])])):u("",!0),xa]),o.showConfirmModal?(l(),a("div",{key:0,onClick:t[18]||(t[18]=p=>o.showConfirmModal=!1),class:"modal"},[n("div",Sa,[La,n("div",Ma,[n("button",{type:"button",class:"btn primary-btn modal-btn",onClick:t[17]||(t[17]=p=>o.showConfirmModal=!1)},Pa)])])])):u("",!0),o.showCategoryCompletedModal?(l(),a("div",Oa,[n("div",Da,[n("h1",Ba,"You have completed "+b(o.skill.name)+"!",1),Ea,(l(!0),a(S,null,V(o.nextSkillsInBranch,p=>(l(),a("div",null,[E(c,{class:k([{"grade-school":p.level=="grade_school","middle-school":p.level=="middle_school","high-school":p.level=="high_school",college:p.level=="college",phd:p.level=="phd"},"skill-link btn mb-1"]),to:`/skills/${p.url}`,target:"_blank"},{default:T(()=>[x(b(p.name),1)]),_:2},1032,["class","to"])]))),256)),n("button",{class:"btn primary-btn ms-auto me-0",onClick:t[19]||(t[19]=p=>o.showCategoryCompletedModal=!1)}," Close ")])])):u("",!0),o.showFlaggingModal?(l(),m(w,{key:2,userId:i.userDetailsStore.userId,contentType:"skill",contentId:o.skillId},null,8,["userId","contentId"])):u("",!0),i.userDetailsStore.role=="student"&&(o.showTutorialTip1||o.showTutorialTip5)?(l(),a("div",Ra,[n("div",Va,[o.showTutorialTip1?(l(),a("div",Ha,[Na,n("button",{class:"btn primary-btn",onClick:t[20]||(t[20]=p=>r.progressTutorial(1))}," next ")])):o.showTutorialTip5?(l(),a("div",za,[Fa,n("button",{class:"btn primary-btn",onClick:t[21]||(t[21]=p=>r.progressTutorial(5))}," next ")])):u("",!0)])])):u("",!0),i.userDetailsStore.role=="editor"&&(o.showTutorialTip1||o.showTutorialTip4||o.showTutorialTip5)?(l(),a("div",ja,[n("div",Ua,[o.showTutorialTip1?(l(),a("div",qa,[$a,n("button",{class:"btn primary-btn",onClick:t[22]||(t[22]=p=>r.progressTutorial(1))}," next ")])):o.showTutorialTip4?(l(),a("div",Wa,[Ka,n("button",{class:"btn primary-btn",onClick:t[23]||(t[23]=p=>r.progressTutorial(4))}," next ")])):o.showTutorialTip5?(l(),a("div",Ga,[Ya,Ja,n("button",{class:"btn primary-btn",onClick:t[24]||(t[24]=p=>r.progressTutorial(5))}," next ")])):u("",!0)])])):u("",!0),i.userDetailsStore.role=="instructor"&&(o.showTutorialTip1||o.showTutorialTip4||o.showTutorialTip5)?(l(),a("div",Za,[n("div",Qa,[o.showTutorialTip1?(l(),a("div",Xa,[tc,n("button",{class:"btn primary-btn",onClick:t[25]||(t[25]=p=>r.progressTutorial(1))}," next ")])):o.showTutorialTip4?(l(),a("div",ec,[sc,n("button",{class:"btn primary-btn",onClick:t[26]||(t[26]=p=>r.progressTutorial(4))}," next ")])):o.showTutorialTip5?(l(),a("div",ic,[oc,nc,n("button",{class:"btn primary-btn",onClick:t[27]||(t[27]=p=>r.progressTutorial(5))}," next ")])):u("",!0)])])):u("",!0)],64)}const lc=O(yr,[["render",rc],["__scopeId","data-v-599a21d4"]]),ac={data(){return{skillId:this.$route.params.skillId}},components:{ShowSkill:lc}},cc={class:"position-relative d-flex"},hc={class:"container"};function uc(s,t,e,i,o,r){const c=y("ShowSkill");return l(),a("div",cc,[n("div",hc,[E(c)])])}const wc=O(ac,[["render",uc]]);export{wc as default};
