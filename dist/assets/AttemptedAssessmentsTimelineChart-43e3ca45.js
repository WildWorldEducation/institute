import{_ as lt,e as ct,H as ut,o as ft,c as ht}from"./main-2721b449.js";import{S as Ke,r as bt,e as kt,a as _t,s as R}from"./transform-35b9fb9e.js";import{u as Ct,a as xt,t as Xe,b as Je,e as It,c as Et}from"./time-962c8065.js";import{m as He}from"./linear-c968f95f.js";import{p as St}from"./band-039a8264.js";function se(e){return typeof e=="string"?new Ke([document.querySelectorAll(e)],[document.documentElement]):new Ke([kt(e)],bt)}var mt="%Y-%m-%dT%H:%M:%S.%LZ";function Dt(e){return e.toISOString()}Date.prototype.toISOString||Ct(mt);function Lt(e){var t=new Date(e);return isNaN(t)?null:t}var Mt=+new Date("2000-01-01T00:00:00.000Z")?Lt:xt(mt);const Tt=Mt,ce={second:"%Y-%m-%d %H:%M:%S",minute:"%Y-%m-%d %H:%M",hour:"%Y-%m-%d %H:00",day:"%Y-%m-%d",week:"%Y week %W",month:"%Y-%m",quarter:"%Y-Q%Q",year:"%Y"};function At(e){function t(n,o){return a=>(o(a),n)}return Object.keys(e).reduce((n,o)=>(n[o]=t(n,e[o]),n),{})}const ve="milestones",et=ve+"__category_label",zt=ve+"__horizontal_line",Ot=ve+"__vertical_line",we=ve+"__group",wt=we+"__bullet",ye=we+"__label",ze=ye+"-last",Ye=ye+"-above",Be=ye+"__text",tt=Be+"__title",dt=Be+"__event",nt=dt+"--hover",q={DISTRIBUTION:"top-bottom",OPTIMIZE:!1,ORIENTATION:"horizontal",SCALE_TYPE:"time",MAPPING:{category:void 0,entries:void 0,timestamp:"timestamp",value:"value",text:"text",url:"url",id:"id",textStyle:"textStyle",titleStyle:"titleStyle"},LABEL_FORMAT:"%Y-%m-%d %H:%M",USE_LABELS:!0,AGGREGATE_BY:"minute",AUTO_RESIZE:!0,URL_TARGET:"_self"};function Ne(e,t){let n=e%2;return t==="top"?n=!0:t==="bottom"&&(n=!1),n>0}var G="$";function We(){}We.prototype=Pe.prototype={constructor:We,has:function(e){return G+e in this},get:function(e){return this[G+e]},set:function(e,t){return this[G+e]=t,this},remove:function(e){var t=G+e;return t in this&&delete this[t]},clear:function(){for(var e in this)e[0]===G&&delete this[e]},keys:function(){var e=[];for(var t in this)t[0]===G&&e.push(t.slice(1));return e},values:function(){var e=[];for(var t in this)t[0]===G&&e.push(this[t]);return e},entries:function(){var e=[];for(var t in this)t[0]===G&&e.push({key:t.slice(1),value:this[t]});return e},size:function(){var e=0;for(var t in this)t[0]===G&&++e;return e},empty:function(){for(var e in this)if(e[0]===G)return!1;return!0},each:function(e){for(var t in this)t[0]===G&&e(this[t],t.slice(1),this)}};function Pe(e,t){var n=new We;if(e instanceof We)e.each(function(i,c){n.set(c,i)});else if(Array.isArray(e)){var o=-1,a=e.length,s;if(t==null)for(;++o<a;)n.set(o,e[o]);else for(;++o<a;)n.set(t(s=e[o],o,e),s)}else if(e)for(var u in e)n.set(u,e[u]);return n}function Ue(){var e=[],t=[],n,o,a;function s(i,c,p,h){if(c>=e.length)return n!=null&&i.sort(n),o!=null?o(i):i;for(var l=-1,g=i.length,T=e[c++],A,b,N=Pe(),I,H=p();++l<g;)(I=N.get(A=T(b=i[l])+""))?I.push(b):N.set(A,[b]);return N.each(function(m,C){h(H,C,s(m,c,p,h))}),H}function u(i,c){if(++c>e.length)return i;var p,h=t[c-1];return o!=null&&c>=e.length?p=i.entries():(p=[],i.each(function(l,g){p.push({key:g,values:u(l,c)})})),h!=null?p.sort(function(l,g){return h(l.key,g.key)}):p}return a={object:function(i){return s(i,0,Bt,Nt)},map:function(i){return s(i,0,st,it)},entries:function(i){return u(s(i,0,st,it),0)},key:function(i){return e.push(i),a},sortKeys:function(i){return t[e.length-1]=i,a},sortValues:function(i){return n=i,a},rollup:function(i){return o=i,a}}}function Bt(){return{}}function Nt(e,t,n){e[t]=n}function st(){return Pe()}function it(e,t,n){e.set(t,n)}function ot(){}var le=Pe.prototype;ot.prototype={constructor:ot,has:le.has,add:function(e){return e+="",this[G+e]=e,this},remove:le.remove,clear:le.clear,values:le.keys,size:le.size,empty:le.empty,each:le.each};function pt(e,t){return parseInt(e.style[t].replace("px",""),10)}const ge=6,Wt=(e,t,n,o,a,s,u,i,c,p,h,l,g,T,A,b=!0,N="time")=>{let I=l==="horizontal"&&b?n+u:n-u,H;do if(l==="horizontal"&&b?I+=u:I-=u,H=g._groups[I],typeof H>"u")break;while(i>=H[0][h]);let m;typeof o.category>"u"?m=a[s.timelineIndex][I]:m=a[s.timelineIndex].entries[I];let C=pt(t,p);if(typeof m<"u"){const W=N==="ordinal"?m.key:e(m.key),X=A(W);l==="horizontal"&b?C=X-c-ge:l==="horizontal"&!b?C=X-ge:C=c-X-ge}else l==="horizontal"&b?C=T-c-ge:(l==="horizontal"&!b,C=c-ge);return u<0?Math.min(c,C):C},Pt=(e,t,n,o)=>e==="horizontal"?t[n+o]:t[n-o],rt=(e,t,n,o,a)=>{const u=Pt(a,n,e,t);let i=0;return typeof u<"u"&&(i=u[0][o]+3),i},at=20,ie=(e,t)=>parseInt(e.style(t).replace("px",""),10),Oe=e=>e.select(function(){return this.parentNode}),Rt=(e,t,n)=>{const o=e%t;return(n+o)%t!==0},Gt=(e,t,n,o,a,s,u,i,c,p,h="time")=>{const l=Ue().key(N=>se(N).data()[0].timelineIndex).entries(u._groups),g=t==="top-bottom"?2:1,T=N=>{let I=0;return l.forEach(H=>{const m=H.values;m.forEach(C=>{const W=se(C).data()[0],X=s==="horizontal"?60:20,z=s==="horizontal"?m.length-W.index-1:W.index,te=se(m[z]).data()[0],Re=h==="ordinal"?te.key:e(te.key),Y=p(Re),V=m[z][0];let J=z===m.length-1;!J&&t==="top-bottom"&&(J=z===m.length-2&&i-Y<60);const Ee=s==="horizontal"?"offsetWidth":"offsetHeight",ue=s==="horizontal"?"width":"height",fe=pt(V,ue),_=se(m[z]);let y=J?!0:Oe(_).classed(ze);const he=s==="horizontal"?"offsetHeight":"offsetWidth",be=s==="horizontal"?"padding-bottom":"padding-right",Se=s==="horizontal"?"padding-top":"padding-left",ee=Ne(z,t)?be:Se,De=y?Y-fe<0:Y+fe>i;if(N===0&&(y=J?!0:De,_.style(ee,"0px"),Oe(_).classed(ze,y)),V[Ee]>fe||fe<X||y||De){let E=null,r=0,ne=s==="horizontal"?g-1:g+1;do if(s==="horizontal"?ne++:ne--,r++,ne>0){const Z=rt(z,g,m,he,s),Q=s==="horizontal"?rt(z,g*-1,m,he,s):Z;let S=Z<=Q&&!J;!S&&!J&&(S=Y<X);let v=S?Z:Q;J&&(v=0);const D=S?g:g*-1;_.style(ee,v+"px"),Oe(_).classed(ze,!S),E=Wt(e,V,z,o,a,W,D,v,Y,ue,he,s,u,i,p,S,h)}while(E<V[Ee]&&r<at);s==="horizontal"&&(E=Math.min(n,E)),_.style(c,E+"px");const ke=ie(_.select(".wrapper"),"width");if(ke<E&&(E=ke+6,_.style(c,E+"px")),N>0&&s==="horizontal"){const Z=ie(_,"width"),Q=y?Y-Z:Y+Z;m.forEach((v,D)=>{const F=se(v).data()[0];if(F.key===te.key||Rt(z,g,D))return;const me=h==="ordinal"?F.key:e(F.key);let L=p(me)-5;const O=L,de=se(m[D]),oe=Oe(de).classed(ze);if(y&&!oe){const M=ie(de,"width");L=L+M+5}if(!y&&oe){const M=ie(de,"width");L=L-M-5}const _e=y?L>Q:Q>O,Le=y?O<Y:O>Y;if(_e&&Le){const M=v[0][he];if(ie(_,ee)<M){const qe=y?L-Q:Q-O,Ce=ie(_,c)-qe-6;Ce>X?(E=Math.min(E,Ce),_.style(c,`${E}px`)):_.style(ee,`${M+5}px`),I++}}});let S=Number.POSITIVE_INFINITY;m.forEach((v,D)=>{if((Ne(D,t)?be:Se)!==ee)return;const me=se(m[D]),L=ie(me,ee);S=Math.min(S,L)}),S>0&&m.forEach((v,D)=>{const F=z%g;if((D+F)%g!==0)return;const L=se(m[D]),O=ie(L,ee);L.style(ee,`${O-S}px`)})}}})}),I};let A=0,b=0;do b=T(A),A++,A===1&&(b=1);while(A<at&&b>0)};function Fe(e){if(e==="%Y-Q%Q"){const t=Xe(ce.month);return n=>{const o=t(n),a=o.split("-")[1],s=Math.ceil(parseInt(a)/3);return o.split("-")[0]+"-Q"+s}}return Xe(e)}function $e(e){if(e==="%Y-Q%Q"){const t=Je(ce.month);return n=>{if(n.search("-Q")===-1){const a=Math.ceil(parseInt(n.split("-")[1])/3)*3-2+"",s=a.length<2?"0"+a:a;return t(n.split("-")[0]+"-"+s)}else{const o=parseInt(n.split("-")[1][1])*3+"",a=o.length<2?"0"+o:o;return t(n.split("-")[0]+"-"+a)}}}return Je(e)}function Ht(e,t,n,o,a="time"){const s=function(i){return a==="ordinal"?i[n.value]:e(o(i[n.timestamp]))};if(typeof n.category<"u"&&typeof n.entries<"u")return t=t.map((i,c)=>({category:i[n.category],entries:u(i[n.entries],c)})),t;typeof t<"u"&&!Array.isArray(t[0])&&(t=[t]);function u(i,c){const p=a==="ordinal"?Ue().key(s).entries(i):Ue().key(s).sortKeys(_t).entries(i);if(a==="ordinal"){const h={};i.forEach((l,g)=>{const T=s(l);!h[T]&&h[T]!==0&&(h[T]=g)}),p.sort((l,g)=>(h[l.key]||0)-(h[g.key]||0))}return p.map((h,l)=>(h.index=l,h.timelineIndex=c,h.scaleType=a,h))}return t.map((i,c)=>u(i,c))}function gt(e){let t=q.DISTRIBUTION;function n(r){t=r}let o=q.OPTIMIZE;function a(r){o=r}let s=q.ORIENTATION;function u(r){s=r,R(e).html("")}let i=q.SCALE_TYPE;function c(r){(r==="time"||r==="ordinal")&&(i=r,R(e).html(""))}let p=Tt;function h(r){p=$e(r)}let l=Object.assign({},q.MAPPING);function g(r){l=Object.assign({},l,r)}let T;function A(r){T=Fe(r)}A(q.LABEL_FORMAT);let b;function N(r){Array.isArray(r)&&r.length==2&&(b=r)}let I;function H(r){I=r}H(q.USE_LABELS);let m;function C(r){typeof r=="string"&&["_blank","_self","_parent","_top"].includes(r.toLowerCase())&&(m=r)}C(q.URL_TARGET);let W;function X(r){W=r}function z(r){return typeof W=="function"&&(R(this).classed(nt,!0),W(r)),r}let te;function Re(r){te=r}function Y(r){return typeof W=="function"&&(R(this).classed(nt,!1),te(r)),r}let V;function J(r){V=r}function Ee(r){return typeof V=="function"&&V(r),r}let ue;function fe(r){ue=r}let _=Fe(ce[q.AGGREGATE_BY]),y=$e(ce[q.AGGREGATE_BY]);function he(r){_=Fe(ce[r]),y=$e(ce[r]),A(ce[r])}const be={current:q.AUTO_RESIZE},Se=()=>{R(e).node()!==null&&window.requestAnimationFrame(()=>{be.current&&E()})};new ResizeObserver(Se).observe(typeof e=="string"?document.querySelector(e):e);function De(r){be.current=r}function E(r){const ne=s==="horizontal"?"width":"height",ke=s==="horizontal"?"margin-left":"margin-top",Z=s==="horizontal"?zt:Ot,Q=s==="horizontal"?180:100,S=R(e).selectAll("."+ve),v=typeof r<"u"?Ht(_,r,l,p,i):S.data(),D=S.data(v),F=D.enter().append("div").attr("class",ve);D.exit().remove();const me=11,L=parseFloat(R(e).style(ne))-me;typeof l.category<"u"?(F.append("div").attr("class",et).text(k=>k.category),F.append("div").attr("class","data-js-timeline").append("div").attr("class",Z)):F.append("div").attr("class",Z);const O=D.merge(F),de=[],oe=O.selectAll("."+et);oe.each((k,w,$)=>{de.push($[w].offsetWidth)});const _e=Math.round(He(de)||0),Le=10,M=L-_e-Le;oe.style("width",_e+"px"),s==="vertical"&&(oe.style("margin-left","-50%"),oe.style("text-align","center")),O.selectAll(".data-js-timeline").style(ke,_e+Le+"px"),O.selectAll("."+Z).style(ne,M+"px");const Me=(typeof l.category>"u"?O:O.selectAll(".data-js-timeline")).selectAll("."+we).data(k=>typeof l.category>"u"?k:k.entries),Ce=v.reduce((k,w)=>((typeof l.category>"u"?w:w.entries).map(Te=>k.push(Te.key)),k),[]),vt=typeof b<"u"?b.map(y):It(Ce,k=>y(k)),xe=i==="ordinal"?St().range([0,M]).domain(Ce):Et().rangeRound([0,M]).domain(vt),Ve=Me.enter().append("div").attr("class",we);Me.exit().remove(),Ve.append("div").attr("class",wt);const Ze=Ve.merge(Me).style(ke,k=>{k.scaleType=i;const w=i==="ordinal"?k.key:y(k.key);return xe(w)+"px"});if(I){const k=Ze.selectAll("."+ye+"-"+s).data(f=>[f]),$=k.enter().append("div").attr("class",ye+"-"+s).merge(k).classed(Ye+"-"+s,f=>Ne(f.index,t)).selectAll("."+Be+"-"+s).data(f=>[f]),Te=$.enter().append("div").attr("class",Be+"-"+s).merge($).style(ne,f=>{f.scaleType=i;const j=i==="ordinal"?f.key:y(f.key),re=xe(j);let ae,B,d;const P=f.index+1,K=t==="top-bottom"?2:1;typeof l.category>"u"?(ae=v[f.timelineIndex][f.index+K],B=v[f.timelineIndex][f.index-K],d=v[f.timelineIndex].length):(ae=v[f.timelineIndex].entries[f.index+K],B=v[f.timelineIndex].entries[f.index-K],d=v[f.timelineIndex].entries.length);let U;const x=s==="horizontal"?ae:B,pe=s==="horizontal"?B:ae;if(typeof x<"u"){x.scaleType=i;const Ge=i==="ordinal"?x.key:y(x.key),Ie=xe(Ge);U=s==="horizontal"?Ie-re:re-Ie,d-P===2&&(U/=2)}else if(d-P===1)U=s==="horizontal"?M-re:re;else if(d-P===0)if(typeof pe<"u"){pe.scaleType=i;const Ge=i==="ordinal"?pe.key:y(pe.key),Ie=xe(Ge);U=s==="horizontal"?(M-Ie)/2:Ie/2}else U=M;const je=Math.max(0,U-6);return Math.min(s==="horizontal"?Q:je,je)+"px"}).each(function(f){const j=Ne(f.index,t),re=R(this);re.html(null);const ae=f.values.reduce((d,P)=>P[l.titleStyle]!==void 0?Object.assign(d,P[l.titleStyle]):d,{}),B=re.append("div").classed("wrapper",!0);if(!j||s==="vertical"){const d=B.append("span").classed(tt,!0);i==="ordinal"?d.text(f.key):d.text(T(y(f.key))),Object.entries(ae).forEach(([P,K])=>d.style(P,K)),B.append("br")}if(f.values.map((d,P)=>{P>0&&B.append("br");const K=Object.assign({},d[l.textStyle]),U=d[l.text];let x;["jpg","jpeg","gif","png","webp"].indexOf(U.split(".").pop())>-1?x=B.append("img").classed("milestones-label",!0).classed("milestones-image-label",!0).attr("height","100").attr("src",U):d[l.url]?x=B.append("a").classed("milestones-label",!0).classed("milestones-link-label",!0).attr("href",d[l.url]).attr("target",m).text(U):x=B.append("span").classed("milestones-label",!0).classed("milestones-text-label",!0).text(U),d[l.id]&&x.attr("id",d[l.id]),x.datum({text:d[l.text],timestamp:d[l.timestamp],attributes:d}),(typeof V=="function"||typeof te=="function"||typeof W=="function")&&x.classed(dt,!0),typeof V=="function"&&x.on("click",Ee),typeof te=="function"&&x.on("mouseleave",Y),typeof W=="function"&&x.on("mouseover",z),Object.entries(K).forEach(([pe,Qe])=>x.style(pe,Qe))}),j&&s==="horizontal"){B.append("br");const d=B.append("span").classed(tt,!0);i==="ordinal"?d.text(f.key):d.text(T(y(f.key))),Object.entries(ae).forEach(([P,K])=>d.style(P,K))}}),Ae=$.merge(Te);Ae.style("padding-top","0px").style("padding-bottom","0px"),o&&Gt(y,t,Q,l,v,s,Ae,M,ne,xe,i)}else Ze.selectAll("."+ye+"-"+s).remove();O.each((k,w,$)=>{const Ae=He(R($[w]).selectAll("* ."+Ye+"-"+s)._groups[0],j=>j.offsetHeight),f=He(R($[w]).selectAll("* :not(."+Ye+"-"+s+")")._groups[0],j=>j.offsetHeight);if(s==="horizontal")R($[w]).style("margin-top",10+(Ae||0)+"px").style("height",10+(f||0)+"px");else{const j=typeof l.category<"u"?Math.round(100/(v.length+1))*(w+1):"50";R($[w]).style("margin-top","50px").style("margin-left",j+"%").style("position","absolute")}}),typeof ue=="function"&&ue()}return At({aggregateBy:he,mapping:g,optimize:a,autoResize:De,orientation:u,distribution:n,scaleType:c,parseTime:h,labelFormat:A,urlTarget:C,useLabels:H,range:N,render:E,renderCallback:fe,onEventClick:J,onEventMouseLeave:Re,onEventMouseOver:X})}const Yt={setup(){const e=ct(),t=ut();return{userDetailsStore:e,userSkillsStore:t}},props:["data"],data(){return{chartOrientation:"horizontal"}},async mounted(){this.drawTimeLineChartWithMilesStone(),this.calculateChartLength(this.data)},methods:{drawTimeLineChartWithMilesStone(){gt("#passed-assessments-timeline").mapping({timestamp:"mastered_date",text:"labelName"}).aggregateBy("week").labelFormat("%d-%m-%Y").optimize(!0).orientation(this.chartOrientation).renderCallback(()=>{if(this.changeLabelColor(),this.chartOrientation==="vertical"){const t=document.getElementsByClassName("milestones")[0];t.style.marginLeft="30%"}}).render(this.data),this.changeBulletColor(),this.changeLabelColor()},calculateChartLength(e){const t=e[0].date,n=e[e.length-1].date,o=this.getDaysBetweenDates(t,n),a=e.length;this.chartWidth=o*3+a*50+"px"},getDaysBetweenDates(e,t){const n=new Date(e),o=new Date(t),a=n.getTime(),s=o.getTime(),u=Math.abs(s-a),i=1e3*60*60*24;return Math.round(u/i)},changeBulletColor(){const t=document.getElementsByClassName("milestones")[0].getElementsByClassName("milestones__group");for(let n=0;n<t.length;n++){const o=t[n],s=o.getElementsByClassName("milestones-link-label")[0].id,u=this.data.find(h=>h.id===parseInt(s)),c=o.getElementsByClassName("milestones__group__bullet")[0],p=this.mapSkillLevelWithColor(u.level);c.style.backgroundColor=p}},changeLabelColor(){this.data.forEach(e=>{const t=document.getElementById(e.id),n=this.data.find(a=>parseInt(t.id)===a.id),o=this.mapSkillLevelWithColor(n.level);t.style.color=o})},mapSkillLevelWithColor(e){switch(e){case"grade_school":return"#116b62";case"middle_school":return"#168216";case"high_school":return"#7d6a02";case"college":return"#ffa500";case"phd":return"#9e0000"}},handleOrientationBtnClick(e){this.chartOrientation=e,this.drawTimeLineChartWithMilesStone()}}},Ft={id:"passed-assessments-timeline"};function $t(e,t,n,o,a,s){return ft(),ht("div",Ft)}const en=lt(Yt,[["render",$t]]);const Ut={setup(){const e=ct(),t=ut();return{userDetailsStore:e,userSkillsStore:t}},props:["data"],data(){return{chartOrientation:"horizontal"}},async mounted(){this.drawTimeLineChartWithMilesStone(),this.calculateChartLength(this.data)},methods:{drawTimeLineChartWithMilesStone(){gt("#attempted-assessments-timeline").mapping({timestamp:"date",text:"labelName"}).aggregateBy("week").labelFormat("%d-%m-%Y").optimize(!0).orientation(this.chartOrientation).renderCallback(()=>{if(this.changeLabelColor(),this.chartOrientation==="vertical"){const t=document.getElementsByClassName("milestones")[0];t.style.marginLeft="30%"}}).render(this.data),this.changeBulletColor(),this.changeLabelColor()},calculateChartLength(e){const t=e[0].date,n=e[e.length-1].date,o=this.getDaysBetweenDates(t,n),a=e.length;this.chartWidth=o*3+a*50+"px"},getDaysBetweenDates(e,t){const n=new Date(e),o=new Date(t),a=n.getTime(),s=o.getTime(),u=Math.abs(s-a),i=1e3*60*60*24;return Math.round(u/i)},changeBulletColor(){const t=document.getElementsByClassName("milestones")[0].getElementsByClassName("milestones__group");for(let n=0;n<t.length;n++){const o=t[n],s=o.getElementsByClassName("milestones-link-label")[0].id,u=this.data.find(h=>h.id===parseInt(s)),c=o.getElementsByClassName("milestones__group__bullet")[0],p=this.mapSkillLevelWithColor(u.level);c.style.backgroundColor=p}},changeLabelColor(){this.data.forEach(e=>{const t=document.getElementById(e.id),n=this.data.find(a=>parseInt(t.id)===a.id),o=this.mapSkillLevelWithColor(n.level);t.style.color=o})},mapSkillLevelWithColor(e){switch(e){case"grade_school":return"#116b62";case"middle_school":return"#168216";case"high_school":return"#7d6a02";case"college":return"#ffa500";case"phd":return"#9e0000"}},handleOrientationBtnClick(e){this.chartOrientation=e,this.drawTimeLineChartWithMilesStone()}}},qt={id:"attempted-assessments-timeline"};function Vt(e,t,n,o,a,s){return ft(),ht("div",qt)}const tn=lt(Ut,[["render",Vt]]);export{tn as A,en as P};
