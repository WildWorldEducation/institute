import{u as P}from"./AnalyticsStore-43262f0a.js";import{_ as x,o as m,c as _,f as j,r as S,a,g as v,l as D,k as b,b as C,p as B,d as I}from"./main-75cfc7bf.js";import{s as g}from"./transform-62bed377.js";import{u as T,l as q}from"./line-69ff8f5e.js";import{e as R}from"./time-bec744cd.js";import{l as w,m as k,c as H,b as $,a as L}from"./linear-de29b0e6.js";import{o as M}from"./ordinal-ed23e132.js";import{c as O}from"./category10-63f9141e.js";import{b as V}from"./band-a97ffeb0.js";import{s as N}from"./sort-a49d696f.js";import"./point-ea70dc51.js";import"./colors-98f238a0.js";const z={name:"SchoolProgressChart",props:[],data(){return{axisData:[]}},mounted(){},methods:{createChart(t){g("svg").remove(),t.student.length>0?this.axisData=t.student:t.average.length>0?this.axisData=t.average:this.axisData=[];const l=Object.entries(t).map(([e,A])=>({name:e,values:A}));g("#progress-chart-container");const n=document.getElementById("progress-chart-container").clientWidth,o=document.getElementById("progress-chart-container").clientHeight,c=0,d=0,h=0,i=0,r=T(R(this.axisData,e=>e.date),[i,n-d]),p=w([0,k(this.axisData,e=>e.quantity)],[o-h,c]),y=M().domain(l.map(e=>e.name)).range(O),u=q().x(e=>r(e.date)).y(e=>p(e.quantity)),s=g("#progress-chart-container").append("svg").attr("width","100%").attr("height","100%").attr("viewBox",[0,0,+Math.min(n,o),+Math.min(n,o)]).attr("preserveAspectRatio","xMinYMin");s.append("g").attr("transform",`translate(0,${o-h})`).call(H(r).ticks(this.axisData.length).tickSizeOuter(0)),s.append("g").attr("transform",`translate(${i},0)`).call($(p).ticks(o/80)).call(e=>e.selectAll(".tick line").clone().attr("x2",n-i-d).attr("stroke-opacity",.1)),s.selectAll(".line").data(l).join("path").attr("fill","none").attr("stroke",e=>y(e.name)).attr("stroke-width",3).attr("d",e=>u(e.values))}}};function E(t,l,n,o,c,d){return null}const Y=x(z,[["render",E]]),W={name:"StudentComparisonChart",props:["data","colour"],data(){return{}},mounted(){},methods:{createChart(t){g("#student-comparison-container");const l=25,n=0,o=0,c=10,d=200,h=700,i=Math.ceil((t.length+.1)*l)+n+c,r=w().domain([0,k(t,s=>s.quantity)]).range([d,h-o]),p=V().domain(N(t,s=>-s.quantity).map(s=>s.name)).rangeRound([n,i-c]).padding(.1),y=r.tickFormat(20),u=g("#student-comparison-container").append("svg").attr("width",h).attr("height",i).attr("viewBox",[0,0,h,i]).attr("style","max-width: 100%; height: 100%; font: 14px sans-serif;");u.append("g").attr("fill",this.colour).selectAll().data(t).join("rect").attr("x",r(0)).attr("y",s=>p(s.name)).attr("width",s=>r(s.quantity)-r(0)).attr("height",p.bandwidth()),u.append("g").attr("fill","white").attr("text-anchor","end").selectAll().data(t).join("text").attr("x",s=>r(s.quantity)).attr("y",s=>p(s.name)+p.bandwidth()/2).attr("dy","0.35em").attr("dx",-4).text(s=>y(s.quantity)).call(s=>s.filter(e=>r(e.quantity)-r(0)<20).attr("dx",4).attr("fill","black").attr("text-anchor","start")),u.append("g").attr("transform",`translate(0,${n})`).call(L(r).ticks(0)).call(s=>s.select(".domain").remove()),u.append("g").attr("transform",`translate(${d},0)`).attr("style","font-size: 16px").call($(p).tickSizeOuter(0))}}},F={id:"student-comparison-container"};function U(t,l,n,o,c,d){return m(),_("div",F)}const G=x(W,[["render",U]]);const J={name:"Student-Dashboard",setup(){const t=j(),l=P();return{userDetailsStore:t,analyticsStore:l}},data(){return{showSidebar:!0,screenWidth:screen.width,isStudentData:!0,isSchoolData:!0,isLanguageData:!1,isMathData:!1,isHistoryData:!1,isLifeData:!1,isCSData:!1,isSAndIData:!1,isDIData:!1,progressData:{student:[],average:[]},isAboveTheCurve:!1}},components:{StudentProgressChart:Y,StudentComparisonChart:G},async created(){await this.analyticsStore.getStudentProgress(this.userDetailsStore.userId,this.userDetailsStore.tenantId),await this.analyticsStore.getStudentPassedAssessmentsBySubject(this.userDetailsStore.userId),console.log("Student root subjects passed assessments:",this.analyticsStore.studentRootSubjectsPassedAssessments),this.analyticsStore.progress.student[this.analyticsStore.progress.student.length-1].quantity>this.analyticsStore.progress.tenant[this.analyticsStore.progress.tenant.length-1].quantity&&(this.isAboveTheCurve=!0),await this.HandleProgressData(),await this.HandleComparisonData()},methods:{async HandleProgressData(){if(this.isStudentData){this.progressData.student=[];for(let t=0;t<this.analyticsStore.progress.student.length;t++)this.progressData.student.push(this.analyticsStore.progress.student[t])}else this.progressData.student=[];if(this.isSchoolData){this.progressData.average=[];for(let t=0;t<this.analyticsStore.progress.tenant.length;t++)this.progressData.average.push(this.analyticsStore.progress.tenant[t])}else this.progressData.average=[];this.$nextTick(()=>{this.$refs.progressChart&&this.$refs.progressChart.createChart(this.progressData)})},async HandleComparisonData(){this.$nextTick(()=>{this.$refs.comparisonChart&&this.$refs.comparisonChart.createChart(this.analyticsStore.studentRootSubjectsPassedAssessments)})},toggleSidebar(){this.showSidebar=!this.showSidebar}}},f=t=>(B("data-v-39b54d9a"),t=t(),I(),t),K={class:"dashboard"},Q={class:"main"},X={class:"content container-fluid"},Z={class:"dash-row row"},tt={id:"progress-chart-container"},st=f(()=>a("div",{class:"position-absolute chart-heading"},[a("h2",{class:"heading h5"},"Progress"),a("strong",null,"You"),a("br"),a("span",{style:{color:"#ff7f0e"}},[a("strong",null,"School average")])],-1)),et={class:"col-md-6 position-relative"},at=f(()=>a("h2",{class:"heading chart-heading h5 mt-1"}," Subject comparison ",-1)),rt=f(()=>a("p",null,[a("em",null,"TODO: different color for each subject")],-1)),ot={class:"dash-row row"},nt=f(()=>a("h2",{class:"position-absolute chart-heading h5"}," Time spent ",-1)),it=f(()=>a("div",{class:"card"},[a("div",{class:"card-body"},"Skills passed: 25")],-1)),ct={key:0,class:"alert alert-success",role:"alert"},lt={key:1,class:"alert alert-warning",role:"alert"};function dt(t,l,n,o,c,d){const h=S("StudentProgressChart"),i=S("RouterLink"),r=S("StudentComparisonChart");return m(),_("div",K,[a("div",Q,[a("div",X,[a("div",Z,[v(i,{to:"/my-progress/skills",class:"col-md-6 h-100 p-0 position-relative"},{default:D(()=>[a("div",tt,[st,c.progressData.student.length>0||c.progressData.average.length>0?(m(),b(h,{key:0,ref:"progressChart"},null,512)):C("",!0)])]),_:1}),a("div",et,[at,rt,o.analyticsStore.studentRootSubjectsPassedAssessments.length>0?(m(),b(r,{key:0,ref:"comparisonChart",data:o.analyticsStore.studentRootSubjectsPassedAssessments,colour:"#5f31dd"},null,8,["data"])):C("",!0)])]),a("div",ot,[v(i,{to:"/my-progress/time",class:"col-md chart-container p-0 position-relative"},{default:D(()=>[nt]),_:1}),v(i,{to:"/my-progress/tokens",class:"col-md chart-container p-0 position-relative"},{default:D(()=>[it,c.isAboveTheCurve?(m(),_("div",ct," Nice going, you're above the curve! ")):(m(),_("div",lt," You're below the curve, keep trying! "))]),_:1})])])])])}const bt=x(J,[["render",dt],["__scopeId","data-v-39b54d9a"]]);export{bt as default};
