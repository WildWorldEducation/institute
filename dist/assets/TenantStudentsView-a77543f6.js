import{_ as A,A as k,f as v,o as r,c as l,F as q,z as H,a as o,b as w,q as M,t as B,J as N,r as _,k as y,p as R,d as T,g as b}from"./main-4609db7c.js";import{u as I}from"./TeacherAnalyticsStore-932940b2.js";import{u as L}from"./AnalyticsStore-069017a1.js";import{S as U}from"./StudentProgressLineChart-c980524d.js";import{S as E}from"./StudentSkillActivityChart-0ec333b1.js";import{P as V,A as O}from"./AttemptedAssessmentsTimelineChart-e8c2e6a6.js";import{F as Q}from"./FailedAssessmentsHorizontalBarChart-8406ac4e.js";import{S as W}from"./StudentDurationPerDayLineChart-7532d7c2.js";import{s as f}from"./transform-35b9fb9e.js";import{l as $,m as x,a as C,b as P}from"./linear-c968f95f.js";import{b as D}from"./band-18e9f0c1.js";import{s as j}from"./sort-855cf5d1.js";import"./line-8aa3dac8.js";import"./time-962c8065.js";import"./point-ea70dc51.js";const J={setup(){const t=k(),s=v();return{usersStore:t,userDetailsStore:s}},data(){return{selectedItemId:null}},created(){this.selectedItemId=this.usersStore.selectedUserId},methods:{selectUser(t){this.selectedItemId=t.id,this.usersStore.selectedUserId!==t.id&&(this.usersStore.selectedUserId=t.id,this.$parent&&this.$parent.updateUserDetails&&this.$parent.updateUserDetails(t))}}},Z={class:"container mt-1"},G={class:"d-flex bg-light rounded p-2"},K=["src"],X=["onClick"];function Y(t,s,d,a,i,h){return r(),l("div",Z,[(r(!0),l(q,null,H(a.usersStore.studentsPerTenant,c=>(r(),l("div",{key:c.id},[o("div",G,[c.avatar!=null?(r(),l("img",{key:0,class:"user-avatars",src:c.avatar},null,8,K)):w("",!0),o("button",{class:M(c.id===i.selectedItemId?"isCurrentlyChoose":"user-buttons"),onClick:n=>h.selectUser(c)},B(c.username),11,X)])]))),128))])}const tt=A(J,[["render",Y],["__scopeId","data-v-68d8cb62"]]),et={name:"StudentAttemptedAssessmentsByRootSubjectHorizontalBarChart",props:["data","colour"],data(){return{padding:60}},mounted(){f("#student-attempted-assessments-by-root-subject-chart-container");const t=25,s=0,d=0,a=10,i=300,h=700,c=Math.ceil((this.data.length+.1)*t)+s+a,n=$().domain([0,x(this.data,e=>e.quantity)]).range([i,h-d]),u=D().domain(j(this.data,e=>-e.quantity).map(e=>e.name)).rangeRound([s,c-a]).padding(.1),S=n.tickFormat(20),m=f("#student-attempted-assessments-by-root-subject-chart-container").append("svg").attr("width",h).attr("height",c).attr("viewBox",[0,0,h,c]).attr("style","max-width: 100%; height: 100%; font: 14px sans-serif;");m.append("g").attr("fill",this.colour).selectAll().data(this.data).join("rect").attr("x",n(0)).attr("y",e=>u(e.name)).attr("width",e=>n(e.quantity)-n(0)).attr("height",u.bandwidth()),m.append("g").attr("fill","white").attr("text-anchor","end").selectAll().data(this.data).join("text").attr("x",e=>n(e.quantity)).attr("y",e=>u(e.name)+u.bandwidth()/2).attr("dy","0.35em").attr("dx",-4).text(e=>S(e.quantity)).call(e=>e.filter(g=>n(g.quantity)-n(0)<20).attr("dx",4).attr("fill","black").attr("text-anchor","start")),m.append("g").attr("transform",`translate(0,${s})`).call(C(n).ticks(0)).call(e=>e.select(".domain").remove()),m.append("g").attr("transform",`translate(${i},0)`).attr("style","font-size: 16px").call(P(u).tickSizeOuter(0))},computed:{}},st={id:"student-attempted-assessments-by-root-subject-chart-container"};function at(t,s,d,a,i,h){return r(),l("div",st)}const nt=A(et,[["render",at]]),it={name:"StudentFailedAssessmentsByRootSubjectHorizontalBarChart",props:["data","colour"],data(){return{}},mounted(){f("#student-failed-assessments-by-root-subject-chart-container");const t=25,s=0,d=0,a=10,i=300,h=700,c=Math.ceil((this.data.length+.1)*t)+s+a,n=$().domain([0,x(this.data,e=>e.quantity)]).range([i,h-d]),u=D().domain(j(this.data,e=>-e.quantity).map(e=>e.name)).rangeRound([s,c-a]).padding(.1),S=n.tickFormat(20),m=f("#student-failed-assessments-by-root-subject-chart-container").append("svg").attr("width",h).attr("height",c).attr("viewBox",[0,0,h,c]).attr("style","max-width: 100%; height: 100%; font: 14px sans-serif;");m.append("g").attr("fill",this.colour).selectAll().data(this.data).join("rect").attr("x",n(0)).attr("y",e=>u(e.name)).attr("width",e=>n(e.quantity)-n(0)).attr("height",u.bandwidth()),m.append("g").attr("fill","white").attr("text-anchor","end").selectAll().data(this.data).join("text").attr("x",e=>n(e.quantity)).attr("y",e=>u(e.name)+u.bandwidth()/2).attr("dy","0.35em").attr("dx",-4).text(e=>S(e.quantity)).call(e=>e.filter(g=>n(g.quantity)-n(0)<20).attr("dx",4).attr("fill","white").attr("text-anchor","start")),m.append("g").attr("transform",`translate(0,${s})`).call(C(n).ticks(0)).call(e=>e.select(".domain").remove()),m.append("g").attr("transform",`translate(${i},0)`).attr("style","font-size: 16px").call(P(u).tickSizeOuter(0))}},rt={id:"student-failed-assessments-by-root-subject-chart-container"};function ot(t,s,d,a,i,h){return r(),l("div",rt)}const dt=A(it,[["render",ot]]),ct={name:"StudentPassedAssessmentsByRootSubjectHorizontalBarChart",props:["data","colour"],data(){return{}},mounted(){f("#student-passed-assessments-by-root-subject-chart-container");const t=25,s=0,d=0,a=10,i=300,h=700,c=Math.ceil((this.data.length+.1)*t)+s+a,n=$().domain([0,x(this.data,e=>e.quantity)]).range([i,h-d]),u=D().domain(j(this.data,e=>-e.quantity).map(e=>e.name)).rangeRound([s,c-a]).padding(.1),S=n.tickFormat(20),m=f("#student-passed-assessments-by-root-subject-chart-container").append("svg").attr("width",h).attr("height",c).attr("viewBox",[0,0,h,c]).attr("style","max-width: 100%; height: 100%; font: 14px sans-serif;");m.append("g").attr("fill",this.colour).selectAll().data(this.data).join("rect").attr("x",n(0)).attr("y",e=>u(e.name)).attr("width",e=>n(e.quantity)-n(0)).attr("height",u.bandwidth()),m.append("g").attr("fill","white").attr("text-anchor","end").selectAll().data(this.data).join("text").attr("x",e=>n(e.quantity)).attr("y",e=>u(e.name)+u.bandwidth()/2).attr("dy","0.35em").attr("dx",-4).text(e=>S(e.quantity)).call(e=>e.filter(g=>n(g.quantity)-n(0)<20).attr("dx",4).attr("fill","black").attr("text-anchor","start")),m.append("g").attr("transform",`translate(0,${s})`).call(C(n).ticks(0)).call(e=>e.select(".domain").remove()),m.append("g").attr("transform",`translate(${i},0)`).attr("style","font-size: 16px").call(P(u).tickSizeOuter(0))},computed:{}},lt={id:"student-passed-assessments-by-root-subject-chart-container"};function ut(t,s,d,a,i,h){return r(),l("div",lt)}const ht=A(ct,[["render",ut]]);const mt={props:["userId"],components:{StudentProgressLineChart:U,StudentSkillActivityChart:E,PassedAssessmentsTimelineChart:V,AttemptedAssessmentsTimelineChart:O,FailedAssessmentsHorizontalBarChart:Q,StudentDurationPerDayLineChart:W,StudentAttemptedAssessmentsByRootSubjectHorizontalBarChart:nt,StudentFailedAssessmentsByRootSubjectHorizontalBarChart:dt,StudentPassedAssessmentsByRootSubjectHorizontalBarChart:ht},setup(){const t=k(),s=v(),d=I(),a=N(),i=L();return t.users.length<1&&t.getUsers(),{usersStore:t,userDetailsStore:s,teacherAnalyticsStore:d,userSkillsStore:a,analyticsStore:i}},data(){return{isMobileCheck:window.innerWidth,studentProgress:[],assessmentPasses:[],assessmentAttempts:[],skillDurations:[],durationsPerDay:[],visitedSkills:[]}},async created(){await this.getTenantStudentProgress(),await this.getAssessmentPasses(),await this.getAssessmentAttempts(),this.teacherAnalyticsStore.studentMultipleFails.length==0&&await this.teacherAnalyticsStore.getStudentMultipleFails(this.$parent.user.id),await this.getStudentDurationPerDay(),this.teacherAnalyticsStore.skillActivities.length==0&&await this.teacherAnalyticsStore.getSkillActivityReport(this.$parent.user.id),this.teacherAnalyticsStore.skillActivities=this.teacherAnalyticsStore.skillActivities.map(t=>({...t,formattedQuantity:this.millisToMinutesAndSeconds(t.quantity)})),await this.analyticsStore.getStudentFailedAssessmentsBySubject(this.$parent.user.id),await this.analyticsStore.getStudentPassedAssessmentsBySubject(this.$parent.user.id),await this.analyticsStore.getStudentAttemptedAssessmentsBySubject(this.$parent.user.id)},computed:{studentName(){return`${this.$parent.user.username}`.trim()}},methods:{async getTenantStudentProgress(){fetch(`/student-analytics/student-progress/${this.$parent.user.id}`).then(t=>t.json()).then(t=>{for(let s=0;s<t.length;s++)t[s].date=new Date(t[s].date);t.sort((s,d)=>s.date-d.date),this.studentProgress=t}).catch(t=>{console.error("Error fetching student progress:",t)})},async getAssessmentAttempts(){fetch(`/student-analytics/started-unmastered-assessments/${this.$parent.user.id}`).then(t=>t.json()).then(t=>{this.assessmentAttempts=t.map(s=>({...s,url:`/skills/${s.url}`,labelName:`${s.name}`}))}).catch(t=>{console.error("Error fetching last visited skills:",t)})},async getAssessmentPasses(){await this.userSkillsStore.getMasteredSkills(this.$parent.user.id),this.assessmentPasses=this.userSkillsStore.masteredSkills.map(t=>({...t,url:`/skills/${t.url}`,labelName:`${t.name}`}))},async getStudentDurationPerDay(){fetch(`/student-analytics/student-duration-per-day/${this.$parent.user.id}`).then(t=>t.json()).then(t=>{for(let s=0;s<t.length;s++)t[s].formattedQuantity=t[s].quantity/(1e3*60),t[s].date=new Date(t[s].date);t.sort((s,d)=>s.date-d.date),this.durationsPerDay=t}).catch(t=>{console.error("Error fetching student duration per day:",t)})}}},p=t=>(R("data-v-2c345b20"),t=t(),T(),t),pt={id:"user-information",class:"container mt-1 bg-light p-2"},_t=p(()=>o("div",{id:"close-popup-btn"},[o("svg",{width:"18",height:"18",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[o("path",{d:"M0.312625 14.5205L4.83312 9.99999L0.312625 5.49218C0.111396 5.29025 -0.00159545 5.0168 -0.00159545 4.73172C-0.00159545 4.44665 0.111396 4.17319 0.312625 3.97126L3.96282 0.312625C4.16474 0.111396 4.4382 -0.00159545 4.72327 -0.00159545C5.00835 -0.00159545 5.2818 0.111396 5.48373 0.312625L9.99999 4.83312L14.5205 0.312625C14.6204 0.21056 14.7397 0.12947 14.8714 0.0741101C15.003 0.0187502 15.1444 -0.00976563 15.2873 -0.00976562C15.4301 -0.00976563 15.5715 0.0187502 15.7032 0.0741101C15.8349 0.12947 15.9541 0.21056 16.0541 0.312625L19.6874 3.96282C19.8886 4.16474 20.0016 4.4382 20.0016 4.72327C20.0016 5.00835 19.8886 5.2818 19.6874 5.48373L15.1669 9.99999L19.6874 14.5205C19.8883 14.7217 20.0012 14.9944 20.0012 15.2788C20.0012 15.5632 19.8883 15.836 19.6874 16.0372L16.0541 19.6874C15.8529 19.8883 15.5801 20.0012 15.2957 20.0012C15.0113 20.0012 14.7386 19.8883 14.5374 19.6874L9.99999 15.1669L5.49218 19.6874C5.29025 19.8886 5.0168 20.0016 4.73172 20.0016C4.44665 20.0016 4.17319 19.8886 3.97126 19.6874L0.312625 16.0541C0.21056 15.9541 0.12947 15.8349 0.0741101 15.7032C0.0187502 15.5715 -0.00976563 15.4301 -0.00976562 15.2873C-0.00976563 15.1444 0.0187502 15.003 0.0741101 14.8714C0.12947 14.7397 0.21056 14.6204 0.312625 14.5205Z",fill:"white"})])],-1)),yt=[_t],St={class:"row"},gt={class:"col-12 col-md-7"},ft={key:0,class:"secondary-heading h3"},At={class:"row"},bt={class:"d-flex flex-column"},kt=p(()=>o("h1",{class:"heading"},"Student Reports",-1)),vt=p(()=>o("h2",{class:"secondary-heading"},"Engagement",-1)),wt=p(()=>o("h4",null,"Total time on platform",-1)),$t={key:1},xt=p(()=>o("h4",{class:"mt-4"},"Skills visited",-1)),Ct={key:3},Pt=p(()=>o("h2",{class:"secondary-heading mt-5"},"Academics",-1)),Dt=p(()=>o("h4",null,"Skill mastery progress",-1)),jt={key:5},Bt=p(()=>o("h3",{class:"secondary-heading mt-4"},"By subject",-1)),Rt=p(()=>o("h4",{class:""},"Failed more than once",-1)),Tt={key:7},It=p(()=>o("h4",{class:""},"Passed",-1)),Lt={key:9},zt=p(()=>o("h4",{class:""},"Attempted",-1)),Ft={key:11},qt=p(()=>o("h3",{class:"secondary-heading mt-4"},"By skill",-1)),Ht=p(()=>o("h4",null,"Assessments failed",-1)),Mt={key:13},Nt=p(()=>o("h4",{class:"mt-4"},"Assessments passed",-1)),Ut={key:15},Et=p(()=>o("h4",{class:"mt-4"},"Assessments attempted",-1)),Vt={key:17,class:"mb-5"};function Ot(t,s,d,a,i,h){const c=_("StudentDurationPerDayLineChart"),n=_("StudentSkillActivityChart"),u=_("StudentProgressLineChart"),S=_("StudentFailedAssessmentsByRootSubjectHorizontalBarChart"),m=_("StudentPassedAssessmentsByRootSubjectHorizontalBarChart"),e=_("StudentAttemptedAssessmentsByRootSubjectHorizontalBarChart"),g=_("FailedAssessmentsHorizontalBarChart"),z=_("PassedAssessmentsTimelineChart"),F=_("AttemptedAssessmentsTimelineChart");return r(),l("div",pt,[o("div",{class:"flex-row-reverse d-flex d-md-none align-items-end mb-2",onClick:s[0]||(s[0]=re=>this.$parent.showDetails=!1)},yt),o("div",St,[o("div",gt,[i.isMobileCheck<576?(r(),l("h1",ft,B(this.$parent.user.username),1)):w("",!0)])]),o("div",At,[o("div",bt,[kt,vt,wt,i.durationsPerDay.length>0?(r(),y(c,{key:0,data:i.durationsPerDay},null,8,["data"])):(r(),l("p",$t,"There is no data to show yet.")),xt,a.teacherAnalyticsStore.skillActivities.length>0?(r(),y(n,{key:2,data:a.teacherAnalyticsStore.skillActivities},null,8,["data"])):(r(),l("p",Ct,"No skills visited by this student.")),Pt,Dt,i.studentProgress.length>0?(r(),y(u,{key:4,data:i.studentProgress,colour:"#5f31dd"},null,8,["data"])):(r(),l("p",jt,"No data to show yet.")),Bt,Rt,a.analyticsStore.studentRootSubjectsFailedAssessments.length>0?(r(),y(S,{key:6,data:a.analyticsStore.studentRootSubjectsFailedAssessments,colour:"darkred",class:"mb-5"},null,8,["data"])):(r(),l("p",Tt,"No data yet")),It,a.analyticsStore.studentRootSubjectsPassedAssessments.length>0?(r(),y(m,{key:8,data:a.analyticsStore.studentRootSubjectsPassedAssessments,colour:"darkgreen",class:"mb-5"},null,8,["data"])):(r(),l("p",Lt,"No data yet")),zt,a.analyticsStore.studentRootSubjectsAttemptedAssessments.length>0?(r(),y(e,{key:10,data:a.analyticsStore.studentRootSubjectsAttemptedAssessments,colour:"darkblue",class:"mb-5"},null,8,["data"])):(r(),l("p",Ft,"No data yet")),qt,Ht,a.teacherAnalyticsStore.studentMultipleFails.length>0?(r(),y(g,{key:12,data:a.teacherAnalyticsStore.studentMultipleFails,colour:"darkred"},null,8,["data"])):(r(),l("p",Mt," This student has not failed any assessments more than once yet. ")),Nt,i.assessmentPasses.length>0?(r(),y(z,{key:14,data:i.assessmentPasses},null,8,["data"])):(r(),l("p",Ut," This student has not completed any assessments yet. ")),Et,i.assessmentAttempts.length>0?(r(),y(F,{key:16,class:"mb-5",data:i.assessmentAttempts},null,8,["data"])):(r(),l("p",Vt," This student has attempted any assessments yet. "))])])])}const Qt=A(mt,[["render",Ot],["__scopeId","data-v-2c345b20"]]);const Wt={setup(){const t=k(),s=v(),d=I(),a=L();return{usersStore:t,userDetailsStore:s,teacherAnalyticsStore:d,analyticsStore:a}},data(){return{user:{id:null,firstName:null,lastName:null,username:null,avatar:null},showDetails:!1,tenantStudents:[],showUserInfo:!0,isLoading:!0,currentUserId:"",isInitializing:!0}},components:{TenantStudentList:tt,TenantStudentDetails:Qt},async created(){await this.usersStore.getStudentsPerTenant(this.userDetailsStore.tenantId),this.isLoading=!1,this.initializeSelectedUser(),this.$nextTick(()=>{this.isInitializing=!1})},methods:{initializeSelectedUser(){const t=this.usersStore.selectedUserId;let s=!1;if(t){const d=this.usersStore.studentsPerTenant.find(a=>a.id===t);d&&(s=!0,this.updateUserDetails(d,!0))}s||(this.updateUserDetails(this.usersStore.studentsPerTenant[0],!0),this.$refs.usersListRef&&(this.$refs.usersListRef.selectedItemId=this.usersStore.studentsPerTenant[0].id))},async updateUserDetails(t,s=!1){if(!t)return;this.user.id=t.id,this.user.firstName=t.first_name,this.user.lastName=t.last_name,this.user.username=t.username,this.user.email=t.email,this.user.avatar=t.avatar,this.user.role=t.role,t.isSkillsLocked!==void 0&&(this.user.isSkillsLocked=t.isSkillsLocked),s?this.usersStore.selectedUserId=t.id:this.usersStore.setSelectedUser(t.id),window.innerWidth<769&&(this.showDetails=!0);let d=this.userDetailsStore.tenantId;this.usersStore.studentsPerTenant.length<1&&await this.usersStore.getStudentsPerTenant(d),this.$refs.tenantStudentDetailsRef.studentProgress=[],this.$refs.tenantStudentDetailsRef.getTenantStudentProgress(),this.$refs.tenantStudentDetailsRef.assessmentPasses=[],this.$refs.tenantStudentDetailsRef.getAssessmentPasses(),this.$refs.tenantStudentDetailsRef.assessmentAttempts=[],this.$refs.tenantStudentDetailsRef.getAssessmentAttempts(),this.teacherAnalyticsStore.studentMultipleFails=[],await this.teacherAnalyticsStore.getStudentMultipleFails(this.user.id),this.$refs.tenantStudentDetailsRef.durationsPerDay=[],this.$refs.tenantStudentDetailsRef.getStudentDurationPerDay(),this.teacherAnalyticsStore.skillActivities=[],await this.teacherAnalyticsStore.getSkillActivityReport(this.user.id),this.teacherAnalyticsStore.skillActivities=this.teacherAnalyticsStore.skillActivities.map(a=>({...a,formattedQuantity:this.millisToMinutesAndSeconds(a.quantity)})),this.analyticsStore.studentRootSubjectsFailedAssessments=[],this.analyticsStore.getStudentFailedAssessmentsBySubject(this.user.id),this.analyticsStore.studentRootSubjectsPassedAssessments=[],this.analyticsStore.getStudentPassedAssessmentsBySubject(this.user.id),this.analyticsStore.studentRootSubjectsAttemptedAssessments=[],this.analyticsStore.getStudentAttemptedAssessmentsBySubject(this.user.id)},updateShowUserDetails(t){this.usersStore.selectedUserId=t.id},millisToMinutesAndSeconds(t){var s=Math.floor(t/6e4),d=(t%6e4/1e3).toFixed(0);return s+":"+(d<10?"0":"")+d}}},Jt=t=>(R("data-v-6d6a4cb7"),t=t(),T(),t),Zt={key:0,class:"loading-animation d-flex justify-content-center align-items-center py-4"},Gt=Jt(()=>o("span",{class:"loader"},null,-1)),Kt=[Gt],Xt={key:1,id:"user-container",class:"container-fluid"},Yt={class:"row position-relative"},te={class:"col-lg-4 col-md-5"},ee={class:"col-lg-8 col-md-7 d-none d-md-block"},se={class:"row user-form-data-row"},ae={key:0,class:"col-md-7 d-block d-md-none",id:"user-detail-section"},ne={class:"row"};function ie(t,s,d,a,i,h){const c=_("TenantStudentList"),n=_("TenantStudentDetails");return i.isLoading==!0?(r(),l("div",Zt,Kt)):(r(),l("div",Xt,[o("div",Yt,[o("div",te,[b(c,{ref:"usersListRef"},null,512)]),o("div",ee,[o("div",se,[b(n,{ref:"tenantStudentDetailsRef",userId:i.user.id},null,8,["userId"])])]),i.showDetails?(r(),l("div",ae,[o("div",ne,[b(n,{userId:i.user.id},null,8,["userId"])])])):w("",!0)])]))}const ke=A(Wt,[["render",ie],["__scopeId","data-v-6d6a4cb7"]]);export{ke as default};
