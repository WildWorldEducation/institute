import{_ as b,A as D,f as v,K as P,r as u,o as d,c as h,a,t as f,g as S,k as g,s as k,p as x,d as B}from"./main-e10ce0af.js";import{u as C}from"./AnalyticsStore-c154d111.js";import{S as j}from"./StudentProgressChart-42a4bebe.js";import"./transform-4d0f7c8f.js";import{l as A,a as I,b as N}from"./linear-841004c4.js";import{m as R,b as T}from"./continuous-e5db47ab.js";import{s as H}from"./sort-fcaf8f38.js";import{s as y}from"./string-c67ea49d.js";import{P as V}from"./PassedAssessmentsTimelineChart-32f28632.js";import{D as $}from"./downloadCSVBtn-b6253f61.js";import"./line-bfb1ca50.js";import"./time-ce17bce2.js";import"./point-ea70dc51.js";import"./colors-98f238a0.js";import"./main-2d5109d7.js";const M={name:"StudentPassedAssessmentsByRootSubjectHorizontalBarChart",props:["data","colour"],data(){return{}},mounted(){y("#student-passed-subjects-chart-container");const s=0,e=0,l=20,o=200,n=document.getElementById("student-passed-subjects-chart-container").clientWidth,m=document.getElementById("student-passed-subjects-chart-container").clientHeight,r=A().domain([0,R(this.data,t=>t.quantity)]).range([o,n-e]),i=T().domain(H(this.data,t=>-t.quantity).map(t=>t.name)).rangeRound([s,m-l]).padding(.1),p=r.tickFormat(20),c=y("#student-passed-subjects-chart-container").append("svg").attr("width","100%").attr("height","100%").attr("viewBox",[0,0,"100%","100%"]).attr("preserveAspectRatio","xMinYMin");c.append("g").selectAll().data(this.data).join("rect").attr("x",r(0)).attr("y",t=>i(t.name)).attr("width",t=>r(t.quantity)-r(0)).attr("height",i.bandwidth()).attr("fill",function(t){return t.name=="Language"?"DarkMagenta":t.name=="Mathematics"?"blue":t.name=="Science & Invention"?"purple":t.name=="Computer Science"?"deeppink":t.name=="Dangerous Ideas"?"brown":t.name=="History"?"cyan":t.name=="Life"?"magenta":"#ff7f0e"}),c.append("g").attr("fill","white").attr("text-anchor","end").selectAll().data(this.data).join("text").attr("x",t=>r(t.quantity)).attr("y",t=>i(t.name)+i.bandwidth()/2).attr("dy","0.35em").attr("dx",-4).text(t=>p(t.quantity)).call(t=>t.filter(w=>r(w.quantity)-r(0)<20).attr("dx",4).attr("fill","black").attr("text-anchor","start")),c.append("g").attr("transform",`translate(0,${s})`).call(I(r).ticks(0)).call(t=>t.select(".domain").remove()),c.append("g").attr("transform",`translate(${o},0)`).attr("style","font-size: 16px").call(N(i).tickSizeOuter(0))},computed:{}};function U(s,e,l,o,n,m){return null}const q=b(M,[["render",U]]);const z={setup(){const s=D(),e=C(),l=v(),o=P();return{usersStore:s,userDetailsStore:l,analyticsStore:e,userSkillsStore:o}},components:{StudentProgressChart:j,DownloadCSVBtn:$,PassedAssessmentsTimelineChart:V,StudentPassedAssessmentsByRootSubjectHorizontalBarChart:q},data(){return{studentId:this.$route.params.studentId,studentName:null,progressData:{student:[],average:[]},assessmentPasses:[]}},async created(){this.usersStore.users.length<1&&await this.usersStore.getUsers();const s=this.usersStore.users.find(e=>e.id===this.studentId);s&&(this.studentName=s.username),await this.analyticsStore.getStudentProgress(this.studentId,this.userDetailsStore.tenantId),await this.HandleProgressData(),await this.analyticsStore.getStudentPassedAssessmentsBySubject(this.studentId),await this.getUserSkillMasteredHistory(this.studentId),this.assessmentPassesDownloadData=this.assessmentPasses.map(e=>({skill:e.name,date:this.assessmentDate(e.mastered_date)}))},methods:{async HandleProgressData(){this.progressData.student=[];for(let s=0;s<this.analyticsStore.progress.student.length;s++)this.progressData.student.push(this.analyticsStore.progress.student[s]);this.progressData.average=[];for(let s=0;s<this.analyticsStore.progress.tenant.length;s++)this.progressData.average.push(this.analyticsStore.progress.tenant[s]);this.$nextTick(()=>{this.$refs.progressChart&&this.$refs.progressChart.createChart(this.progressData)})},async getUserSkillMasteredHistory(s){await this.userSkillsStore.getMasteredSkills(s),this.assessmentPasses=this.userSkillsStore.masteredSkills.map(e=>({...e,url:`/skills/${e.url}`,labelName:`${e.name}`}))},assessmentDate(s){return new Date(s).toLocaleString("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})}}},_=s=>(x("data-v-3b59bff3"),s=s(),B(),s),L={class:"container-fluid chart-page"},E={class:"d-flex justify-content-between w-100"},O=_(()=>a("h1",{class:"heading h4"},"Assessments passed",-1)),F={class:"tertiary-heading h4 d-flex justify-content-end align-items-center"},K={class:"row chart-row"},W={class:"col-lg-8 chart-col position-relative"},Y={id:"progress-chart-container"},G={key:1},J={class:"position-absolute"},Q={style:{color:"green"}},X=_(()=>a("span",{style:{color:"#ff7f0e"}},"class average",-1)),Z={class:"col-lg-4 chart-col"},tt={id:"student-passed-subjects-chart-container"},st={key:1},et=_(()=>a("figcaption",{class:""},"By subject",-1)),at={class:"row chart-row position-relative"},nt={class:"position-relative"},rt={key:1};function ot(s,e,l,o,n,m){const r=u("DownloadCSVBtn"),i=u("StudentProgressChart"),p=u("StudentPassedAssessmentsByRootSubjectHorizontalBarChart"),c=u("PassedAssessmentsTimelineChart");return d(),h("div",L,[a("span",E,[O,a("h2",F,f(n.studentName),1)]),a("div",K,[a("div",W,[a("div",Y,[S(r,{data:n.progressData,fileName:`Progress Report - ${n.studentName}`,toolTip:"Download progress data as CSV",class:"position-absolute download-btn"},null,8,["data","fileName"]),n.progressData.student.length>0||n.progressData.average.length>0?(d(),g(i,{key:0,ref:"progressChart",data:n.progressData},null,8,["data"])):(d(),h("p",G,"There is no data to show yet."))]),a("figcaption",J,[a("span",Q,f(n.studentName),1),k(" vs "),X])]),a("div",Z,[a("div",tt,[o.analyticsStore.studentRootSubjectsPassedAssessments.length>0?(d(),g(p,{key:0,data:o.analyticsStore.studentRootSubjectsPassedAssessments},null,8,["data"])):(d(),h("p",st,"No data yet"))]),et])]),a("div",at,[a("div",nt,[S(r,{data:s.assessmentPassesDownloadData,fileName:`Passed Assessments - ${n.studentName}`,toolTip:"Download passed assessments data as CSV",class:"position-absolute download-btn"},null,8,["data","fileName"]),n.assessmentPasses.length>0?(d(),g(c,{key:0,class:"mb-5",data:n.assessmentPasses},null,8,["data"])):(d(),h("p",rt," This student has not completed any assessments yet. "))])])])}const Dt=b(z,[["render",ot],["__scopeId","data-v-3b59bff3"]]);export{Dt as default};
