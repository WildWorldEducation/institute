import{s as T}from"./transform-35b9fb9e.js";import{_ as g,o as u,c as m,f as P,r as y,a as s,b as D,s as _,k as w,p as M,d as B}from"./main-138df8f6.js";import{l as v,m as x,a as S,b,c as z}from"./linear-c968f95f.js";import{b as C}from"./band-18e9f0c1.js";import{s as L}from"./sort-855cf5d1.js";import{u as $,l as A}from"./line-8aa3dac8.js";import{e as j}from"./time-962c8065.js";import{u as q}from"./AnalyticsStore-85b92399.js";import"./point-ea70dc51.js";const I={name:"TenantAvgTokensToMasterSkillsHorizontalBarChart",props:["data","colour"],data(){return{padding:60}},mounted(){T("#tenant-avg-tokens-to-master-skills-chart-container");const e=25,t=0,i=0,n=10,h=200,o=1e3,c=Math.ceil((this.data.length+.1)*e)+t+n,r=v().domain([0,x(this.data,a=>a.quantity)]).range([h,o-i]),d=C().domain(L(this.data,a=>-a.quantity).map(a=>a.name)).rangeRound([t,c-n]).padding(.1),l=r.tickFormat(20),p=T("#tenant-avg-tokens-to-master-skills-chart-container").append("svg").attr("width",o).attr("height",c).attr("viewBox",[0,0,o,c]).attr("style","max-width: 100%; height: 100%; font: 14px sans-serif;");p.append("g").attr("fill",this.colour).selectAll().data(this.data).join("rect").attr("x",r(0)).attr("y",a=>d(a.name)).attr("width",a=>r(a.quantity)-r(0)).attr("height",d.bandwidth()),p.append("g").attr("fill","white").attr("text-anchor","end").selectAll().data(this.data).join("text").attr("x",a=>r(a.quantity)).attr("y",a=>d(a.name)+d.bandwidth()/2).attr("dy","0.35em").attr("dx",-4).text(a=>l(a.quantity)).call(a=>a.filter(f=>r(f.quantity)-r(0)<20).attr("dx",4).attr("fill","black").attr("text-anchor","start")),p.append("g").attr("transform",`translate(0,${t})`).call(S(r).ticks(0)).call(a=>a.select(".domain").remove()),p.append("g").attr("transform",`translate(${h},0)`).call(b(d).tickSizeOuter(0))},computed:{}},H={id:"tenant-avg-tokens-to-master-skills-chart-container"};function R(e,t,i,n,h,o){return u(),m("div",H)}const E=g(I,[["render",R],["__scopeId","data-v-e380fbfe"]]);const O={name:"TenantTokensPerSkillHorizontalBarChart",props:["data","colour"],data(){return{padding:60}},mounted(){T("#tenant-tokens-per-skill-chart-container");const e=25,t=0,i=0,n=10,h=200,o=1e3,c=Math.ceil((this.data.length+.1)*e)+t+n,r=v().domain([0,x(this.data,a=>a.quantity)]).range([h,o-i]),d=C().domain(L(this.data,a=>-a.quantity).map(a=>a.name)).rangeRound([t,c-n]).padding(.1),l=r.tickFormat(20),p=T("#tenant-tokens-per-skill-chart-container").append("svg").attr("width",o).attr("height",c).attr("viewBox",[0,0,o,c]).attr("style","max-width: 100%; height: 100%; font: 14px sans-serif;");p.append("g").attr("fill",this.colour).selectAll().data(this.data).join("rect").attr("x",r(0)).attr("y",a=>d(a.name)).attr("width",a=>r(a.quantity)-r(0)).attr("height",d.bandwidth()),p.append("g").attr("fill","white").attr("text-anchor","end").selectAll().data(this.data).join("text").attr("x",a=>r(a.quantity)).attr("y",a=>d(a.name)+d.bandwidth()/2).attr("dy","0.35em").attr("dx",-4).text(a=>l(a.quantity)).call(a=>a.filter(f=>r(f.quantity)-r(0)<20).attr("dx",4).attr("fill","black").attr("text-anchor","start")),p.append("g").attr("transform",`translate(0,${t})`).call(S(r).ticks(0)).call(a=>a.select(".domain").remove()),p.append("g").attr("transform",`translate(${h},0)`).call(b(d).tickSizeOuter(0))},computed:{}},N={id:"tenant-tokens-per-skill-chart-container"};function W(e,t,i,n,h,o){return u(),m("div",N)}const V=g(O,[["render",W],["__scopeId","data-v-039ce704"]]),F={name:"TenantTokensPerDayLineChart",props:["data","colour"],data(){return{padding:60}},mounted(){const e=this.data;T("#tenant-tokens-per-day-chart-container");const t=928,i=500,n=20,h=30,o=30,c=40,r=$(j(e,a=>a.date),[c,t-h]),d=v([0,x(e,a=>a.quantity)],[i-o,n]),l=A().x(a=>r(a.date)).y(a=>d(a.quantity)),p=T("#tenant-tokens-per-day-chart-container").append("svg").attr("width",t).attr("height",i).attr("viewBox",[0,0,t,i]).attr("style","max-width: 100%; height: auto; height: intrinsic;");p.append("g").attr("transform",`translate(0,${i-o})`).call(z(r).ticks(e.length/2).tickSizeOuter(0)),p.append("g").attr("transform",`translate(${c},0)`).call(b(d).ticks(i/80)).call(a=>a.selectAll(".tick line").clone().attr("x2",t-c-h).attr("stroke-opacity",.1)).call(a=>a.append("text").attr("x",-c).attr("y",10).attr("fill","currentColor").attr("text-anchor","start").text("â†‘ Tokens")),p.append("path").attr("fill","none").attr("stroke","#5f31dd").attr("stroke-width",1.5).attr("d",l(e))}},U={id:"tenant-tokens-per-day-chart-container"};function G(e,t,i,n,h,o){return u(),m("div",U)}const J=g(F,[["render",G]]);const K={setup(){const e=P(),t=q();return{userDetailsStore:e,analyticsStore:t}},components:{TenantAvgTokensToMasterSkillsHorizontalBarChart:E,TenantTokensPerSkillHorizontalBarChart:V,TenantTokensPerDayLineChart:J},data(){return{tenantId:this.$route.params.tenantId,isDataWeekly:!1,isTutorialComplete:!1,showTutorialTip1:!1,showTutorialTip2:!1,showTutorialTip3:!1,showTutorialTip4:!1,dataMode:"total"}},async created(){await this.checkIfTutorialComplete(),await this.getAvgTokensToMasterSkills(),await this.getTotalTokensPerSkill(),await this.getTotalTokensPerDay()},methods:{async checkIfTutorialComplete(){const t=await(await fetch(`/users/check-tutorial-progress/school-report/${this.userDetailsStore.userId}`)).json();t==0?(this.isTutorialComplete=!1,this.showTutorialTip1=!0):t==1&&(this.isTutorialComplete=!0)},progressTutorial(e){e==1?(this.showTutorialTip1=!1,this.showTutorialTip2=!0):e==2?(this.showTutorialTip2=!1,this.showTutorialTip3=!0):e==3?(this.showTutorialTip3=!1,this.showTutorialTip4=!0):e==4&&(this.showTutorialTip4=!1,this.markTutorialComplete())},restartTutorial(){this.isTutorialComplete=!1,this.showTutorialTip1=!0,this.showTutorialTip2=!1,this.showTutorialTip3=!1,this.showTutorialTip4=!1},markTutorialComplete(){let e="/users/mark-tutorial-complete/school-report/"+this.userDetailsStore.userId;fetch(e,{method:"PUT",headers:{"Content-Type":"application/json"}})},skipTutorial(){this.showTutorialTip1=!1,this.showTutorialTip2=!1,this.showTutorialTip3=!1,this.showTutorialTip4=!1,this.isTutorialComplete=!0,this.markTutorialComplete()},async getAvgTokensToMasterSkills(){try{const e=await fetch(`/student-analytics/avg-tokens-to-master-skills/tenant/${this.tenantId}`);if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);const t=await e.json();this.analyticsStore.avgTokensToMasterSkills=Array.isArray(t)?t:[]}catch(e){console.error("Error fetching cohort mastered assessments:",e),this.analyticsStore.avgTokensToMasterSkills=[]}},async getTotalTokensPerSkill(){try{const e=await fetch(`/student-analytics/total-tokens-per-skill/tenant/${this.tenantId}`);if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);const t=await e.json();this.analyticsStore.totalTokensPerSkill=Array.isArray(t)?t:[]}catch(e){console.error("Error fetching cohort mastered assessments:",e),this.analyticsStore.totalTokensPerSkill=[]}},async getTotalTokensPerDay(){this.analyticsStore.totalTokensPerDay=[],fetch(`/student-analytics/tenant-tokens-per-day/${this.dataMode}/${this.tenantId}`).then(e=>e.json()).then(e=>{for(let t=0;t<e.length;t++)e[t].date=new Date(e[t].date);e.sort((t,i)=>t.date-i.date),this.analyticsStore.totalTokensPerDay=e}).catch(e=>{console.error("Error fetching student progress:",e)})},downloadData(e,t){const i=Object.keys(e[0]);console.log(i);const n=[];n.push(i.join(","));for(const r of e){const d=i.map(l=>{const p=r[l];return`"${String(p).replace(/"/g,'""')}"`});n.push(d.join(","))}const h=n.join(`
`),o=new Blob([h],{type:"text/csv;charset=utf-8;"}),c=document.createElement("a");c.href=URL.createObjectURL(o),c.download=t+".csv",c.click()},async toggleWeeklyCumulativeData(){this.dataMode=="total"?this.dataMode="weekly":this.dataMode="total",await this.getTotalTokensPerDay()}}},k=e=>(M("data-v-65ce7f6c"),e=e(),B(),e),Q={class:"container"},X={class:"d-flex justify-content-between w-100"},Y=k(()=>s("h1",{class:"heading"},"Cost Report",-1)),Z={class:"btn-group d-flex d-sm-inline-flex mt-2",role:"group"},tt=k(()=>s("label",{class:"btn btn-outline-dark btn-sm filter-btn",for:"total1"},"Total",-1)),et=k(()=>s("label",{class:"btn btn-outline-dark btn-sm filter-btn",for:"week1"},"This week",-1)),at=k(()=>s("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 192 512",width:"20",height:"23",class:"primary-icon"},[s("path",{d:"M48 80a48 48 0 1 1 96 0A48 48 0 1 1 48 80zM0 224c0-17.7 14.3-32 32-32l64 0c17.7 0 32 14.3 32 32l0 224 32 0c17.7 0 32 14.3 32 32s-14.3 32-32 32L32 512c-17.7 0-32-14.3-32-32s14.3-32 32-32l32 0 0-192-32 0c-17.7 0-32-14.3-32-32z"})],-1)),st=[at],ot={key:0,class:"modal"},nt={class:"modal-content"},rt=k(()=>s("p",{class:"modal-text"}," The School Admin Report provides comprehensive analytics on student engagement, academic performance, and resource usage across your school. ",-1)),it={class:"d-flex justify-content-between"},lt={class:"d-flex justify-content-between"},ct=k(()=>s("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",width:"18",height:"18"},[s("path",{d:"M0 64C0 28.7 28.7 0 64 0L213.5 0c17 0 33.3 6.7 45.3 18.7L365.3 125.3c12 12 18.7 28.3 18.7 45.3L384 448c0 35.3-28.7 64-64 64L64 512c-35.3 0-64-28.7-64-64L0 64zm208-5.5l0 93.5c0 13.3 10.7 24 24 24L325.5 176 208 58.5zM175 441c9.4 9.4 24.6 9.4 33.9 0l64-64c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0l-23 23 0-86.1c0-13.3-10.7-24-24-24s-24 10.7-24 24l0 86.1-23-23c-9.4-9.4-24.6-9.4-33.9 0s-9.4 24.6 0 33.9l64 64z"})],-1)),dt=[ct],ht={key:2},pt=k(()=>s("p",null,[s("em",null,"Please note recording of tokens per skill stops after student mastery of that skill")],-1)),ut={class:"d-flex justify-content-between"},kt=k(()=>s("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",width:"18",height:"18"},[s("path",{d:"M0 64C0 28.7 28.7 0 64 0L213.5 0c17 0 33.3 6.7 45.3 18.7L365.3 125.3c12 12 18.7 28.3 18.7 45.3L384 448c0 35.3-28.7 64-64 64L64 512c-35.3 0-64-28.7-64-64L0 64zm208-5.5l0 93.5c0 13.3 10.7 24 24 24L325.5 176 208 58.5zM175 441c9.4 9.4 24.6 9.4 33.9 0l64-64c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0l-23 23 0-86.1c0-13.3-10.7-24-24-24s-24 10.7-24 24l0 86.1-23-23c-9.4-9.4-24.6-9.4-33.9 0s-9.4 24.6 0 33.9l64 64z"})],-1)),mt=[kt],Tt={key:4},gt={class:"d-flex justify-content-between mt-5"},ft=k(()=>s("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",width:"18",height:"18"},[s("path",{d:"M0 64C0 28.7 28.7 0 64 0L213.5 0c17 0 33.3 6.7 45.3 18.7L365.3 125.3c12 12 18.7 28.3 18.7 45.3L384 448c0 35.3-28.7 64-64 64L64 512c-35.3 0-64-28.7-64-64L0 64zm208-5.5l0 93.5c0 13.3 10.7 24 24 24L325.5 176 208 58.5zM175 441c9.4 9.4 24.6 9.4 33.9 0l64-64c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0l-23 23 0-86.1c0-13.3-10.7-24-24-24s-24 10.7-24 24l0 86.1-23-23c-9.4-9.4-24.6-9.4-33.9 0s-9.4 24.6 0 33.9l64 64z"})],-1)),yt=[ft],_t={key:6,class:"mb-5"};function wt(e,t,i,n,h,o){const c=y("TenantTokensPerDayLineChart"),r=y("TenantAvgTokensToMasterSkillsHorizontalBarChart"),d=y("TenantTokensPerSkillHorizontalBarChart");return u(),m("div",Q,[s("span",X,[Y,s("span",null,[s("div",Z,[s("input",{type:"radio",class:"btn-check",name:"timeFilter1",id:"total1",onClick:t[0]||(t[0]=(...l)=>o.toggleWeeklyCumulativeData&&o.toggleWeeklyCumulativeData(...l)),checked:""}),tt,s("input",{type:"radio",class:"btn-check",name:"timeFilter1",id:"week1",onClick:t[1]||(t[1]=(...l)=>o.toggleWeeklyCumulativeData&&o.toggleWeeklyCumulativeData(...l))}),et]),s("button",{class:"btn me-1",onClick:t[2]||(t[2]=(...l)=>o.restartTutorial&&o.restartTutorial(...l)),"aria-label":"info"},st)])]),h.showTutorialTip1?(u(),m("div",ot,[s("div",nt,[rt,s("div",it,[s("button",{class:"btn primary-btn",onClick:t[3]||(t[3]=l=>o.progressTutorial(1))}," next "),s("button",{class:"btn red-btn",onClick:t[4]||(t[4]=(...l)=>o.skipTutorial&&o.skipTutorial(...l))}," exit tutorial ")])])])):D("",!0),s("h4",lt,[_(" Tokens spent per day "),s("button",{class:"btn",onClick:t[5]||(t[5]=l=>o.downloadData(n.analyticsStore.totalTokensPerDay,"Tokens-per-day"))},dt)]),n.analyticsStore.totalTokensPerDay.length>0?(u(),w(c,{key:1,data:n.analyticsStore.totalTokensPerDay,colour:"#5f31dd",class:"mb-5"},null,8,["data"])):(u(),m("p",ht,"No data yet")),pt,s("h4",ut,[_(" Average number of tokens spent to master a skill "),s("button",{class:"btn",onClick:t[6]||(t[6]=l=>o.downloadData(n.analyticsStore.avgTokensToMasterSkills,"Avg-tokens-to-master-skill"))},mt)]),n.analyticsStore.avgTokensToMasterSkills.length>0?(u(),w(r,{key:3,data:n.analyticsStore.avgTokensToMasterSkills,colour:"darkgreen"},null,8,["data"])):(u(),m("p",Tt,"No data yet")),s("h4",gt,[_(" Tokens spent per skill "),s("button",{class:"btn",onClick:t[7]||(t[7]=l=>o.downloadData(n.analyticsStore.totalTokensPerSkill,"Tokens-per-skill"))},yt)]),n.analyticsStore.totalTokensPerSkill.length>0?(u(),w(d,{key:5,data:n.analyticsStore.totalTokensPerSkill,colour:"#5f31dd",class:"mb-5"},null,8,["data"])):(u(),m("p",_t,"No data yet"))])}const Bt=g(K,[["render",wt],["__scopeId","data-v-65ce7f6c"]]);export{Bt as default};
