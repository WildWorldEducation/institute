import{_ as m,A as k,f as g,r as w,o,c as i,a as t,q as S,s as u,t as d,g as h,l as f,T as C,b as p,F as b,z as v,p as x,d as T}from"./main-4c3aab74.js";const I={setup(){const s=k(),e=g();return{usersStore:s,usersDetailsStore:e}},data(){return{referrals:[],copySuccess:!1,copyTimeoutId:null}},async created(){typeof this.usersDetailsStore.userId>"u"&&await this.usersDetailsStore.getUserDetails(),await this.getReferrals()},computed:{referralLink(){return`https://parrhesia.io/student-signup?ref=${this.usersDetailsStore.userName}`}},methods:{async getReferrals(){fetch(`/referrals/${this.usersDetailsStore.userId}/list`).then(function(s){return s.json()}).then(async s=>{await this.usersStore.getUsers(),this.referrals=s;for(let e=0;e<this.referrals.length;e++)for(let r=0;r<this.usersStore.users.length;r++)this.referrals[e].referred_user_id==this.usersStore.users[r].id&&(this.referrals[e].referredUser=this.usersStore.users[r].username),this.referrals[e].referrer_user_id==this.usersStore.users[r].id&&(this.referrals[e].referringUser=this.usersStore.users[r].username);console.log(this.referrals)})},async copyReferralLink(){try{await this.copyToClipboard(this.referralLink)}catch(s){console.error("Copy failed:",s)}},async copyToClipboard(s){this.copyTimeoutId&&clearTimeout(this.copyTimeoutId);let e=!1;if(navigator.clipboard&&window.isSecureContext)try{await navigator.clipboard.writeText(s),e=!0}catch{console.warn("Clipboard API failed, using fallback")}if(!e){await this.$nextTick();const r=this.$refs.referralInput;r&&(r.focus(),r.select(),e=document.execCommand("copy"))}if(e)this.showCopyFeedback();else throw new Error("Could not copy to clipboard")},showCopyFeedback(){this.copySuccess=!0,this.copyTimeoutId=setTimeout(()=>{this.copySuccess=!1,this.copyTimeoutId=null},3e3)}},beforeUnmount(){this.copyTimeoutId&&clearTimeout(this.copyTimeoutId)}},c=s=>(x("data-v-e3304543"),s=s(),T(),s),L={class:"container bg-light rounded"},R={class:"d-flex justify-content-between align-items-start"},V=c(()=>t("h1",{class:"heading"},"Referrals",-1)),D={key:0,class:"referral-link-section"},U=c(()=>t("h3",{class:"secondary-heading h5 mb-2"},"Student Referral Link",-1)),j={class:"d-flex align-items-center gap-2"},N={class:"referral-link-container"},B=["value"],F={key:0,width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},H=c(()=>t("path",{d:"M20 9H11C9.89543 9 9 9.89543 9 11V20C9 21.1046 9.89543 22 11 22H20C21.1046 22 22 21.1046 22 20V11C22 9.89543 21.1046 9 20 9Z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)),M=c(()=>t("path",{d:"M5 15H4C2.89543 15 2 14.1046 2 13V4C2 2.89543 2.89543 2 4 2H13C14.1046 2 15 2.89543 15 4V5",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)),z=[H,M],A={key:1,width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},E=c(()=>t("path",{d:"M20 6L9 17L4 12",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)),q=[E],P={key:0,class:"copy-success-message mt-2 mb-0"},Z={class:"referrals-list"},G={key:0},J={key:1};function K(s,e,r,_,n,l){const y=w("router-link");return o(),i("div",L,[t("div",R,[V,_.usersDetailsStore.role=="partner"?(o(),i("div",D,[U,t("div",j,[t("div",N,[t("input",{ref:"referralInput",value:l.referralLink,type:"text",class:"form-control referral-input",readonly:""},null,8,B),t("button",{onClick:e[0]||(e[0]=(...a)=>l.copyReferralLink&&l.copyReferralLink(...a)),class:S(["btn primary-btn copy-btn",{"btn-success":n.copySuccess}])},[n.copySuccess?(o(),i("svg",A,q)):(o(),i("svg",F,z)),u(" "+d(n.copySuccess?"Copied!":"Copy"),1)],2)])]),h(C,{name:"fade"},{default:f(()=>[n.copySuccess?(o(),i("p",P," âœ“ Referral link copied to clipboard! ")):p("",!0)]),_:1})])):p("",!0)]),t("div",Z,[n.referrals.length>0?(o(),i("ul",G,[(o(!0),i(b,null,v(n.referrals,a=>(o(),i("li",{key:a.id,class:"mb-2"},[h(y,{to:"/referrals/"+a.referred_user_id},{default:f(()=>[u(d(a.referredUser),1)]),_:2},1032,["to"])]))),128))])):(o(),i("p",J," No referrals yet. Share your referral link to start earning! "))])])}const Q=m(I,[["render",K],["__scopeId","data-v-e3304543"]]);export{Q as default};
