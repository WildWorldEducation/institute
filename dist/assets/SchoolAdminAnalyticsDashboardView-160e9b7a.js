import{u as T}from"./AnalyticsStore-585cd30a.js";import{_,o as g,c as w,f as B,A as I,r as f,a as n,g as S,l as v,k as x,b,E as j,p as E,d as L}from"./main-694b4f39.js";import"./transform-4d0f7c8f.js";import{u as $,l as k}from"./line-d122782f.js";import{e as A}from"./time-3c9385c3.js";import{l as C,a as M,b as R,c as V}from"./linear-d9b6cbf2.js";import{m as D}from"./continuous-93813e6c.js";import{o as q,b as H}from"./band-2263c9e7.js";import{s as u}from"./string-c67ea49d.js";import{c as N}from"./category10-63f9141e.js";import{s as O}from"./sort-fcaf8f38.js";import"./point-ea70dc51.js";import"./colors-98f238a0.js";const U={name:"SchoolProgressChart",props:[],data(){return{axisData:[]}},mounted(){},methods:{createChart(t){t.school.length>0?this.axisData=t.school:this.axisData=[];const e=Object.entries(t).map(([r,P])=>({name:r,values:P}));u("#progress-chart-container");const s=document.getElementById("progress-chart-container").clientWidth,o=document.getElementById("progress-chart-container").clientHeight,i=0,c=0,h=0,l=0,d=$(A(this.axisData,r=>r.date),[l,s-c]),m=C([0,D(this.axisData,r=>r.quantity)],[o-h,i]),p=q().domain(e.map(r=>r.name)).range(N),a=k().x(r=>d(r.date)).y(r=>m(r.quantity));u("#progress-chart-container").append("svg").attr("width","100%").attr("height","100%").attr("viewBox",[0,0,+Math.min(s,o),+Math.min(s,o)]).attr("preserveAspectRatio","xMinYMin").selectAll(".line").data(e).join("path").attr("fill","none").attr("stroke",r=>p(r.name)).attr("stroke-width",3).attr("d",r=>a(r.values))},updateChart(t){}}};function W(t,e,s,o,i,c){return null}const z=_(U,[["render",W]]),F={name:"SchoolComparisonChart",props:["colour"],data(){return{}},mounted(){},methods:{createChart(t){u("#school-comparison-chart-container");const e=40,s=0,o=0,i=10,c=200,h=1e3,l=Math.ceil((t.length+.1)*e)+s+i,d=C().domain([0,D(t,a=>a.quantity)]).range([c,h-o]),m=H().domain(O(t,a=>-a.quantity).map(a=>a.name)).rangeRound([s,l-i]).padding(.1);d.tickFormat(20);const p=u("#school-comparison-chart-container").append("svg").attr("width",h).attr("height",l).attr("viewBox",[0,0,h,l]).attr("style","max-width: 100%; height: 100%; font: 16px sans-serif;");p.append("g").attr("fill",this.colour).selectAll().data(t).join("rect").attr("x",d(0)).attr("y",a=>m(a.name)).attr("width",a=>d(a.quantity)-d(0)).attr("height",m.bandwidth()),p.append("g").attr("transform",`translate(0,${s})`).call(M(d).ticks(0)).call(a=>a.select(".domain").remove()),p.append("g").attr("transform",`translate(${c},0)`).style("font","20px sans-serif").call(R(m).tickSizeOuter(0))}}},Y={id:"school-comparison-chart-container"};function G(t,e,s,o,i,c){return g(),w("div",Y)}const J=_(F,[["render",G]]),K={name:"SchoolTimeChart",props:["colour"],data(){return{}},mounted(){},methods:{createChart(t){u("#school-time-chart-container");const e=document.getElementById("time-chart-container").clientWidth,s=document.getElementById("time-chart-container").clientHeight,o=0,i=0,c=0,h=0,l=$(A(t,a=>a.date),[h,e-i]),d=C([0,D(t,a=>a.minutes)],[s-c,o]),m=k().x(a=>l(a.date)).y(a=>d(a.minutes)),p=u("#school-time-chart-container").append("svg").attr("width",e).attr("height",s).attr("viewBox",[0,0,e,s]).attr("style","max-width: 100%; height: auto; height: intrinsic;");p.append("g").attr("transform",`translate(0,${s-c})`).call(V(l).ticks(t.length/2).tickSizeOuter(0)),p.append("path").attr("fill","none").attr("stroke","#ff7f0e").attr("stroke-width",3).attr("d",m(t))}}},Q={id:"school-time-chart-container"};function X(t,e,s,o,i,c){return g(),w("div",Q)}const Z=_(K,[["render",X]]);const tt={name:"School-Admin-Dashboard",setup(){const t=B(),e=T(),s=I();return{userDetailsStore:t,analyticsStore:e,usersStore:s}},data(){return{showSidebar:!0,screenWidth:screen.width,isEveryone:!0,isSchoolData:!1,isLanguageData:!1,isMathData:!1,isHistoryData:!1,isLifeData:!1,isCSData:!1,isSAndIData:!1,isDIData:!1,progressData:{school:[]},isAboveTheCurve:!1}},components:{SchoolProgressChart:z,SchoolComparisonChart:J,SchoolTimeChart:Z},async created(){await this.analyticsStore.getSchoolProgress(this.userDetailsStore.tenantId),this.analyticsStore.rootSubjectsPassedAssessments.length==0&&await this.getComparisonData(),await this.getProgressData(),await this.getTimeData()},methods:{async getProgressData(){this.progressData.school=[];for(let t=0;t<this.analyticsStore.progress.tenant.length;t++)this.progressData.school.push(this.analyticsStore.progress.tenant[t]);this.$nextTick(()=>{this.$refs.progressChart&&this.$refs.progressChart.createChart(this.progressData)})},async getComparisonData(){try{const t=await fetch(`/student-analytics/passed-assessments-by-subject/tenant/${this.userDetailsStore.tenantId}`);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);this.analyticsStore.rootSubjectsPassedAssessments=await t.json(),this.$nextTick(()=>{this.$refs.comparisonChart&&this.$refs.comparisonChart.createChart(this.analyticsStore.rootSubjectsPassedAssessments)})}catch(t){console.error("Error fetching cohort mastered assessments:",t),this.analyticsStore.rootSubjectsPassedAssessments=[]}},async getTimeData(){this.analyticsStore.durationPerDay=[];let t=`/student-analytics/tenant-duration-per-day/weekly/${this.userDetailsStore.tenantId}`;fetch(t).then(e=>e.json()).then(async e=>{this.analyticsStore.durationPerDay=[];for(let s=0;s<e.length;s++)e[s].date=new Date(e[s].date),e[s].minutes=e[s].milliseconds/(1e3*60),this.analyticsStore.durationPerDay.push(e[s]);this.analyticsStore.durationPerDay.sort((s,o)=>s.date-o.date),this.$nextTick(()=>{this.$refs.timeChart&&this.$refs.timeChart.createChart(this.analyticsStore.durationPerDay)})}).catch(e=>{console.error("Error fetching student progress:",e)})}}},y=t=>(E("data-v-7efb73c3"),t=t(),L(),t),st={class:"dashboard"},et={class:"content container"},at=j('<div class="row top-row" data-v-7efb73c3><div class="col-md text-center" data-v-7efb73c3><h2 class="h5 heading m-0" data-v-7efb73c3>Avg # Skills Mastered</h2><span class="top-row-text" data-v-7efb73c3>10</span></div><div class="col-md text-center" data-v-7efb73c3><h2 class="h5 heading m-0" data-v-7efb73c3>Students</h2><span class="top-row-text" data-v-7efb73c3>35</span></div><div class="col-md text-center" data-v-7efb73c3><h2 class="h5 heading m-0" data-v-7efb73c3>Teachers</h2><span class="top-row-text" data-v-7efb73c3>5</span></div><div class="col-md text-center" data-v-7efb73c3><h2 class="h5 heading m-0" data-v-7efb73c3>AI Tutor Usage</h2><span class="top-row-text" data-v-7efb73c3>$500</span></div></div>',1),ot={class:"dash-row row"},rt={id:"progress-chart-container",class:"col-md position-relative"},nt=y(()=>n("h2",{class:"heading h5"},"Student progress",-1)),it={class:"col-md"},ct=y(()=>n("h2",{class:"heading chart-heading h5"},"Subject comparison",-1)),ht={class:"dash-row row mt-2 mb-2"},dt={class:"col-md position-relative"},lt=y(()=>n("h2",{class:"heading h5"},"Cost By Subject",-1)),mt={class:"col-md position-relative"},pt={id:"time-chart-container"},gt=y(()=>n("h2",{class:"heading h5"},"Student Engagement",-1));function ut(t,e,s,o,i,c){const h=f("RouterLink"),l=f("SchoolProgressChart"),d=f("SchoolComparisonChart"),m=f("SchoolTimeChart");return g(),w("div",st,[n("div",et,[at,n("div",ot,[n("div",rt,[S(h,{to:"/reports/academics",class:"me-2 position-absolute chart-heading"},{default:v(()=>[nt]),_:1}),i.progressData.school.length>0?(g(),x(l,{key:0,ref:"progressChart"},null,512)):b("",!0)]),n("div",it,[ct,o.analyticsStore.rootSubjectsPassedAssessments.length>0?(g(),x(d,{key:0,colour:"#5f31dd",ref:"comparisonChart"},null,512)):b("",!0)])]),n("div",ht,[n("div",dt,[S(h,{to:"/reports/cost",class:"me-2 position-absolute chart-heading"},{default:v(()=>[lt]),_:1})]),n("div",mt,[n("div",pt,[S(h,{to:"/reports/engagement",class:"position-absolute chart-heading"},{default:v(()=>[gt,o.analyticsStore.durationPerDay.length>0?(g(),x(m,{key:0,ref:"timeChart"},null,512)):b("",!0)]),_:1})])])])])])}const Tt=_(tt,[["render",ut],["__scopeId","data-v-7efb73c3"]]);export{Tt as default};
