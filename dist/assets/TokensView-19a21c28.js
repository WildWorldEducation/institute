import{_ as g,e as f,h as y,o as r,c as l,a as t,p as u,t as a,j as m,b as d,F as p,x as k}from"./main-5a4c8e44.js";import{u as w}from"./SettingsStore-dd816efa.js";const D={setup(){const s=f(),e=w(),c=y();return{userDetailsStore:s,settingsStore:e,sessionDetailsStore:c}},data(){return{monthlyTokenUsage:null,year:0,month:"",isAITokenLimitReached:!1,isMobileCheck:window.innerWidth,showTooltip:!1,receipts:[],isAITokenLimitReached:!1,assistantsModelPrice:{input:75,output:150},showTokensDropDown:!1,products:[{name:"200,000 tokens for $10",tokens:2e5},{name:"400,000 tokens for $20",tokens:4e5},{name:"1,000,000 tokens for $50",tokens:1e6}],chosenProduct:{}}},async created(){if(this.chosenProduct=this.products[0],this.settingsStore.freeTokenMonthlyLimit==0&&await this.settingsStore.getSettings(),await this.userDetailsStore.getUserDetails(),console.log(this.userDetailsStore.email),console.log(this.userDetailsStore.userName),!this.userDetailsStore.email=="collinsmalcolm@gmail.com"&&!this.userDetailsStore.email=="simonehcollins@gmail.com"&&!this.userDetailsStore.username=="malcolm"&&!this.userDetailsStore.username=="simonehcollins"){let s=this.userDetailsStore.monthlyTokenUsage-this.settingsStore.freeTokenMonthlyLimit;this.settingsStore.freeTokenMonthlyLimit<=this.userDetailsStore.monthlyTokenUsage&&s>this.userDetailsStore.tokens&&(this.isAITokenLimitReached=!0)}this.getReceipts()},async mounted(){let s=document.createElement("script");s.setAttribute("src","https://js.stripe.com/v3/"),document.head.appendChild(s),this.year=new Date().getFullYear();const e=["January","February","March","April","May","June","July","August","September","October","November","December"],c=new Date;this.month=e[c.getMonth()]},computed:{formattedMonthlyTokenUsage(){return this.userDetailsStore.monthlyTokenUsage?this.userDetailsStore.monthlyTokenUsage.toLocaleString():"0"}},methods:{closeOnDropdownOnClickAnywhere(){const s=document.getElementById("token-dropdown");document.body.addEventListener("click",e=>{s.contains(e.target)||(this.showTokensDropDown=!1)})},async getReceipts(){const s=await fetch("/tokens/get-receipts/"+this.userDetailsStore.userId);this.receipts=await s.json()},checkout(s){fetch("/tokens/create-checkout-session",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:this.userDetailsStore.userId,numberOfTokens:s})}).then(e=>e.ok?e.json():e.json().then(c=>Promise.reject(c))).then(({url:e})=>{window.location=e}).catch(e=>{console.error(e.error)})},formattedStripeReceiptDate(s){let e=new Date(s.date);const c=e.getUTCMonth()+1,h=e.getUTCDate();return e.getUTCFullYear()+"/"+c+"/"+h},formattedStripeReceiptAmount(s){return(s.amount/100).toLocaleString("en-US",{style:"currency",currency:"USD"})},openTooltip(){this.showTooltip=!0},closeTooltip(){this.showTooltip=!1}}},S={class:"container"},T={class:"row"},b={class:"col-md"},v={key:0,class:"modal"},C={class:"modal-content"},M={class:"row"},L={class:"col col-md-8 col-lg-5 mt-2"},_={class:"d-flex flex-column position-relative"},x={key:0,class:"custom-dropdown-base"},A=["onClick"],U=["href"],I={key:0};function R(s,e,c,h,o,i){return r(),l("div",S,[t("div",T,[t("div",b,[t("h2",{class:u(["secondary-heading h4 mb-4",{"text-center":o.isMobileCheck<576}])}," Monthly AI usage: "+a(o.month)+" "+a(o.year),3),t("ul",null,[t("li",null,[t("p",null,[e[4]||(e[4]=t("strong",null,"Free limit:",-1)),m(" "+a(h.settingsStore.freeTokenMonthlyLimit.toLocaleString()),1)])]),t("li",null,[t("p",null,[e[5]||(e[5]=t("strong",null,"Current token usage:",-1)),m(" "+a(i.formattedMonthlyTokenUsage),1)])]),t("li",null,[t("p",null,[e[6]||(e[6]=t("strong",null,"Your tokens:",-1)),m(" "+a(h.userDetailsStore.tokens.toLocaleString()),1)])])]),o.isAITokenLimitReached?(r(),l("div",{key:0,class:u(["alert alert-warning",{"mb-0":o.isMobileCheck>=576}]),role:"alert"}," You are over the monthly free limit. You can't use the AI features until next month. ",2)):d("",!0)]),o.showTooltip?(r(),l("div",v,[t("div",C,[t("div",null,[e[7]||(e[7]=t("p",null," It is against our policy to share accounts and each account is meant to only be used by one user. ",-1)),t("button",{class:"btn primary-btn",onClick:e[0]||(e[0]=(...n)=>i.closeTooltip&&i.closeTooltip(...n))}," Close ")])])])):d("",!0),t("div",{class:u(["col-md d-flex",o.isMobileCheck>576?"justify-content-end":"justify-content-center"])},[t("button",{class:"btn info-btn ms-1",onClick:e[1]||(e[1]=(...n)=>i.openTooltip&&i.openTooltip(...n))},e[8]||(e[8]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 192 512",width:"20",height:"20",class:"primary-icon"},[t("path",{d:"M48 80a48 48 0 1 1 96 0A48 48 0 1 1 48 80zM0 224c0-17.7 14.3-32 32-32l64 0c17.7 0 32 14.3 32 32l0 224 32 0c17.7 0 32 14.3 32 32s-14.3 32-32 32L32 512c-17.7 0-32-14.3-32-32s14.3-32 32-32l32 0 0-192-32 0c-17.7 0-32-14.3-32-32z"})],-1)]))],2)]),e[12]||(e[12]=t("hr",null,null,-1)),t("div",M,[t("div",L,[e[10]||(e[10]=t("h2",{class:"secondary-heading h4"},"Buy Tokens",-1)),t("div",_,[t("div",{id:"token-dropdown",class:u([o.showTokensDropDown?"custom-select-button-focus":"custom-select-button"]),onClick:e[2]||(e[2]=n=>{o.showTokensDropDown=!o.showTokensDropDown,i.closeOnDropdownOnClickAnywhere()})},[m(a(o.chosenProduct.name)+" ",1),e[9]||(e[9]=t("span",null,[t("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[t("path",{d:"M14.2929 8.70711C14.9229 8.07714 14.4767 7 13.5858 7H6.41421C5.52331 7 5.07714 8.07714 5.70711 8.70711L9.29289 12.2929C9.68342 12.6834 10.3166 12.6834 10.7071 12.2929L14.2929 8.70711Z",fill:"#344054"})])],-1))],2),o.showTokensDropDown?(r(),l("div",x,[(r(!0),l(p,null,k(o.products,n=>(r(),l("div",{class:"custom-dropdown-option",onClick:j=>{o.chosenProduct=n,o.showTokensDropDown=!1}},a(n.name),9,A))),256))])):d("",!0)])])]),t("button",{onClick:e[3]||(e[3]=n=>i.checkout(o.chosenProduct.tokens)),class:"btn primary-btn mt-2 mb-2"}," buy "),e[13]||(e[13]=t("hr",null,null,-1)),t("div",{class:u({"text-center":o.isMobileCheck<576})},[e[11]||(e[11]=t("h2",{class:"secondary-heading h4"},"Receipts",-1)),(r(!0),l(p,null,k(o.receipts,n=>(r(),l("div",null,[t("a",{href:n.url,target:"_blank"},a(i.formattedStripeReceiptAmount(n))+" "+a(i.formattedStripeReceiptDate(n)),9,U)]))),256)),o.isMobileCheck<576?(r(),l("p",I,"Â ")):d("",!0)],2)])}const P=g(D,[["render",R],["__scopeId","data-v-9192feb1"]]);export{P as default};
