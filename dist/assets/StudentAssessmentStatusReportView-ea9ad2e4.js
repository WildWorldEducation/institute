import{_ as y,y as A,I as S,r as u,o as d,c as h,a as n,t as w,k as f,f as x}from"./main-0345d612.js";import{u as b}from"./AnalyticsStore-df08e50f.js";import"./transform-af9a74a2.js";import{l as B,c as k,b as D}from"./linear-5b188edc.js";import{m as v,b as j}from"./continuous-7328829e.js";import{s as C}from"./sort-ed61f96d.js";import{s as g}from"./string-dd82ab4a.js";import{A as I}from"./AttemptedAssessmentsTimelineChart-98f19bab.js";import{D as N}from"./downloadCSVBtn-46a99ed8.js";import"./main-1bd7eaf1.js";import"./time-0457d93b.js";import"./extent-4cf1c809.js";const R={name:"StudentAttemptedAssessmentsByRootSubjectHorizontalBarChart",props:["data"],data(){return{}},mounted(){console.log(this.data),g("#assessment-comparison-chart-container");const s=0,e=10,m=10,i=200,o=document.getElementById("assessment-comparison-chart-container").clientWidth,l=document.getElementById("assessment-comparison-chart-container").clientHeight,a=B().domain([0,v(this.data,t=>t.quantity)]).range([i,o-e]),r=j().domain(C(this.data,t=>-t.quantity).map(t=>t.name)).rangeRound([s,l-m]).padding(.2),p=a.tickFormat(20),c=g("#assessment-comparison-chart-container").append("svg").attr("width","100%").attr("height","100%").attr("viewBox",[0,0,"100%","100%"]).attr("style","max-width: 100%; height: 100%; font: 14px sans-serif;");c.append("g").selectAll().data(this.data).join("rect").attr("x",a(0)).attr("y",t=>r(t.name)).attr("width",t=>a(t.quantity)-a(0)).attr("height",r.bandwidth()).attr("fill",function(t){return t.name=="Language"?"DarkMagenta":t.name=="Mathematics"?"blue":t.name=="Science & Invention"?"purple":t.name=="Computer Science"?"deeppink":t.name=="Dangerous Ideas"?"brown":t.name=="History"?"cyan":t.name=="Life"?"magenta":"#ff7f0e"}),c.append("g").attr("fill","white").attr("text-anchor","end").selectAll().data(this.data).join("text").attr("x",t=>a(t.quantity)).attr("y",t=>r(t.name)+r.bandwidth()/2).attr("dy","0.35em").attr("dx",-4).text(t=>p(t.quantity)).call(t=>t.filter(_=>a(_.quantity)-a(0)<20).attr("dx",4).attr("fill","black").attr("text-anchor","start")),c.append("g").attr("transform",`translate(0,${s})`).call(k(a).ticks(0)).call(t=>t.select(".domain").remove()),c.append("g").attr("transform",`translate(${i},0)`).attr("style","font-size: 16px").call(D(r).tickSizeOuter(0))},computed:{}};function $(s,e,m,i,o,l){return null}const T=y(R,[["render",$]]);const V={setup(){const s=A(),e=S(),m=b();return{usersStore:s,userSkillsStore:e,analyticsStore:m}},components:{AttemptedAssessmentsTimelineChart:I,StudentAttemptedAssessmentsByRootSubjectHorizontalBarChart:T,DownloadCSVBtn:N},data(){return{studentId:this.$route.params.studentId,studentName:null,assessmentAttempts:[],assessmentAttemptsDownloadData:[]}},async created(){this.usersStore.users.length<1&&await this.usersStore.getUsers();const s=this.usersStore.users.find(e=>e.id===this.studentId);s&&(this.studentName=s.username),await this.getAssessmentAttempts(),await this.analyticsStore.getStudentAttemptedAssessmentsBySubject(this.studentId)},methods:{async getAssessmentAttempts(){fetch(`/student-analytics/started-unmastered-assessments/${this.studentId}`).then(s=>s.json()).then(s=>{this.assessmentAttempts=s.map(e=>({...e,url:`/skills/${e.url}`,labelName:`${e.name}`})),this.assessmentAttemptsDownloadData=this.assessmentAttempts.map(e=>({skill:e.name,date:this.assessmentDate(e.date)}))}).catch(s=>{console.error("Error fetching last visited skills:",s)})},assessmentDate(s){return new Date(s).toLocaleString("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})}}},q={class:"container-fluid chart-page"},z={class:"d-flex justify-content-between w-100"},H={class:"tertiary-heading h4"},L={class:"row chart-row"},E={id:"assessment-comparison-chart-container",class:"position-relative h-100"},U={key:1},M={class:"row mt-5 chart-row"},O={id:"assessment-timeline-chart-container",class:"position-relative"},F={key:1};function W(s,e,m,i,o,l){const a=u("StudentAttemptedAssessmentsByRootSubjectHorizontalBarChart"),r=u("DownloadCSVBtn"),p=u("AttemptedAssessmentsTimelineChart");return d(),h("div",q,[n("span",z,[e[0]||(e[0]=n("h1",{class:"heading h4"},"Attempted assessments",-1)),n("h2",H,w(o.studentName),1)]),n("div",L,[e[1]||(e[1]=n("h3",{class:"secondary-heading h5"},"Subject Comparison",-1)),n("div",E,[i.analyticsStore.studentRootSubjectsAttemptedAssessments.length>0?(d(),f(a,{key:0,data:i.analyticsStore.studentRootSubjectsAttemptedAssessments},null,8,["data"])):(d(),h("p",U,"No data yet"))])]),n("div",M,[e[2]||(e[2]=n("h3",{class:"secondary-heading h5"},"Timeline",-1)),n("div",O,[x(r,{data:o.assessmentAttemptsDownloadData,fileName:`Attempted Assessments - ${o.studentName}`,toolTip:"Download attempted assessments data as CSV",class:"position-absolute download-btn"},null,8,["data","fileName"]),o.assessmentAttempts.length>0?(d(),f(p,{key:0,data:o.assessmentAttempts},null,8,["data"])):(d(),h("p",F," This student has not attempted any assessments yet. "))])])])}const nt=y(V,[["render",W],["__scopeId","data-v-e2c3eaae"]]);export{nt as default};
