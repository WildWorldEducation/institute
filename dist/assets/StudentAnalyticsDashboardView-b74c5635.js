import{u as H}from"./AnalyticsStore-c716d570.js";import{u as L}from"./TeacherAnalyticsStore-85023488.js";import{_ as C,o as p,c as f,f as V,r as D,a,g as S,l as x,k as $,b,F,z,s as v,t as E,p as N,d as O}from"./main-2f162222.js";import"./transform-4d0f7c8f.js";import{u as B,l as M}from"./line-d122782f.js";import{e as q}from"./time-3c9385c3.js";import{l as A,c as P,b as T,a as W}from"./linear-d9b6cbf2.js";import{m as I}from"./continuous-93813e6c.js";import{o as R,b as Q}from"./band-2263c9e7.js";import{s as _}from"./string-c67ea49d.js";import{c as j}from"./category10-63f9141e.js";import{s as Y}from"./sort-fcaf8f38.js";import"./point-ea70dc51.js";import"./colors-98f238a0.js";const U={name:"SchoolProgressChart",props:[],data(){return{axisData:[]}},mounted(){},methods:{createChart(e){e.student.length>0?this.axisData=e.student:e.average.length>0?this.axisData=e.average:this.axisData=[];const l=Object.entries(e).map(([t,y])=>({name:t,values:y}));_("#progress-chart-container");const r=document.getElementById("progress-chart-container").clientWidth,n=document.getElementById("progress-chart-container").clientHeight,d=5,u=20,o=20,c=20,i=B(q(this.axisData,t=>t.date),[c,r-u]),h=A([0,I(this.axisData,t=>t.quantity)],[n-o,d]);R().domain(l.map(t=>t.name)).range(j);const m=M().x(t=>i(t.date)).y(t=>h(t.quantity)),s=_("#progress-chart-container").append("svg").attr("width","100%").attr("height","100%").attr("viewBox",[0,0,+Math.min(r,n),+Math.min(r,n)]).attr("preserveAspectRatio","xMinYMin");s.append("g").attr("transform",`translate(0,${n-20})`).call(P(i).ticks(r/100).tickSizeOuter(0)),s.append("g").attr("transform",`translate(${c},0)`).call(T(h).ticks(n/80)).call(t=>t.selectAll(".tick line").clone().attr("x2",r-c-u).attr("stroke-opacity",.1)),s.selectAll(".line").data(l).join("path").attr("fill","none").attr("stroke",t=>t.name=="student"?"green":"#ff7f0e").attr("stroke-width",3).attr("d",t=>m(t.values))}}};function G(e,l,r,n,d,u){return null}const J=C(U,[["render",G]]),K={name:"SchoolTimeChart",props:[],data(){return{axisData:[]}},mounted(){},methods:{createChart(e){if(console.log(e),e.student.length==0)this.axisData=e.tenant;else if(e.tenant.length==0)this.axisData=e.student;else{const t=e.student.reduce((k,w)=>Math.max(k,w.quantity),-1/0),y=e.tenant.reduce((k,w)=>Math.max(k,w.quantity),-1/0);t>=y?this.axisData=e.student:this.axisData=e.tenant}const l=Object.entries(e).map(([t,y])=>({name:t,values:y}));_("#time-chart-container");const r=document.getElementById("time-chart-container").clientWidth,n=document.getElementById("time-chart-container").clientHeight,d=0,u=20,o=20,c=20,i=B(q(this.axisData,t=>t.date),[c,r-u]),h=A([0,I(this.axisData,t=>t.formattedQuantity)],[n-o,d]);R().domain(l.map(t=>t.name)).range(j);const m=M().x(t=>i(t.date)).y(t=>h(t.formattedQuantity)),s=_("#time-chart-container").append("svg").attr("width","100%").attr("height","100%").attr("viewBox",[0,0,+Math.min(r,n),+Math.min(r,n)]).attr("preserveAspectRatio","xMinYMin");s.append("g").attr("transform",`translate(0,${n-o})`).call(P(i).ticks(e.length).tickSizeOuter(0)),s.append("g").attr("transform",`translate(${c},0)`).call(T(h).ticks(n/40)).call(t=>t.select(".domain").remove()).call(t=>t.selectAll(".tick line").clone().attr("x2",r-c-u).attr("stroke-opacity",.2)).call(t=>t.append("text").attr("x",-c).attr("y",10).attr("fill","currentColor").attr("text-anchor","start")),s.selectAll(".line").data(l).join("path").attr("fill","none").attr("stroke",t=>t.name=="student"?"RoyalBlue":"#ff7f0e").attr("stroke-width",3).attr("d",t=>m(t.values))}}};function X(e,l,r,n,d,u){return null}const Z=C(K,[["render",X]]),tt={name:"StudentComparisonChart",props:["data","colour"],data(){return{}},mounted(){},methods:{createChart(e){_("#student-comparison-container");const l=25,r=0,n=20,d=10,u=200,o=700,c=Math.ceil((e.length+.1)*l)+r+d,i=A().domain([0,I(e,s=>s.quantity)]).range([u,o-n]),h=Q().domain(Y(e,s=>-s.quantity).map(s=>s.name)).rangeRound([r,c-d]).padding(.1);i.tickFormat(20);const m=_("#student-comparison-container").append("svg").attr("width",o).attr("height",c).attr("viewBox",[0,0,o,c]).attr("style","max-width: 100%; height: 100%; font: 14px sans-serif;");m.append("g").selectAll().data(e).join("rect").attr("x",i(0)).attr("y",s=>h(s.name)).attr("width",s=>i(s.quantity)-i(0)).attr("height",h.bandwidth()).attr("fill",function(s){return s.name=="Language"?"green":s.name=="Mathematics"?"blue":s.name=="Science & Invention"?"purple":s.name=="Computer Science"?"deeppink":s.name=="Dangerous Ideas"?"brown":s.name=="History"?"cyan":s.name=="Life"?"magenta":"#ff7f0e"}),m.append("g").attr("fill","white").attr("text-anchor","end").selectAll().data(e).join("text").attr("x",s=>i(s.quantity)).attr("y",s=>h(s.name)+h.bandwidth()/2).attr("dy","0.35em").attr("dx",-4).text(s=>s.quantity).call(s=>s.filter(t=>i(t.quantity)-i(0)<20).attr("dx",4).attr("fill","black").attr("text-anchor","start")),m.append("g").attr("transform",`translate(0,${r})`).call(W(i).ticks(0)).call(s=>s.select(".domain").remove()),m.append("g").attr("transform",`translate(${u},0)`).attr("style","font-size: 16px").call(T(h).tickSizeOuter(0))}}},et={id:"student-comparison-container"};function st(e,l,r,n,d,u){return p(),f("div",et)}const at=C(tt,[["render",st]]);const nt={name:"Student-Dashboard",setup(){const e=V(),l=H(),r=L();return{userDetailsStore:e,analyticsStore:l,teacherAnalyticsStore:r}},data(){return{showSidebar:!0,screenWidth:screen.width,isStudentData:!0,isSchoolData:!0,isLanguageData:!1,isMathData:!1,isHistoryData:!1,isLifeData:!1,isCSData:!1,isSAndIData:!1,isDIData:!1,progressData:{student:[],average:[]},isAboveTheCurve:!1}},components:{StudentProgressChart:J,StudentComparisonChart:at,StudentTimeChart:Z},async created(){await this.analyticsStore.getStudentProgress(this.userDetailsStore.userId,this.userDetailsStore.tenantId),await this.analyticsStore.getStudentPassedAssessmentsBySubject(this.userDetailsStore.userId),await this.analyticsStore.getStudentTime(this.userDetailsStore.userId,this.userDetailsStore.tenantId),await this.teacherAnalyticsStore.getStudentMultipleFails(this.userDetailsStore.userId),this.analyticsStore.progress.student[this.analyticsStore.progress.student.length-1].quantity>this.analyticsStore.progress.tenant[this.analyticsStore.progress.tenant.length-1].quantity&&(this.isAboveTheCurve=!0),await this.HandleProgressData(),await this.HandleComparisonData(),await this.HandleTimeData()},methods:{async HandleProgressData(){if(this.isStudentData){this.progressData.student=[];for(let e=0;e<this.analyticsStore.progress.student.length;e++)this.progressData.student.push(this.analyticsStore.progress.student[e])}else this.progressData.student=[];if(this.isSchoolData){this.progressData.average=[];for(let e=0;e<this.analyticsStore.progress.tenant.length;e++)this.progressData.average.push(this.analyticsStore.progress.tenant[e])}else this.progressData.average=[];this.$nextTick(()=>{this.$refs.progressChart&&this.$refs.progressChart.createChart(this.progressData)})},async HandleComparisonData(){this.$nextTick(()=>{this.$refs.comparisonChart&&this.$refs.comparisonChart.createChart(this.analyticsStore.studentRootSubjectsPassedAssessments)})},async HandleTimeData(){this.$nextTick(()=>{this.$refs.timeChart&&this.$refs.timeChart.createChart(this.analyticsStore.time)})},toggleSidebar(){this.showSidebar=!this.showSidebar}}},g=e=>(N("data-v-7fc41ff1"),e=e(),O(),e),rt={class:"dashboard"},it={class:"main"},ot={class:"content container-fluid"},ct={class:"dash-row row"},lt={class:"col-md-6 h-100 position-relative"},ht=g(()=>a("h2",{class:"heading h5"},"Progress over time",-1)),dt={id:"progress-chart-container"},ut={class:"col-md-6"},mt={id:"comparison-chart-container"},pt=g(()=>a("h2",{class:"heading h5 mt-1"},"Subject comparison",-1)),gt={class:"dash-row row"},ft={class:"col-md h-100 position-relative"},_t=g(()=>a("h2",{class:"heading h5"},"Study time",-1)),yt={id:"time-chart-container"},St={class:"col-md position-relative"},xt={class:"row"},Dt={class:"col-md"},vt=g(()=>a("h2",{class:"h5 heading"}," Super challenging skills ",-1)),Ct={key:0},kt={key:1},wt={class:"col-md"},$t=g(()=>a("h2",{class:"h5 heading"},"Stats",-1)),bt=g(()=>a("li",null,[a("strong",null,"Skills passed:"),v(" 25")],-1)),At=g(()=>a("li",null,[a("strong",null,"Total time spent:"),v(" 5:00 ")],-1)),Tt=g(()=>a("strong",null,"Tokens used:",-1));function It(e,l,r,n,d,u){const o=D("RouterLink"),c=D("StudentProgressChart"),i=D("StudentComparisonChart"),h=D("StudentTimeChart");return p(),f("div",rt,[a("div",it,[a("div",ot,[a("div",ct,[a("div",lt,[S(o,{to:"/my-progress/skills",class:""},{default:x(()=>[ht]),_:1}),a("div",dt,[d.progressData.student.length>0||d.progressData.average.length>0?(p(),$(c,{key:0,ref:"progressChart"},null,512)):b("",!0)])]),a("div",ut,[a("div",mt,[pt,n.analyticsStore.studentRootSubjectsPassedAssessments.length>0?(p(),$(i,{key:0,ref:"comparisonChart",data:n.analyticsStore.studentRootSubjectsPassedAssessments,colour:"#5f31dd"},null,8,["data"])):b("",!0)])])]),a("div",gt,[a("div",ft,[S(o,{to:"/my-progress/time"},{default:x(()=>[_t]),_:1}),a("div",yt,[n.analyticsStore.time.student.length>0||n.analyticsStore.time.tenant.length>0?(p(),$(h,{key:0,ref:"timeChart"},null,512)):b("",!0)])]),a("div",St,[a("div",xt,[a("div",Dt,[S(o,{to:"/my-progress/super-challenging",class:"col"},{default:x(()=>[vt]),_:1}),n.teacherAnalyticsStore.studentMultipleFails.length>0?(p(),f("ul",Ct,[(p(!0),f(F,null,z(n.teacherAnalyticsStore.studentMultipleFails,m=>(p(),f("li",{class:"failed-skills",key:m.id},[S(o,{to:"/skills/"+m.url,target:"_blank"},{default:x(()=>[v(E(m.name),1)]),_:2},1032,["to"])]))),128))])):(p(),f("p",kt,"Nothing to worry about yet"))]),a("div",wt,[$t,a("ul",null,[bt,At,a("li",null,[S(o,{to:"/my-progress/tokens"},{default:x(()=>[Tt,v(" 10,000")]),_:1})])])])])])])])])])}const Wt=C(nt,[["render",It],["__scopeId","data-v-7fc41ff1"]]);export{Wt as default};
