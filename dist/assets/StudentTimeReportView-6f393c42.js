import{_ as f,y as k,r,o,c as a,a as s,t as d,j as u,f as m,k as h,b as y,F as S}from"./main-c88d736d.js";import{T as g}from"./TimePerSkillHorizontalBarChart-706efc3a.js";import{S as w}from"./StudentDurationPerDayLineChart-66b45e07.js";import{D as P}from"./downloadCSVBtn-21d059b9.js";import"./transform-4d0f7c8f.js";import"./string-c67ea49d.js";import"./linear-d9b6cbf2.js";import"./continuous-93813e6c.js";import"./band-2263c9e7.js";import"./sort-fcaf8f38.js";import"./line-d122782f.js";import"./time-3c9385c3.js";import"./point-ea70dc51.js";const T={setup(){return{usersStore:k()}},components:{TimePerSkillHorizontalBarChart:g,StudentDurationPerDayLineChart:w,DownloadCSVBtn:P},data(){return{studentId:this.$route.params.studentId,studentName:null,skillDurations:[],durationsPerDay:[],allSkillsDuration:0,isDataLoaded:!1,totalTimeOnPlatformDownloadData:[],minutesPerSkillDownloadData:[]}},async created(){this.usersStore.users.length<1&&await this.usersStore.getUsers();const e=this.usersStore.users.find(t=>t.id===this.studentId);e&&(this.studentName=e.username),await this.getSkillDuration(),await this.getAllSkillsDuration(),await this.getStudentDurationPerDay(),this.isDataLoaded=!0},methods:{async getSkillDuration(){fetch(`/student-analytics/skill-durations/${this.studentId}`).then(e=>e.json()).then(e=>{this.skillDurations=e;for(let t=0;t<this.skillDurations.length;t++)this.skillDurations[t].formattedQuantity=this.millisToMinutesAndSeconds(this.skillDurations[t].quantity);this.minutesPerSkillDownloadData=this.skillDurations.map(t=>({skill:t.name,quantity:t.formattedQuantity}))}).catch(e=>{console.error("Error fetching last visited skills:",e)})},async getAllSkillsDuration(){fetch(`/student-analytics/all-skills-duration/${this.studentId}`).then(e=>e.json()).then(e=>{this.allSkillsDuration=e.duration}).catch(e=>{console.error("Error fetching last visited skills:",e)})},async getStudentDurationPerDay(){fetch(`/student-analytics/student-duration-per-day/${this.studentId}`).then(e=>e.json()).then(e=>{for(let t=0;t<e.length;t++)e[t].formattedQuantity=e[t].quantity/(1e3*60),e[t].date=new Date(e[t].date);e.sort((t,i)=>t.date-i.date),this.durationsPerDay=e,this.totalTimeOnPlatformDownloadData=this.durationsPerDay.map(t=>({date:t.date,minutes:t.formattedQuantity}))}).catch(e=>{console.error("Error fetching student duration per day:",e)})},millisToMinutesAndSeconds(e){var t=Math.floor(e/6e4),i=(e%6e4/1e3).toFixed(0);return t+":"+(i<10?"0":"")+i}}},_={class:"container"},N={class:"d-flex justify-content-between w-100"},C={class:"secondary-heading h3"},v={key:0},B={class:"secondary-heading d-flex justify-content-between w-100 align-items-center"},V={key:1},x={class:"secondary-heading d-flex justify-content-between w-100 align-items-center"},j={key:1};function b(e,t,i,A,n,c){const l=r("DownloadCSVBtn"),D=r("StudentDurationPerDayLineChart"),p=r("TimePerSkillHorizontalBarChart");return o(),a(S,null,[s("div",_,[s("span",N,[t[0]||(t[0]=s("h1",{class:"heading"},"Time Report",-1)),s("h2",C,d(n.studentName),1)]),t[5]||(t[5]=s("p",null,[s("em",null," Please note that time spent on external sources (e.g. websites) related to skills is not measured.")],-1)),n.isDataLoaded?(o(),a("div",v,[s("div",null,[s("h4",B,[t[1]||(t[1]=u(" Total time on platform ",-1)),m(l,{data:n.totalTimeOnPlatformDownloadData,fileName:`Total time on platform - ${n.studentName}`,toolTip:"Download total time on platform data as CSV"},null,8,["data","fileName"])]),n.durationsPerDay.length>0?(o(),h(D,{key:0,data:n.durationsPerDay},null,8,["data"])):(o(),a("p",V,"There is no data to show yet."))]),s("div",null,[t[4]||(t[4]=s("h4",{class:"secondary-heading r"},"All skills",-1)),s("p",null,d(c.millisToMinutesAndSeconds(this.allSkillsDuration)),1),s("h4",x,[t[2]||(t[2]=u(" Minutes per skill ",-1)),m(l,{data:n.minutesPerSkillDownloadData,fileName:`Minutes per skill - ${n.studentName}`,toolTip:"Download minutes per skill data as CSV"},null,8,["data","fileName"])]),n.skillDurations.length>0?(o(),h(p,{key:0,data:n.skillDurations,colour:"darkgreen"},null,8,["data"])):(o(),a("div",j,t[3]||(t[3]=[s("p",null,"No skills visited by this student.",-1)])))])])):y("",!0)]),t[6]||(t[6]=s("p",null,"Â ",-1))],64)}const J=f(T,[["render",b]]);export{J as default};
