import{u as p}from"./CohortsStore-4104f9b3.js";import{_ as u,o as c,c as h,e as m,r as g,a as l,t as y,f}from"./main-ae8b2d89.js";import{s as v}from"./transform-62bed377.js";import{b as k}from"./band-22321830.js";import{l as w,m as S,b}from"./linear-c1216a03.js";import"./ordinal-3694ef9e.js";const _={name:"CohortSkillActivityChart",props:["data","colour"],data(){return{chartHeight:400,chartWidth:1200,labelWidth:20}},watch:{data:{handler(){this.labelWidth=this.calculateLongestLabelWidth(),this.chartHeight=this.calculateChartHeight(),this.drawChart()}}},methods:{drawChart(){const t=this.data;if(!t||t.length===0){console.warn("No data available for the chart");return}const e={top:20,right:400,bottom:40,left:200},s=400,a=this.chartHeight-e.top-e.bottom,r=v("#skill-activity-chart-container").append("svg").attr("width",s+e.left+e.right).attr("height",a+e.top+e.bottom).append("g").attr("transform",`translate(${e.left},${e.top})`),i=k().domain(this.data.map(o=>o.name)).range([0,a]).padding(.3),d=w().domain([0,S(this.data,o=>o.quantity)]).range([0,s]);r.selectAll(".bar").data(this.data).enter().append("rect").attr("class","bar").attr("x",0).attr("y",o=>i(o.name)).attr("width",o=>o.quantity>0?d(o.quantity):d(1)).attr("height",o=>o.quantity>0?i.bandwidth():1).attr("fill","#5f31dd"),r.append("g").attr("class","axis").call(b(i)),r.append("text").attr("class","axis-label").attr("transform",`translate(${s/2},${a+35})`).style("text-anchor","middle").text("Duration (hours)"),r.selectAll(".bar-label").data(this.data).enter().append("text").attr("class","bar-label").attr("x",o=>d(o.quantity)+5).attr("y",o=>i(o.name)+i.bandwidth()/2).attr("dy","0.35em").style("font-size","12px").text(o=>o.quantity)},calculateChartHeight(){return this.data.length>0?this.data.length*30+100:400},calculateLongestLabelWidth(){let t=0;for(const s of this.data)t=Math.max(t,s.name.length);return t+10}}},A={id:"skill-activity-chart-container"};function x(t,e,s,a,n,r){return c(),h("div",A)}const C=u(_,[["render",x]]),$={setup(){const t=p(),e=m();return{cohortsStore:t,userDetailsStore:e}},data(){return{cohortId:this.$route.params.cohortId,cohortName:"",visitedSkills:[],skillActivities:[]}},components:{CohortSkillActivityChart:C},async created(){this.cohortsStore.cohorts.length<1&&await this.cohortsStore.getCohorts(this.userDetailsStore.userId);const t=this.cohortsStore.cohorts.find(e=>e.id==this.cohortId);t?(this.cohortName=t.name,await this.getCohortSkillActivityReport()):this.cohortId==="all-students"?(this.cohortName="All Students",await this.getAllStudentsSkillActivityReport()):console.error("Cohort not found for ID:",this.cohortId),this.skillActivities=this.skillActivities.map(e=>({...e,quantity:this.millisecondsToHours(e.quantity,2)}))},mounted(){},methods:{async getCohortSkillActivityReport(){try{const t=await fetch(`/student-analytics/cohort-skill-activity-report/${this.cohortId}`);if(!t.ok)throw new Error("Network response was not ok");this.skillActivities=await t.json()}catch(t){console.error("Error fetching skill activity report:",t)}},async getAllStudentsSkillActivityReport(){try{const t=await fetch(`/student-analytics/all-student-cohort-activity/instructor/${this.userDetailsStore.userId}`);if(!t.ok)throw new Error("Network response was not ok");this.skillActivities=await t.json()}catch(t){console.error("Error fetching skill activity report for all students:",t)}},visitedDate(t){return new Date(t).toLocaleString("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})},millisecondsToHours(t,e){return(t/36e5).toFixed(e)}}},D={class:"container"},H={class:"d-flex justify-content-between w-100"},N={class:"secondary-heading h3"},I={key:0,class:"mb-4"},q={key:1};function R(t,e,s,a,n,r){const i=g("CohortSkillActivityChart");return c(),h("div",D,[l("span",H,[e[0]||(e[0]=l("h1",{class:"heading"},"Skill Activity Report",-1)),l("h2",N,y(n.cohortName),1)]),this.skillActivities.length>0?(c(),h("div",I,[f(i,{data:n.skillActivities,colour:"#4CAF50"},null,8,["data"])])):(c(),h("div",q,e[1]||(e[1]=[l("p",null,"No skills visited by this cohort.",-1)])))])}const F=u($,[["render",R]]);export{F as default};
