import{u as $}from"./AnalyticsStore-289c1ad2.js";import{u as P}from"./TeacherAnalyticsStore-cbef459a.js";import{_ as w,o as c,c as m,e as B,r as _,a as t,f as S,k as y,p as f,b as M,j as b,F as j,x as q,t as D}from"./main-53559ef3.js";import{S as H}from"./StudentProgressChart-9c3b4073.js";import"./transform-af9a74a2.js";import{u as L,l as R}from"./line-85f04100.js";import{e as N}from"./extent-4cf1c809.js";import{l as T,a as V,b as A,c as F}from"./linear-5b188edc.js";import{m as I,o as U,b as z}from"./continuous-7328829e.js";import{c as E}from"./colors-98f238a0.js";import{s as C}from"./string-dd82ab4a.js";import{s as O}from"./sort-ed61f96d.js";import"./time-0457d93b.js";import"./point-ea70dc51.js";const Y=E("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),Q={name:"SchoolTimeChart",props:[],data(){return{axisData:[]}},mounted(){},methods:{createChart(a){if(a.student.length==0)this.axisData=a.tenant;else if(a.tenant.length==0)this.axisData=a.student;else{const n=a.student.reduce((k,x)=>Math.max(k,x.quantity),-1/0),v=a.tenant.reduce((k,x)=>Math.max(k,x.quantity),-1/0);n>=v?this.axisData=a.student:this.axisData=a.tenant}const s=Object.entries(a).map(([n,v])=>({name:n,values:v})),o=document.getElementById("time-chart-container").clientWidth,r=document.getElementById("time-chart-container").clientHeight,i=5,g=0,d=25,p=25,l=L(N(this.axisData,n=>n.date),[p,o-g]),h=T([0,I(this.axisData,n=>n.formattedQuantity)],[r-d,i]);U().domain(s.map(n=>n.name)).range(Y);const u=R().x(n=>l(n.date)).y(n=>h(n.formattedQuantity)),e=C("#time-chart-container").append("svg").attr("width","100%").attr("height","100%").attr("viewBox",[0,0,+Math.min(o,r),+Math.min(o,r)]).attr("preserveAspectRatio","xMinYMin");e.append("g").attr("transform",`translate(0,${r-d})`).call(V(l).ticks(7).tickSizeOuter(0)),e.append("g").attr("transform",`translate(${p},0)`).call(A(h).ticks(r/40)).call(n=>n.select(".domain").remove()).call(n=>n.selectAll(".tick line").clone().attr("x2",o-p-g).attr("stroke-opacity",.2)).call(n=>n.append("text").attr("x",-p).attr("y",10).attr("fill","currentColor").attr("text-anchor","start")),e.selectAll(".line").data(s).join("path").attr("fill","none").attr("stroke",n=>n.name=="student"?"RoyalBlue":"#ff7f0e").attr("stroke-width",n=>n.name=="student"?3:2).attr("d",n=>u(n.values))}}};function W(a,s,o,r,i,g){return null}const G=w(Q,[["render",W]]),J={name:"StudentComparisonChart",props:["data","colour"],data(){return{}},mounted(){},methods:{createChart(a){C("#student-comparison-container");const s=25,o=0,r=20,i=10,g=200,d=700,p=Math.ceil((a.length+.1)*s)+o+i,l=T().domain([0,I(a,e=>e.quantity)]).range([g,d-r]),h=z().domain(O(a,e=>-e.quantity).map(e=>e.name)).rangeRound([o,p-i]).padding(.1);l.tickFormat(20);const u=C("#student-comparison-container").append("svg").attr("width","100%").attr("height","100%").attr("viewBox",[0,0,d,p]).attr("style","max-width: 100%; height: 100%; font: 14px sans-serif;");u.append("g").selectAll().data(a).join("rect").attr("x",l(0)).attr("y",e=>h(e.name)).attr("width",e=>l(e.quantity)-l(0)).attr("height",h.bandwidth()).attr("fill",function(e){return e.name=="Language"?"DarkMagenta":e.name=="Mathematics"?"blue":e.name=="Science & Invention"?"purple":e.name=="Computer Science"?"deeppink":e.name=="Dangerous Ideas"?"brown":e.name=="History"?"cyan":e.name=="Life"?"magenta":"#ff7f0e"}),u.append("g").attr("fill","white").attr("text-anchor","end").selectAll().data(a).join("text").attr("x",e=>l(e.quantity)).attr("y",e=>h(e.name)+h.bandwidth()/2).attr("dy","0.35em").attr("dx",-4).text(e=>e.quantity).call(e=>e.filter(n=>l(n.quantity)-l(0)<20).attr("dx",4).attr("fill","black").attr("text-anchor","start")),u.append("g").attr("transform",`translate(0,${o})`).call(F(l).ticks(0)).call(e=>e.select(".domain").remove()),u.append("g").attr("transform",`translate(${g},0)`).attr("style","font-size: 16px").call(A(h).tickSizeOuter(0))}}},K={id:"student-comparison-container"};function X(a,s,o,r,i,g){return c(),m("div",K)}const Z=w(J,[["render",X]]);const tt={name:"Student-Dashboard",setup(){const a=B(),s=$(),o=P();return{userDetailsStore:a,analyticsStore:s,teacherAnalyticsStore:o}},data(){return{showSidebar:!0,screenWidth:screen.width,isStudentData:!0,isSchoolData:!0,isLanguageData:!1,isMathData:!1,isHistoryData:!1,isLifeData:!1,isCSData:!1,isSAndIData:!1,isDIData:!1,progressData:{student:[],average:[]},isAboveTheCurve:!1,totalSkillsPassed:null,totalTimeSpent:null,totalAIUsage:null}},components:{StudentProgressChart:H,StudentComparisonChart:Z,StudentTimeChart:G},async created(){await this.analyticsStore.getStudentProgress(this.userDetailsStore.userId,this.userDetailsStore.tenantId),await this.analyticsStore.getStudentTotalTimeSpent(this.userDetailsStore.userId),this.totalTimeSpent=this.analyticsStore.studentTotalTimeSpent+" hrs",await this.analyticsStore.getStudentTotalSubjectsPassedAssessments(this.userDetailsStore.userId),this.totalSkillsPassed=this.analyticsStore.studentTotalSubjectsPassedAssessments,await this.analyticsStore.getStudentPassedAssessmentsBySubject(this.userDetailsStore.userId),await this.analyticsStore.getStudentTime(this.userDetailsStore.userId,this.userDetailsStore.tenantId),await this.analyticsStore.getStudentTotalTokensSpent(this.userDetailsStore.userId),this.totalAIUsage=this.analyticsStore.studentTotalTokensSpent+" tokens",await this.teacherAnalyticsStore.getStudentMultipleFails(this.userDetailsStore.userId),(this.analyticsStore.progress.student.length>0||this.analyticsStore.progress.tenant.length>0)&&this.analyticsStore.progress.student[this.analyticsStore.progress.student.length-1].quantity>this.analyticsStore.progress.tenant[this.analyticsStore.progress.tenant.length-1].quantity&&(this.isAboveTheCurve=!0),await this.HandleProgressData(),await this.HandleComparisonData(),await this.HandleTimeData()},methods:{async HandleProgressData(){if(this.isStudentData){this.progressData.student=[];for(let a=0;a<this.analyticsStore.progress.student.length;a++)this.progressData.student.push(this.analyticsStore.progress.student[a])}else this.progressData.student=[];if(this.isSchoolData){this.progressData.average=[];for(let a=0;a<this.analyticsStore.progress.tenant.length;a++)this.progressData.average.push(this.analyticsStore.progress.tenant[a])}else this.progressData.average=[];this.$nextTick(()=>{this.$refs.progressChart&&this.$refs.progressChart.createChart(this.progressData)})},async HandleComparisonData(){this.$nextTick(()=>{this.$refs.comparisonChart&&this.$refs.comparisonChart.createChart(this.analyticsStore.studentRootSubjectsPassedAssessments)})},async HandleTimeData(){this.$nextTick(()=>{this.$refs.timeChart&&this.$refs.timeChart.createChart(this.analyticsStore.time)})}}},et={class:"dashboard"},st={class:"main"},at={class:"content container-fluid"},nt={class:"dash-row row"},rt={class:"col-md-6 h-100 position-relative chart-card"},it={key:0,class:""},ot={id:"progress-chart-container"},lt={key:1},ct={class:"col-md-6"},dt={id:"comparison-chart-container",class:"chart-card"},ht={key:1},ut={class:"dash-row row"},mt={class:"col-md h-100 position-relative chart-card"},pt={id:"time-chart-container"},gt={key:1},ft={class:"col-md position-relative"},St={class:"row"},yt={class:"col-md"},_t={class:"chart-card"},Dt={key:0},vt={key:1},kt={class:"col-md"},xt={class:"chart-card"};function bt(a,s,o,r,i,g){const d=_("RouterLink"),p=_("StudentProgressChart"),l=_("StudentComparisonChart"),h=_("StudentTimeChart");return c(),m("div",et,[t("div",st,[t("div",at,[t("div",nt,[t("div",rt,[S(d,{to:"/my-progress/skills",class:"",target:"_blank"},{default:y(()=>s[0]||(s[0]=[t("h2",{class:"heading h5"},"Progress over time",-1)])),_:1,__:[0]}),i.progressData.student.length>0||i.progressData.average.length>0?(c(),m("figcaption",it,s[1]||(s[1]=[t("span",{style:{color:"green"}},"You",-1),f(" vs ",-1),t("span",{style:{color:"#ff7f0e"}},"school average",-1)]))):M("",!0),t("div",ot,[i.progressData.student.length>0||i.progressData.average.length>0?(c(),b(p,{key:0,ref:"progressChart"},null,512)):(c(),m("p",lt,"No progress yet"))])]),t("div",ct,[t("div",dt,[s[2]||(s[2]=t("h2",{class:"heading h5 mt-1"},"Progress comparison",-1)),r.analyticsStore.studentRootSubjectsPassedAssessments.length>0?(c(),b(l,{key:0,ref:"comparisonChart",data:r.analyticsStore.studentRootSubjectsPassedAssessments,colour:"#5f31dd"},null,8,["data"])):(c(),m("p",ht,"No progress yet"))])])]),t("div",ut,[t("div",mt,[S(d,{to:"/my-progress/time",target:"_blank"},{default:y(()=>s[3]||(s[3]=[t("h2",{class:"heading h5"},"Study time",-1)])),_:1,__:[3]}),s[4]||(s[4]=t("figcaption",null,[t("span",{style:{color:"blue"}},"You"),f(" vs "),t("span",{style:{color:"#ff7f0e"}},"school average")],-1)),t("div",pt,[r.analyticsStore.time.student.length>0||r.analyticsStore.time.tenant.length>0?(c(),b(h,{key:0,ref:"timeChart"},null,512)):(c(),m("p",gt,"No data available"))])]),t("div",ft,[t("div",St,[t("div",yt,[t("div",_t,[S(d,{to:"/my-progress/super-challenging",class:"col",target:"_blank"},{default:y(()=>s[5]||(s[5]=[t("h2",{class:"h5 heading"}," Consider asking for help ",-1)])),_:1,__:[5]}),r.teacherAnalyticsStore.studentMultipleFails.length>0?(c(),m("ul",Dt,[(c(!0),m(j,null,q(r.teacherAnalyticsStore.studentMultipleFails,u=>(c(),m("li",{class:"failed-skills",key:u.id},[S(d,{to:"/skills/"+u.url,target:"_blank"},{default:y(()=>[f(D(u.name),1)]),_:2},1032,["to"])]))),128))])):(c(),m("p",vt,"Nothing to worry about yet"))])]),t("div",kt,[t("div",xt,[s[9]||(s[9]=t("h2",{class:"h5 heading"},"Stats",-1)),t("ul",null,[t("li",null,[s[6]||(s[6]=t("strong",null,"Skills passed:",-1)),f(" "+D(i.totalSkillsPassed),1)]),t("li",null,[s[7]||(s[7]=t("strong",null,"Total time spent:",-1)),f(" "+D(i.totalTimeSpent),1)]),t("li",null,[S(d,{to:"/my-progress/tokens",target:"_blank"},{default:y(()=>[s[8]||(s[8]=t("strong",null,"AI usage:",-1)),f(" "+D(i.totalAIUsage),1)]),_:1,__:[8]})])])])])])])])])])])}const Nt=w(tt,[["render",bt],["__scopeId","data-v-77f6b74b"]]);export{Nt as default};
