import{P as _,_ as g,q as f,g as S,H as y,r as A,o as l,c as d,d as a,m as w,t as u,b as h,e as p,j as b,F as I,p as v,f as q}from"./main-c7ae9181.js";import{u as c}from"./AssessmentsStore-5e3e84e6.js";const N=_("unmarkedAnswers",{state:()=>({unmarkedEssayAnswers:[],unmarkedImageAnswers:[]}),actions:{async getUnmarkedEssayAnswers(){const s=await(await fetch("/unmarked-answers/essay/list")).json(),o=await(await fetch("/questions/essay/list")).json();for(let t=0;t<s.length;t++)for(let n=0;n<o.length;n++)s[t].question_id==o[n].id&&(s[t].question=o[n].question);const i=await(await fetch("/assessments/list")).json();for(let t=0;t<s.length;t++)for(let n=0;n<i.length;n++)s[t].assessment_id==i[n].id&&(s[t].studentId=i[n].student_id,s[t].skillId=i[n].skill_id);return this.unmarkedEssayAnswers=s,this.$state},async getUnmarkedImageAnswers(){const s=await(await fetch("/unmarked-answers/image/list")).json(),o=await(await fetch("/questions/image/list")).json();for(let t=0;t<s.length;t++)for(let n=0;n<o.length;n++)s[t].question_id==o[n].id&&(s[t].question=o[n].question);const i=await(await fetch("/assessments/list")).json();for(let t=0;t<s.length;t++)for(let n=0;n<i.length;n++)s[t].assessment_id==i[n].id&&(s[t].studentId=i[n].student_id,s[t].skillId=i[n].skill_id);return this.unmarkedImageAnswers=s,this.$state},async deleteUnmarkedEssayAnswer(e){const s=await fetch("/unmarked-answers/essay/"+e.id,{method:"DELETE"});console.log("deleteUnmarkedEssayAnswer");const o=await(await fetch("/unmarked-answers/essay/list/"+e.assessment_id)).json(),i=await(await fetch("/unmarked-answers/image/list/"+e.assessment_id)).json();let t=o+i;console.log(t),t==0&&c().deleteAssessment(e.assessment_id),s.error&&console.log(s.error),this.getUnmarkedEssayAnswers()},async deleteUnmarkedImageAnswer(e){const s=await fetch("/unmarked-answers/image/"+e.id,{method:"DELETE"});console.log("deleteUnmarkedImageAnswer");const o=await(await fetch("/unmarked-answers/essay/list/"+e.assessment_id)).json(),i=await(await fetch("/unmarked-answers/image/list/"+e.assessment_id)).json();let t=o+i;console.log(t),t==0&&c().deleteAssessment(e.assessment_id),s.error&&console.log(s.error),this.getUnmarkedImageAnswers()}}});const M={setup(){const e=N(),s=c(),r=f(),o=S(),m=y();return{unmarkedAnswersStore:e,usersStore:r,skillsStore:o,assessmentsStore:s,userSkillsStore:m}},data(){return{assessmentId:this.$route.params.id,questionNumber:0,answers:[],assessment:{},skill:{},studentName:"",skillName:"",showModal:!1,modalMessage:"",isFailed:!1}},async created(){this.unmarkedAnswersStore.unmarkedEssayAnswers.length==0&&await this.unmarkedAnswersStore.getUnmarkedEssayAnswers(),this.unmarkedAnswersStore.unmarkedImageAnswers.length==0&&await this.unmarkedAnswersStore.getUnmarkedImageAnswers(),this.assessmentsStore.assessments.length==0&&await this.assessmentsStore.getAssessments();for(let e=0;e<this.unmarkedAnswersStore.unmarkedEssayAnswers.length;e++)if(this.unmarkedAnswersStore.unmarkedEssayAnswers[e].assessment_id==this.assessmentId){let s=this.unmarkedAnswersStore.unmarkedEssayAnswers[e];s.type="essay",this.answers.push(s)}for(let e=0;e<this.unmarkedAnswersStore.unmarkedImageAnswers.length;e++)if(this.unmarkedAnswersStore.unmarkedImageAnswers[e].assessment_id==this.assessmentId){let s=this.unmarkedAnswersStore.unmarkedImageAnswers[e];s.type="image",this.answers.push(s)}for(let e=0;e<this.assessmentsStore.assessments.length;e++)this.assessmentsStore.assessments[e].id==this.assessmentId&&(this.assessment=this.assessmentsStore.assessments[e]);this.usersStore.users.length==0&&await this.usersStore.getUsers();for(let e=0;e<this.answers.length;e++)for(let s=0;s<this.usersStore.users.length;s++)this.answers[e].studentId==this.usersStore.users[s].id&&(this.answers[e].studentUsername=this.usersStore.users[s].username,this.studentName=this.usersStore.users[s].username);this.skillsStore.skillsList.length==0&&await this.skillsStore.getSkillsList();for(let e=0;e<this.answers.length;e++)for(let s=0;s<this.skillsStore.skillsList.length;s++)this.answers[e].skillId==this.skillsStore.skillsList[s].id&&(this.answers[e].skillName=this.skillsStore.skillsList[s].name,this.skill=this.skillsStore.skillsList[s],this.skillName=this.skillsStore.skillsList[s].name)},computed:{},methods:{Next(){this.questionNumber++},Previous(){this.questionNumber--},dateFormat(){return new Date(this.assessment.date).toLocaleDateString("default",{weekday:"short",year:"numeric",month:"short",day:"numeric"})},async MarkCorrect(e){var s="/assessments/"+e.assessment_id+"/increase-grade";await fetch(s,{method:"PUT",headers:{"Content-Type":"content/type"},body:{}}),await this.assessmentsStore.getAssessments();for(let r=0;r<this.assessmentsStore.assessments.length;r++)this.assessmentsStore.assessments[r].id==e.assessment_id&&(this.assessment=this.assessmentsStore.assessments[r],this.assessmentsStore.assessments[r].num_unmarked_questions_remaining==0&&(this.assessmentsStore.assessments[r].current_score/this.assessmentsStore.assessments[r].total_score*100>=90?(this.MakeMastered(this.assessmentsStore.assessments[r].student_id,this.skill),this.modalMessage="Student passed",this.showModal=!0,this.isFailed=!1):(this.modalMessage="Student failed",this.showModal=!0,this.isFailed=!0)));e.type=="essay"?this.unmarkedAnswersStore.deleteUnmarkedEssayAnswer(e):this.unmarkedAnswersStore.deleteUnmarkedImageAnswer(e),this.answers.splice(this.questionNumber,1),this.assessment.date=this.dateFormat()},async MarkIncorrect(e){var s="/assessments/"+e.assessment_id+"/decrease-grade";fetch(s,{method:"PUT",headers:{"Content-Type":"content/type"},body:{}}),await this.assessmentsStore.getAssessments();for(let r=0;r<this.assessmentsStore.assessments.length;r++)this.assessmentsStore.assessments[r].id==e.assessment_id&&this.assessmentsStore.assessments[r].num_unmarked_questions_remaining==0&&this.assessmentsStore.assessments[r].current_score/this.assessmentsStore.assessments[r].total_score*100<90&&(this.modalMessage="Student failed",this.isFailed=!0,this.showModal=!0);e.type=="essay"?this.unmarkedAnswersStore.deleteUnmarkedEssayAnswer(e):this.unmarkedAnswersStore.deleteUnmarkedImageAnswer(e),this.answers.splice(this.questionNumber,1),this.assessment.date=this.dateFormat()},async MakeMastered(e,s){await this.userSkillsStore.MakeMastered(e,s)}}},k=e=>(v("data-v-43695c33"),e=e(),q(),e),U={class:"container mt-3 pb-4"},j=k(()=>a("h1",{class:"h1-stroke"},"Unmarked Questions",-1)),E={id:"assessment-info"},x={id:"date"},C={key:0},L={id:"question-bg"},T={class:"d-flex w-100 flex-row justify-content-end"},F=k(()=>a("span",{"b-tooltip.hover":"",title:"The student needs to get at least 90% to pass",id:"score-text",class:"me-2"}," score: ",-1)),O={"b-tooltip.hover":"",title:"current score",id:"current-score"},P={title:"total score",id:"total-score"},V={id:"question",class:"mb-3"},D=["innerHTML"],H={key:1,id:"image-answer",class:"mb-3"},$=["src"],B=["src"],Q=["src"],K=["src"],z=["src"],G={key:1,class:"d-flex flex-column"},J=k(()=>a("p",null,"No unmarked questions currently",-1)),R={key:0},W={key:1},X={key:2,class:"d-flex mt-3 mb-2"},Y={class:"d-flex w-100 justify-content-lg-center gap-2"},Z={key:0,class:"d-flex justify-content-end"},ss={key:0},es={id:"myModal",class:"modal"},ts={class:"modal-content"},ns={class:"modal-message"},as={style:{display:"flex",gap:"10px"}};function rs(e,s,r,o,m,i){const t=A("router-link");return l(),d(I,null,[a("div",U,[j,a("div",E,[w(u(this.studentName)+" : "+u(this.skillName)+" ",1),a("span",x,u(this.assessment.date),1)]),this.answers.length>0?(l(),d("div",C,[a("div",L,[a("div",T,[F,a("span",O,u(this.assessment.current_score)+" / ",1),a("span",P,u(this.assessment.total_score),1)]),a("div",V,u(this.answers[this.questionNumber].question),1),this.answers[this.questionNumber].type=="essay"?(l(),d("div",{key:0,id:"essay-answer",class:"mb-3",innerHTML:this.answers[this.questionNumber].answer},null,8,D)):(l(),d("div",H,[a("img",{src:this.answers[this.questionNumber].answer_1},null,8,$),a("img",{src:this.answers[this.questionNumber].answer_2},null,8,B),a("img",{src:this.answers[this.questionNumber].answer_3},null,8,Q),a("img",{src:this.answers[this.questionNumber].answer_4},null,8,K),a("img",{src:this.answers[this.questionNumber].answer_5},null,8,z)]))])])):(l(),d("div",G,[J,m.isFailed?(l(),d("p",R,"Student has failed")):(l(),d("p",W,"Student has passed and mastered this skill"))])),this.answers.length>0?(l(),d("div",X,[a("div",Y,[a("button",{onClick:s[0]||(s[0]=n=>i.MarkCorrect(this.answers[this.questionNumber])),class:"btn green-btn"}," Mark Correct "),a("button",{onClick:s[1]||(s[1]=n=>i.MarkIncorrect(this.answers[this.questionNumber])),class:"btn red-btn"}," Mark Incorrect ")]),this.answers.length>0?(l(),d("div",Z,[this.questionNumber>0?(l(),d("button",{key:0,onClick:s[2]||(s[2]=n=>i.Previous()),class:"btn green-btn me-2"}," Previous ")):h("",!0),this.questionNumber!=this.answers.length-1?(l(),d("button",{key:1,onClick:s[3]||(s[3]=n=>i.Next()),class:"btn green-btn"}," Next ")):h("",!0)])):h("",!0)])):h("",!0)]),m.showModal?(l(),d("div",ss,[a("div",es,[a("div",ts,[a("p",ns,u(m.modalMessage),1),a("div",as,[p(t,{class:"btn green-btn",to:"/"},{default:b(()=>[w("To Hub")]),_:1}),a("button",{class:"btn primary-btn",onClick:s[4]||(s[4]=n=>m.showModal=!1)}," OK ")])])])])):h("",!0)],64)}const ls=g(M,[["render",rs],["__scopeId","data-v-43695c33"]]);export{ls as default};
