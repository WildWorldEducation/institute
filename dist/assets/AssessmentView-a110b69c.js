import{_ as I,o as n,c as o,a as e,w as v,C as Q,F as f,z as q,b as u,f as C,J as E,e as D,r as p,k as x,l as $,s as k,v as V,t as _,P,N as Y,g as M,q as A,p as N,d as L,h as B,L as H,n as J}from"./main-e532c3f9.js";import{u as K}from"./SettingsStore-dc2df2c7.js";import{u as W}from"./AssessmentsStore-7f25dda6.js";import{F as U}from"./FlagModals-db6b4723.js";import{S as F}from"./SkillTimeTracker-3a668fd8.js";const G={data(){return{skillId:this.$route.params.id,essayAnswer:""}},setup(){},methods:{getAnswer(){return this.essayAnswer},clearAnswer(){this.essayAnswer=""},setAnswer(i){this.essayAnswer=i}}},X={class:"container mt-3"},Z={class:"row"},ss={class:"mb-3"};function es(i,s,r,l,t,h){return n(),o("div",X,[e("div",Z,[e("div",ss,[v(e("textarea",{"onUpdate:modelValue":s[0]||(s[0]=d=>t.essayAnswer=d),class:"form-control",id:"exampleFormControlTextarea1",rows:"3"},null,512),[[Q,t.essayAnswer]])])])])}const ts=I(G,[["render",es]]);const is={data(){return{skillId:this.$route.params.id,imageAnswer:[]}},props:["numImagesRequired"],methods:{getAnswer(){return this.imageAnswer},clearAnswer(){this.imageAnswer=[]},setAnswer(i){this.imageAnswer=i},onFileChange(i){var s=i.target.files||i.dataTransfer.files;if(s.length>0)for(var r=0;r<s.length;r++){var l=new FileReader;l.readAsDataURL(s[r])}if(s.length)for(let t=0;t<s.length;t++){if(s[t].size>7e5){alert("image is too big");return}this.createImage(s[t],t)}},createImage(i,s){var r=new Image,l=new FileReader,t=this;l.onload=h=>{t.image=h.target.result,this.imageAnswer.push(h.target.result),r.src=h.target.result},l.readAsDataURL(i)},removeImages:function(i){this.imageAnswer=[]}}},ns={class:"mb-3"},os={class:"main-content-container container-fluid"},rs={class:"row"},ls={class:"col-lg-4"},as=["onUpdate:modelValue"],us={class:"row"},cs={class:"preview col-xl-3 col-lg-4 col-md-6 my-2"},hs=["src"];function ds(i,s,r,l,t,h){return n(),o("div",ns,[e("div",os,[e("div",rs,[e("div",ls,[e("div",null,[(n(!0),o(f,null,q(r.numImagesRequired,(d,a)=>v((n(),o("input",{class:"form-control mb-2","onUpdate:modelValue":m=>t.imageAnswer[a]=m,placeholder:"add image link"},null,8,as)),[[Q,t.imageAnswer[a]]])),256))])])]),e("div",us,[(n(!0),o(f,null,q(t.imageAnswer.length,(d,a)=>(n(),o("div",cs,[e("img",{src:t.imageAnswer[a]},null,8,hs)]))),256))]),t.imageAnswer.length>0?(n(),o("button",{key:0,class:"btn red-btn mt-3",onClick:s[0]||(s[0]=(...d)=>h.removeImages&&h.removeImages(...d))}," Start again ")):u("",!0)])])}const ms=I(is,[["render",ds]]);const _s={setup(){const i=C(),s=E(),r=D();return{userDetailsStore:i,userSkillsStore:s,skillTreeStore:r}},data(){return{skillId:this.$route.params.skillId,question:{text:"",explanation:"",correct_answer:1,is_random:!1},answers:[{text:"",show:!0},{text:"",show:!0},{text:"",show:!0},{text:"",show:!0},{text:"",show:!0}],validate:{validated:!1,name:!1,question:!1,answer:!1,explanation:!1},studentId:null,reshake:!1,questionAddedModal:!1,questionSubmitted:!1,submittedMess:!1}},async mounted(){},methods:{Submit(){if(this.studentId=this.userDetailsStore.userId,this.validate.validated=!1,(this.question.text===""||this.question.text===null)&&(this.validate.question=!0,this.validate.validated=!0),this.answers.forEach(r=>{r.show==!0&&r.text==""&&(this.validate.validated=!0)}),(this.question.explanation===""||this.question.explanation===null)&&(this.validate.explanation=!0,this.validate.validated=!0),this.validate.validated){this.reshake=!0;return}const i={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:this.question,answers:this.answers,skill_id:this.skillId,student_id:this.studentId})};var s="/questions/student-mc-questions/add";fetch(s,i).then(()=>{this.questionAddedModal=!0,this.questionSubmitted=!0,window.scrollTo(0,0)})},showSubmittedMess(){this.submittedMess=!0,setTimeout(()=>{this.submittedMess=!1},2e3)},skipAddingQuestion(){this.questionSubmitted=!0,window.scrollTo(0,0)},addAnswer(){this.answers[2].show==!1?this.answers[2].show=!0:this.answers[3].show==!1?this.answers[3].show=!0:this.answers[4].show==!1&&(this.answers[4].show=!0)},removeAnswer(){this.answers[4].show==!0?(this.answers[4].show=!1,this.question.correct_answer==5&&(this.question.correct_answer=4)):this.answers[3].show==!0?(this.answers[3].show=!1,this.question.correct_answer==4&&(this.question.correct_answer=3)):this.answers[2].show==!0&&(this.answers[2].show=!1,this.question.correct_answer==3&&(this.question.correct_answer=2))}}},gs={class:"student-add-result pb-3 w-100"},fs={class:"main-content-container container-fluid"},ws={class:"row p-0"},ps={key:1,id:"form-container",class:"col p-4"},ys={key:0,class:"d-flex flex-column"},vs=e("div",{id:"congrats-tile"}," Well done, you have passed! ",-1),ks=e("p",null," Would you like to add your own question for this subject? If it is accepted, your reputation score will increase. ",-1),qs=[vs,ks],bs={key:1,class:"d-flex flex-column shake"},Ss=e("div",{id:"congrats-tile"}," Thank you for submitting your question. ",-1),xs=[Ss],As={class:"mb-3"},Is=e("label",{for:"last_name",class:"form-label"},"Question",-1),Ms={key:0,class:"form-validate"},Ts={class:"form-label"},Qs={class:"d-flex answer-option"},$s=["onUpdate:modelValue","id"],Cs={key:0,class:"form-validate"},Ns={class:"form-check"},Ls=["id","value"],Rs=["for"],zs=e("svg",{"data-v-ea3cd1bf":"",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",width:"15",height:"15",fill:"white"},[e("path",{"data-v-ea3cd1bf":"",d:"M170.5 51.6L151.5 80h145l-19-28.4c-1.5-2.2-4-3.6-6.7-3.6H177.1c-2.7 0-5.2 1.3-6.7 3.6zm147-26.6L354.2 80H368h48 8c13.3 0 24 10.7 24 24s-10.7 24-24 24h-8V432c0 44.2-35.8 80-80 80H112c-44.2 0-80-35.8-80-80V128H24c-13.3 0-24-10.7-24-24S10.7 80 24 80h8H80 93.8l36.7-55.1C140.9 9.4 158.4 0 177.1 0h93.7c18.7 0 36.2 9.4 46.6 24.9zM80 128V432c0 17.7 14.3 32 32 32H336c17.7 0 32-14.3 32-32V128H80zm80 64V400c0 8.8-7.2 16-16 16s-16-7.2-16-16V192c0-8.8 7.2-16 16-16s16 7.2 16 16zm80 0V400c0 8.8-7.2 16-16 16s-16-7.2-16-16V192c0-8.8 7.2-16 16-16s16 7.2 16 16zm80 0V400c0 8.8-7.2 16-16 16s-16-7.2-16-16V192c0-8.8 7.2-16 16-16s16 7.2 16 16z"})],-1),Fs={class:"mb-3"},Es=e("svg",{width:"20",height:"20",fill:"#ffffff",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512"},[e("path",{d:"M256 80c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 144L48 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l144 0 0 144c0 17.7 14.3 32 32 32s32-14.3 32-32l0-144 144 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-144 0 0-144z"})],-1),Ds={class:"mb-3 form-check"},Vs=e("label",{for:"randomOrder",class:"form-check-label"},"Show answers in random order",-1),Ps={class:"mb-3"},Bs=e("label",{class:"form-label"},"Explanation",-1),Us={key:0,class:"form-validate"},js={class:"d-flex justify-content-end gap-4"},Os={key:3,class:"form-validate shake"},Ys={key:0},Hs={id:"myModal",class:"modal"},Js={class:"modal-content"},Ks=e("div",{class:"d-flex align-content-center"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",width:"50",height:"50",fill:"green"},[e("path",{d:"M256 48a208 208 0 1 1 0 416 208 208 0 1 1 0-416zm0 464A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM369 209c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0l-111 111-47-47c-9.4-9.4-24.6-9.4-33.9 0s-9.4 24.6 0 33.9l64 64c9.4 9.4 24.6 9.4 33.9 0L369 209z"})]),e("div",{class:"my-auto ms-2"}," Your question have been submitted ")],-1),Ws={class:"d-flex flex-row-reverse"};function Gs(i,s,r,l,t,h){const d=p("RouterLink");return n(),o(f,null,[e("div",gs,[e("div",fs,[e("div",ws,[t.questionSubmitted?(n(),x(d,{key:0,class:"btn btn-light primary-btn",style:{width:"136px"},to:"/skills"},{default:$(()=>[k(" Back to skills ")]),_:1})):u("",!0),t.questionSubmitted?u("",!0):(n(),o("div",ps,[t.questionSubmitted?u("",!0):(n(),o("div",ys,qs)),t.questionSubmitted?(n(),o("div",bs,xs)):u("",!0),e("div",As,[Is,v(e("textarea",{"onUpdate:modelValue":s[0]||(s[0]=a=>t.question.text=a),rows:"1",class:"form-control"},`
                        `,512),[[Q,t.question.text]]),t.validate.question&&(t.question.text===""||t.question.text===null)?(n(),o("div",Ms," please enter a question ! ")):u("",!0)]),(n(!0),o(f,null,q(t.answers,(a,m)=>v((n(),o("div",{key:m,class:"mb-3"},[e("label",Ts,"Answer "+_(m+1)+":",1),e("div",Qs,[v(e("input",{"onUpdate:modelValue":c=>a.text=c,id:"answer"+(m+1),placeholder:"Enter answer option",type:"text",class:"form-control"},null,8,$s),[[Q,a.text]])]),t.validate.validated&&a.text===""?(n(),o("div",Cs," please enter a correct answer ! ")):u("",!0),e("div",Ns,[v(e("input",{class:"form-check-input",type:"radio",id:"correct"+(m+1),name:"correctAnswer",value:m+1,"onUpdate:modelValue":s[1]||(s[1]=c=>t.question.correct_answer=c)},null,8,Ls),[[P,t.question.correct_answer]]),e("label",{for:"correct"+(m+1),class:""},"Set as correct",8,Rs)])])),[[V,a.show]])),128)),t.answers[2].show==!0?(n(),o("button",{key:2,onClick:s[2]||(s[2]=a=>h.removeAnswer()),"data-v-ea3cd1bf":"",type:"button",class:"btn red-btn p-2 mb-2",title:"Delete answer"},[zs,k(" Â Remove Answer ")])):u("",!0),e("div",Fs,[t.answers[4].show==!1?(n(),o("button",{key:0,onClick:s[3]||(s[3]=(...a)=>h.addAnswer&&h.addAnswer(...a)),class:"btn primary-btn"},[Es,k(" Add Answer ")])):u("",!0)]),e("div",Ds,[v(e("input",{type:"checkbox",id:"randomOrder","onUpdate:modelValue":s[4]||(s[4]=a=>t.question.is_random=a),class:"form-check-input"},null,512),[[Y,t.question.is_random]]),Vs]),e("div",Ps,[Bs,v(e("textarea",{"onUpdate:modelValue":s[5]||(s[5]=a=>t.question.explanation=a),class:"form-control",rows:"3"},null,512),[[Q,t.question.explanation]]),t.validate.explanation&&(t.question.explanation===""||t.question.explanation===null)?(n(),o("div",Us," Please add an explanation ! ")):u("",!0)]),e("div",js,[e("button",{class:"btn btn-light",onClick:s[6]||(s[6]=(...a)=>h.skipAddingQuestion&&h.skipAddingQuestion(...a))}," Skip "),e("button",{class:"btn primary-btn",onClick:s[7]||(s[7]=a=>t.questionSubmitted?h.showSubmittedMess():h.Submit())}," Submit ")]),t.submittedMess?(n(),o("div",Os," You already submitted a question !! ")):u("",!0)]))])])]),t.questionAddedModal?(n(),o("div",Ys,[e("div",Hs,[e("div",Js,[Ks,e("div",Ws,[e("button",{type:"button",class:"btn green-btn",onClick:s[8]||(s[8]=a=>t.questionAddedModal=!1)}," ok "),t.questionSubmitted?(n(),x(d,{key:0,class:"btn btn-light primary-btn mx-2",to:"/skills"},{default:$(()=>[k(" Back to skills ")]),_:1})):u("",!0)])])])])):u("",!0)],64)}const j=I(_s,[["render",Gs]]);const Xs={setup(){return{userDetailsStore:C()}},data(){return{nextSkillsInBranch:[],showNextSkillsInBranch:!1,isLoading:!0,hasLoaded:!1}},mounted(){this.hasLoaded||this.getNextSkills()},methods:{async getNextSkills(){if(this.hasLoaded)return;const i=this.$route.params.skillId;if(!i){console.error("No skill ID found in route params"),this.isLoading=!1;return}try{this.isLoading=!0;const s=await fetch(`/user-skills/get-next-accessible-in-branch/${this.userDetailsStore.userId}/${i}`);if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);this.nextSkillsInBranch=await s.json(),console.log(`Found ${this.nextSkillsInBranch.length} next skills in branch`)}catch(s){console.error("Error fetching next skills:",s)}finally{this.isLoading=!1,this.showNextSkillsInBranch=!0,this.hasLoaded=!0}}}},z=i=>(N("data-v-7f5c5faf"),i=i(),L(),i),Zs=z(()=>e("h2",{class:"secondary-heading h4"},"Continue your learning",-1)),se={key:0,class:"wrapper"},ee=z(()=>e("p",null,"Loading related skills...",-1)),te=[ee],ie={key:1,class:"wrapper"},ne={key:2,class:"wrapper"},oe=z(()=>e("p",null," ğ Excellent work! You've completed all available skills in this learning path. ",-1)),re=[oe];function le(i,s,r,l,t,h){const d=p("router-link");return n(),o("div",null,[Zs,t.isLoading?(n(),o("div",se,te)):t.showNextSkillsInBranch&&t.nextSkillsInBranch.length>0?(n(),o("div",ie,[(n(!0),o(f,null,q(t.nextSkillsInBranch,a=>(n(),o("div",{key:a.id},[M(d,{class:A([{"grade-school":a.level=="grade_school","middle-school":a.level=="middle_school","high-school":a.level=="high_school",college:a.level=="college",phd:a.level=="phd"},"skill-link btn"]),to:`/skills/${a.url}`,target:"_blank"},{default:$(()=>[k(_(a.name),1)]),_:2},1032,["class","to"])]))),128))])):t.showNextSkillsInBranch&&t.nextSkillsInBranch.length===0?(n(),o("div",ne,re)):u("",!0)])}const ae=I(Xs,[["render",le],["__scopeId","data-v-7f5c5faf"]]);const ue={setup(){return{userDetailsStore:C()}},components:{StudentAddMCQuestion:j,NextSkillSuggestion:ae,FlagModals:U},data(){return{assessmentResult:"",finishDate:"",finishTime:"",parent:"",score:0,totalScore:1,scorePercent:0,questions:[],essayQuestionsLength:0,correctIndex:[],passModal:!1,failsModal:!1,waitForMarkModal:!1,questionToFlagId:0,questionToFlagType:"",showFlaggingModal:!1}},props:["skill","isManualEssayMarking"],mounted(){this.assessmentResult=this.$parent.assessmentStatus;const i=`modalShown_${this.$route.params.id}`;if(!sessionStorage.getItem(i)){switch(this.assessmentResult){case"You passed":this.passModal=!0;break;case"You failed":this.failsModal=!0;break;case"wait for essay answers to be mark":this.waitForMarkModal=!0;break}sessionStorage.setItem(i,"true")}this.finishDate=this.$parent.finishTime.toLocaleString(void 0,{weekday:"long",year:"numeric",month:"long",day:"numeric"}),this.finishTime=this.$parent.finishTime.toLocaleTimeString(),this.score=this.$parent.score,this.isManualEssayMarking==1?this.totalScore=this.$parent.numMCQuestions:this.totalScore=this.$parent.questions.length,this.totalScore!==0&&(this.scorePercent=Math.floor(this.score/this.totalScore*100)),this.isManualEssayMarking==1?(this.questions=this.$parent.questions.filter(r=>r.questionType==="mc"),this.essayQuestionsLength=this.$parent.questions.length-this.questions.length):this.questions=this.$parent.questions,this.correctIndex=[1]},methods:{setQuestionForFlagging(i,s){this.questionToFlagId=i,this.questionToFlagType=s,this.showFlaggingModal=!0}}},w=i=>(N("data-v-dded13bd"),i=i(),L(),i),ce={class:"container pb-3"},he={class:"d-flex flex-md-row flex-column gap-3"},de={class:"assessment-info"},me=w(()=>e("span",{class:"info-label"},"Result:",-1)),_e={key:0,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 512",fill:"red",height:"14",width:"14",class:"status-icon"},ge=w(()=>e("path",{d:"M64 64c0-17.7-14.3-32-32-32S0 46.3 0 64V320c0 17.7 14.3 32 32 32s32-14.3 32-32V64zM32 480a40 40 0 1 0 0-80 40 40 0 1 0 0 80z"},null,-1)),fe=[ge],we={key:1,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",fill:"green",height:"14",width:"14",class:"mb-1"},pe=w(()=>e("path",{d:"M438.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L160 338.7 393.4 105.4c12.5-12.5 32.8-12.5 45.3 0z"},null,-1)),ye=[pe],ve=w(()=>e("span",{class:"info-label"},"Finish Date: ",-1)),ke={class:"info-value"},qe={id:"finish-time"},be={class:"hover-cursor","b-on-hover":"",title:"you need to score above 80% to pass the assessment"},Se=w(()=>e("span",{class:"info-label"},"Score: ",-1)),xe={class:"info-value"},Ae=w(()=>e("span",null,"*",-1)),Ie={key:0,class:"essay-warning"},Me={class:"mc-question-result"},Te=["onClick"],Qe={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",style:{height:"22px",opacity:"0.5"}},$e=w(()=>e("path",{fill:"#8f7bd6",d:"M64 32C64 14.3 49.7 0 32 0S0 14.3 0 32V64 368 480c0 17.7 14.3 32 32 32s32-14.3 32-32V352l64.3-16.1c41.1-10.3 84.6-5.5 122.5 13.4c44.2 22.1 95.5 24.8 141.7 7.4l34.7-13c12.5-4.7 20.8-16.6 20.8-30V66.1c0-23-24.2-38-44.8-27.7l-9.6 4.8c-46.3 23.2-100.8 23.2-147.1 0c-35.1-17.6-75.4-22-113.5-12.5L64 48V32z"},null,-1)),Ce=[$e],Ne={class:"question"},Le={class:"d-flex flex-column"},Re={class:"form-check my-3"},ze={class:"control control-checkbox"},Fe={key:0,class:"correct-indicate"},Ee={key:1,class:"user-answer-indicate"},De={key:2,class:"correct-indicate"},Ve=["value","disabled"],Pe={class:"control_indicator"},Be={key:0,class:"checked"},Ue={key:1},je=w(()=>e("span",{class:"explain-label"},"Your answer:",-1)),Oe={class:"explain-text"},Ye={key:2},He=w(()=>e("span",{class:"explain-label"},"Your answer:",-1)),Je=["src"],Ke={key:3,class:"explain-answer"},We=w(()=>e("div",{class:"explain-label"},"Explanation:",-1)),Ge={class:"explain-text"},Xe={key:0},Ze={id:"myModal",class:"modal"},st={class:"modal-content"},et=w(()=>e("div",{class:"d-flex align-content-center"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",width:"50",height:"50",fill:"green"},[e("path",{d:"M256 48a208 208 0 1 1 0 416 208 208 0 1 1 0-416zm0 464A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM369 209c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0l-111 111-47-47c-9.4-9.4-24.6-9.4-33.9 0s-9.4 24.6 0 33.9l64 64c9.4 9.4 24.6 9.4 33.9 0L369 209z"})]),e("div",{class:"my-auto ms-2"}," Well done! You passed and have now mastered the skill! ")],-1)),tt={class:"d-flex flex-row-reverse"},it={key:1},nt={id:"myModal",class:"modal"},ot={class:"modal-content"},rt=w(()=>e("div",{class:"d-flex align-content-center"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",fill:"red",width:"50",height:"50"},[e("path",{d:"M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zm0-384c13.3 0 24 10.7 24 24V264c0 13.3-10.7 24-24 24s-24-10.7-24-24V152c0-13.3 10.7-24 24-24zM224 352a32 32 0 1 1 64 0 32 32 0 1 1 -64 0z"})]),e("div",{class:"my-auto ms-2"}," You failed this time, try again later! ")],-1)),lt={class:"d-flex flex-row-reverse"},at={key:2},ut={id:"myModal",class:"modal"},ct={class:"modal-content"},ht=w(()=>e("div",null," There is at least one question that needs to be marked by your instructor. Please check whether you passed later. ",-1)),dt={class:"d-flex flex-row-reverse"};function mt(i,s,r,l,t,h){const d=p("NextSkillSuggestion"),a=p("StudentAddMCQuestion"),m=p("FlagModals");return n(),o(f,null,[e("div",ce,[e("div",he,[e("div",null,[e("div",de,[e("div",null,[me,e("span",{class:A(t.assessmentResult=="You passed"?"student-pass":"student-fail")},[k(_(t.assessmentResult)+" ",1),t.assessmentResult==="You failed"?(n(),o("svg",_e,fe)):u("",!0),t.assessmentResult==="You passed"?(n(),o("svg",we,ye)):u("",!0)],2)]),e("div",null,[ve,e("span",ke,[k(_(t.finishDate)+" ",1),e("span",qe," at "+_(t.finishTime),1)])]),e("div",be,[Se,e("span",xe,_(t.score)+" out "+_(t.totalScore),1),k(" ( "+_(t.scorePercent)+"%) ",1),Ae]),r.isManualEssayMarking==1&&t.essayQuestionsLength!=0?(n(),o("div",Ie," There are "+_(t.essayQuestionsLength)+" answers that needed to be mark by your instructor ",1)):u("",!0)]),t.assessmentResult==="You passed"?(n(),x(d,{key:0})):u("",!0)]),t.assessmentResult==="You passed"?(n(),x(a,{key:0})):u("",!0)]),(n(!0),o(f,null,q(t.questions,c=>(n(),o("div",Me,[c.questionType=="mc"?(n(),o("div",{key:0,"b-tooltip.hover":"",title:"flag this question for review",onClick:g=>h.setQuestionForFlagging(c.id,"mc_question"),class:"flagging-icon",style:{height:"50px"}},[(n(),o("svg",Qe,Ce))],8,Te)):u("",!0),e("div",{class:A(c.userAnswer==c.correct_answer||c.isCorrect==!0?"correct-label":"wrong-label")},_(c.userAnswer==c.correct_answer||c.isCorrect==!0?"Correct !!":"Incorrect !!"),3),e("div",Ne,_(c.question),1),e("div",Le,[c.questionType=="mc"?(n(!0),o(f,{key:0},q(c.answerOptions,(g,y)=>(n(),o("div",Re,[e("label",ze,[e("div",{class:A(["my-auto mx-2 me-4 answer-option ",g.index==c.correct_answer?" correct-answer":c.userAnswer==g.index?"user-answer":" incorrect-answer"])},[k(_(g.option)+" ",1),g.index==c.correct_answer&&c.userAnswer!==c.correct_answer?(n(),o("span",Fe," (correct answer)")):u("",!0),g.index!==c.correct_answer&&c.userAnswer==g.index?(n(),o("span",Ee," (your answer)")):u("",!0),g.index==c.correct_answer&&c.userAnswer==c.correct_answer?(n(),o("span",De," (you are correct !)")):u("",!0)],2),e("input",{type:"radio",name:"nodeType",value:g.index,disabled:g.index!=c.correct_answer},null,8,Ve),e("div",Pe,[g.index==c.correct_answer?(n(),o("div",Be)):u("",!0)])])]))),256)):c.questionType=="essay"?(n(),o("div",Ue,[je,e("div",Oe,_(c.userAnswer),1)])):c.questionType=="image"?(n(),o("div",Ye,[He,(n(!0),o(f,null,q(c.userAnswer.length,(g,y)=>(n(),o("img",{src:c.userAnswer[y],width:"80"},null,8,Je))),256))])):u("",!0),c.questionType=="mc"||c.isCorrect==!1?(n(),o("div",Ke,[We,e("div",Ge,_(c.explanation),1)])):u("",!0)])]))),256))]),t.passModal?(n(),o("div",Xe,[e("div",Ze,[e("div",st,[et,e("div",tt,[e("button",{type:"button",class:"btn green-btn",onClick:s[0]||(s[0]=c=>t.passModal=!1)}," Great! ")])])])])):u("",!0),t.failsModal?(n(),o("div",it,[e("div",nt,[e("div",ot,[rt,e("div",lt,[e("button",{type:"button",class:"btn red-btn",onClick:s[1]||(s[1]=c=>t.failsModal=!1)}," OK ")])])])])):u("",!0),t.waitForMarkModal?(n(),o("div",at,[e("div",ut,[e("div",ct,[ht,e("div",dt,[e("button",{type:"button",class:"btn green-btn",onClick:s[2]||(s[2]=c=>t.waitForMarkModal=!1)}," OK ")])])])])):u("",!0),t.showFlaggingModal?(n(),x(m,{key:3,userId:l.userDetailsStore.userId,contentType:t.questionToFlagType,contentId:t.questionToFlagId},null,8,["userId","contentType","contentId"])):u("",!0)],64)}const _t=I(ue,[["render",mt],["__scopeId","data-v-dded13bd"]]);const gt={setup(){const i=C(),s=K(),r=B(),l=W(),t=E(),h=D();return{userDetailsStore:i,settingsStore:s,skillsStore:r,assessmentsStore:l,userSkillsStore:t,skillTreeStore:h}},data(){return{loading:!0,skillId:this.$route.params.skillId,skill:{},mcQuestions:[],mcQuestionsAnswer:[],essayQuestions:[],imageQuestions:[],questions:[],question:{},questionNumber:0,score:0,assessmentId:null,numMCQuestions:0,numEssayQuestions:0,numImageQuestions:0,totalNumOfQuestions:0,isAllQuestionsAnswered:!1,waitForMarkModal:!1,oldAssessment:void 0,updatedAssessment:!1,showFlaggingModal:!1,flagContentType:"",isQuizPassed:!1,answerHoveredIndex:1/0,showResult:!1,assessmentStatus:"",haveEssayQuestion:!1,finishTime:null,needToSelectInstructor:!1,aiLoading:!1,numOfImagesRequired:1,isSubmitting:!1}},async created(){if(this.checkForExistingResults())return;this.settingsStore.quizMaxQuestions==null&&await this.settingsStore.getSettings(),await this.assessmentsStore.getAssessments();const i=this.assessmentsStore.assessments,s=await this.userDetailsStore.getUserDetails();let r;for(let l=0;l<this.skillsStore.skillsList.length;l++)this.skillsStore.skillsList[l].id==this.skillId&&(r=this.skillsStore.skillsList[l].type,this.skill=this.skillsStore.skillsList[l]);if(this.oldAssessment=i.find(l=>l.student_id===s.userId&&l.skill_id===this.skill.id),this.oldAssessment!==void 0&&(this.updatedAssessment=!0),r!="super")await this.fetchMCQuestions(this.skillId);else{let l=[];for(let t=0;t<this.skillsStore.skillsList.length;t++)this.skillsStore.skillsList[t].parent==this.skillId&&this.skillsStore.skillsList[t].type=="sub"&&l.push(this.skillsStore.skillsList[t]);for(let t=0;t<l.length;t++)await this.fetchMCQuestions(l[t].id)}},components:{EssayAnswer:ts,ImageAnswer:ms,StudentAddMCQuestion:j,AssessmentResult:_t,FlagModals:U},methods:{async fetchMCQuestions(i){fetch("/questions/"+i+"/multiple-choice").then(function(s){return s.json()}).then(s=>{this.mcQuestions=this.mcQuestions.concat(s)}).then(()=>{for(let r=0;r<this.mcQuestions.length;r++)this.mcQuestions[r].userAnswer=null,this.mcQuestions[r].questionType="mc";for(let r=0;r<this.mcQuestions.length;r++){var s=[];s.push({option:this.mcQuestions[r].answer_1,index:1}),s.push({option:this.mcQuestions[r].answer_2,index:2}),s.push({option:this.mcQuestions[r].answer_3,show:this.mcQuestions[r].show_answer_3,index:3}),s.push({option:this.mcQuestions[r].answer_4,show:this.mcQuestions[r].show_answer_4,index:4}),s.push({option:this.mcQuestions[r].answer_5,show:this.mcQuestions[r].show_answer_5,index:5}),this.mcQuestions[r].is_random&&(s=s.sort((l,t)=>.5-Math.random())),this.mcQuestions[r].answerOptions=s}}).then(()=>{this.fetchEssayQuestions(i)})},async fetchEssayQuestions(i){fetch("/questions/"+i+"/essay").then(function(s){return s.json()}).then(s=>{s.length>0&&!this.userDetailsStore.instructorId&&this.settingsStore.isManualEssayMarking==1&&(this.needToSelectInstructor=!0),this.essayQuestions=this.essayQuestions.concat(s)}).then(()=>{for(let s=0;s<this.essayQuestions.length;s++)this.essayQuestions[s].userAnswer=null,this.essayQuestions[s].questionType="essay"}).then(()=>{this.questions=this.essayQuestions.concat(this.mcQuestions)}).then(()=>{this.fetchImageQuestions(i)})},async fetchImageQuestions(i){fetch("/questions/"+i+"/image").then(function(s){return s.json()}).then(s=>{s.length>0&&!this.userDetailsStore.instructorId&&this.settingsStore.isManualEssayMarking==1&&(this.needToSelectInstructor=!0),this.imageQuestions=this.imageQuestions.concat(s)}).then(()=>{for(let s=0;s<this.imageQuestions.length;s++)this.imageQuestions[s].userAnswer=null,this.imageQuestions[s].questionType="image"}).then(()=>{this.questions=this.imageQuestions.concat(this.questions),this.questions=this.questions.sort((s,r)=>.5-Math.random()),this.questions.length>this.settingsStore.quizMaxQuestions&&(this.questions.length=this.settingsStore.quizMaxQuestions),this.question=this.questions[0],this.question.questionType=="image"&&(this.numOfImagesRequired=this.question.num_images_required),this.totalNumOfQuestions=this.questions.length}).then(()=>{this.loading=!1})},Next(){if(this.questions[this.questionNumber].questionType=="essay"){const i=this.$refs.essayAnswer.getAnswer();this.questions[this.questionNumber].userAnswer=i,this.$refs.essayAnswer.clearAnswer()}else if(this.questions[this.questionNumber].questionType=="image"){const i=this.$refs.imageAnswer.getAnswer();this.questions[this.questionNumber].userAnswer=i,this.$refs.imageAnswer.clearAnswer()}this.questionNumber++,this.questions[this.questionNumber].questionType=="essay"?this.questions[this.questionNumber].userAnswer&&this.$refs.essayAnswer.setAnswer(this.questions[this.questionNumber].userAnswer):this.questions[this.questionNumber].questionType=="image"&&(this.questions[this.questionNumber].userAnswer&&this.$refs.imageAnswer.setAnswer(this.questions[this.questionNumber].userAnswer),this.numOfImagesRequired=this.questions[this.questionNumber].num_images_required)},Previous(){if(this.questions[this.questionNumber].questionType=="essay"){const i=this.$refs.essayAnswer.getAnswer();this.questions[this.questionNumber].userAnswer=i}else if(this.questions[this.questionNumber].questionType=="image"){const i=this.$refs.imageAnswer.getAnswer();this.questions[this.questionNumber].userAnswer=i}this.questionNumber--,this.questions[this.questionNumber].questionType=="essay"?this.$refs.essayAnswer.setAnswer(this.questions[this.questionNumber].userAnswer):this.questions[this.questionNumber].questionType=="image"&&(this.$refs.imageAnswer.setAnswer(this.questions[this.questionNumber].userAnswer),this.numOfImagesRequired=this.questions[this.questionNumber].num_images_required)},async Submit(){this.isSubmitting=!0;try{if(this.UserAnswer(),!this.isAllQuestionsAnswered){alert("Please answer all questions before submitting."),this.isSubmitting=!1;return}if(this.finishTime=new Date,this.questions[this.questionNumber].questionType=="essay"){const s=this.$refs.essayAnswer.getAnswer();this.questions[this.questionNumber].userAnswer=s}else if(this.questions[this.questionNumber].questionType=="image"){const s=this.$refs.imageAnswer.getAnswer();this.questions[this.questionNumber].userAnswer=s}this.numMCQuestions=0,this.numEssayQuestions=0,this.numImageQuestions=0;for(let s=0;s<this.questions.length;s++)this.questions[s].questionType=="mc"?this.numMCQuestions++:this.questions[s].questionType=="essay"?this.numEssayQuestions++:this.questions[s].questionType=="image"&&this.numImageQuestions++;if(this.numEssayQuestions===0&&this.numImageQuestions===0){this.score=0;for(let s=0;s<this.questions.length;s++)this.questions[s].questionType=="mc"&&this.questions[s].userAnswer==this.questions[s].correct_answer&&this.score++;this.score/this.numMCQuestions*100>=this.settingsStore.passMark?(await this.MakeMastered(this.skill),this.isQuizPassed=!0,this.assessmentStatus="You passed",this.showResult=!0,this.saveResultsForResultComponent()):(this.isQuizPassed=!0,this.assessmentStatus="You failed",this.showResult=!0,this.saveResultsForResultComponent()),this.isSubmitting=!1}else if(this.settingsStore.isManualEssayMarking==1){this.score=0;for(let t=0;t<this.questions.length;t++)this.questions[t].questionType=="mc"&&this.questions[t].userAnswer==this.questions[t].correct_answer&&this.score++;let s="POST";this.oldAssessment!==void 0&&(s="PUT");let r=this.numEssayQuestions+this.numImageQuestions;const l={method:s,headers:{"Content-Type":"application/json"},body:JSON.stringify({totalScore:this.totalNumOfQuestions,currentScore:this.score,numUnmarkedQuestions:r})};var i="/assessments/"+this.userDetailsStore.userId+"/"+this.skillId;try{const h=await(await fetch(i,l)).json();this.assessmentId=h.id,await fetch("/unmarked-answers/delete/"+this.assessmentId,{method:"DELETE"});const d=[];for(let a=0;a<this.questions.length;a++)if(this.questions[a].questionType=="essay"){const m={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({answer:this.questions[a].userAnswer,questionId:this.questions[a].id})};var i="/unmarked-answers/add/essay/"+this.assessmentId;d.push(fetch(i,m))}else if(this.questions[a].questionType=="image"){const m={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({answer:this.questions[a].userAnswer,questionId:this.questions[a].id})};var i="/unmarked-answers/add/image/"+this.assessmentId;d.push(fetch(i,m))}await Promise.all(d),this.isQuizPassed=!0,this.showResult=!0,this.saveResultsForResultComponent(),this.assessmentStatus="please wait for answers to be marked",this.isSubmitting=!1}catch(t){console.error("Error submitting assessment:",t),alert("There was an error submitting your assessment. Please try again."),this.isSubmitting=!1}}else try{for(let s=0;s<this.questions.length;s++)if(this.questions[s].questionType=="essay"){let r=this.questions[s].question,l=this.questions[s].userAnswer;await this.AIMarkEssayQuestion(r,l,s)}else if(this.questions[s].questionType=="image"){let r=this.questions[s].question,l=this.questions[s].userAnswer;await this.AIMarkImageQuestion(r,l,s)}this.score=0;for(let s=0;s<this.questions.length;s++)this.questions[s].questionType=="mc"?this.questions[s].userAnswer==this.questions[s].correct_answer&&this.score++:this.questions[s].isCorrect===!0&&this.score++;this.score/this.questions.length*100>=this.settingsStore.passMark?(await this.MakeMastered(this.skill),this.isQuizPassed=!0,this.assessmentStatus="You passed"):(this.isQuizPassed=!0,this.assessmentStatus="You failed"),this.showResult=!0,this.saveResultsForResultComponent(),this.isSubmitting=!1}catch(s){console.error("Error marking questions with AI:",s),alert("There was an error marking your answers. Please try again."),this.isSubmitting=!1}this.userSkillsStore.recordAssessmentAttempt(this.userDetailsStore.userId,this.skill.id)}catch(s){console.error("Unexpected error during submission:",s),alert("There was an unexpected error. Please try again."),this.isSubmitting=!1}},async AIMarkEssayQuestion(i,s,r){this.isSubmitting||(this.aiLoading=!0);try{const l={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:i,answer:s,level:this.skill.level})},d=await(await fetch("/questions/mark-essay-question",l)).json();d.isCorrect==!0?this.questions[r].isCorrect=!0:(this.questions[r].explanation=d.explanation,this.questions[r].isCorrect=!1)}catch(l){throw console.error("Error marking essay question:",l),l}finally{this.isSubmitting||(this.aiLoading=!1)}},async AIMarkImageQuestion(i,s,r){this.isSubmitting||(this.aiLoading=!0);try{const l={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:i,answer:s,level:this.skill.level})},d=await(await fetch("/questions/mark-image-question",l)).json();d.isError==!0?(this.questions[r].isCorrect=!1,this.questions[r].explanation="There was an error grading this question. The file size(s) may be too big."):d.isCorrect==!0?this.questions[r].isCorrect=!0:(this.questions[r].explanation=d.explanation,this.questions[r].isCorrect=!1)}catch(l){throw console.error("Error marking image question:",l),l}finally{this.isSubmitting||(this.aiLoading=!1)}},UserAnswer(){for(let i=0;i<this.questions.length;i++)if(this.questions[i].userAnswer==null||this.questions[i].userAnswer===""){this.isAllQuestionsAnswered=!1;return}else this.isAllQuestionsAnswered=!0},TestPass(){this.isQuizPassed=!0},handleClickFlagIcon(){switch(this.questions[this.questionNumber].questionType){case"mc":this.flagContentType="mc_question";break;case"essay":this.flagContentType="essay_question";break;case"image":this.flagContentType="image_question";break}this.showFlaggingModal=!0},async MakeMastered(i){await this.userSkillsStore.MakeMastered(this.userDetailsStore.userId,i),await this.skillTreeStore.getUserSkills()},saveResultsForResultComponent(){const i={assessmentResult:this.assessmentStatus,finishDate:this.finishTime.toLocaleString(void 0,{weekday:"long",year:"numeric",month:"long",day:"numeric"}),finishTime:this.finishTime.toLocaleTimeString(),score:this.score,totalScore:this.totalNumOfQuestions,scorePercent:Math.floor(this.score/this.totalNumOfQuestions*100),questions:this.questions,essayQuestionsLength:this.numEssayQuestions+this.numImageQuestions,skill:this.skill,isManualEssayMarking:this.settingsStore.isManualEssayMarking,timestamp:Date.now()};sessionStorage.setItem(`assessmentResults_${this.skillId}`,JSON.stringify(i))},checkForExistingResults(){const i=sessionStorage.getItem(`assessmentResults_${this.skillId}`);if(i)try{const s=JSON.parse(i),r=2*60*60*1e3;if(s.timestamp&&Date.now()-s.timestamp<r)return this.showResult=!0,this.isQuizPassed=!0,this.assessmentStatus=s.assessmentResult,this.score=s.score,this.totalNumOfQuestions=s.totalScore,this.finishTime=new Date,this.questions=s.questions,this.loading=!1,!0;sessionStorage.removeItem(`assessmentResults_${this.skillId}`)}catch(s){console.error("Error loading stored results:",s),sessionStorage.removeItem(`assessmentResults_${this.skillId}`)}return!1}}},b=i=>(N("data-v-eb8bd03f"),i=i(),L(),i),ft={key:0,class:"secondary-text"},wt={key:1,class:"loading-animation d-flex justify-content-center align-items-center py-4"},pt=b(()=>e("span",{class:"loader"},null,-1)),yt=[pt],vt={key:2,class:"loading-overlay"},kt=b(()=>e("div",{class:"loading-container"},[e("span",{class:"assessment-grading-loader"}),e("div",{class:"loading-text mt-3"},"Processing your answers...")],-1)),qt=[kt],bt={key:3},St={key:0},xt={id:"myModal",class:"modal"},At={class:"modal-content"},It=b(()=>e("div",{class:"mb-2"}," You are taking a new quiz for this skill while your old one is still waiting to be marked. Please note that your old answers will be replaced. ",-1)),Mt={class:"d-flex flex-row-reverse"},Tt={class:"pb-2 pb-md-0"},Qt={key:0,class:"container mt-2 mb-3 p-3 pt-2 mb-3",id:"question-container"},$t={class:"row"},Ct={key:0},Nt={class:"col d-flex my-2 gap-2 justify-content-between flex-column flex-md-row"},Lt={class:"d-flex align-items-lg-center"},Rt={id:"question-number-div"},zt={id:"question-content"},Ft={class:"d-flex justify-content-end"},Et={key:0,"b-tooltip.hover":"",title:"This question was written or edited by a human",class:"author-icon me-4",style:{height:"50px"}},Dt={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 320 512",height:"22",style:{opacity:"0.5"},class:"primary-icon"},Vt=b(()=>e("path",{d:"M112 48a48 48 0 1 1 96 0 48 48 0 1 1 -96 0zm40 304l0 128c0 17.7-14.3 32-32 32s-32-14.3-32-32l0-223.1L59.4 304.5c-9.1 15.1-28.8 20-43.9 10.9s-20-28.8-10.9-43.9l58.3-97c17.4-28.9 48.6-46.6 82.3-46.6l29.7 0c33.7 0 64.9 17.7 82.3 46.6l58.3 97c9.1 15.1 4.2 34.8-10.9 43.9s-34.8 4.2-43.9-10.9L232 256.9 232 480c0 17.7-14.3 32-32 32s-32-14.3-32-32l0-128-16 0z"},null,-1)),Pt=[Vt],Bt={key:1,"b-tooltip.hover":"",title:"This question was written by an AI",class:"author-icon me-4",style:{height:"50px"}},Ut={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 640 512",height:"22",style:{opacity:"0.5"},class:"primary-icon"},jt=b(()=>e("path",{d:"M320 0c17.7 0 32 14.3 32 32l0 64 120 0c39.8 0 72 32.2 72 72l0 272c0 39.8-32.2 72-72 72l-304 0c-39.8 0-72-32.2-72-72l0-272c0-39.8 32.2-72 72-72l120 0 0-64c0-17.7 14.3-32 32-32zM208 384c-8.8 0-16 7.2-16 16s7.2 16 16 16l32 0c8.8 0 16-7.2 16-16s-7.2-16-16-16l-32 0zm96 0c-8.8 0-16 7.2-16 16s7.2 16 16 16l32 0c8.8 0 16-7.2 16-16s-7.2-16-16-16l-32 0zm96 0c-8.8 0-16 7.2-16 16s7.2 16 16 16l32 0c8.8 0 16-7.2 16-16s-7.2-16-16-16l-32 0zM264 256a40 40 0 1 0 -80 0 40 40 0 1 0 80 0zm152 40a40 40 0 1 0 0-80 40 40 0 1 0 0 80zM48 224l16 0 0 192-16 0c-26.5 0-48-21.5-48-48l0-96c0-26.5 21.5-48 48-48zm544 0c26.5 0 48 21.5 48 48l0 96c0 26.5-21.5 48-48 48l-16 0 0-192 16 0z"},null,-1)),Ot=[jt],Yt={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",style:{height:"22px",opacity:"0.5"},class:"primary-icon"},Ht=b(()=>e("path",{d:"M64 32C64 14.3 49.7 0 32 0S0 14.3 0 32V64 368 480c0 17.7 14.3 32 32 32s32-14.3 32-32V352l64.3-16.1c41.1-10.3 84.6-5.5 122.5 13.4c44.2 22.1 95.5 24.8 141.7 7.4l34.7-13c12.5-4.7 20.8-16.6 20.8-30V66.1c0-23-24.2-38-44.8-27.7l-9.6 4.8c-46.3 23.2-100.8 23.2-147.1 0c-35.1-17.6-75.4-22-113.5-12.5L64 48V32z"},null,-1)),Jt=[Ht],Kt={key:0},Wt={class:"form-check my-3"},Gt={class:"control control-checkbox"},Xt=["name","value","onUpdate:modelValue"],Zt=["onMouseover"],si={class:"form-group"},ei={class:"form-group"},ti={class:"mt-3 d-flex justify-content-end"},ii=["disabled"],ni={key:1,id:"question-content"},oi={key:6,class:"modal"},ri={class:"modal-content"},li=b(()=>e("div",{class:""},[e("p",{class:"text-center"}," Please choose an instructor before taking these quizzes. ")],-1)),ai={class:"d-flex flex-column-reverse flex-md-row justify-content-center gap-2"},ui=b(()=>e("span",null,"Back",-1)),ci=b(()=>e("span",null,"Select Instructor",-1));function hi(i,s,r,l,t,h){const d=p("EssayAnswer"),a=p("ImageAnswer"),m=p("AssessmentResult"),c=p("FlagModals"),g=p("RouterLink");return n(),o(f,null,[t.loading==!0?(n(),o("div",ft,"Loading...")):u("",!0),t.aiLoading?(n(),o("div",wt,yt)):u("",!0),t.isSubmitting&&!t.showResult?(n(),o("div",vt,qt)):u("",!0),t.loading==!1&&t.isQuizPassed==!1&&!t.needToSelectInstructor&&!t.aiLoading&&!t.isSubmitting?(n(),o("div",bt,[t.updatedAssessment?(n(),o("div",St,[e("div",xt,[e("div",At,[It,e("div",Mt,[e("button",{type:"button",class:"btn green-btn",onClick:s[0]||(s[0]=y=>t.updatedAssessment=!1)}," OK ")])])])])):u("",!0),e("div",Tt,[t.questions.length>0?(n(),o("div",Qt,[(n(!0),o(f,null,q(t.questions,(y,T)=>(n(),o("div",$t,[T==t.questionNumber?(n(),o("div",Ct,[e("div",Nt,[e("div",Lt,[e("div",Rt,_(T+1),1),e("div",zt,_(y.question),1)]),e("div",Ft,[y.is_human_edited?(n(),o("div",Et,[(n(),o("svg",Dt,Pt))])):(n(),o("div",Bt,[(n(),o("svg",Ut,Ot))])),e("div",{"b-tooltip.hover":"",title:"Flag this question for review",onClick:s[1]||(s[1]=(...S)=>h.handleClickFlagIcon&&h.handleClickFlagIcon(...S)),class:"flagging-icon",style:{height:"50px"}},[(n(),o("svg",Yt,Jt))])])]),y.questionType=="mc"?(n(),o("div",Kt,[(n(!0),o(f,null,q(y.answerOptions,S=>v((n(),o("div",Wt,[e("label",Gt,[e("div",{class:A(t.answerHoveredIndex==S.index?"my-auto mx-2 me-4 answer-option checkbox-hovered":"my-auto mx-2 me-4 answer-option")},_(S.option),3),v(e("input",{type:"radio",name:T+"answer",value:S.index,"onUpdate:modelValue":R=>t.questions[T].userAnswer=R},null,8,Xt),[[P,t.questions[T].userAnswer]]),e("div",{class:"control_indicator",onMouseover:R=>t.answerHoveredIndex=S.index,onMouseleave:s[2]||(s[2]=R=>t.answerHoveredIndex=1/0)},null,40,Zt)])],512)),[[V,S.index<=2||S.show==1]])),256))])):u("",!0)])):u("",!0)]))),256)),e("div",{class:A(`${t.questions[t.questionNumber].questionType=="essay"?"d-block":"d-none"}`)},[e("div",si,[M(d,{ref:"essayAnswer"},null,512)])],2),e("div",{class:A(`${t.questions[t.questionNumber].questionType=="image"?"d-block":"d-none"}`)},[e("div",ei,[M(a,{numImagesRequired:t.numOfImagesRequired,ref:"imageAnswer"},null,8,["numImagesRequired"])])],2),e("div",ti,[t.questionNumber>0?(n(),o("button",{key:0,onClick:s[3]||(s[3]=y=>h.Previous()),class:"btn primary-btn me-2"}," Previous ")):u("",!0),t.questionNumber<t.questions.length-1?(n(),o("button",{key:1,onClick:s[4]||(s[4]=y=>h.Next()),class:"btn green-btn"}," Next ")):u("",!0),t.questionNumber>=t.questions.length-1?(n(),o("button",{key:2,onClick:s[5]||(s[5]=y=>h.Submit()),class:"btn green-btn",disabled:t.isSubmitting}," Submit ",8,ii)):u("",!0)])])):(n(),o("div",ni," There is no quiz for this skill yet. Please check again soon. "))])])):u("",!0),t.showResult?(n(),x(m,{key:4,skill:t.skill,isManualEssayMarking:l.settingsStore.isManualEssayMarking},null,8,["skill","isManualEssayMarking"])):u("",!0),t.showFlaggingModal?(n(),x(c,{key:5,userId:l.userDetailsStore.userId,contentId:t.questions[t.questionNumber].id,contentType:t.flagContentType},null,8,["userId","contentId","contentType"])):u("",!0),t.needToSelectInstructor?(n(),o("div",oi,[e("div",ri,[li,e("div",ai,[M(g,{to:`/skills/${t.skillId}`,type:"button",class:"btn green-btn w-100 w-md-50"},{default:$(()=>[ui]),_:1},8,["to"]),M(g,{to:"/profile/edit",type:"button",class:"btn green-btn w-100 w-md-50"},{default:$(()=>[ci]),_:1})])])])):u("",!0)],64)}const di=I(gt,[["render",hi],["__scopeId","data-v-eb8bd03f"]]);const mi={setup(){const i=B(),s=H(),r=C();return{skillsStore:i,showSkillStore:s,userDetailsStore:r}},data(){return{skillId:this.$route.params.skillId,skill:{name:null,image:null,firstAncestorId:null,levelInHierarchy:null,url:"",type:null}}},components:{SkillTimeTracker:F},async mounted(){this.skillsStore.skillsList.length==0&&await this.skillsStore.getSkillsList();for(let i=0;i<this.skillsStore.skillsList.length;i++)this.skillId==this.skillsStore.skillsList[i].id&&(this.skill.name=this.skillsStore.skillsList[i].name,this.skill.url=this.skillsStore.skillsList[i].url,this.skill.type=this.skillsStore.skillsList[i].type)},components:{Assessment:di,SkillTimeTracker:F},beforeRouteLeave(i,s,r){if(!this.userDetailsStore.userId&&this.skill.type=="domain"){r();return}this.$refs.skillTimeTracker.saveDuration(),r()},methods:{imageUrlAlternative(i){i.target.src="/images/skill-avatar/recurso.png"}}},O=i=>(N("data-v-e6089094"),i=i(),L(),i),_i={class:"container bg-light rounded p-3"},gi=O(()=>e("h1",{class:"heading"},"Assessment",-1)),fi={class:"skill-name"},wi={class:"mt-4 mb-2"},pi={id:"assessment-horizontal-line",class:"w-md-75 w-100"},yi=O(()=>e("div",{id:"full-line"},null,-1));function vi(i,s,r,l,t,h){var m,c;const d=p("Assessment"),a=p("SkillTimeTracker");return n(),o(f,null,[e("div",_i,[gi,e("p",fi,[e("em",null,_(this.skill.name),1)]),e("div",wi,[e("div",pi,[yi,e("div",{style:J(`width: ${parseInt((((m=i.$refs.assessment)==null?void 0:m.questionNumber)+1)/((c=i.$refs.assessment)==null?void 0:c.totalNumOfQuestions)*100)}%;`),id:"progress"},null,4)])]),M(d,{ref:"assessment"},null,512)]),t.skill.type?(n(),x(a,{key:0,ref:"skillTimeTracker"},null,512)):u("",!0)],64)}const Ai=I(mi,[["render",vi],["__scopeId","data-v-e6089094"]]);export{Ai as default};
