import{_ as y,A as m,f as k,r as g,o,c as i,a as r,q as w,s as S,t as d,g as u,l as h,T as b,b as f,F as C,z as v,p as x,d as T}from"./main-e9595a07.js";const I={setup(){const s=m(),e=k();return{usersStore:s,usersDetailsStore:e}},data(){return{referrals:[],copySuccess:!1,copyTimeoutId:null}},async created(){typeof this.usersDetailsStore.userId>"u"&&await this.usersDetailsStore.getUserDetails(),await this.getReferrals()},computed:{referralLink(){return`https://parrhesia.io/student-signup?ref=${this.usersDetailsStore.userName}`}},methods:{async getReferrals(){fetch(`/referrals/${this.usersDetailsStore.userId}/list`).then(function(s){return s.json()}).then(async s=>{await this.usersStore.getUsers(),this.referrals=s;for(let e=0;e<this.referrals.length;e++)for(let t=0;t<this.usersStore.users.length;t++)this.referrals[e].referred_user_id==this.usersStore.users[t].id&&(this.referrals[e].referredUser=this.usersStore.users[t].username),this.referrals[e].referrer_user_id==this.usersStore.users[t].id&&(this.referrals[e].referringUser=this.usersStore.users[t].username);console.log(this.referrals)})},async copyReferralLink(){try{await this.copyToClipboard(this.referralLink)}catch(s){console.error("Copy failed:",s)}},async copyToClipboard(s){this.copyTimeoutId&&clearTimeout(this.copyTimeoutId);let e=!1;if(navigator.clipboard&&window.isSecureContext)try{await navigator.clipboard.writeText(s),e=!0}catch{console.warn("Clipboard API failed, using fallback")}if(!e){await this.$nextTick();const t=this.$refs.referralInput;t&&(t.focus(),t.select(),e=document.execCommand("copy"))}if(e)this.showCopyFeedback();else throw new Error("Could not copy to clipboard")},showCopyFeedback(){this.copySuccess=!0,this.copyTimeoutId=setTimeout(()=>{this.copySuccess=!1,this.copyTimeoutId=null},3e3)}},beforeUnmount(){this.copyTimeoutId&&clearTimeout(this.copyTimeoutId)}},c=s=>(x("data-v-10dab299"),s=s(),T(),s),L={class:"container bg-light rounded"},R={class:"d-flex justify-content-between align-items-start mb-4"},D=c(()=>r("h1",{class:"heading"},"Referrals",-1)),U={key:0,class:"referral-link-section"},V=c(()=>r("h3",{class:"secondary-heading h5 mb-2"},"Student Referral Link",-1)),j={class:"d-flex align-items-center gap-2"},N={class:"referral-link-container"},B=["value"],F={key:0,width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},H=c(()=>r("path",{d:"M20 9H11C9.89543 9 9 9.89543 9 11V20C9 21.1046 9.89543 22 11 22H20C21.1046 22 22 21.1046 22 20V11C22 9.89543 21.1046 9 20 9Z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)),M=c(()=>r("path",{d:"M5 15H4C2.89543 15 2 14.1046 2 13V4C2 2.89543 2.89543 2 4 2H13C14.1046 2 15 2.89543 15 4V5",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)),z=[H,M],A={key:1,width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},E=c(()=>r("path",{d:"M20 6L9 17L4 12",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)),q=[E],P={key:0,class:"copy-success-message mt-2 mb-0"},Y={class:"referrals-list"},Z=c(()=>r("h3",{class:"secondary-heading h5 mb-3"},"Your Referrals",-1)),G={key:0,class:"list-unstyled"},J={class:"referral-item p-3 border rounded"},K={key:1,class:"text-muted"};function O(s,e,t,p,n,l){const _=g("router-link");return o(),i("div",L,[r("div",R,[D,p.usersDetailsStore.role=="partner"?(o(),i("div",U,[V,r("div",j,[r("div",N,[r("input",{ref:"referralInput",value:l.referralLink,type:"text",class:"form-control referral-input",readonly:""},null,8,B),r("button",{onClick:e[0]||(e[0]=(...a)=>l.copyReferralLink&&l.copyReferralLink(...a)),class:w(["btn primary-btn copy-btn",{"btn-success":n.copySuccess}])},[n.copySuccess?(o(),i("svg",A,q)):(o(),i("svg",F,z)),S(" "+d(n.copySuccess?"Copied!":"Copy"),1)],2)])]),u(b,{name:"fade"},{default:h(()=>[n.copySuccess?(o(),i("p",P," âœ“ Referral link copied to clipboard! ")):f("",!0)]),_:1})])):f("",!0)]),r("div",Y,[Z,n.referrals.length>0?(o(),i("ul",G,[(o(!0),i(C,null,v(n.referrals,a=>(o(),i("li",{key:a.id,class:"mb-2"},[r("div",J,[u(_,{to:"/referrals/"+a.referrer_user_id+"/"+a.referred_user_id,class:"text-decoration-none"},{default:h(()=>[r("strong",null,d(a.referredUser),1)]),_:2},1032,["to"])])]))),128))])):(o(),i("p",K," No referrals yet. Share your referral link to start earning! "))])])}const W=y(I,[["render",O],["__scopeId","data-v-10dab299"]]);export{W as default};
