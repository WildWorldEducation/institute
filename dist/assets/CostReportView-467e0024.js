import{s as T}from"./transform-62bed377.js";import{_ as m,o as u,c as k,e as L,r as f,a as r,b as P,j as y,k as w}from"./main-d0bd4343.js";import{l as v,m as x,f as S,b as _,a as M}from"./linear-c1216a03.js";import{b}from"./band-22321830.js";import{s as C}from"./sort-a49d696f.js";import{u as $,l as B}from"./line-61e28c6d.js";import{e as z}from"./time-8a8f3333.js";import{u as D}from"./AnalyticsStore-fd39aabb.js";import"./ordinal-3694ef9e.js";import"./point-ea70dc51.js";const A={name:"TenantAvgTokensToMasterSkillsHorizontalBarChart",props:["data","colour"],data(){return{padding:60}},mounted(){T("#tenant-avg-tokens-to-master-skills-chart-container");const e=25,t=0,i=0,s=10,d=200,o=1e3,l=Math.ceil((this.data.length+.1)*e)+t+s,n=v().domain([0,x(this.data,a=>a.quantity)]).range([d,o-i]),c=b().domain(C(this.data,a=>-a.quantity).map(a=>a.name)).rangeRound([t,l-s]).padding(.1),h=n.tickFormat(20),p=T("#tenant-avg-tokens-to-master-skills-chart-container").append("svg").attr("width",o).attr("height",l).attr("viewBox",[0,0,o,l]).attr("style","max-width: 100%; height: 100%; font: 14px sans-serif;");p.append("g").attr("fill",this.colour).selectAll().data(this.data).join("rect").attr("x",n(0)).attr("y",a=>c(a.name)).attr("width",a=>n(a.quantity)-n(0)).attr("height",c.bandwidth()),p.append("g").attr("fill","white").attr("text-anchor","end").selectAll().data(this.data).join("text").attr("x",a=>n(a.quantity)).attr("y",a=>c(a.name)+c.bandwidth()/2).attr("dy","0.35em").attr("dx",-4).text(a=>h(a.quantity)).call(a=>a.filter(g=>n(g.quantity)-n(0)<20).attr("dx",4).attr("fill","black").attr("text-anchor","start")),p.append("g").attr("transform",`translate(0,${t})`).call(S(n).ticks(0)).call(a=>a.select(".domain").remove()),p.append("g").attr("transform",`translate(${d},0)`).call(_(c).tickSizeOuter(0))},computed:{}},j={id:"tenant-avg-tokens-to-master-skills-chart-container"};function q(e,t,i,s,d,o){return u(),k("div",j)}const H=m(A,[["render",q],["__scopeId","data-v-e380fbfe"]]);const I={name:"TenantTokensPerSkillHorizontalBarChart",props:["data","colour"],data(){return{padding:60}},mounted(){T("#tenant-tokens-per-skill-chart-container");const e=25,t=0,i=0,s=10,d=200,o=1e3,l=Math.ceil((this.data.length+.1)*e)+t+s,n=v().domain([0,x(this.data,a=>a.quantity)]).range([d,o-i]),c=b().domain(C(this.data,a=>-a.quantity).map(a=>a.name)).rangeRound([t,l-s]).padding(.1),h=n.tickFormat(20),p=T("#tenant-tokens-per-skill-chart-container").append("svg").attr("width",o).attr("height",l).attr("viewBox",[0,0,o,l]).attr("style","max-width: 100%; height: 100%; font: 14px sans-serif;");p.append("g").attr("fill",this.colour).selectAll().data(this.data).join("rect").attr("x",n(0)).attr("y",a=>c(a.name)).attr("width",a=>n(a.quantity)-n(0)).attr("height",c.bandwidth()),p.append("g").attr("fill","white").attr("text-anchor","end").selectAll().data(this.data).join("text").attr("x",a=>n(a.quantity)).attr("y",a=>c(a.name)+c.bandwidth()/2).attr("dy","0.35em").attr("dx",-4).text(a=>h(a.quantity)).call(a=>a.filter(g=>n(g.quantity)-n(0)<20).attr("dx",4).attr("fill","black").attr("text-anchor","start")),p.append("g").attr("transform",`translate(0,${t})`).call(S(n).ticks(0)).call(a=>a.select(".domain").remove()),p.append("g").attr("transform",`translate(${d},0)`).call(_(c).tickSizeOuter(0))},computed:{}},R={id:"tenant-tokens-per-skill-chart-container"};function O(e,t,i,s,d,o){return u(),k("div",R)}const E=m(I,[["render",O],["__scopeId","data-v-039ce704"]]),N={name:"TenantTokensPerDayLineChart",props:["data","colour"],data(){return{padding:60}},mounted(){const e=this.data;T("#tenant-tokens-per-day-chart-container");const t=928,i=500,s=20,d=30,o=30,l=40,n=$(z(e,a=>a.date),[l,t-d]),c=v([0,x(e,a=>a.quantity)],[i-o,s]),h=B().x(a=>n(a.date)).y(a=>c(a.quantity)),p=T("#tenant-tokens-per-day-chart-container").append("svg").attr("width",t).attr("height",i).attr("viewBox",[0,0,t,i]).attr("style","max-width: 100%; height: auto; height: intrinsic;");p.append("g").attr("transform",`translate(0,${i-o})`).call(M(n).ticks(e.length/2).tickSizeOuter(0)),p.append("g").attr("transform",`translate(${l},0)`).call(_(c).ticks(i/80)).call(a=>a.selectAll(".tick line").clone().attr("x2",t-l-d).attr("stroke-opacity",.1)).call(a=>a.append("text").attr("x",-l).attr("y",10).attr("fill","currentColor").attr("text-anchor","start").text("â†‘ Tokens")),p.append("path").attr("fill","none").attr("stroke","#5f31dd").attr("stroke-width",1.5).attr("d",h(e))}},V={id:"tenant-tokens-per-day-chart-container"};function U(e,t,i,s,d,o){return u(),k("div",V)}const F=m(N,[["render",U]]);const W={setup(){const e=L(),t=D();return{userDetailsStore:e,analyticsStore:t}},components:{TenantAvgTokensToMasterSkillsHorizontalBarChart:H,TenantTokensPerSkillHorizontalBarChart:E,TenantTokensPerDayLineChart:F},data(){return{tenantId:this.$route.params.tenantId,isDataWeekly:!1,isTutorialComplete:!1,showTutorialTip1:!1,showTutorialTip2:!1,showTutorialTip3:!1,showTutorialTip4:!1,dataMode:"total"}},async created(){await this.checkIfTutorialComplete(),await this.getAvgTokensToMasterSkills(),await this.getTotalTokensPerSkill(),await this.getTotalTokensPerDay()},methods:{async checkIfTutorialComplete(){const t=await(await fetch(`/users/check-tutorial-progress/school-report/${this.userDetailsStore.userId}`)).json();t==0?(this.isTutorialComplete=!1,this.showTutorialTip1=!0):t==1&&(this.isTutorialComplete=!0)},progressTutorial(e){e==1?(this.showTutorialTip1=!1,this.showTutorialTip2=!0):e==2?(this.showTutorialTip2=!1,this.showTutorialTip3=!0):e==3?(this.showTutorialTip3=!1,this.showTutorialTip4=!0):e==4&&(this.showTutorialTip4=!1,this.markTutorialComplete())},restartTutorial(){this.isTutorialComplete=!1,this.showTutorialTip1=!0,this.showTutorialTip2=!1,this.showTutorialTip3=!1,this.showTutorialTip4=!1},markTutorialComplete(){let e="/users/mark-tutorial-complete/school-report/"+this.userDetailsStore.userId;fetch(e,{method:"PUT",headers:{"Content-Type":"application/json"}})},skipTutorial(){this.showTutorialTip1=!1,this.showTutorialTip2=!1,this.showTutorialTip3=!1,this.showTutorialTip4=!1,this.isTutorialComplete=!0,this.markTutorialComplete()},async getAvgTokensToMasterSkills(){try{const e=await fetch(`/student-analytics/avg-tokens-to-master-skills/tenant/${this.tenantId}`);if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);const t=await e.json();this.analyticsStore.avgTokensToMasterSkills=Array.isArray(t)?t:[]}catch(e){console.error("Error fetching cohort mastered assessments:",e),this.analyticsStore.avgTokensToMasterSkills=[]}},async getTotalTokensPerSkill(){try{const e=await fetch(`/student-analytics/total-tokens-per-skill/tenant/${this.tenantId}`);if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);const t=await e.json();this.analyticsStore.totalTokensPerSkill=Array.isArray(t)?t:[]}catch(e){console.error("Error fetching cohort mastered assessments:",e),this.analyticsStore.totalTokensPerSkill=[]}},async getTotalTokensPerDay(){this.analyticsStore.totalTokensPerDay=[],fetch(`/student-analytics/tenant-tokens-per-day/${this.dataMode}/${this.tenantId}`).then(e=>e.json()).then(e=>{for(let t=0;t<e.length;t++)e[t].date=new Date(e[t].date);e.sort((t,i)=>t.date-i.date),this.analyticsStore.totalTokensPerDay=e}).catch(e=>{console.error("Error fetching student progress:",e)})},downloadData(e,t){const i=Object.keys(e[0]);console.log(i);const s=[];s.push(i.join(","));for(const n of e){const c=i.map(h=>{const p=n[h];return`"${String(p).replace(/"/g,'""')}"`});s.push(c.join(","))}const d=s.join(`
`),o=new Blob([d],{type:"text/csv;charset=utf-8;"}),l=document.createElement("a");l.href=URL.createObjectURL(o),l.download=t+".csv",l.click()},async toggleWeeklyCumulativeData(){this.dataMode=="total"?this.dataMode="weekly":this.dataMode="total",await this.getTenantDuration(),await this.getPercentageStudentsMasteredOneSkill(),await this.getTotalTokensPerDay()}}},G={class:"container"},J={class:"d-flex justify-content-between w-100"},K={key:0,class:"modal"},Q={class:"modal-content"},X={class:"d-flex justify-content-between"},Y={class:"d-flex justify-content-between"},Z={key:2},tt={class:"d-flex justify-content-between"},at={key:4},et={class:"d-flex justify-content-between mt-5"},st={key:6,class:"mb-5"};function ot(e,t,i,s,d,o){const l=f("TenantTokensPerDayLineChart"),n=f("TenantAvgTokensToMasterSkillsHorizontalBarChart"),c=f("TenantTokensPerSkillHorizontalBarChart");return u(),k("div",G,[r("span",J,[t[7]||(t[7]=r("h1",{class:"heading"},"Cost Report",-1)),r("button",{class:"btn me-1",onClick:t[0]||(t[0]=(...h)=>o.restartTutorial&&o.restartTutorial(...h)),"aria-label":"info"},t[6]||(t[6]=[r("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 192 512",width:"20",height:"23",class:"primary-icon"},[r("path",{d:"M48 80a48 48 0 1 1 96 0A48 48 0 1 1 48 80zM0 224c0-17.7 14.3-32 32-32l64 0c17.7 0 32 14.3 32 32l0 224 32 0c17.7 0 32 14.3 32 32s-14.3 32-32 32L32 512c-17.7 0-32-14.3-32-32s14.3-32 32-32l32 0 0-192-32 0c-17.7 0-32-14.3-32-32z"})],-1)]))]),d.showTutorialTip1?(u(),k("div",K,[r("div",Q,[t[8]||(t[8]=r("p",{class:"modal-text"}," The School Admin Report provides comprehensive analytics on student engagement, academic performance, and resource usage across your school. ",-1)),r("div",X,[r("button",{class:"btn primary-btn",onClick:t[1]||(t[1]=h=>o.progressTutorial(1))}," next "),r("button",{class:"btn red-btn",onClick:t[2]||(t[2]=(...h)=>o.skipTutorial&&o.skipTutorial(...h))}," exit tutorial ")])])])):P("",!0),r("h4",Y,[t[10]||(t[10]=y(" Tokens spent per day ",-1)),r("button",{class:"btn",onClick:t[3]||(t[3]=h=>o.downloadData(s.analyticsStore.totalTokensPerDay,"Tokens-per-day"))},t[9]||(t[9]=[r("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",width:"18",height:"18"},[r("path",{d:"M0 64C0 28.7 28.7 0 64 0L213.5 0c17 0 33.3 6.7 45.3 18.7L365.3 125.3c12 12 18.7 28.3 18.7 45.3L384 448c0 35.3-28.7 64-64 64L64 512c-35.3 0-64-28.7-64-64L0 64zm208-5.5l0 93.5c0 13.3 10.7 24 24 24L325.5 176 208 58.5zM175 441c9.4 9.4 24.6 9.4 33.9 0l64-64c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0l-23 23 0-86.1c0-13.3-10.7-24-24-24s-24 10.7-24 24l0 86.1-23-23c-9.4-9.4-24.6-9.4-33.9 0s-9.4 24.6 0 33.9l64 64z"})],-1)]))]),s.analyticsStore.totalTokensPerDay.length>0?(u(),w(l,{key:1,data:s.analyticsStore.totalTokensPerDay,colour:"#5f31dd",class:"mb-5"},null,8,["data"])):(u(),k("p",Z,"No data yet")),t[15]||(t[15]=r("p",null,[r("em",null,"Please note recording of tokens per skill stops after student mastery of that skill")],-1)),r("h4",tt,[t[12]||(t[12]=y(" Average number of tokens spent to master a skill ",-1)),r("button",{class:"btn",onClick:t[4]||(t[4]=h=>o.downloadData(s.analyticsStore.avgTokensToMasterSkills,"Avg-tokens-to-master-skill"))},t[11]||(t[11]=[r("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",width:"18",height:"18"},[r("path",{d:"M0 64C0 28.7 28.7 0 64 0L213.5 0c17 0 33.3 6.7 45.3 18.7L365.3 125.3c12 12 18.7 28.3 18.7 45.3L384 448c0 35.3-28.7 64-64 64L64 512c-35.3 0-64-28.7-64-64L0 64zm208-5.5l0 93.5c0 13.3 10.7 24 24 24L325.5 176 208 58.5zM175 441c9.4 9.4 24.6 9.4 33.9 0l64-64c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0l-23 23 0-86.1c0-13.3-10.7-24-24-24s-24 10.7-24 24l0 86.1-23-23c-9.4-9.4-24.6-9.4-33.9 0s-9.4 24.6 0 33.9l64 64z"})],-1)]))]),s.analyticsStore.avgTokensToMasterSkills.length>0?(u(),w(n,{key:3,data:s.analyticsStore.avgTokensToMasterSkills,colour:"darkgreen"},null,8,["data"])):(u(),k("p",at,"No data yet")),r("h4",et,[t[14]||(t[14]=y(" Tokens spent per skill ",-1)),r("button",{class:"btn",onClick:t[5]||(t[5]=h=>o.downloadData(s.analyticsStore.totalTokensPerSkill,"Tokens-per-skill"))},t[13]||(t[13]=[r("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",width:"18",height:"18"},[r("path",{d:"M0 64C0 28.7 28.7 0 64 0L213.5 0c17 0 33.3 6.7 45.3 18.7L365.3 125.3c12 12 18.7 28.3 18.7 45.3L384 448c0 35.3-28.7 64-64 64L64 512c-35.3 0-64-28.7-64-64L0 64zm208-5.5l0 93.5c0 13.3 10.7 24 24 24L325.5 176 208 58.5zM175 441c9.4 9.4 24.6 9.4 33.9 0l64-64c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0l-23 23 0-86.1c0-13.3-10.7-24-24-24s-24 10.7-24 24l0 86.1-23-23c-9.4-9.4-24.6-9.4-33.9 0s-9.4 24.6 0 33.9l64 64z"})],-1)]))]),s.analyticsStore.totalTokensPerSkill.length>0?(u(),w(c,{key:5,data:s.analyticsStore.totalTokensPerSkill,colour:"#5f31dd",class:"mb-5"},null,8,["data"])):(u(),k("p",st,"No data yet"))])}const Tt=m(W,[["render",ot],["__scopeId","data-v-f17a87e5"]]);export{Tt as default};
