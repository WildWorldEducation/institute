import{_,A as D,f as w,L as b,r as m,o as l,c,a as n,t as f,g as h,s as v,b as g,k as P,p as k,d as x}from"./main-ec9f55d1.js";import{u as C}from"./AnalyticsStore-975cd556.js";import{S as B}from"./StudentProgressChart-e6de9e53.js";import"./transform-af9a74a2.js";import{l as j,c as A,b as I}from"./linear-5b188edc.js";import{m as N,b as R}from"./continuous-7328829e.js";import{s as T}from"./sort-ed61f96d.js";import{s as V}from"./string-dd82ab4a.js";import{P as H}from"./PassedAssessmentsTimelineChart-aab1aa68.js";import{D as L}from"./downloadCSVBtn-64ac23b3.js";import"./line-85f04100.js";import"./time-0457d93b.js";import"./point-ea70dc51.js";import"./extent-4cf1c809.js";import"./colors-98f238a0.js";import"./main-1bd7eaf1.js";const M={name:"StudentPassedAssessmentsByRootSubjectHorizontalBarChart",props:["data","colour"],data(){return{}},mounted(){const e=document.getElementById("student-passed-subjects-chart-container").clientWidth,p=document.getElementById("student-passed-subjects-chart-container").clientHeight,r=j().domain([0,N(this.data,t=>t.quantity)]).range([200,e-0]),o=R().domain(T(this.data,t=>-t.quantity).map(t=>t.name)).rangeRound([0,p-20]).padding(.1);r.tickFormat(20);const d=V("#student-passed-subjects-chart-container").append("svg").attr("width","100%").attr("height","100%").attr("viewBox",[0,0,"100%","100%"]).attr("preserveAspectRatio","xMinYMin");d.append("g").selectAll().data(this.data).join("rect").attr("x",r(0)).attr("y",t=>o(t.name)).attr("width",t=>r(t.quantity)-r(0)).attr("height",o.bandwidth()).attr("fill",function(t){return t.name=="Language"?"DarkMagenta":t.name=="Mathematics"?"blue":t.name=="Science & Invention"?"purple":t.name=="Computer Science"?"deeppink":t.name=="Dangerous Ideas"?"brown":t.name=="History"?"cyan":t.name=="Life"?"magenta":"#ff7f0e"}),d.append("g").attr("fill","white").attr("text-anchor","end").selectAll().data(this.data).join("text").attr("x",t=>r(t.quantity)).attr("y",t=>o(t.name)+o.bandwidth()/2).attr("dy","0.35em").attr("dx",-4).text(t=>t.quantity).call(t=>t.filter(y=>r(y.quantity)-r(0)<20).attr("dx",4).attr("fill","black").attr("text-anchor","start")),d.append("g").attr("transform","translate(0,0)").call(A(r).ticks(0)).call(t=>t.select(".domain").remove()),d.append("g").attr("transform","translate(200,0)").attr("style","font-size: 16px").call(I(o).tickSizeOuter(0))},computed:{}};function U(s,a,u,i,e,p){return null}const q=_(M,[["render",U]]);const z={setup(){const s=D(),a=C(),u=w(),i=b();return{usersStore:s,userDetailsStore:u,analyticsStore:a,userSkillsStore:i}},components:{StudentProgressChart:B,DownloadCSVBtn:L,PassedAssessmentsTimelineChart:H,StudentPassedAssessmentsByRootSubjectHorizontalBarChart:q},data(){return{studentId:this.$route.params.studentId,studentName:null,progressData:{student:[],average:[]},assessmentPasses:[]}},async created(){this.usersStore.users.length<1&&await this.usersStore.getUsers();const s=this.usersStore.users.find(a=>a.id===this.studentId);s&&(this.studentName=s.username),await this.analyticsStore.getStudentProgress(this.studentId,this.userDetailsStore.tenantId),await this.HandleProgressData(),await this.analyticsStore.getStudentPassedAssessmentsBySubject(this.studentId),await this.getUserSkillMasteredHistory(this.studentId),this.assessmentPassesDownloadData=this.assessmentPasses.map(a=>({skill:a.name,date:this.assessmentDate(a.mastered_date)}))},methods:{async HandleProgressData(){this.progressData.student=[];for(let s=0;s<this.analyticsStore.progress.student.length;s++)this.progressData.student.push(this.analyticsStore.progress.student[s]);this.progressData.average=[];for(let s=0;s<this.analyticsStore.progress.tenant.length;s++)this.progressData.average.push(this.analyticsStore.progress.tenant[s]);this.$nextTick(()=>{this.$refs.progressChart&&this.$refs.progressChart.createChart(this.progressData)})},async getUserSkillMasteredHistory(s){await this.userSkillsStore.getMasteredSkills(s),this.assessmentPasses=this.userSkillsStore.masteredSkills.map(a=>({...a,url:`/skills/${a.url}`,labelName:`${a.name}`}))},assessmentDate(s){return new Date(s).toLocaleString("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})}}},S=s=>(k("data-v-fffe51be"),s=s(),x(),s),$={class:"container-fluid chart-page"},E={class:"d-flex justify-content-between w-100"},O=S(()=>n("h1",{class:"heading h4"},"Assessments passed",-1)),F={class:"tertiary-heading h4 d-flex justify-content-end align-items-center"},W={class:"row chart-row"},Y={class:"col-lg-8 chart-col position-relative"},G={key:0,id:"progress-chart-container"},J={key:1},K={key:2,class:"position-absolute"},Q={style:{color:"green"}},X=S(()=>n("span",{style:{color:"#ff7f0e"}},"class average",-1)),Z={class:"col-lg-4 chart-col"},tt={id:"student-passed-subjects-chart-container"},st={class:"row chart-row position-relative"},et={key:0,class:"position-relative"};function at(s,a,u,i,e,p){const r=m("DownloadCSVBtn"),o=m("StudentProgressChart"),d=m("StudentPassedAssessmentsByRootSubjectHorizontalBarChart"),t=m("PassedAssessmentsTimelineChart");return l(),c("div",$,[n("span",E,[O,n("h2",F,f(e.studentName),1)]),n("div",W,[n("div",Y,[e.progressData.student.length>0||e.progressData.average.length>0?(l(),c("div",G,[h(r,{data:e.progressData,fileName:`Progress Report - ${e.studentName}`,toolTip:"Download progress data as CSV",class:"position-absolute download-btn"},null,8,["data","fileName"]),h(o,{ref:"progressChart",data:e.progressData},null,8,["data"])])):(l(),c("p",J,"There is no data to show yet.")),e.progressData.student.length>0||e.progressData.average.length>0?(l(),c("figcaption",K,[n("span",Q,f(e.studentName),1),v(" vs "),X])):g("",!0)]),n("div",Z,[n("div",tt,[i.analyticsStore.studentRootSubjectsPassedAssessments.length>0?(l(),P(d,{key:0,data:i.analyticsStore.studentRootSubjectsPassedAssessments},null,8,["data"])):g("",!0)])])]),n("div",st,[e.assessmentPasses.length>0?(l(),c("div",et,[h(r,{data:s.assessmentPassesDownloadData,fileName:`Passed Assessments - ${e.studentName}`,toolTip:"Download passed assessments data as CSV",class:"position-absolute download-btn"},null,8,["data","fileName"]),h(t,{class:"mb-5",data:e.assessmentPasses},null,8,["data"])])):g("",!0)])])}const Dt=_(z,[["render",at],["__scopeId","data-v-fffe51be"]]);export{Dt as default};
