import{_ as f,o,c as d,A as S,r as _,a as e,t as p,k as x,b as k,F as D,z as b,g as w,l as v,s as T}from"./main-0d30f197.js";import"./transform-23c7b39f.js";import{l as A,m as B,b as $,s as N}from"./linear-5b5f98b2.js";import{s as g}from"./select-03d56b88.js";import{a as q,b as C}from"./continuous-dd31f971.js";import"./ascending-3ff63084.js";import"./init-77b53fdd.js";import"./ordinal-ba9b4969.js";const M={name:"TimePerSkillHorizontalBarChart",props:["data","colour"],data(){return{padding:60}},mounted(){g("#time-per-skill-chart-container");const t=25,a=0,c=0,u=10,r=200,l=1e3,h=Math.ceil((this.data.length+.1)*t)+a+u,n=A().domain([0,B(this.data,s=>s.quantity)]).range([r,l-c]),i=$().domain(N(this.data,s=>-s.quantity).map(s=>s.name)).rangeRound([a,h-u]).padding(.1);n.tickFormat(20);const m=g("#time-per-skill-chart-container").append("svg").attr("width",l).attr("height",h).attr("viewBox",[0,0,l,h]).attr("style","max-width: 100%; height: 100%; font: 14px sans-serif;");m.append("g").attr("fill",this.colour).selectAll().data(this.data).join("rect").attr("x",n(0)).attr("y",s=>i(s.name)).attr("width",s=>n(s.quantity)-n(0)).attr("height",i.bandwidth()),m.append("g").attr("fill","white").attr("text-anchor","end").selectAll().data(this.data).join("text").attr("x",s=>n(s.quantity)).attr("y",s=>i(s.name)+i.bandwidth()/2).attr("dy","0.35em").attr("dx",-4).text(s=>s.formattedQuantity).call(s=>s.filter(y=>n(y.quantity)-n(0)<40).attr("dx",4).attr("fill","black").attr("text-anchor","start")),m.append("g").attr("transform",`translate(0,${a})`).call(q(n).ticks(0)).call(s=>s.select(".domain").remove()),m.append("g").attr("transform",`translate(${r},0)`).call(C(i).tickSizeOuter(0))},computed:{}},j={id:"time-per-skill-chart-container"};function z(t,a,c,u,r,l){return o(),d("div",j)}const L=f(M,[["render",z]]),H={setup(){return{usersStore:S()}},components:{TimePerSkillHorizontalBarChart:L},data(){return{studentId:this.$route.params.studentId,studentName:null,skillDurations:[],allSkillsDuration:0,isDataLoaded:!1}},async created(){this.usersStore.users.length<1&&await this.usersStore.getUsers();const t=this.usersStore.users.find(a=>a.id===this.studentId);t&&(this.studentName=t.username),await this.getSkillDuration(),await this.getAllSkillsDuration(),this.isDataLoaded=!0},methods:{async getSkillDuration(){fetch(`/student-analytics/skill-durations/${this.studentId}`).then(t=>t.json()).then(t=>{this.skillDurations=t;for(let a=0;a<this.skillDurations.length;a++)this.skillDurations[a].formattedQuantity=this.millisToMinutesAndSeconds(this.skillDurations[a].quantity)}).catch(t=>{console.error("Error fetching last visited skills:",t)})},async getAllSkillsDuration(){fetch(`/student-analytics/all-skills-duration/${this.studentId}`).then(t=>t.json()).then(t=>{this.allSkillsDuration=t.duration}).catch(t=>{console.error("Error fetching last visited skills:",t)})},millisToMinutesAndSeconds(t){var a=Math.floor(t/6e4),c=(t%6e4/1e3).toFixed(0);return a+":"+(c<10?"0":"")+c}}},I={class:"container"},P={class:"d-flex justify-content-between w-100"},V=e("h1",{class:"heading"},"Time Report",-1),F={class:"secondary-heading h3"},R=e("p",null,[e("em",null," Please note that time spent on external sources (e.g. websites) related to skills is not measured.")],-1),E={key:0},O=e("h2",{class:"secondary-heading"},"All skills",-1),Q=e("h2",{class:"secondary-heading"},"Minutes per skill",-1),U={key:1,class:"mb-4"},G={class:"table"},J=e("tr",null,[e("th",null,"Skill"),e("th",null,"Duration")],-1),K={key:2},W=e("p",null,"No skills visited by this student.",-1),X=[W];function Y(t,a,c,u,r,l){const h=_("TimePerSkillHorizontalBarChart"),n=_("router-link");return o(),d("div",I,[e("span",P,[V,e("h2",F,p(r.studentName),1)]),R,r.isDataLoaded?(o(),d("div",E,[O,e("p",null,p(l.millisToMinutesAndSeconds(this.allSkillsDuration)),1),Q,r.skillDurations.length>0?(o(),x(h,{key:0,data:r.skillDurations,colour:"darkgreen"},null,8,["data"])):k("",!0),this.skillDurations.length>0?(o(),d("div",U,[e("table",G,[J,(o(!0),d(D,null,b(r.skillDurations,i=>(o(),d("tr",{key:i.id,class:"table-rows"},[e("td",null,[w(n,{target:"_blank",to:"/skills/"+i.url},{default:v(()=>[T(p(i.name),1)]),_:2},1032,["to"])]),e("td",null,p(l.millisToMinutesAndSeconds(i.quantity)),1)]))),128))])])):(o(),d("div",K,X))])):k("",!0)])}const ot=f(H,[["render",Y]]);export{ot as default};
