import{_ as f,o as g,c as u,f as q,A as R,r as _,a as n,q as L,F as V,z as F,t as Q,g as $,l as C,k as D,b as T,E as H,p as z,d as O}from"./main-a7b69baf.js";import{u as P}from"./AnalyticsStore-969510ae.js";import"./transform-4d0f7c8f.js";import{u as A,l as I}from"./line-d122782f.js";import{e as B}from"./time-3c9385c3.js";import{l as w,c as j,b as k,a as U}from"./linear-d9b6cbf2.js";import{m as b}from"./continuous-93813e6c.js";import{s as x}from"./string-c67ea49d.js";import{b as Y,o as N}from"./band-2263c9e7.js";import{s as G}from"./sort-fcaf8f38.js";import{c as W}from"./category10-63f9141e.js";import"./point-ea70dc51.js";import"./colors-98f238a0.js";const J={name:"SchoolProgressChart",setup(){return{analyticsStore:P()}},data(){return{}},mounted(){},methods:{createChart(t){const a=document.getElementById("progress-chart-container").clientWidth,s=document.getElementById("progress-chart-container").clientHeight,o=5,c=20,h=20,i=20,l=A(B(this.analyticsStore.progress.tenant,e=>e.date),[i,a-c]),d=w([0,b(this.analyticsStore.progress.tenant,e=>e.quantity)],[s-h,o]),p=I().x(e=>l(e.date)).y(e=>d(e.quantity)),m=x("#progress-chart-container").append("svg").attr("width",a).attr("height",s).attr("viewBox",[0,0,a,s]).attr("style","max-width: 100%; height: auto; height: intrinsic;");m.append("g").attr("transform",`translate(0,${s-20})`).call(j(l).ticks(a/100).tickSizeOuter(0)),m.append("g").attr("transform",`translate(${i},0)`).call(k(d).ticks(s/40)).call(e=>e.select(".domain").remove()).call(e=>e.selectAll(".tick line").clone().attr("x2",a-i-c).attr("stroke-opacity",.2)).call(e=>e.append("text").attr("x",-i).attr("y",10).attr("fill","currentColor").attr("text-anchor","start")),m.append("path").attr("fill","none").attr("stroke","green").attr("stroke-width",3).attr("d",p(t))}}};function K(t,a,s,o,c,h){return null}const X=f(J,[["render",K]]),Z={name:"SchoolComparisonChart",props:["colour"],data(){return{}},mounted(){},methods:{createChart(t){x("#school-comparison-chart-container");const a=40,s=0,o=20,c=10,h=200,i=1e3,l=Math.ceil((t.length+.1)*a)+s+c,d=w().domain([0,b(t,e=>e.quantity)]).range([h,i-o]),p=Y().domain(G(t,e=>-e.quantity).map(e=>e.name)).rangeRound([s,l-c]).padding(.1);d.tickFormat(20);const m=x("#school-comparison-chart-container").append("svg").attr("width",i).attr("height",l).attr("viewBox",[0,0,i,l]).attr("style","max-width: 100%; height: 100%; font: 16px sans-serif;");m.append("g").selectAll().data(t).join("rect").attr("x",d(0)).attr("y",e=>p(e.name)).attr("width",e=>d(e.quantity)-d(0)).attr("height",p.bandwidth()).attr("fill",function(e){return e.name=="Language"?"DarkMagenta":e.name=="Mathematics"?"blue":e.name=="Science & Invention"?"purple":e.name=="Computer Science"?"deeppink":e.name=="Dangerous Ideas"?"brown":e.name=="History"?"cyan":e.name=="Life"?"magenta":"#ff7f0e"}),m.append("g").attr("fill","white").attr("text-anchor","end").selectAll().data(t).join("text").attr("x",e=>d(e.quantity)).attr("y",e=>p(e.name)+p.bandwidth()/2).attr("dy","0.35em").attr("dx",-4).text(e=>e.quantity).call(e=>e.filter(r=>d(r.quantity)-d(0)<20).attr("dx",4).attr("fill","black").attr("text-anchor","start")),m.append("g").attr("transform",`translate(0,${s})`).call(U(d).ticks(0)).call(e=>e.select(".domain").remove()),m.append("g").attr("transform",`translate(${h},0)`).style("font","20px sans-serif").call(k(p).tickSizeOuter(0))}}},tt={id:"school-comparison-chart-container"};function et(t,a,s,o,c,h){return g(),u("div",tt)}const st=f(Z,[["render",et]]),at={name:"SchoolTimeChart",setup(){return{analyticsStore:P()}},data(){return{}},mounted(){},methods:{createChart(t){const a=document.getElementById("time-chart-container").clientWidth,s=document.getElementById("time-chart-container").clientHeight,o=0,c=20,h=20,i=25,l=A(B(this.analyticsStore.time.tenant,e=>e.date),[i,a-c]),d=w([0,b(this.analyticsStore.time.tenant,e=>e.minutes)],[s-h,o]),p=I().x(e=>l(e.date)).y(e=>d(e.minutes)),m=x("#school-time-chart-container").append("svg").attr("width",a).attr("height",s).attr("viewBox",[0,0,a,s]).attr("style","max-width: 100%; height: auto; height: intrinsic;");m.append("g").attr("transform",`translate(0,${s-h})`).call(j(l).ticks(t.length).tickSizeOuter(0)),m.append("g").attr("transform",`translate(${i},0)`).call(k(d).ticks(s/40)).call(e=>e.select(".domain").remove()).call(e=>e.selectAll(".tick line").clone().attr("x2",a-i-c).attr("stroke-opacity",.2)).call(e=>e.append("text").attr("x",-i).attr("y",10).attr("fill","currentColor").attr("text-anchor","start")),m.append("path").attr("fill","none").attr("stroke","#ff7f0e").attr("stroke-width",3).attr("d",p(t))}}},rt={id:"school-time-chart-container"};function ot(t,a,s,o,c,h){return g(),u("div",rt)}const nt=f(at,[["render",ot]]);const it={name:"School-Admin-Class-Dashboard",setup(){const t=q(),a=P(),s=R();return{userDetailsStore:t,analyticsStore:a,usersStore:s}},data(){return{progressChartMode:"school",isAboveTheCurve:!1,teachers:[],selectedTeacher:{},isSchoolSelected:!0}},components:{SchoolProgressChart:X,SchoolComparisonChart:st,SchoolTimeChart:nt},async created(){this.teachers.length<1&&await this.getTeachers(this.userDetailsStore.tenantId),this.analyticsStore.rootSubjectsPassedAssessments.length==0&&await this.getComparisonData(),await this.getSchoolData()},methods:{async getTeachers(t){const s=await(await fetch("/tenants/instructors/"+t)).json();for(let o=0;o<s.length;o++)s[o].type="teacher";this.teachers=s},async selectElement(t){this.clearCharts(),t.type==="teacher"?(this.selectedTeacher=t,this.isSchoolSelected=!1,await this.getClassData()):t==="school"&&(this.isSchoolSelected=!0,this.selectedTeacher={},await this.getSchoolData())},clearCharts(){this.analyticsStore.progress.class=[],this.analyticsStore.durationPerDay=[];let t=document.getElementById("progress-chart-container"),a=t.querySelector("svg");a&&a.remove(),t=document.getElementById("time-chart-container"),a=t.querySelector("svg"),a&&a.remove()},async getSchoolData(){this.progressChartMode="school",await this.getSchoolProgressData(),await this.getSchoolTimeData()},async getClassData(){this.progressChartMode="teacher",await this.getClassProgressData(this.selectedTeacher.id),await this.getClassTimeData()},async getSchoolProgressData(){await this.analyticsStore.getSchoolProgress(this.userDetailsStore.tenantId),this.$nextTick(()=>{this.$refs.progressChart&&this.$refs.progressChart.createChart(this.analyticsStore.progress.tenant)})},async getSchoolTimeData(){await this.analyticsStore.getSchoolTime(this.userDetailsStore.tenantId),this.$nextTick(()=>{this.$refs.timeChart&&this.$refs.timeChart.createChart(this.analyticsStore.time.tenant)})},async getComparisonData(){try{const t=await fetch(`/student-analytics/passed-assessments-by-subject/tenant/${this.userDetailsStore.tenantId}`);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);this.analyticsStore.rootSubjectsPassedAssessments=await t.json(),this.$nextTick(()=>{this.$refs.comparisonChart&&this.$refs.comparisonChart.createChart(this.analyticsStore.rootSubjectsPassedAssessments)})}catch(t){console.error("Error fetching cohort mastered assessments:",t),this.analyticsStore.rootSubjectsPassedAssessments=[]}},async getClassProgressData(){await this.analyticsStore.getClassProgress(this.selectedTeacher.id),this.$nextTick(()=>{this.$refs.progressChart&&this.$refs.progressChart.createChart(this.analyticsStore.progress.class)})},async getClassTimeData(){await this.analyticsStore.getClassTime(this.selectedTeacher.id),this.$nextTick(()=>{this.$refs.timeChart&&this.$refs.timeChart.createChart(this.analyticsStore.time.class)})}}},E=t=>(z("data-v-ee754619"),t=t(),O(),t),ct={class:"dashboard"},lt={class:"col-lg-1 col-md-2"},ht={class:"d-flex bg-light rounded p-2"},dt={class:"d-flex bg-light rounded p-2"},mt=["onClick"],pt={class:"col-lg-11 col-md-10 dashboard"},gt={class:"container-fluid"},ut=H('<div class="row top-row text-start" data-v-ee754619><div class="col-sm top-row-text" data-v-ee754619><strong data-v-ee754619>Students: </strong><span data-v-ee754619>10</span></div><div class="col-sm top-row-text" data-v-ee754619></div><div class="col-sm top-row-text" data-v-ee754619><strong data-v-ee754619>Skills Mastered: </strong><span data-v-ee754619>10</span></div><div class="col-sm top-row-text" data-v-ee754619><strong data-v-ee754619>Cost: </strong><span data-v-ee754619>$0</span></div></div>',1),_t={class:"dash-row row"},ft={class:"col-md h-100"},yt=E(()=>n("h2",{class:"heading h5"},"Progress",-1)),St={id:"progress-chart-container"},vt={key:1},xt={class:"col-md"},$t=E(()=>n("h2",{class:"heading h5"},"Subject comparison",-1)),Ct={class:"dash-row row mt-2 mb-2"},Dt={class:"col-md position-relative"},wt=E(()=>n("h2",{class:"heading h5"},"Cost By Subject",-1)),kt={class:"col-md h-100"},bt=E(()=>n("h2",{class:"heading h5"},"Weekly engagement",-1)),Tt={id:"time-chart-container"},Pt={key:1};function At(t,a,s,o,c,h){const i=_("RouterLink"),l=_("SchoolProgressChart"),d=_("SchoolComparisonChart"),p=_("SchoolTimeChart");return g(),u("div",ct,[n("div",lt,[n("div",ht,[n("button",{class:L(c.isSchoolSelected?"isCurrentlySelected":"side-buttons"),onClick:a[0]||(a[0]=m=>h.selectElement("school"))}," school ",2)]),(g(!0),u(V,null,F(c.teachers,m=>(g(),u("div",{key:m.id},[n("div",dt,[n("button",{class:L(m.id===c.selectedTeacher.id?"isCurrentlySelected":"side-buttons"),onClick:e=>h.selectElement(m)},Q(m.username),11,mt)])]))),128))]),n("div",pt,[n("div",gt,[ut,n("div",_t,[n("div",ft,[$(i,{to:"/reports/academics",class:"",target:"_blank"},{default:C(()=>[yt]),_:1}),n("div",St,[o.analyticsStore.progress.tenant.length>0||o.analyticsStore.progress.class.length>0?(g(),D(l,{key:0,ref:"progressChart"},null,512)):(g(),u("p",vt,"No data"))])]),n("div",xt,[$t,o.analyticsStore.rootSubjectsPassedAssessments.length>0?(g(),D(d,{key:0,colour:"#5f31dd",ref:"comparisonChart"},null,512)):T("",!0)])]),n("div",Ct,[n("div",Dt,[$(i,{to:"/reports/cost",class:"me-2 position-absolute chart-heading",target:"_blank"},{default:C(()=>[wt]),_:1})]),n("div",kt,[$(i,{to:"/reports/engagement",target:"_blank"},{default:C(()=>[bt]),_:1}),n("div",Tt,[o.analyticsStore.time.tenant.length>0||o.analyticsStore.time.class.length>0?(g(),D(p,{key:0,ref:"timeChart"},null,512)):(g(),u("p",Pt,"No data"))])])])])])])}const It=f(it,[["render",At],["__scopeId","data-v-ee754619"]]),Bt={name:"TeacherProgressChart",props:[],data(){return{axisData:[]}},mounted(){},methods:{createChart(t){if(t.class.length==0)this.axisData=t.average;else if(t.school.length==0)this.axisData=t.class;else{const r=t.class.reduce((S,v)=>Math.max(S,v.quantity),-1/0),y=t.school.reduce((S,v)=>Math.max(S,v.quantity),-1/0);r>=y?this.axisData=t.class:this.axisData=t.school}const a=Object.entries(t).map(([r,y])=>({name:r,values:y})),s=document.getElementById("progress-chart-container").clientWidth,o=document.getElementById("progress-chart-container").clientHeight,c=5,h=20,i=20,l=20,d=A(B(this.axisData,r=>r.date),[l,s-h]),p=w([0,b(this.axisData,r=>r.quantity)],[o-i,c]);N().domain(a.map(r=>r.name)).range(W);const m=I().x(r=>d(r.date)).y(r=>p(r.quantity)),e=x("#progress-chart-container").append("svg").attr("width","100%").attr("height","100%").attr("viewBox",[0,0,+Math.min(s,o),+Math.min(s,o)]).attr("preserveAspectRatio","xMinYMin");e.append("g").attr("transform",`translate(0,${o-20})`).call(j(d).ticks(s/100).tickSizeOuter(0)),e.append("g").attr("transform",`translate(${l},0)`).call(k(p).ticks(o/80)).call(r=>r.selectAll(".tick line").clone().attr("x2",s-l-h).attr("stroke-opacity",.1)),e.selectAll(".line").data(a).join("path").attr("fill","none").attr("stroke",r=>r.name=="class"?"green":"#ff7f0e").attr("stroke-width",3).attr("d",r=>m(r.values))}}};function jt(t,a,s,o,c,h){return null}const Et=f(Bt,[["render",jt]]),Mt={name:"SchoolTimeChart",props:[],data(){return{axisData:[]}},mounted(){},methods:{createChart(t){if(console.log(t),t.student.length==0)this.axisData=t.tenant;else if(t.tenant.length==0)this.axisData=t.student;else{const r=t.student.reduce((S,v)=>Math.max(S,v.quantity),-1/0),y=t.tenant.reduce((S,v)=>Math.max(S,v.quantity),-1/0);r>=y?this.axisData=t.student:this.axisData=t.tenant}const a=Object.entries(t).map(([r,y])=>({name:r,values:y}));x("#time-chart-container");const s=document.getElementById("time-chart-container").clientWidth,o=document.getElementById("time-chart-container").clientHeight,c=0,h=20,i=20,l=20,d=A(B(this.axisData,r=>r.date),[l,s-h]),p=w([0,b(this.axisData,r=>r.formattedQuantity)],[o-i,c]);N().domain(a.map(r=>r.name)).range(W);const m=I().x(r=>d(r.date)).y(r=>p(r.formattedQuantity)),e=x("#time-chart-container").append("svg").attr("width","100%").attr("height","100%").attr("viewBox",[0,0,+Math.min(s,o),+Math.min(s,o)]).attr("preserveAspectRatio","xMinYMin");e.append("g").attr("transform",`translate(0,${o-i})`).call(j(d).ticks(t.length).tickSizeOuter(0)),e.append("g").attr("transform",`translate(${l},0)`).call(k(p).ticks(o/40)).call(r=>r.select(".domain").remove()).call(r=>r.selectAll(".tick line").clone().attr("x2",s-l-h).attr("stroke-opacity",.2)).call(r=>r.append("text").attr("x",-l).attr("y",10).attr("fill","currentColor").attr("text-anchor","start")),e.selectAll(".line").data(a).join("path").attr("fill","none").attr("stroke",r=>r.name=="student"?"RoyalBlue":"#ff7f0e").attr("stroke-width",3).attr("d",r=>m(r.values))}}};function qt(t,a,s,o,c,h){return null}const Lt=f(Mt,[["render",qt]]);const Rt={name:"Teacher-Analytics-Dashboard",setup(){const t=q(),a=P(),s=R();return{userDetailsStore:t,analyticsStore:a,usersStore:s}},data(){return{progressChartMode:"teacher",progressData:{school:[],class:[]}}},components:{TeacherProgressChart:Et,TeacherTimeChart:Lt},async created(){await this.getProgressData()},methods:{async getProgressData(){await this.analyticsStore.getSchoolProgress(this.userDetailsStore.tenantId),this.progressData.school=[];for(let t=0;t<this.analyticsStore.progress.tenant.length;t++)this.progressData.school.push(this.analyticsStore.progress.tenant[t]);await this.analyticsStore.getClassProgress(this.userDetailsStore.userId),this.progressData.class=[];for(let t=0;t<this.analyticsStore.classProgress.length;t++)this.progressData.class.push(this.analyticsStore.classProgress[t]);this.$nextTick(()=>{this.$refs.progressChart&&this.$refs.progressChart.createChart(this.progressData)})},async getTimeData(){this.analyticsStore.durationPerDay=[];let t=`/student-analytics/tenant-duration-per-day/weekly/${this.userDetailsStore.tenantId}`;fetch(t).then(a=>a.json()).then(async a=>{this.analyticsStore.durationPerDay=[];for(let s=0;s<a.length;s++)a[s].date=new Date(a[s].date),a[s].minutes=a[s].milliseconds/(1e3*60),this.analyticsStore.durationPerDay.push(a[s]);this.analyticsStore.durationPerDay.sort((s,o)=>s.date-o.date),this.$nextTick(()=>{this.$refs.timeChart&&this.$refs.timeChart.createChart(this.analyticsStore.durationPerDay)})}).catch(a=>{console.error("Error fetching student progress:",a)})},async getComparisonData(){try{const t=await fetch(`/student-analytics/passed-assessments-by-subject/tenant/${this.userDetailsStore.tenantId}`);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);this.analyticsStore.rootSubjectsPassedAssessments=await t.json(),this.$nextTick(()=>{this.$refs.comparisonChart&&this.$refs.comparisonChart.createChart(this.analyticsStore.rootSubjectsPassedAssessments)})}catch(t){console.error("Error fetching cohort mastered assessments:",t),this.analyticsStore.rootSubjectsPassedAssessments=[]}}}},M=t=>(z("data-v-cb4058ae"),t=t(),O(),t),Vt={class:"dashboard"},Ht={class:"container-fluid"},zt=H('<div class="row top-row" data-v-cb4058ae><div class="col-sm top-row-text" data-v-cb4058ae><strong data-v-cb4058ae>Skills Mastered: </strong><span data-v-cb4058ae>10</span></div><div class="col-sm top-row-text" data-v-cb4058ae><strong data-v-cb4058ae>Students: </strong><span data-v-cb4058ae>5</span></div><div class="col-sm top-row-text" data-v-cb4058ae></div><div class="col-sm top-row-text" data-v-cb4058ae></div></div>',1),Ot={class:"dash-row row"},Nt={class:"col-md h-100"},Wt=M(()=>n("h2",{class:"heading h5"},"Progress",-1)),Ft={id:"progress-chart-container",class:"position-relative"},Qt=M(()=>n("div",{class:"col-md"},[n("h2",{class:"heading h5"},"Subject comparison")],-1)),Ut={class:"dash-row row mt-2 mb-2"},Yt={class:"col-md position-relative"},Gt=M(()=>n("h2",{class:"heading h5"},"Cost By Subject",-1)),Jt={class:"col-md position-relative"},Kt={id:"time-chart-container"},Xt=M(()=>n("h2",{class:"heading h5"},"Engagement",-1));function Zt(t,a,s,o,c,h){const i=_("RouterLink"),l=_("TeacherProgressChart");return g(),u("div",Vt,[n("div",Ht,[zt,n("div",Ot,[n("div",Nt,[$(i,{to:"/reports/academics",class:""},{default:C(()=>[Wt]),_:1}),n("div",Ft,[c.progressData.school.length>0||c.progressData.class.length>0?(g(),D(l,{key:0,ref:"progressChart"},null,512)):T("",!0)])]),Qt]),n("div",Ut,[n("div",Yt,[$(i,{to:"/reports/cost",class:"me-2 position-absolute chart-heading"},{default:C(()=>[Gt]),_:1})]),n("div",Jt,[n("div",Kt,[$(i,{to:"/reports/engagement",class:"position-absolute chart-heading"},{default:C(()=>[Xt]),_:1})])])])])])}const te=f(Rt,[["render",Zt],["__scopeId","data-v-cb4058ae"]]),ee={name:"Dashboard",setup(){return{userDetailsStore:q()}},data(){return{}},components:{SchoolAdminDashboard:It,TeacherAnalyticsDashboard:te},async created(){}};function se(t,a,s,o,c,h){const i=_("SchoolAdminDashboard"),l=_("TeacherAnalyticsDashboard");return g(),u(V,null,[o.userDetailsStore.role=="school_admin"?(g(),D(i,{key:0})):T("",!0),o.userDetailsStore.role=="instructor"||o.userDetailsStore.role=="partner"?(g(),D(l,{key:1})):T("",!0)],64)}const _e=f(ee,[["render",se]]);export{_e as default};
