import{_ as S,o as l,c as u,e as E,y as R,r as y,a,m as A,F,x as H,t as z,b as x,j as _,k as f,f as v,p as L}from"./main-0db18a32.js";import{u as M}from"./AnalyticsStore-c8b73b27.js";import"./transform-af9a74a2.js";import{u as B,l as I}from"./line-85f04100.js";import{e as P}from"./extent-4cf1c809.js";import{l as w,a as j,b as T,c as V}from"./linear-5b188edc.js";import{m as D,b as Y}from"./continuous-7328829e.js";import{s as b}from"./string-dd82ab4a.js";import{s as U}from"./sort-ed61f96d.js";import"./time-0457d93b.js";import"./point-ea70dc51.js";const G={name:"SchoolProgressChart",setup(){return{analyticsStore:M()}},data(){return{}},mounted(){},methods:{createChart(t){this.$parent.progressChartMode==="school"?(this.axisData=t.school,t.school):(this.axisData=t.teacher,t.teacher);const e=document.getElementById("progress-chart-container").clientWidth,o=document.getElementById("progress-chart-container").clientHeight,r=5,i=20,d=20,c=35,g=B(P(this.analyticsStore.progress.tenant,s=>s.date),[c,e-i]),m=w([0,D(this.analyticsStore.progress.tenant,s=>s.quantity)],[o-d,r]),p=I().x(s=>g(s.date)).y(s=>m(s.quantity)),n=b("#progress-chart-container").append("svg").attr("width",e).attr("height",o).attr("viewBox",[0,0,e,o]).attr("style","max-width: 100%; height: auto; height: intrinsic;");n.append("g").attr("transform",`translate(0,${o-20})`).call(j(g).ticks(e/100).tickSizeOuter(0)),n.append("g").attr("transform",`translate(${c},0)`).call(T(m).ticks(o/40)).call(s=>s.select(".domain").remove()).call(s=>s.selectAll(".tick line").clone().attr("x2",e-c-i).attr("stroke-opacity",.2)).call(s=>s.append("text").attr("x",-c).attr("y",10).attr("fill","currentColor").attr("text-anchor","start")),n.append("path").attr("fill","none").attr("stroke","green").attr("stroke-width",3).attr("d",p(t))}}};function J(t,e,o,r,i,d){return null}const N=S(G,[["render",J]]),K={name:"SchoolTimeChart",setup(){return{analyticsStore:M()}},data(){return{}},mounted(){},methods:{createChart(t){const e=document.getElementById("time-chart-container").clientWidth,o=document.getElementById("time-chart-container").clientHeight,r=0,i=20,d=20,c=25,g=B(P(this.analyticsStore.time.tenant,s=>s.date),[c,e-i]),m=w([0,D(this.analyticsStore.time.tenant,s=>s.minutes)],[o-d,r]),p=I().x(s=>g(s.date)).y(s=>m(s.minutes)),n=b("#school-time-chart-container").append("svg").attr("width",e).attr("height",o).attr("viewBox",[0,0,e,o]).attr("style","max-width: 100%; height: auto; height: intrinsic;");n.append("g").attr("transform",`translate(0,${o-d})`).call(j(g).ticks(t.length).tickSizeOuter(0)),n.append("g").attr("transform",`translate(${c},0)`).call(T(m).ticks(o/40)).call(s=>s.select(".domain").remove()).call(s=>s.selectAll(".tick line").clone().attr("x2",e-c-i).attr("stroke-opacity",.2)).call(s=>s.append("text").attr("x",-c).attr("y",10).attr("fill","currentColor").attr("text-anchor","start")),n.append("path").attr("fill","none").attr("stroke","#ff7f0e").attr("stroke-width",3).attr("d",p(t))}}},Q={id:"school-time-chart-container"};function X(t,e,o,r,i,d){return l(),u("div",Q)}const W=S(K,[["render",X]]),Z={name:"TenantFailedAssessmentsByRootSubjectHorizontalBarChart",props:["data"],data(){return{}},mounted(){const d=document.getElementById("failed-chart-container").clientWidth,c=30*this.data.length+0+10,g=w().domain([0,D(this.data,n=>n.quantity)]).range([200,d-0]),m=Y().domain(U(this.data,n=>-n.quantity).map(n=>n.name)).rangeRound([0,c-10]).padding(.1),p=b("#failed-chart-container").append("svg").attr("width",d).attr("height",c).attr("viewBox",[0,0,+Math.min(d,c),+Math.min(d,c)]).attr("preserveAspectRatio","xMinYMin");p.append("g").selectAll().data(this.data).join("rect").attr("x",g(0)).attr("y",n=>m(n.name)).attr("width",n=>g(n.quantity)-g(0)).attr("height",m.bandwidth()).attr("fill",function(n){return n.name=="Language"?"DarkMagenta":n.name=="Mathematics"?"blue":n.name=="Science & Invention"?"purple":n.name=="Computer Science"?"deeppink":n.name=="Dangerous Ideas"?"brown":n.name=="History"?"cyan":n.name=="Life"?"magenta":"#ff7f0e"}),p.append("g").attr("fill","white").attr("text-anchor","end").selectAll().data(this.data).join("text").attr("x",n=>g(n.quantity)).attr("y",n=>m(n.name)+m.bandwidth()/2).attr("dy","0.35em").attr("dx",-4).text(n=>n.quantity).call(n=>n.filter(s=>g(s.quantity)-g(0)<20).attr("dx",4).attr("fill","black").attr("text-anchor","start")),p.append("g").attr("transform","translate(0,0)").call(V(g).ticks(0)).call(n=>n.select(".domain").remove()),p.append("g").attr("transform","translate(200,0)").call(T(m).tickSizeOuter(0))}};function tt(t,e,o,r,i,d){return null}const q=S(Z,[["render",tt]]),et={name:"TenantTokensPerDayLineChart",props:[],data(){return{}},methods:{createChart(t){const e=document.getElementById("cost-chart-container").clientWidth,o=document.getElementById("cost-chart-container").clientHeight,r=20,i=20,d=20,c=25,g=B(P(t,s=>s.date),[c,e-i]),m=w([0,D(t,s=>s.quantity)],[o-d,r]),p=I().x(s=>g(s.date)).y(s=>m(s.quantity)),n=b("#cost-chart-container").append("svg").attr("width",e).attr("height",o).attr("viewBox",[0,0,e,o]).attr("style","max-width: 100%; height: auto; height: intrinsic;");n.append("g").attr("transform",`translate(0,${o-d})`).call(j(g).ticks(t.length).tickSizeOuter(0)),n.append("g").attr("transform",`translate(${c},0)`).call(T(m).ticks(o/80)).call(s=>s.selectAll(".tick line").clone().attr("x2",e-c-i).attr("stroke-opacity",.1)).call(s=>s.append("text").attr("x",-c).attr("y",10).attr("fill","currentColor").attr("text-anchor","start").text("â†‘ Tokens")),n.append("path").attr("fill","none").attr("stroke","teal").attr("stroke-width",3).attr("d",p(t))}}};function st(t,e,o,r,i,d){return null}const O=S(et,[["render",st]]);const at={name:"School-Admin-Class-Dashboard",setup(){const t=E(),e=M(),o=R();return{userDetailsStore:t,analyticsStore:e,usersStore:o}},data(){return{progressChartMode:"school",isAboveTheCurve:!1,teachers:[],selectedTeacher:{},isSchoolSelected:!0,isMobileCheck:window.innerWidth}},components:{SchoolProgressChart:N,SchoolTimeChart:W,TenantFailedAssessmentsByRootSubjectHorizontalBarChart:q,SchoolCostChart:O},async created(){this.teachers.length<1&&await this.getTeachers(this.userDetailsStore.tenantId),await this.getSchoolData(),this.analyticsStore.rootSubjectsFailedAssessments.length==0&&await this.getFailedAssessmentsBySubject(),await this.getSchoolCostData()},methods:{async getTeachers(t){const o=await(await fetch("/tenants/instructors/"+t)).json();for(let r=0;r<o.length;r++)o[r].type="teacher";this.teachers=o},async selectElement(t){this.clearCharts(),t.type==="teacher"?(this.selectedTeacher=t,this.isSchoolSelected=!1,await this.getClassData()):t==="school"&&(this.isSchoolSelected=!0,this.selectedTeacher={},await this.getSchoolData())},clearCharts(){this.analyticsStore.progress.class=[],this.analyticsStore.durationPerDay=[];let t=document.getElementById("progress-chart-container"),e=t.querySelector("svg");e&&e.remove(),t=document.getElementById("time-chart-container"),e=t.querySelector("svg"),e&&e.remove()},async getSchoolData(){this.progressChartMode="school",await this.getSchoolProgressData(),await this.getSchoolTimeData()},async getClassData(){this.progressChartMode="teacher",await this.getClassProgressData(this.selectedTeacher.id),await this.getClassTimeData()},async getSchoolProgressData(){await this.analyticsStore.getSchoolProgress(this.userDetailsStore.tenantId),this.$nextTick(()=>{this.$refs.progressChart&&this.$refs.progressChart.createChart(this.analyticsStore.progress.tenant)})},async getClassProgressData(){await this.analyticsStore.getClassProgress(this.selectedTeacher.id),this.$nextTick(()=>{this.$refs.progressChart&&this.$refs.progressChart.createChart(this.analyticsStore.progress.class)})},async getSchoolTimeData(){await this.analyticsStore.getSchoolTime(this.userDetailsStore.tenantId),this.$nextTick(()=>{this.$refs.timeChart&&this.$refs.timeChart.createChart(this.analyticsStore.time.tenant)})},async getClassTimeData(){await this.analyticsStore.getClassTime(this.selectedTeacher.id),this.$nextTick(()=>{this.$refs.timeChart&&this.$refs.timeChart.createChart(this.analyticsStore.time.class)})},async getFailedAssessmentsBySubject(){try{const t=await fetch(`/student-analytics/failed-assessments-by-subject/tenant/${this.userDetailsStore.tenantId}`);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);this.analyticsStore.rootSubjectsFailedAssessments=await t.json()}catch(t){console.error("Error fetching cohort mastered assessments:",t),this.analyticsStore.rootSubjectsFailedAssessments=[]}},async getSchoolCostData(){await this.analyticsStore.getSchoolCost(this.userDetailsStore.tenantId,"weekly"),this.$nextTick(()=>{this.$refs.costChart&&this.$refs.costChart.createChart(this.analyticsStore.cost.tenant)})}}},rt={class:"dashboard"},ot={key:0,class:"col-lg-1 col-md-2"},nt={class:"d-flex rounded p-2"},it={class:"d-flex rounded p-2"},ct=["onClick"],lt={class:"container-fluid h-100"},ht={class:"dash-row row"},dt={class:"col-md p-2"},gt={class:"chart-card h-100"},mt={key:1,class:"heading h5"},ut={id:"progress-chart-container"},pt={key:1},_t={class:"col-md p-2"},yt={class:"chart-card m-2"},ft={key:1,class:"heading h5"},St={id:"failed-chart-container"},Ct={key:1},kt={class:"dash-row row"},$t={class:"col-md position-relative h-100 p-2"},vt={class:"chart-card h-100"},xt={key:1,class:"heading h5"},wt={id:"cost-chart-container"},Tt={key:1},Dt={class:"col-md h-100 p-2"},bt={class:"chart-card h-100"},At={key:1,class:"heading h5"},Bt={id:"time-chart-container"},It={key:1};function Pt(t,e,o,r,i,d){const c=y("RouterLink"),g=y("SchoolProgressChart"),m=y("TenantFailedAssessmentsByRootSubjectHorizontalBarChart"),p=y("SchoolCostChart"),n=y("SchoolTimeChart");return l(),u("div",rt,[i.teachers.length>0&&i.isMobileCheck>=768?(l(),u("div",ot,[a("div",nt,[a("button",{class:A(i.isSchoolSelected?"isCurrentlySelected":"side-buttons"),onClick:e[0]||(e[0]=s=>d.selectElement("school"))}," school ",2)]),(l(!0),u(F,null,H(i.teachers,s=>(l(),u("div",{key:s.id},[a("div",it,[a("button",{class:A(s.id===i.selectedTeacher.id?"isCurrentlySelected":"side-buttons"),onClick:h=>d.selectElement(s)},z(s.username),11,ct)])]))),128))])):x("",!0),a("div",{class:A([{"col-lg-11":i.teachers.length>0,"col-md-10":i.teachers.length>0,"col-lg-12":i.teachers.length==0},"h-100"])},[a("div",lt,[a("div",ht,[a("div",dt,[a("div",gt,[i.progressChartMode=="school"?(l(),_(c,{key:0,to:"/progress-report",class:"",target:"_blank"},{default:f(()=>e[1]||(e[1]=[a("h2",{class:"heading h5"},"Progress",-1)])),_:1,__:[1]})):(l(),u("h2",mt,"Progress")),a("div",ut,[i.progressChartMode=="school"&&r.analyticsStore.progress.tenant.length>0||i.progressChartMode=="teacher"&&r.analyticsStore.progress.class.length>0?(l(),_(g,{key:0,ref:"progressChart"},null,512)):(l(),u("p",pt,"No data yet"))])])]),a("div",_t,[a("div",yt,[i.progressChartMode=="school"?(l(),_(c,{key:0,to:"/challenges-report",class:"",target:"_blank"},{default:f(()=>e[2]||(e[2]=[a("h2",{class:"heading h5"},"Challenges",-1)])),_:1,__:[2]})):(l(),u("h2",ft,"Challenges")),a("div",St,[r.analyticsStore.rootSubjectsFailedAssessments.length>0?(l(),_(m,{key:0,data:r.analyticsStore.rootSubjectsFailedAssessments,ref:"failedAssessmentsChart"},null,8,["data"])):(l(),u("p",Ct,"No challenges yet"))])])])]),a("div",kt,[a("div",$t,[a("div",vt,[i.progressChartMode=="school"?(l(),_(c,{key:0,to:"/cost-report",class:"",target:"_blank"},{default:f(()=>e[3]||(e[3]=[a("h2",{class:"heading h5"},"Cost",-1)])),_:1,__:[3]})):(l(),u("h2",xt,"Cost")),a("div",wt,[r.analyticsStore.cost.tenant.length>0||r.analyticsStore.cost.class.length>0?(l(),_(p,{key:0,ref:"costChart"},null,512)):(l(),u("p",Tt,"No data yet"))])])]),a("div",Dt,[a("div",bt,[i.progressChartMode=="school"?(l(),_(c,{key:0,to:"/engagement-report",target:"_blank"},{default:f(()=>e[4]||(e[4]=[a("h2",{class:"heading h5"},"Weekly engagement",-1)])),_:1,__:[4]})):(l(),u("h2",At,"Weekly engagement")),a("div",Bt,[r.analyticsStore.time.tenant.length>0||r.analyticsStore.time.class.length>0?(l(),_(n,{key:0,ref:"timeChart"},null,512)):(l(),u("p",It,"No data"))])])])])])],2)])}const jt=S(at,[["render",Pt],["__scopeId","data-v-996ab920"]]);const Mt={name:"Platform-Admin-Class-Dashboard",setup(){const t=E(),e=M(),o=R();return{userDetailsStore:t,analyticsStore:e,usersStore:o}},data(){return{tenantId:this.$route.params.tenantId,progressChartMode:"school",isAboveTheCurve:!1,teachers:[],selectedTeacher:{},isSchoolSelected:!0}},components:{SchoolProgressChart:N,SchoolTimeChart:W,TenantFailedAssessmentsByRootSubjectHorizontalBarChart:q,SchoolCostChart:O},async created(){this.teachers.length<1&&await this.getTeachers(this.tenantId),await this.getSchoolData(),this.analyticsStore.rootSubjectsFailedAssessments.length==0&&await this.getFailedAssessmentsBySubject(),await this.getSchoolCostData()},methods:{async getTeachers(t){const o=await(await fetch("/tenants/instructors/"+t)).json();for(let r=0;r<o.length;r++)o[r].type="teacher";this.teachers=o},async selectElement(t){this.clearCharts(),t.type==="teacher"?(this.selectedTeacher=t,this.isSchoolSelected=!1,await this.getClassData()):t==="school"&&(this.isSchoolSelected=!0,this.selectedTeacher={},await this.getSchoolData())},clearCharts(){this.analyticsStore.progress.class=[],this.analyticsStore.durationPerDay=[];let t=document.getElementById("progress-chart-container"),e=t.querySelector("svg");e&&e.remove(),t=document.getElementById("time-chart-container"),e=t.querySelector("svg"),e&&e.remove()},async getSchoolData(){this.progressChartMode="school",await this.getSchoolProgressData(),await this.getSchoolTimeData()},async getClassData(){this.progressChartMode="teacher",await this.getClassProgressData(this.selectedTeacher.id),await this.getClassTimeData()},async getSchoolProgressData(){await this.analyticsStore.getSchoolProgress(this.tenantId),this.$nextTick(()=>{this.$refs.progressChart&&this.$refs.progressChart.createChart(this.analyticsStore.progress.tenant)})},async getClassProgressData(){await this.analyticsStore.getClassProgress(this.tenantId,this.selectedTeacher.id),this.$nextTick(()=>{this.$refs.progressChart&&this.$refs.progressChart.createChart(this.analyticsStore.progress.class)})},async getSchoolTimeData(){await this.analyticsStore.getSchoolTime(this.tenantId),this.$nextTick(()=>{this.$refs.timeChart&&this.$refs.timeChart.createChart(this.analyticsStore.time.tenant)})},async getClassTimeData(){await this.analyticsStore.getClassTime(this.selectedTeacher.id),this.$nextTick(()=>{this.$refs.timeChart&&this.$refs.timeChart.createChart(this.analyticsStore.time.class)})},async getFailedAssessmentsBySubject(){try{const t=await fetch(`/student-analytics/failed-assessments-by-subject/tenant/${this.tenantId}`);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);this.analyticsStore.rootSubjectsFailedAssessments=await t.json()}catch(t){console.error("Error fetching cohort mastered assessments:",t),this.analyticsStore.rootSubjectsFailedAssessments=[]}},async getSchoolCostData(){await this.analyticsStore.getSchoolCost(this.tenantId,"weekly"),this.$nextTick(()=>{this.$refs.costChart&&this.$refs.costChart.createChart(this.analyticsStore.cost.tenant)})}}},Et={class:"dashboard"},Rt={key:0,class:"col-lg-1 col-md-2"},Ft={class:"d-flex bg-light rounded p-2"},qt={class:"d-flex bg-light rounded p-2"},Lt=["onClick"],Ht={class:"container-fluid"},zt={class:"dash-row row"},Nt={class:"col-md h-100 p-2"},Wt={class:"chart-card h-100"},Ot={id:"progress-chart-container"},Vt={key:1},Yt={class:"col-md h-100 p-2"},Ut={class:"chart-card h-100"},Gt={id:"failed-chart-container"},Jt={key:1},Kt={class:"dash-row row"},Qt={class:"col-md position-relative h-100 p-2"},Xt={class:"chart-card h-100"},Zt={id:"cost-chart-container"},te={key:1},ee={class:"col-md h-100 p-2"},se={class:"chart-card h-100"},ae={id:"time-chart-container"},re={key:1};function oe(t,e,o,r,i,d){const c=y("RouterLink"),g=y("SchoolProgressChart"),m=y("TenantFailedAssessmentsByRootSubjectHorizontalBarChart"),p=y("SchoolCostChart"),n=y("SchoolTimeChart");return l(),u("div",Et,[i.teachers.length>0?(l(),u("div",Rt,[a("div",Ft,[a("button",{class:A(i.isSchoolSelected?"isCurrentlySelected":"side-buttons"),onClick:e[0]||(e[0]=s=>d.selectElement("school"))}," school ",2)]),(l(!0),u(F,null,H(i.teachers,s=>(l(),u("div",{key:s.id},[a("div",qt,[a("button",{class:A(s.id===i.selectedTeacher.id?"isCurrentlySelected":"side-buttons"),onClick:h=>d.selectElement(s)},z(s.username),11,Lt)])]))),128))])):x("",!0),a("div",{class:A([{"col-lg-11":i.teachers.length>0,"col-md-10":i.teachers.length>0,"col-lg-12":i.teachers.length==0},"dashboard"])},[a("div",Ht,[a("div",zt,[a("div",Nt,[a("div",Wt,[v(c,{to:"/progress-report",class:"",target:"_blank"},{default:f(()=>e[1]||(e[1]=[a("h2",{class:"heading h5"},"Progress",-1)])),_:1,__:[1]}),a("div",Ot,[i.progressChartMode=="school"&&r.analyticsStore.progress.tenant.length>0||i.progressChartMode=="class"&&r.analyticsStore.progress.class.length>0?(l(),_(g,{key:0,ref:"progressChart"},null,512)):(l(),u("p",Vt,"No data yet"))])])]),a("div",Yt,[a("div",Ut,[v(c,{to:"/challenges-report",class:"",target:"_blank"},{default:f(()=>e[2]||(e[2]=[a("h2",{class:"heading h5"},"Challenges",-1)])),_:1,__:[2]}),a("div",Gt,[r.analyticsStore.rootSubjectsFailedAssessments.length>0?(l(),_(m,{key:0,data:r.analyticsStore.rootSubjectsFailedAssessments,ref:"failedAssessmentsChart"},null,8,["data"])):(l(),u("p",Jt,"No challenges yet"))])])])]),a("div",Kt,[a("div",Qt,[a("div",Xt,[v(c,{to:"/cost-report",class:"",target:"_blank"},{default:f(()=>e[3]||(e[3]=[a("h2",{class:"heading h5"},"Cost",-1)])),_:1,__:[3]}),a("div",Zt,[r.analyticsStore.cost.tenant.length>0||r.analyticsStore.cost.class.length>0?(l(),_(p,{key:0,ref:"costChart"},null,512)):(l(),u("p",te,"No data yet"))])])]),a("div",ee,[a("div",se,[v(c,{to:"/engagement-report",target:"_blank"},{default:f(()=>e[4]||(e[4]=[a("h2",{class:"heading h5"},"Weekly engagement",-1)])),_:1,__:[4]}),a("div",ae,[r.analyticsStore.time.tenant.length>0||r.analyticsStore.time.class.length>0?(l(),_(n,{key:0,ref:"timeChart"},null,512)):(l(),u("p",re,"No data"))])])])])])],2)])}const ne=S(Mt,[["render",oe],["__scopeId","data-v-8ede5924"]]),ie={name:"TeacherProgressChart",props:[],data(){return{axisData:[]}},mounted(){},methods:{createChart(t){if(t.class.length==0)this.axisData=t.tenant;else if(t.tenant.length==0)this.axisData=t.class;else{const h=t.class.reduce((k,$)=>Math.max(k,$.quantity),-1/0),C=t.tenant.reduce((k,$)=>Math.max(k,$.quantity),-1/0);h>=C?this.axisData=t.class:this.axisData=t.tenant}const e=Object.entries(t).map(([h,C])=>({name:h,values:C})),o=document.getElementById("progress-chart-container").clientWidth,r=document.getElementById("progress-chart-container").clientHeight,i=5,d=20,c=20,g=20,m=B(P(this.axisData,h=>h.date),[g,o-d]),p=w([0,D(this.axisData,h=>h.quantity)],[r-c,i]),n=I().x(h=>m(h.date)).y(h=>p(h.quantity)),s=b("#progress-chart-container").append("svg").attr("width","100%").attr("height","100%").attr("viewBox",[0,0,+Math.min(o,r),+Math.min(o,r)]).attr("preserveAspectRatio","xMinYMin");s.append("g").attr("transform",`translate(0,${r-20})`).call(j(m).ticks(o/100).tickSizeOuter(0)),s.append("g").attr("transform",`translate(${g},0)`).call(T(p).ticks(r/80)).call(h=>h.selectAll(".tick line").clone().attr("x2",o-g-d).attr("stroke-opacity",.1)),s.selectAll(".line").data(e).join("path").attr("fill","none").attr("stroke",h=>h.name=="class"?"green":"#ff7f0e").attr("stroke-width",h=>h.name=="class"?3:2).attr("d",h=>n(h.values))}}};function ce(t,e,o,r,i,d){return null}const le=S(ie,[["render",ce]]),he={name:"SchoolTimeChart",props:[],data(){return{axisData:[]}},mounted(){},methods:{createChart(t){if(t.class.length==0)this.axisData=t.tenant;else if(t.tenant.length==0)this.axisData=t.class;else{const h=t.class.reduce((k,$)=>Math.max(k,$.quantity),-1/0),C=t.tenant.reduce((k,$)=>Math.max(k,$.quantity),-1/0);h>=C?this.axisData=t.class:this.axisData=t.tenant}const e=Object.entries(t).map(([h,C])=>({name:h,values:C})),o=document.getElementById("time-chart-container").clientWidth,r=document.getElementById("time-chart-container").clientHeight,i=0,d=20,c=20,g=25,m=B(P(this.axisData,h=>h.date),[g,o-d]),p=w([0,D(this.axisData,h=>h.minutes)],[r-c,i]),n=I().x(h=>m(h.date)).y(h=>p(h.minutes)),s=b("#time-chart-container").append("svg").attr("width","100%").attr("height","100%").attr("viewBox",[0,0,+Math.min(o,r),+Math.min(o,r)]).attr("preserveAspectRatio","xMinYMin");s.append("g").attr("transform",`translate(0,${r-c})`).call(j(m).ticks(o/100).tickSizeOuter(0)),s.append("g").attr("transform",`translate(${g},0)`).call(T(p).ticks(r/80)).call(h=>h.selectAll(".tick line").clone().attr("x2",o-g-d).attr("stroke-opacity",.1)),s.selectAll(".line").data(e).join("path").attr("fill","none").attr("stroke",h=>h.name=="class"?"RoyalBlue":"#ff7f0e").attr("stroke-width",h=>h.name=="class"?3:2).attr("d",h=>n(h.values))}}};function de(t,e,o,r,i,d){return null}const ge=S(he,[["render",de]]),me={name:"TenantTokensPerDayLineChart",props:[],data(){return{}},methods:{createChart(t){const e=document.getElementById("cost-chart-container").clientWidth,o=document.getElementById("cost-chart-container").clientHeight,r=0,i=20,d=20,c=25,g=B(P(t,s=>s.date),[c,e-i]),m=w([0,D(t,s=>s.quantity)],[o-d,r]),p=I().x(s=>g(s.date)).y(s=>m(s.quantity)),n=b("#cost-chart-container").append("svg").attr("width",e).attr("height",o).attr("viewBox",[0,0,e,o]).attr("style","max-width: 100%; height: auto; height: intrinsic;");n.append("g").attr("transform",`translate(0,${o-d})`).call(j(g).ticks(t.length).tickSizeOuter(0)),n.append("g").attr("transform",`translate(${c},0)`).call(T(m).ticks(o/80)).call(s=>s.selectAll(".tick line").clone().attr("x2",e-c-i).attr("stroke-opacity",.1)).call(s=>s.append("text").attr("x",-c).attr("y",10).attr("fill","currentColor").attr("text-anchor","start").text("â†‘ Tokens")),n.append("path").attr("fill","none").attr("stroke","teal").attr("stroke-width",3).attr("d",p(t))}}};function ue(t,e,o,r,i,d){return null}const pe=S(me,[["render",ue]]);const _e={name:"Teacher-Analytics-Dashboard",setup(){const t=E(),e=M(),o=R();return{userDetailsStore:t,analyticsStore:e,usersStore:o}},data(){return{progressChartMode:"teacher"}},components:{TeacherProgressChart:le,TeacherTimeChart:ge,TeacherCostChart:pe,TenantFailedAssessmentsByRootSubjectHorizontalBarChart:q},async created(){await this.getProgressData(),await this.getTimeData(),await this.getCostData(),await this.getChallengesData()},methods:{async getProgressData(){await this.analyticsStore.getSchoolProgress(this.userDetailsStore.tenantId),await this.analyticsStore.getClassProgress(this.userDetailsStore.userId),this.$nextTick(()=>{this.$refs.progressChart&&this.$refs.progressChart.createChart(this.analyticsStore.progress)})},async getTimeData(){await this.analyticsStore.getClassTime(this.userDetailsStore.userId),await this.analyticsStore.getSchoolTime(this.userDetailsStore.tenantId),this.$nextTick(()=>{this.$refs.timeChart&&this.$refs.timeChart.createChart(this.analyticsStore.time)})},async getCostData(){await this.analyticsStore.getClassCost(this.userDetailsStore.userId,"weekly"),await this.analyticsStore.getSchoolCost(this.userDetailsStore.tenantId,"weekly"),this.$nextTick(()=>{this.$refs.costChart&&this.$refs.costChart.createChart(this.analyticsStore.cost.class)})},async getComparisonData(){try{const t=await fetch(`/student-analytics/passed-assessments-by-subject/tenant/${this.userDetailsStore.tenantId}`);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);this.analyticsStore.rootSubjectsPassedAssessments=await t.json(),this.$nextTick(()=>{this.$refs.comparisonChart&&this.$refs.comparisonChart.createChart(this.analyticsStore.rootSubjectsPassedAssessments)})}catch(t){console.error("Error fetching cohort mastered assessments:",t),this.analyticsStore.rootSubjectsPassedAssessments=[]}},async getChallengesData(){await this.analyticsStore.getTeacherClassFailedAssessmentsBySubject(this.userDetailsStore.userId)}}},ye={class:"dashboard"},fe={class:"container-fluid"},Se={class:"dash-row row"},Ce={class:"col-md h-100 p-2"},ke={class:"chart-card h-100"},$e={id:"progress-chart-container",class:"position-relative"},ve={class:"col-md h-100 p-2"},xe={class:"chart-card h-100"},we={id:"failed-chart-container"},Te={key:1},De={class:"dash-row row"},be={class:"col-md position-relative h-100 p-2"},Ae={class:"chart-card h-100"},Be={id:"cost-chart-container"},Ie={key:1},Pe={class:"col-md position-relative h-100 p-2"},je={class:"chart-card h-100"},Me={id:"time-chart-container"};function Ee(t,e,o,r,i,d){const c=y("RouterLink"),g=y("TeacherProgressChart"),m=y("TenantFailedAssessmentsByRootSubjectHorizontalBarChart"),p=y("TeacherCostChart"),n=y("TeacherTimeChart");return l(),u("div",ye,[a("div",fe,[a("div",Se,[a("div",Ce,[a("div",ke,[v(c,{to:"/progress-report",class:"",target:"_blank"},{default:f(()=>e[0]||(e[0]=[a("h2",{class:"heading h5"},"Progress",-1)])),_:1,__:[0]}),a("div",$e,[r.analyticsStore.progress.tenant.length>0||r.analyticsStore.progress.class.length>0?(l(),_(g,{key:0,ref:"progressChart"},null,512)):x("",!0)]),e[1]||(e[1]=a("figcaption",null,[a("span",{style:{color:"green"}},"Your class"),L(" | "),a("span",{style:{color:"#ff7f0e"}},"the whole school")],-1))])]),a("div",ve,[a("div",xe,[v(c,{to:"/challenges-report",class:"",target:"_blank"},{default:f(()=>e[2]||(e[2]=[a("h2",{class:"heading h5"},"Challenges",-1)])),_:1,__:[2]}),a("div",we,[r.analyticsStore.cohortRootSubjectsFailedAssessments.length>0?(l(),_(m,{key:0,data:r.analyticsStore.cohortRootSubjectsFailedAssessments},null,8,["data"])):(l(),u("p",Te,"No challenges yet"))])])])]),a("div",De,[a("div",be,[a("div",Ae,[e[3]||(e[3]=a("h2",{class:"heading h5"},"AI usage",-1)),a("div",Be,[r.analyticsStore.cost.tenant.length>0||r.analyticsStore.cost.class.length>0?(l(),_(p,{key:0,ref:"costChart"},null,512)):(l(),u("p",Ie,"No usage yet"))])])]),a("div",Pe,[a("div",je,[v(c,{to:"/engagement-report",class:"chart-heading",target:"_blank"},{default:f(()=>e[4]||(e[4]=[a("h2",{class:"heading h5"},"Engagement",-1)])),_:1,__:[4]}),a("div",Me,[r.analyticsStore.time.tenant.length>0||r.analyticsStore.time.class.length>0?(l(),_(n,{key:0,ref:"timeChart"},null,512)):x("",!0)]),e[5]||(e[5]=a("figcaption",null,[a("span",{style:{color:"green"}},"Your class"),L(" | "),a("span",{style:{color:"#ff7f0e"}},"the whole school")],-1))])])])])])}const Re=S(_e,[["render",Ee],["__scopeId","data-v-75e17e96"]]),Fe={name:"Dashboard",setup(){return{userDetailsStore:E()}},data(){return{}},components:{PlatformAdminDashboard:ne,SchoolAdminDashboard:jt,TeacherAnalyticsDashboard:Re},async created(){}};function qe(t,e,o,r,i,d){const c=y("PlatformAdminDashboard"),g=y("SchoolAdminDashboard"),m=y("TeacherAnalyticsDashboard");return l(),u(F,null,[r.userDetailsStore.role=="platform_admin"?(l(),_(c,{key:0})):x("",!0),r.userDetailsStore.role=="school_admin"?(l(),_(g,{key:1})):x("",!0),r.userDetailsStore.role=="instructor"||r.userDetailsStore.role=="partner"?(l(),_(m,{key:2})):x("",!0)],64)}const Ke=S(Fe,[["render",qe]]);export{Ke as default};
