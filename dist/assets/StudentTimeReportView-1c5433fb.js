import{_ as f,A as _,r,o,c as i,a as s,t as d,s as u,g as c,k as h,b as k,F as y}from"./main-694b4f39.js";import{T as S}from"./TimePerSkillHorizontalBarChart-771ae14b.js";import{S as g}from"./StudentDurationPerDayLineChart-1557f3af.js";import{D as w}from"./downloadCSVBtn-97466661.js";import"./transform-4d0f7c8f.js";import"./string-c67ea49d.js";import"./linear-d9b6cbf2.js";import"./continuous-93813e6c.js";import"./band-2263c9e7.js";import"./sort-fcaf8f38.js";import"./line-d122782f.js";import"./time-3c9385c3.js";import"./point-ea70dc51.js";const P={setup(){return{usersStore:_()}},components:{TimePerSkillHorizontalBarChart:S,StudentDurationPerDayLineChart:g,DownloadCSVBtn:w},data(){return{studentId:this.$route.params.studentId,studentName:null,skillDurations:[],durationsPerDay:[],allSkillsDuration:0,isDataLoaded:!1,totalTimeOnPlatformDownloadData:[],minutesPerSkillDownloadData:[]}},async created(){this.usersStore.users.length<1&&await this.usersStore.getUsers();const t=this.usersStore.users.find(e=>e.id===this.studentId);t&&(this.studentName=t.username),await this.getSkillDuration(),await this.getAllSkillsDuration(),await this.getStudentDurationPerDay(),this.isDataLoaded=!0},methods:{async getSkillDuration(){fetch(`/student-analytics/skill-durations/${this.studentId}`).then(t=>t.json()).then(t=>{this.skillDurations=t;for(let e=0;e<this.skillDurations.length;e++)this.skillDurations[e].formattedQuantity=this.millisToMinutesAndSeconds(this.skillDurations[e].quantity);this.minutesPerSkillDownloadData=this.skillDurations.map(e=>({skill:e.name,quantity:e.formattedQuantity}))}).catch(t=>{console.error("Error fetching last visited skills:",t)})},async getAllSkillsDuration(){fetch(`/student-analytics/all-skills-duration/${this.studentId}`).then(t=>t.json()).then(t=>{this.allSkillsDuration=t.duration}).catch(t=>{console.error("Error fetching last visited skills:",t)})},async getStudentDurationPerDay(){fetch(`/student-analytics/student-duration-per-day/${this.studentId}`).then(t=>t.json()).then(t=>{for(let e=0;e<t.length;e++)t[e].formattedQuantity=t[e].quantity/(1e3*60),t[e].date=new Date(t[e].date);t.sort((e,a)=>e.date-a.date),this.durationsPerDay=t,this.totalTimeOnPlatformDownloadData=this.durationsPerDay.map(e=>({date:e.date,minutes:e.formattedQuantity}))}).catch(t=>{console.error("Error fetching student duration per day:",t)})},millisToMinutesAndSeconds(t){var e=Math.floor(t/6e4),a=(t%6e4/1e3).toFixed(0);return e+":"+(a<10?"0":"")+a}}},T={class:"container"},N={class:"d-flex justify-content-between w-100"},C=s("h1",{class:"heading"},"Time Report",-1),v={class:"secondary-heading h3"},B=s("p",null,[s("em",null," Please note that time spent on external sources (e.g. websites) related to skills is not measured.")],-1),V={key:0},x={class:"secondary-heading d-flex justify-content-between w-100 align-items-center"},b={key:1},j=s("h4",{class:"secondary-heading r"},"All skills",-1),A={class:"secondary-heading d-flex justify-content-between w-100 align-items-center"},I={key:1},L=s("p",null,"No skills visited by this student.",-1),M=[L],E=s("p",null,"Â ",-1);function O(t,e,a,Q,n,m){const l=r("DownloadCSVBtn"),D=r("StudentDurationPerDayLineChart"),p=r("TimePerSkillHorizontalBarChart");return o(),i(y,null,[s("div",T,[s("span",N,[C,s("h2",v,d(n.studentName),1)]),B,n.isDataLoaded?(o(),i("div",V,[s("div",null,[s("h4",x,[u(" Total time on platform "),c(l,{data:n.totalTimeOnPlatformDownloadData,fileName:`Total time on platform - ${n.studentName}`,toolTip:"Download total time on platform data as CSV"},null,8,["data","fileName"])]),n.durationsPerDay.length>0?(o(),h(D,{key:0,data:n.durationsPerDay},null,8,["data"])):(o(),i("p",b,"There is no data to show yet."))]),s("div",null,[j,s("p",null,d(m.millisToMinutesAndSeconds(this.allSkillsDuration)),1),s("h4",A,[u(" Minutes per skill "),c(l,{data:n.minutesPerSkillDownloadData,fileName:`Minutes per skill - ${n.studentName}`,toolTip:"Download minutes per skill data as CSV"},null,8,["data","fileName"])]),n.skillDurations.length>0?(o(),h(p,{key:0,data:n.skillDurations,colour:"darkgreen"},null,8,["data"])):(o(),i("div",I,M))])])):k("",!0)]),E],64)}const $=f(P,[["render",O]]);export{$ as default};
