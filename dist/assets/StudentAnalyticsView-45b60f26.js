import{_,o as n,c as l,f,K as A,r as m,k as u,a as i}from"./main-b1b1baf1.js";import{u as T}from"./TeacherAnalyticsStore-964a39e9.js";import{P as D,A as P}from"./AttemptedAssessmentsTimelineChart-6223fc2c.js";import{F as v}from"./FailedAssessmentsHorizontalBarChart-7208eaf4.js";import{T as w}from"./TimePerSkillHorizontalBarChart-4c5f501d.js";import{S as x}from"./StudentDurationPerDayLineChart-ae7819f8.js";import{s as g}from"./transform-35b9fb9e.js";import{l as C,m as B,a as M,b}from"./linear-c968f95f.js";import{b as H}from"./band-18e9f0c1.js";import{s as z}from"./sort-855cf5d1.js";import"./time-962c8065.js";import"./line-8aa3dac8.js";import"./point-ea70dc51.js";const F={name:"TenantAvgTokensToMasterSkillsHorizontalBarChart",props:["data","colour"],data(){return{padding:60}},mounted(){g("#tenant-avg-tokens-to-master-skills-chart-container");const t=25,s=0,r=0,d=10,a=200,p=1e3,k=Math.ceil((this.data.length+.1)*t)+s+d,o=C().domain([0,B(this.data,e=>e.quantity)]).range([a,p-r]),c=H().domain(z(this.data,e=>-e.quantity).map(e=>e.name)).rangeRound([s,k-d]).padding(.1),y=o.tickFormat(20),h=g("#tenant-avg-tokens-to-master-skills-chart-container").append("svg").attr("width",p).attr("height",k).attr("viewBox",[0,0,p,k]).attr("style","max-width: 100%; height: 100%; font: 14px sans-serif;");h.append("g").attr("fill",this.colour).selectAll().data(this.data).join("rect").attr("x",o(0)).attr("y",e=>c(e.name)).attr("width",e=>o(e.quantity)-o(0)).attr("height",c.bandwidth()),h.append("g").attr("fill","white").attr("text-anchor","end").selectAll().data(this.data).join("text").attr("x",e=>o(e.quantity)).attr("y",e=>c(e.name)+c.bandwidth()/2).attr("dy","0.35em").attr("dx",-4).text(e=>y(e.quantity)).call(e=>e.filter(S=>o(S.quantity)-o(0)<20).attr("dx",4).attr("fill","black").attr("text-anchor","start")),h.append("g").attr("transform",`translate(0,${s})`).call(M(o).ticks(0)).call(e=>e.select(".domain").remove()),h.append("g").attr("transform",`translate(${a},0)`).call(b(c).tickSizeOuter(0))},computed:{}},$={id:"tenant-avg-tokens-to-master-skills-chart-container"};function j(t,s,r,d,a,p){return n(),l("div",$)}const I=_(F,[["render",j],["__scopeId","data-v-6e86d297"]]),q={setup(){const t=f(),s=T(),r=A();return{userDetailsStore:t,teacherAnalyticsStore:s,userSkillsStore:r}},components:{PassedAssessmentsTimelineChart:D,AttemptedAssessmentsTimelineChart:P,FailedAssessmentsHorizontalBarChart:v,TimePerSkillHorizontalBarChart:w,StudentDurationPerDayLineChart:x,StudentAvgTokensToMasterSkillsHorizontalBarChart:I},data(){return{studentId:this.userDetailsStore.userId,assessmentPasses:[],assessmentAttempts:[],multipleFails:[],skillDurations:[],durationsPerDay:[],tokensPerSkills:[]}},async created(){await this.getAssessmentAttempts(),await this.getAssessmentPasses(),await this.teacherAnalyticsStore.getStudentMultipleFails(this.userDetailsStore.userId),await this.getSkillDuration(),await this.getStudentDurationPerDay(),await this.getAvgTokensToMasterSkills()},methods:{async getAssessmentAttempts(){fetch(`/student-analytics/started-unmastered-assessments/${this.userDetailsStore.userId}`).then(t=>t.json()).then(t=>{this.assessmentAttempts=t.map(s=>({...s,url:`/skills/${s.url}`,labelName:`${s.name}`}))}).catch(t=>{console.error("Error fetching last visited skills:",t)})},async getAssessmentPasses(){await this.userSkillsStore.getMasteredSkills(this.userDetailsStore.userId),this.assessmentPasses=this.userSkillsStore.masteredSkills.map(t=>({...t,url:`/skills/${t.url}`,labelName:`${t.name}`}))},async getSkillDuration(){fetch(`/student-analytics/skill-durations/${this.studentId}`).then(t=>t.json()).then(t=>{this.skillDurations=t;for(let s=0;s<this.skillDurations.length;s++)this.skillDurations[s].formattedQuantity=this.millisToMinutesAndSeconds(this.skillDurations[s].quantity)}).catch(t=>{console.error("Error fetching last visited skills:",t)})},async getStudentDurationPerDay(){fetch(`/student-analytics/student-duration-per-day/${this.studentId}`).then(t=>t.json()).then(t=>{for(let s=0;s<t.length;s++)t[s].formattedQuantity=t[s].quantity/1e3,t[s].date=new Date(t[s].date);t.sort((s,r)=>s.date-r.date),this.durationsPerDay=t}).catch(t=>{console.error("Error fetching student duration per day:",t)})},async getAvgTokensToMasterSkills(){try{const t=await fetch(`/student-analytics/avg-tokens-to-master-skills/student/${this.studentId}`);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const s=await t.json();this.tokensPerSkills=Array.isArray(s)?s:[]}catch(t){console.error("Error fetching cohort mastered assessments:",t),this.tokensPerSkills=[]}},millisToMinutesAndSeconds(t){var s=Math.floor(t/6e4),r=(t%6e4/1e3).toFixed(0);return s+":"+(r<10?"0":"")+r},assessmentDate(t){return new Date(t).toLocaleString("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})}}},E={class:"container"},L=i("span",{class:"d-flex justify-content-between w-100"},[i("h1",{class:"heading"},"My Progress")],-1),N=i("h2",{class:"heading"},"Assessments",-1),U=i("h4",{class:"secondary-heading"}," Failed multiple times",-1),Q={key:1},R=i("h4",{class:"secondary-heading"},"Passed",-1),V={key:3},K=i("h4",{class:"secondary-heading"},"Attempted",-1),O={key:5},G=i("h2",{class:"heading"},"Engagement",-1),J=i("h4",null,"Time spent on each skill",-1),W={key:7},X=i("h4",{class:"mt-5"},"Time spent per day",-1),Y={key:9},Z=i("h4",{class:"mt-5"},"Tokens spent per skill",-1),tt={key:11};function st(t,s,r,d,a,p){const k=m("FailedAssessmentsHorizontalBarChart"),o=m("PassedAssessmentsTimelineChart"),c=m("AttemptedAssessmentsTimelineChart"),y=m("TimePerSkillHorizontalBarChart"),h=m("StudentDurationPerDayLineChart"),e=m("StudentAvgTokensToMasterSkillsHorizontalBarChart");return n(),l("div",E,[L,N,U,d.teacherAnalyticsStore.studentMultipleFails.length>0?(n(),u(k,{key:0,data:d.teacherAnalyticsStore.studentMultipleFails,colour:"darkred",class:"mb-5"},null,8,["data"])):(n(),l("p",Q," This student has not failed any assessments more than once yet. ")),R,a.assessmentPasses.length>0?(n(),u(o,{key:2,class:"mb-5",data:a.assessmentPasses},null,8,["data"])):(n(),l("p",V,"This student has not completed any assessments yet.")),K,a.assessmentAttempts.length>0?(n(),u(c,{key:4,class:"mb-5",data:a.assessmentAttempts},null,8,["data"])):(n(),l("p",O,"This student has attempted any assessments yet.")),G,J,a.skillDurations.length>0?(n(),u(y,{key:6,data:a.skillDurations,colour:"purple"},null,8,["data"])):(n(),l("p",W,"No data yet")),X,a.durationsPerDay.length>0?(n(),u(h,{key:8,data:a.durationsPerDay,colour:"purple"},null,8,["data"])):(n(),l("p",Y,"No data yet")),Z,a.tokensPerSkills.length>0?(n(),u(e,{key:10,class:"mb-5",data:a.tokensPerSkills,colour:"purple"},null,8,["data"])):(n(),l("p",tt,"No data yet"))])}const kt=_(q,[["render",st]]);export{kt as default};
