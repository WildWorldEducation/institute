import{_ as S,o as c,c as u,f as M,A as L,r as y,a as r,q as A,F as H,z as O,t as V,b as x,k as p,l as f,p as z,d as N,g as w,s as Y}from"./main-7dc47a4f.js";import{u as F}from"./AnalyticsStore-f3bdac87.js";import"./transform-af9a74a2.js";import{u as B,l as I}from"./line-85f04100.js";import{e as P}from"./extent-4cf1c809.js";import{l as v,a as j,b as T,c as K}from"./linear-5b188edc.js";import{m as D,b as Q}from"./continuous-7328829e.js";import{s as b}from"./string-dd82ab4a.js";import{s as X}from"./sort-ed61f96d.js";import"./time-0457d93b.js";import"./point-ea70dc51.js";const Z={name:"SchoolProgressChart",setup(){return{analyticsStore:F()}},data(){return{}},mounted(){},methods:{createChart(t){this.$parent.progressChartMode==="school"?(this.axisData=t.school,t.school):(this.axisData=t.teacher,t.teacher);const o=document.getElementById("progress-chart-container").clientWidth,a=document.getElementById("progress-chart-container").clientHeight,s=5,n=20,d=20,i=25,g=B(P(this.analyticsStore.progress.tenant,e=>e.date),[i,o-n]),m=v([0,D(this.analyticsStore.progress.tenant,e=>e.quantity)],[a-d,s]),h=I().x(e=>g(e.date)).y(e=>m(e.quantity)),_=b("#progress-chart-container").append("svg").attr("width",o).attr("height",a).attr("viewBox",[0,0,o,a]).attr("style","max-width: 100%; height: auto; height: intrinsic;");_.append("g").attr("transform",`translate(0,${a-20})`).call(j(g).ticks(o/100).tickSizeOuter(0)),_.append("g").attr("transform",`translate(${i},0)`).call(T(m).ticks(a/40)).call(e=>e.select(".domain").remove()).call(e=>e.selectAll(".tick line").clone().attr("x2",o-i-n).attr("stroke-opacity",.2)).call(e=>e.append("text").attr("x",-i).attr("y",10).attr("fill","currentColor").attr("text-anchor","start")),_.append("path").attr("fill","none").attr("stroke","green").attr("stroke-width",3).attr("d",h(t))}}};function tt(t,o,a,s,n,d){return null}const U=S(Z,[["render",tt]]),et={name:"SchoolTimeChart",setup(){return{analyticsStore:F()}},data(){return{}},mounted(){},methods:{createChart(t){const o=document.getElementById("time-chart-container").clientWidth,a=document.getElementById("time-chart-container").clientHeight,s=0,n=20,d=20,i=25,g=B(P(this.analyticsStore.time.tenant,e=>e.date),[i,o-n]),m=v([0,D(this.analyticsStore.time.tenant,e=>e.minutes)],[a-d,s]),h=I().x(e=>g(e.date)).y(e=>m(e.minutes)),_=b("#school-time-chart-container").append("svg").attr("width",o).attr("height",a).attr("viewBox",[0,0,o,a]).attr("style","max-width: 100%; height: auto; height: intrinsic;");_.append("g").attr("transform",`translate(0,${a-d})`).call(j(g).ticks(t.length).tickSizeOuter(0)),_.append("g").attr("transform",`translate(${i},0)`).call(T(m).ticks(a/40)).call(e=>e.select(".domain").remove()).call(e=>e.selectAll(".tick line").clone().attr("x2",o-i-n).attr("stroke-opacity",.2)).call(e=>e.append("text").attr("x",-i).attr("y",10).attr("fill","currentColor").attr("text-anchor","start")),_.append("path").attr("fill","none").attr("stroke","#ff7f0e").attr("stroke-width",3).attr("d",h(t))}}},st={id:"school-time-chart-container"};function at(t,o,a,s,n,d){return c(),u("div",st)}const G=S(et,[["render",at]]),rt={name:"TenantFailedAssessmentsByRootSubjectHorizontalBarChart",props:["data"],data(){return{}},mounted(){const n=document.getElementById("failed-chart-container").clientWidth,d=document.getElementById("failed-chart-container").clientHeight,i=v().domain([0,D(this.data,h=>h.quantity)]).range([200,n-0]),g=Q().domain(X(this.data,h=>-h.quantity).map(h=>h.name)).rangeRound([0,d-10]).padding(.1);i.tickFormat(20);const m=b("#failed-chart-container").append("svg").attr("width",n).attr("height",d).attr("viewBox",[0,0,n,d]).attr("style","max-width: 100%; height: 100%;");m.append("g").attr("fill","darkred").selectAll().data(this.data).join("rect").attr("x",i(0)).attr("y",h=>g(h.name)).attr("width",h=>i(h.quantity)-i(0)).attr("height",g.bandwidth()),m.append("g").attr("fill","white").attr("text-anchor","end").selectAll().data(this.data).join("text").attr("x",h=>i(h.quantity)).attr("y",h=>g(h.name)+g.bandwidth()/2).attr("dy","0.35em").attr("dx",-4).text(h=>h.quantity).call(h=>h.filter(_=>i(_.quantity)-i(0)<20).attr("dx",4).attr("fill","black").attr("text-anchor","start")),m.append("g").attr("transform","translate(0,0)").call(K(i).ticks(0)).call(h=>h.select(".domain").remove()),m.append("g").attr("transform","translate(200,0)").call(T(g).tickSizeOuter(0))}};function ot(t,o,a,s,n,d){return null}const W=S(rt,[["render",ot]]),nt={name:"TenantTokensPerDayLineChart",props:[],data(){return{}},methods:{createChart(t){const o=document.getElementById("cost-chart-container").clientWidth,a=document.getElementById("cost-chart-container").clientHeight,s=20,n=20,d=20,i=25,g=B(P(t,e=>e.date),[i,o-n]),m=v([0,D(t,e=>e.quantity)],[a-d,s]),h=I().x(e=>g(e.date)).y(e=>m(e.quantity)),_=b("#cost-chart-container").append("svg").attr("width",o).attr("height",a).attr("viewBox",[0,0,o,a]).attr("style","max-width: 100%; height: auto; height: intrinsic;");_.append("g").attr("transform",`translate(0,${a-d})`).call(j(g).ticks(t.length).tickSizeOuter(0)),_.append("g").attr("transform",`translate(${i},0)`).call(T(m).ticks(a/80)).call(e=>e.selectAll(".tick line").clone().attr("x2",o-i-n).attr("stroke-opacity",.1)).call(e=>e.append("text").attr("x",-i).attr("y",10).attr("fill","currentColor").attr("text-anchor","start").text("↑ Tokens")),_.append("path").attr("fill","none").attr("stroke","teal").attr("stroke-width",3).attr("d",h(t))}}};function it(t,o,a,s,n,d){return null}const J=S(nt,[["render",it]]);const ct={name:"School-Admin-Class-Dashboard",setup(){const t=M(),o=F(),a=L();return{userDetailsStore:t,analyticsStore:o,usersStore:a}},data(){return{progressChartMode:"school",isAboveTheCurve:!1,teachers:[],selectedTeacher:{},isSchoolSelected:!0}},components:{SchoolProgressChart:U,SchoolTimeChart:G,TenantFailedAssessmentsByRootSubjectHorizontalBarChart:W,SchoolCostChart:J},async created(){this.teachers.length<1&&await this.getTeachers(this.userDetailsStore.tenantId),await this.getSchoolData(),this.analyticsStore.rootSubjectsFailedAssessments.length==0&&await this.getFailedAssessmentsBySubject(),await this.getSchoolCostData()},methods:{async getTeachers(t){const a=await(await fetch("/tenants/instructors/"+t)).json();for(let s=0;s<a.length;s++)a[s].type="teacher";this.teachers=a},async selectElement(t){this.clearCharts(),t.type==="teacher"?(this.selectedTeacher=t,this.isSchoolSelected=!1,await this.getClassData()):t==="school"&&(this.isSchoolSelected=!0,this.selectedTeacher={},await this.getSchoolData())},clearCharts(){this.analyticsStore.progress.class=[],this.analyticsStore.durationPerDay=[];let t=document.getElementById("progress-chart-container"),o=t.querySelector("svg");o&&o.remove(),t=document.getElementById("time-chart-container"),o=t.querySelector("svg"),o&&o.remove()},async getSchoolData(){this.progressChartMode="school",await this.getSchoolProgressData(),await this.getSchoolTimeData()},async getClassData(){this.progressChartMode="teacher",await this.getClassProgressData(this.selectedTeacher.id),await this.getClassTimeData()},async getSchoolProgressData(){await this.analyticsStore.getSchoolProgress(this.userDetailsStore.tenantId),this.$nextTick(()=>{this.$refs.progressChart&&this.$refs.progressChart.createChart(this.analyticsStore.progress.tenant)})},async getClassProgressData(){await this.analyticsStore.getClassProgress(this.selectedTeacher.id),this.$nextTick(()=>{this.$refs.progressChart&&this.$refs.progressChart.createChart(this.analyticsStore.progress.class)})},async getSchoolTimeData(){await this.analyticsStore.getSchoolTime(this.userDetailsStore.tenantId),this.$nextTick(()=>{this.$refs.timeChart&&this.$refs.timeChart.createChart(this.analyticsStore.time.tenant)})},async getClassTimeData(){await this.analyticsStore.getClassTime(this.selectedTeacher.id),this.$nextTick(()=>{this.$refs.timeChart&&this.$refs.timeChart.createChart(this.analyticsStore.time.class)})},async getFailedAssessmentsBySubject(){try{const t=await fetch(`/student-analytics/failed-assessments-by-subject/tenant/${this.userDetailsStore.tenantId}`);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);this.analyticsStore.rootSubjectsFailedAssessments=await t.json()}catch(t){console.error("Error fetching cohort mastered assessments:",t),this.analyticsStore.rootSubjectsFailedAssessments=[]}},async getSchoolCostData(){await this.analyticsStore.getSchoolCost(this.userDetailsStore.tenantId,"weekly"),this.$nextTick(()=>{this.$refs.costChart&&this.$refs.costChart.createChart(this.analyticsStore.cost.tenant)})}}},R=t=>(z("data-v-ddc63e53"),t=t(),N(),t),lt={class:"dashboard"},ht={key:0,class:"col-lg-1 col-md-2"},dt={class:"d-flex bg-light rounded p-2"},gt={class:"d-flex bg-light rounded p-2"},mt=["onClick"],_t={class:"container-fluid"},ut={class:"dash-row row"},pt={class:"col-md h-100"},yt=R(()=>r("h2",{class:"heading h5"},"Progress",-1)),ft={key:1,class:"heading h5"},St={id:"progress-chart-container"},Ct={key:1},kt={class:"col-md"},$t=R(()=>r("h2",{class:"heading h5"},"Challenges",-1)),wt={key:1,class:"heading h5"},xt={id:"failed-chart-container"},vt={key:1},Tt={class:"dash-row row"},Dt={class:"col-md position-relative h-100"},bt=R(()=>r("h2",{class:"heading h5"},"Cost",-1)),At={key:1,class:"heading h5"},Bt={id:"cost-chart-container"},It={key:1},Pt={class:"col-md h-100"},jt=R(()=>r("h2",{class:"heading h5"},"Weekly engagement",-1)),Et={key:1,class:"heading h5"},Ft={id:"time-chart-container"},Mt={key:1};function Rt(t,o,a,s,n,d){const i=y("RouterLink"),g=y("SchoolProgressChart"),m=y("TenantFailedAssessmentsByRootSubjectHorizontalBarChart"),h=y("SchoolCostChart"),_=y("SchoolTimeChart");return c(),u("div",lt,[n.teachers.length>0?(c(),u("div",ht,[r("div",dt,[r("button",{class:A(n.isSchoolSelected?"isCurrentlySelected":"side-buttons"),onClick:o[0]||(o[0]=e=>d.selectElement("school"))}," school ",2)]),(c(!0),u(H,null,O(n.teachers,e=>(c(),u("div",{key:e.id},[r("div",gt,[r("button",{class:A(e.id===n.selectedTeacher.id?"isCurrentlySelected":"side-buttons"),onClick:l=>d.selectElement(e)},V(e.username),11,mt)])]))),128))])):x("",!0),r("div",{class:A([{"col-lg-11":n.teachers.length>0,"col-md-10":n.teachers.length>0,"col-lg-12":n.teachers.length==0},"dashboard"])},[r("div",_t,[r("div",ut,[r("div",pt,[n.progressChartMode=="school"?(c(),p(i,{key:0,to:"/progress-report",class:"",target:"_blank"},{default:f(()=>[yt]),_:1})):(c(),u("h2",ft,"Progress")),r("div",St,[n.progressChartMode=="school"&&s.analyticsStore.progress.tenant.length>0||n.progressChartMode=="teacher"&&s.analyticsStore.progress.class.length>0?(c(),p(g,{key:0,ref:"progressChart"},null,512)):(c(),u("p",Ct,"No data yet"))])]),r("div",kt,[n.progressChartMode=="school"?(c(),p(i,{key:0,to:"/challenges-report",class:"",target:"_blank"},{default:f(()=>[$t]),_:1})):(c(),u("h2",wt,"Challenges")),r("div",xt,[s.analyticsStore.rootSubjectsFailedAssessments.length>0?(c(),p(m,{key:0,data:s.analyticsStore.rootSubjectsFailedAssessments,ref:"failedAssessmentsChart"},null,8,["data"])):(c(),u("p",vt,"No challenges yet"))])])]),r("div",Tt,[r("div",Dt,[n.progressChartMode=="school"?(c(),p(i,{key:0,to:"/cost-report",class:"",target:"_blank"},{default:f(()=>[bt]),_:1})):(c(),u("h2",At,"Cost")),r("div",Bt,[s.analyticsStore.cost.tenant.length>0||s.analyticsStore.cost.class.length>0?(c(),p(h,{key:0,ref:"costChart"},null,512)):(c(),u("p",It,"No data yet"))])]),r("div",Pt,[n.progressChartMode=="school"?(c(),p(i,{key:0,to:"/engagement-report",target:"_blank"},{default:f(()=>[jt]),_:1})):(c(),u("h2",Et,"Weekly engagement")),r("div",Ft,[s.analyticsStore.time.tenant.length>0||s.analyticsStore.time.class.length>0?(c(),p(_,{key:0,ref:"timeChart"},null,512)):(c(),u("p",Mt,"No data"))])])])])],2)])}const qt=S(ct,[["render",Rt],["__scopeId","data-v-ddc63e53"]]);const Lt={name:"Platform-Admin-Class-Dashboard",setup(){const t=M(),o=F(),a=L();return{userDetailsStore:t,analyticsStore:o,usersStore:a}},data(){return{tenantId:this.$route.params.tenantId,progressChartMode:"school",isAboveTheCurve:!1,teachers:[],selectedTeacher:{},isSchoolSelected:!0}},components:{SchoolProgressChart:U,SchoolTimeChart:G,TenantFailedAssessmentsByRootSubjectHorizontalBarChart:W,SchoolCostChart:J},async created(){this.teachers.length<1&&await this.getTeachers(this.tenantId),await this.getSchoolData(),this.analyticsStore.rootSubjectsFailedAssessments.length==0&&await this.getFailedAssessmentsBySubject(),await this.getSchoolCostData()},methods:{async getTeachers(t){const a=await(await fetch("/tenants/instructors/"+t)).json();for(let s=0;s<a.length;s++)a[s].type="teacher";this.teachers=a},async selectElement(t){this.clearCharts(),t.type==="teacher"?(this.selectedTeacher=t,this.isSchoolSelected=!1,await this.getClassData()):t==="school"&&(this.isSchoolSelected=!0,this.selectedTeacher={},await this.getSchoolData())},clearCharts(){this.analyticsStore.progress.class=[],this.analyticsStore.durationPerDay=[];let t=document.getElementById("progress-chart-container"),o=t.querySelector("svg");o&&o.remove(),t=document.getElementById("time-chart-container"),o=t.querySelector("svg"),o&&o.remove()},async getSchoolData(){this.progressChartMode="school",await this.getSchoolProgressData(),await this.getSchoolTimeData()},async getClassData(){this.progressChartMode="teacher",await this.getClassProgressData(this.selectedTeacher.id),await this.getClassTimeData()},async getSchoolProgressData(){await this.analyticsStore.getSchoolProgress(this.tenantId),this.$nextTick(()=>{this.$refs.progressChart&&this.$refs.progressChart.createChart(this.analyticsStore.progress.tenant)})},async getClassProgressData(){await this.analyticsStore.getClassProgress(this.tenantId,this.selectedTeacher.id),this.$nextTick(()=>{this.$refs.progressChart&&this.$refs.progressChart.createChart(this.analyticsStore.progress.class)})},async getSchoolTimeData(){await this.analyticsStore.getSchoolTime(this.tenantId),this.$nextTick(()=>{this.$refs.timeChart&&this.$refs.timeChart.createChart(this.analyticsStore.time.tenant)})},async getClassTimeData(){await this.analyticsStore.getClassTime(this.selectedTeacher.id),this.$nextTick(()=>{this.$refs.timeChart&&this.$refs.timeChart.createChart(this.analyticsStore.time.class)})},async getFailedAssessmentsBySubject(){try{const t=await fetch(`/student-analytics/failed-assessments-by-subject/tenant/${this.tenantId}`);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);this.analyticsStore.rootSubjectsFailedAssessments=await t.json()}catch(t){console.error("Error fetching cohort mastered assessments:",t),this.analyticsStore.rootSubjectsFailedAssessments=[]}},async getSchoolCostData(){await this.analyticsStore.getSchoolCost(this.tenantId,"weekly"),this.$nextTick(()=>{this.$refs.costChart&&this.$refs.costChart.createChart(this.analyticsStore.cost.tenant)})}}},q=t=>(z("data-v-698f898b"),t=t(),N(),t),Ht={class:"dashboard"},zt={key:0,class:"col-lg-1 col-md-2"},Nt={class:"d-flex bg-light rounded p-2"},Wt={class:"d-flex bg-light rounded p-2"},Ot=["onClick"],Vt={class:"container-fluid"},Yt={class:"dash-row row"},Ut={class:"col-md h-100"},Gt=q(()=>r("h2",{class:"heading h5"},"Progress",-1)),Jt={id:"progress-chart-container"},Kt={key:1},Qt={class:"col-md"},Xt=q(()=>r("h2",{class:"heading h5"},"Challenges",-1)),Zt={id:"failed-chart-container"},te={key:1},ee={class:"dash-row row"},se={class:"col-md position-relative h-100"},ae=q(()=>r("h2",{class:"heading h5"},"Cost",-1)),re={id:"cost-chart-container"},oe={key:1},ne={class:"col-md h-100"},ie=q(()=>r("h2",{class:"heading h5"},"Weekly engagement",-1)),ce={id:"time-chart-container"},le={key:1};function he(t,o,a,s,n,d){const i=y("RouterLink"),g=y("SchoolProgressChart"),m=y("TenantFailedAssessmentsByRootSubjectHorizontalBarChart"),h=y("SchoolCostChart"),_=y("SchoolTimeChart");return c(),u("div",Ht,[n.teachers.length>0?(c(),u("div",zt,[r("div",Nt,[r("button",{class:A(n.isSchoolSelected?"isCurrentlySelected":"side-buttons"),onClick:o[0]||(o[0]=e=>d.selectElement("school"))}," school ",2)]),(c(!0),u(H,null,O(n.teachers,e=>(c(),u("div",{key:e.id},[r("div",Wt,[r("button",{class:A(e.id===n.selectedTeacher.id?"isCurrentlySelected":"side-buttons"),onClick:l=>d.selectElement(e)},V(e.username),11,Ot)])]))),128))])):x("",!0),r("div",{class:A([{"col-lg-11":n.teachers.length>0,"col-md-10":n.teachers.length>0,"col-lg-12":n.teachers.length==0},"dashboard"])},[r("div",Vt,[r("div",Yt,[r("div",Ut,[w(i,{to:"/progress-report",class:"",target:"_blank"},{default:f(()=>[Gt]),_:1}),r("div",Jt,[n.progressChartMode=="school"&&s.analyticsStore.progress.tenant.length>0||n.progressChartMode=="class"&&s.analyticsStore.progress.class.length>0?(c(),p(g,{key:0,ref:"progressChart"},null,512)):(c(),u("p",Kt,"No data yet"))])]),r("div",Qt,[w(i,{to:"/challenges-report",class:"",target:"_blank"},{default:f(()=>[Xt]),_:1}),r("div",Zt,[s.analyticsStore.rootSubjectsFailedAssessments.length>0?(c(),p(m,{key:0,data:s.analyticsStore.rootSubjectsFailedAssessments,ref:"failedAssessmentsChart"},null,8,["data"])):(c(),u("p",te,"No challenges yet"))])])]),r("div",ee,[r("div",se,[w(i,{to:"/cost-report",class:"",target:"_blank"},{default:f(()=>[ae]),_:1}),r("div",re,[s.analyticsStore.cost.tenant.length>0||s.analyticsStore.cost.class.length>0?(c(),p(h,{key:0,ref:"costChart"},null,512)):(c(),u("p",oe,"No data yet"))])]),r("div",ne,[w(i,{to:"/engagement-report",target:"_blank"},{default:f(()=>[ie]),_:1}),r("div",ce,[s.analyticsStore.time.tenant.length>0||s.analyticsStore.time.class.length>0?(c(),p(_,{key:0,ref:"timeChart"},null,512)):(c(),u("p",le,"No data"))])])])])],2)])}const de=S(Lt,[["render",he],["__scopeId","data-v-698f898b"]]),ge={name:"TeacherProgressChart",props:[],data(){return{axisData:[]}},mounted(){},methods:{createChart(t){if(t.class.length==0)this.axisData=t.tenant;else if(t.tenant.length==0)this.axisData=t.class;else{const l=t.class.reduce((k,$)=>Math.max(k,$.quantity),-1/0),C=t.tenant.reduce((k,$)=>Math.max(k,$.quantity),-1/0);l>=C?this.axisData=t.class:this.axisData=t.tenant}const o=Object.entries(t).map(([l,C])=>({name:l,values:C})),a=document.getElementById("progress-chart-container").clientWidth,s=document.getElementById("progress-chart-container").clientHeight,n=5,d=20,i=20,g=20,m=B(P(this.axisData,l=>l.date),[g,a-d]),h=v([0,D(this.axisData,l=>l.quantity)],[s-i,n]),_=I().x(l=>m(l.date)).y(l=>h(l.quantity)),e=b("#progress-chart-container").append("svg").attr("width","100%").attr("height","100%").attr("viewBox",[0,0,+Math.min(a,s),+Math.min(a,s)]).attr("preserveAspectRatio","xMinYMin");e.append("g").attr("transform",`translate(0,${s-20})`).call(j(m).ticks(a/100).tickSizeOuter(0)),e.append("g").attr("transform",`translate(${g},0)`).call(T(h).ticks(s/80)).call(l=>l.selectAll(".tick line").clone().attr("x2",a-g-d).attr("stroke-opacity",.1)),e.selectAll(".line").data(o).join("path").attr("fill","none").attr("stroke",l=>l.name=="class"?"green":"#ff7f0e").attr("stroke-width",l=>l.name=="class"?3:2).attr("d",l=>_(l.values))}}};function me(t,o,a,s,n,d){return null}const _e=S(ge,[["render",me]]),ue={name:"SchoolTimeChart",props:[],data(){return{axisData:[]}},mounted(){},methods:{createChart(t){if(t.class.length==0)this.axisData=t.tenant;else if(t.tenant.length==0)this.axisData=t.class;else{const l=t.class.reduce((k,$)=>Math.max(k,$.quantity),-1/0),C=t.tenant.reduce((k,$)=>Math.max(k,$.quantity),-1/0);l>=C?this.axisData=t.class:this.axisData=t.tenant}const o=Object.entries(t).map(([l,C])=>({name:l,values:C})),a=document.getElementById("time-chart-container").clientWidth,s=document.getElementById("time-chart-container").clientHeight,n=0,d=20,i=20,g=25,m=B(P(this.axisData,l=>l.date),[g,a-d]),h=v([0,D(this.axisData,l=>l.minutes)],[s-i,n]),_=I().x(l=>m(l.date)).y(l=>h(l.minutes)),e=b("#time-chart-container").append("svg").attr("width","100%").attr("height","100%").attr("viewBox",[0,0,+Math.min(a,s),+Math.min(a,s)]).attr("preserveAspectRatio","xMinYMin");e.append("g").attr("transform",`translate(0,${s-i})`).call(j(m).ticks(a/100).tickSizeOuter(0)),e.append("g").attr("transform",`translate(${g},0)`).call(T(h).ticks(s/80)).call(l=>l.selectAll(".tick line").clone().attr("x2",a-g-d).attr("stroke-opacity",.1)),e.selectAll(".line").data(o).join("path").attr("fill","none").attr("stroke",l=>l.name=="class"?"RoyalBlue":"#ff7f0e").attr("stroke-width",l=>l.name=="class"?3:2).attr("d",l=>_(l.values))}}};function pe(t,o,a,s,n,d){return null}const ye=S(ue,[["render",pe]]),fe={name:"TenantTokensPerDayLineChart",props:[],data(){return{}},methods:{createChart(t){const o=document.getElementById("cost-chart-container").clientWidth,a=document.getElementById("cost-chart-container").clientHeight,s=0,n=20,d=20,i=25,g=B(P(t,e=>e.date),[i,o-n]),m=v([0,D(t,e=>e.quantity)],[a-d,s]),h=I().x(e=>g(e.date)).y(e=>m(e.quantity)),_=b("#cost-chart-container").append("svg").attr("width",o).attr("height",a).attr("viewBox",[0,0,o,a]).attr("style","max-width: 100%; height: auto; height: intrinsic;");_.append("g").attr("transform",`translate(0,${a-d})`).call(j(g).ticks(t.length).tickSizeOuter(0)),_.append("g").attr("transform",`translate(${i},0)`).call(T(m).ticks(a/80)).call(e=>e.selectAll(".tick line").clone().attr("x2",o-i-n).attr("stroke-opacity",.1)).call(e=>e.append("text").attr("x",-i).attr("y",10).attr("fill","currentColor").attr("text-anchor","start").text("↑ Tokens")),_.append("path").attr("fill","none").attr("stroke","teal").attr("stroke-width",3).attr("d",h(t))}}};function Se(t,o,a,s,n,d){return null}const Ce=S(fe,[["render",Se]]);const ke={name:"Teacher-Analytics-Dashboard",setup(){const t=M(),o=F(),a=L();return{userDetailsStore:t,analyticsStore:o,usersStore:a}},data(){return{progressChartMode:"teacher"}},components:{TeacherProgressChart:_e,TeacherTimeChart:ye,TeacherCostChart:Ce,TenantFailedAssessmentsByRootSubjectHorizontalBarChart:W},async created(){await this.getProgressData(),await this.getTimeData(),await this.getCostData(),await this.getChallengesData()},methods:{async getProgressData(){await this.analyticsStore.getSchoolProgress(this.userDetailsStore.tenantId),await this.analyticsStore.getClassProgress(this.userDetailsStore.userId),this.$nextTick(()=>{this.$refs.progressChart&&this.$refs.progressChart.createChart(this.analyticsStore.progress)})},async getTimeData(){await this.analyticsStore.getClassTime(this.userDetailsStore.userId),await this.analyticsStore.getSchoolTime(this.userDetailsStore.tenantId),this.$nextTick(()=>{this.$refs.timeChart&&this.$refs.timeChart.createChart(this.analyticsStore.time)})},async getCostData(){await this.analyticsStore.getClassCost(this.userDetailsStore.userId,"weekly"),await this.analyticsStore.getSchoolCost(this.userDetailsStore.tenantId,"weekly"),this.$nextTick(()=>{this.$refs.costChart&&this.$refs.costChart.createChart(this.analyticsStore.cost.class)})},async getComparisonData(){try{const t=await fetch(`/student-analytics/passed-assessments-by-subject/tenant/${this.userDetailsStore.tenantId}`);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);this.analyticsStore.rootSubjectsPassedAssessments=await t.json(),this.$nextTick(()=>{this.$refs.comparisonChart&&this.$refs.comparisonChart.createChart(this.analyticsStore.rootSubjectsPassedAssessments)})}catch(t){console.error("Error fetching cohort mastered assessments:",t),this.analyticsStore.rootSubjectsPassedAssessments=[]}},async getChallengesData(){await this.analyticsStore.getTeacherClassFailedAssessmentsBySubject(this.userDetailsStore.userId)}}},E=t=>(z("data-v-e92d3877"),t=t(),N(),t),$e={class:"dashboard"},we={class:"container-fluid"},xe={class:"dash-row row"},ve={class:"col-md h-100"},Te=E(()=>r("h2",{class:"heading h5"},"Progress",-1)),De={id:"progress-chart-container",class:"position-relative"},be=E(()=>r("figcaption",null,[r("span",{style:{color:"green"}},"Your class"),Y(" | "),r("span",{style:{color:"#ff7f0e"}},"the whole school")],-1)),Ae={class:"col-md h-100"},Be=E(()=>r("h2",{class:"heading h5"},"Challenges",-1)),Ie={id:"failed-chart-container"},Pe={key:1},je={class:"dash-row row"},Ee={class:"col-md position-relative h-100"},Fe=E(()=>r("h2",{class:"heading h5"},"AI usage",-1)),Me={id:"cost-chart-container"},Re={key:1},qe={class:"col-md position-relative h-100"},Le=E(()=>r("h2",{class:"heading h5"},"Engagement",-1)),He={id:"time-chart-container"},ze=E(()=>r("figcaption",null,[r("span",{style:{color:"green"}},"Your class"),Y(" | "),r("span",{style:{color:"#ff7f0e"}},"the whole school")],-1));function Ne(t,o,a,s,n,d){const i=y("RouterLink"),g=y("TeacherProgressChart"),m=y("TenantFailedAssessmentsByRootSubjectHorizontalBarChart"),h=y("TeacherCostChart"),_=y("TeacherTimeChart");return c(),u("div",$e,[r("div",we,[r("div",xe,[r("div",ve,[w(i,{to:"/progress-report",class:"",target:"_blank"},{default:f(()=>[Te]),_:1}),r("div",De,[s.analyticsStore.progress.tenant.length>0||s.analyticsStore.progress.class.length>0?(c(),p(g,{key:0,ref:"progressChart"},null,512)):x("",!0)]),be]),r("div",Ae,[w(i,{to:"/challenges-report",class:"",target:"_blank"},{default:f(()=>[Be]),_:1}),r("div",Ie,[s.analyticsStore.cohortRootSubjectsFailedAssessments.length>0?(c(),p(m,{key:0,data:s.analyticsStore.cohortRootSubjectsFailedAssessments},null,8,["data"])):(c(),u("p",Pe,"No challenges yet"))])])]),r("div",je,[r("div",Ee,[Fe,r("div",Me,[s.analyticsStore.cost.tenant.length>0||s.analyticsStore.cost.class.length>0?(c(),p(h,{key:0,ref:"costChart"},null,512)):(c(),u("p",Re,"No usage yet"))])]),r("div",qe,[w(i,{to:"/engagement-report",class:"chart-heading",target:"_blank"},{default:f(()=>[Le]),_:1}),r("div",He,[s.analyticsStore.time.tenant.length>0||s.analyticsStore.time.class.length>0?(c(),p(_,{key:0,ref:"timeChart"},null,512)):x("",!0)]),ze])])])])}const We=S(ke,[["render",Ne],["__scopeId","data-v-e92d3877"]]),Oe={name:"Dashboard",setup(){return{userDetailsStore:M()}},data(){return{}},components:{PlatformAdminDashboard:de,SchoolAdminDashboard:qt,TeacherAnalyticsDashboard:We},async created(){}};function Ve(t,o,a,s,n,d){const i=y("PlatformAdminDashboard"),g=y("SchoolAdminDashboard"),m=y("TeacherAnalyticsDashboard");return c(),u(H,null,[s.userDetailsStore.role=="platform_admin"?(c(),p(i,{key:0})):x("",!0),s.userDetailsStore.role=="school_admin"?(c(),p(g,{key:1})):x("",!0),s.userDetailsStore.role=="instructor"||s.userDetailsStore.role=="partner"?(c(),p(m,{key:2})):x("",!0)],64)}const as=S(Oe,[["render",Ve]]);export{as as default};
