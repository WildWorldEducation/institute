import{_ as f,o as g,c as w,f as E,A as q,r as u,a as i,g as x,l as $,k as D,b as C,E as R,p as L,d as V,F as N}from"./main-4e106433.js";import{u as H}from"./AnalyticsStore-53c64b11.js";import"./transform-4d0f7c8f.js";import{u as T,l as A}from"./line-d122782f.js";import{e as I}from"./time-3c9385c3.js";import{l as b,c as B,b as k,a as W}from"./linear-d9b6cbf2.js";import{m as P}from"./continuous-93813e6c.js";import{s as S}from"./string-c67ea49d.js";import{b as F,o as O}from"./band-2263c9e7.js";import{s as U}from"./sort-fcaf8f38.js";import{c as z}from"./category10-63f9141e.js";import"./point-ea70dc51.js";import"./colors-98f238a0.js";const Q={name:"SchoolProgressChart",props:[],data(){return{axisData:[]}},mounted(){},methods:{createChart(t){let r=[];this.$parent.progressChartMode==="school"?(this.axisData=t.school,r=t.school):(this.axisData=t.teacher,r=t.teacher);const s=document.getElementById("progress-chart-container").clientWidth,o=document.getElementById("progress-chart-container").clientHeight,h=5,l=20,c=20,n=20,d=T(I(this.axisData,e=>e.date),[n,s-l]),p=b([0,P(this.axisData,e=>e.quantity)],[o-c,h]),m=A().x(e=>d(e.date)).y(e=>p(e.quantity)),a=S("#progress-chart-container").append("svg").attr("width",s).attr("height",o).attr("viewBox",[0,0,s,o]).attr("style","max-width: 100%; height: auto; height: intrinsic;");a.append("g").attr("transform",`translate(0,${o-20})`).call(B(d).ticks(s/100).tickSizeOuter(0)),a.append("g").attr("transform",`translate(${n},0)`).call(k(p).ticks(o/40)).call(e=>e.select(".domain").remove()).call(e=>e.selectAll(".tick line").clone().attr("x2",s-n-l).attr("stroke-opacity",.2)).call(e=>e.append("text").attr("x",-n).attr("y",10).attr("fill","currentColor").attr("text-anchor","start")),a.append("path").attr("fill","none").attr("stroke","green").attr("stroke-width",3).attr("d",m(r))}}};function Y(t,r,s,o,h,l){return null}const G=f(Q,[["render",Y]]),J={name:"SchoolComparisonChart",props:["colour"],data(){return{}},mounted(){},methods:{createChart(t){S("#school-comparison-chart-container");const r=40,s=0,o=20,h=10,l=200,c=1e3,n=Math.ceil((t.length+.1)*r)+s+h,d=b().domain([0,P(t,a=>a.quantity)]).range([l,c-o]),p=F().domain(U(t,a=>-a.quantity).map(a=>a.name)).rangeRound([s,n-h]).padding(.1);d.tickFormat(20);const m=S("#school-comparison-chart-container").append("svg").attr("width",c).attr("height",n).attr("viewBox",[0,0,c,n]).attr("style","max-width: 100%; height: 100%; font: 16px sans-serif;");m.append("g").selectAll().data(t).join("rect").attr("x",d(0)).attr("y",a=>p(a.name)).attr("width",a=>d(a.quantity)-d(0)).attr("height",p.bandwidth()).attr("fill",function(a){return a.name=="Language"?"DarkMagenta":a.name=="Mathematics"?"blue":a.name=="Science & Invention"?"purple":a.name=="Computer Science"?"deeppink":a.name=="Dangerous Ideas"?"brown":a.name=="History"?"cyan":a.name=="Life"?"magenta":"#ff7f0e"}),m.append("g").attr("fill","white").attr("text-anchor","end").selectAll().data(t).join("text").attr("x",a=>d(a.quantity)).attr("y",a=>p(a.name)+p.bandwidth()/2).attr("dy","0.35em").attr("dx",-4).text(a=>a.quantity).call(a=>a.filter(e=>d(e.quantity)-d(0)<20).attr("dx",4).attr("fill","black").attr("text-anchor","start")),m.append("g").attr("transform",`translate(0,${s})`).call(W(d).ticks(0)).call(a=>a.select(".domain").remove()),m.append("g").attr("transform",`translate(${l},0)`).style("font","20px sans-serif").call(k(p).tickSizeOuter(0))}}},K={id:"school-comparison-chart-container"};function X(t,r,s,o,h,l){return g(),w("div",K)}const Z=f(J,[["render",X]]),tt={name:"SchoolTimeChart",props:["colour"],data(){return{}},mounted(){},methods:{createChart(t){const r=document.getElementById("time-chart-container").clientWidth,s=document.getElementById("time-chart-container").clientHeight,o=0,h=20,l=20,c=25,n=T(I(t,a=>a.date),[c,r-h]),d=b([0,P(t,a=>a.minutes)],[s-l,o]),p=A().x(a=>n(a.date)).y(a=>d(a.minutes)),m=S("#school-time-chart-container").append("svg").attr("width",r).attr("height",s).attr("viewBox",[0,0,r,s]).attr("style","max-width: 100%; height: auto; height: intrinsic;");m.append("g").attr("transform",`translate(0,${s-l})`).call(B(n).ticks(t.length).tickSizeOuter(0)),m.append("g").attr("transform",`translate(${c},0)`).call(k(d).ticks(s/40)).call(a=>a.select(".domain").remove()).call(a=>a.selectAll(".tick line").clone().attr("x2",r-c-h).attr("stroke-opacity",.2)).call(a=>a.append("text").attr("x",-c).attr("y",10).attr("fill","currentColor").attr("text-anchor","start")),m.append("path").attr("fill","none").attr("stroke","#ff7f0e").attr("stroke-width",3).attr("d",p(t))}}},et={id:"school-time-chart-container"};function st(t,r,s,o,h,l){return g(),w("div",et)}const at=f(tt,[["render",st]]);const rt={name:"School-Admin-Dashboard",setup(){const t=E(),r=H(),s=q();return{userDetailsStore:t,analyticsStore:r,usersStore:s}},data(){return{progressChartMode:"school",progressData:{school:[],teacher:[]},isAboveTheCurve:!1}},components:{SchoolProgressChart:G,SchoolComparisonChart:Z,SchoolTimeChart:at},async created(){this.analyticsStore.rootSubjectsPassedAssessments.length==0&&await this.getComparisonData(),await this.getSchoolProgressData(),await this.getTimeData()},methods:{async getSchoolProgressData(){await this.analyticsStore.getSchoolProgress(this.userDetailsStore.tenantId),this.progressData.school=[];for(let t=0;t<this.analyticsStore.progress.tenant.length;t++)this.progressData.school.push(this.analyticsStore.progress.tenant[t]);this.$nextTick(()=>{this.$refs.progressChart&&this.$refs.progressChart.createChart(this.progressData)})},async getClassProgressData(){await this.analyticsStore.getClassProgress("01982d32-db35-7550-83aa-bc32039d99eb"),this.progressData.teacher=[];for(let t=0;t<this.analyticsStore.classProgress.length;t++)this.progressData.teacher.push(this.analyticsStore.classProgress[t]);this.$nextTick(()=>{this.$refs.progressChart&&this.$refs.progressChart.createChart(this.progressData)})},async getTimeData(){this.analyticsStore.durationPerDay=[];let t=`/student-analytics/tenant-duration-per-day/weekly/${this.userDetailsStore.tenantId}`;fetch(t).then(r=>r.json()).then(async r=>{this.analyticsStore.durationPerDay=[];for(let s=0;s<r.length;s++)r[s].date=new Date(r[s].date),r[s].minutes=r[s].milliseconds/(1e3*60),this.analyticsStore.durationPerDay.push(r[s]);this.analyticsStore.durationPerDay.sort((s,o)=>s.date-o.date),this.$nextTick(()=>{this.$refs.timeChart&&this.$refs.timeChart.createChart(this.analyticsStore.durationPerDay)})}).catch(r=>{console.error("Error fetching student progress:",r)})},async getComparisonData(){try{const t=await fetch(`/student-analytics/passed-assessments-by-subject/tenant/${this.userDetailsStore.tenantId}`);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);this.analyticsStore.rootSubjectsPassedAssessments=await t.json(),this.$nextTick(()=>{this.$refs.comparisonChart&&this.$refs.comparisonChart.createChart(this.analyticsStore.rootSubjectsPassedAssessments)})}catch(t){console.error("Error fetching cohort mastered assessments:",t),this.analyticsStore.rootSubjectsPassedAssessments=[]}}}},j=t=>(L("data-v-14cf14e4"),t=t(),V(),t),ot={class:"dashboard"},nt={class:"container-fluid"},it=R('<div class="row top-row" data-v-14cf14e4><div class="col-sm top-row-text" data-v-14cf14e4><strong data-v-14cf14e4>Skills Mastered: </strong><span data-v-14cf14e4>10</span></div><div class="col-sm top-row-text" data-v-14cf14e4><strong data-v-14cf14e4>Students: </strong><span data-v-14cf14e4>35</span></div><div class="col-sm top-row-text" data-v-14cf14e4><strong data-v-14cf14e4>Teachers: </strong><span data-v-14cf14e4>5</span></div><div class="col-sm top-row-text" data-v-14cf14e4><strong data-v-14cf14e4>AI Tutor Usage: </strong><span data-v-14cf14e4>$500</span></div></div>',1),ct={class:"dash-row row"},ht={class:"col-md h-100"},lt=j(()=>i("h2",{class:"heading h5"},"Progress",-1)),dt={id:"progress-chart-container",class:"position-relative"},pt={class:"col-md"},mt=j(()=>i("h2",{class:"heading h5"},"Subject comparison",-1)),gt={class:"dash-row row mt-2 mb-2"},ut={class:"col-md position-relative"},ft=j(()=>i("h2",{class:"heading h5"},"Cost By Subject",-1)),_t={class:"col-md position-relative"},yt={id:"time-chart-container"},vt=j(()=>i("h2",{class:"heading h5"},"Engagement",-1));function St(t,r,s,o,h,l){const c=u("RouterLink"),n=u("SchoolProgressChart"),d=u("SchoolComparisonChart"),p=u("SchoolTimeChart");return g(),w("div",ot,[i("div",nt,[it,i("div",ct,[i("div",ht,[x(c,{to:"/reports/academics",class:""},{default:$(()=>[lt]),_:1}),i("div",dt,[h.progressData.school.length>0||o.analyticsStore.classProgress.length>0?(g(),D(n,{key:0,ref:"progressChart"},null,512)):C("",!0)])]),i("div",pt,[mt,o.analyticsStore.rootSubjectsPassedAssessments.length>0?(g(),D(d,{key:0,colour:"#5f31dd",ref:"comparisonChart"},null,512)):C("",!0)])]),i("div",gt,[i("div",ut,[x(c,{to:"/reports/cost",class:"me-2 position-absolute chart-heading"},{default:$(()=>[ft]),_:1})]),i("div",_t,[i("div",yt,[x(c,{to:"/reports/engagement",class:"position-absolute chart-heading"},{default:$(()=>[vt,o.analyticsStore.durationPerDay.length>0?(g(),D(p,{key:0,ref:"timeChart"},null,512)):C("",!0)]),_:1})])])])])])}const xt=f(rt,[["render",St],["__scopeId","data-v-14cf14e4"]]),$t={name:"TeacherProgressChart",props:[],data(){return{axisData:[]}},mounted(){},methods:{createChart(t){if(t.class.length==0)this.axisData=t.average;else if(t.school.length==0)this.axisData=t.class;else{const e=t.class.reduce((y,v)=>Math.max(y,v.quantity),-1/0),_=t.school.reduce((y,v)=>Math.max(y,v.quantity),-1/0);e>=_?this.axisData=t.class:this.axisData=t.school}const r=Object.entries(t).map(([e,_])=>({name:e,values:_})),s=document.getElementById("progress-chart-container").clientWidth,o=document.getElementById("progress-chart-container").clientHeight,h=5,l=20,c=20,n=20,d=T(I(this.axisData,e=>e.date),[n,s-l]),p=b([0,P(this.axisData,e=>e.quantity)],[o-c,h]);O().domain(r.map(e=>e.name)).range(z);const m=A().x(e=>d(e.date)).y(e=>p(e.quantity)),a=S("#progress-chart-container").append("svg").attr("width","100%").attr("height","100%").attr("viewBox",[0,0,+Math.min(s,o),+Math.min(s,o)]).attr("preserveAspectRatio","xMinYMin");a.append("g").attr("transform",`translate(0,${o-20})`).call(B(d).ticks(s/100).tickSizeOuter(0)),a.append("g").attr("transform",`translate(${n},0)`).call(k(p).ticks(o/80)).call(e=>e.selectAll(".tick line").clone().attr("x2",s-n-l).attr("stroke-opacity",.1)),a.selectAll(".line").data(r).join("path").attr("fill","none").attr("stroke",e=>e.name=="class"?"green":"#ff7f0e").attr("stroke-width",3).attr("d",e=>m(e.values))}}};function Dt(t,r,s,o,h,l){return null}const Ct=f($t,[["render",Dt]]),wt={name:"SchoolTimeChart",props:[],data(){return{axisData:[]}},mounted(){},methods:{createChart(t){if(console.log(t),t.student.length==0)this.axisData=t.tenant;else if(t.tenant.length==0)this.axisData=t.student;else{const e=t.student.reduce((y,v)=>Math.max(y,v.quantity),-1/0),_=t.tenant.reduce((y,v)=>Math.max(y,v.quantity),-1/0);e>=_?this.axisData=t.student:this.axisData=t.tenant}const r=Object.entries(t).map(([e,_])=>({name:e,values:_}));S("#time-chart-container");const s=document.getElementById("time-chart-container").clientWidth,o=document.getElementById("time-chart-container").clientHeight,h=0,l=20,c=20,n=20,d=T(I(this.axisData,e=>e.date),[n,s-l]),p=b([0,P(this.axisData,e=>e.formattedQuantity)],[o-c,h]);O().domain(r.map(e=>e.name)).range(z);const m=A().x(e=>d(e.date)).y(e=>p(e.formattedQuantity)),a=S("#time-chart-container").append("svg").attr("width","100%").attr("height","100%").attr("viewBox",[0,0,+Math.min(s,o),+Math.min(s,o)]).attr("preserveAspectRatio","xMinYMin");a.append("g").attr("transform",`translate(0,${o-c})`).call(B(d).ticks(t.length).tickSizeOuter(0)),a.append("g").attr("transform",`translate(${n},0)`).call(k(p).ticks(o/40)).call(e=>e.select(".domain").remove()).call(e=>e.selectAll(".tick line").clone().attr("x2",s-n-l).attr("stroke-opacity",.2)).call(e=>e.append("text").attr("x",-n).attr("y",10).attr("fill","currentColor").attr("text-anchor","start")),a.selectAll(".line").data(r).join("path").attr("fill","none").attr("stroke",e=>e.name=="student"?"RoyalBlue":"#ff7f0e").attr("stroke-width",3).attr("d",e=>m(e.values))}}};function bt(t,r,s,o,h,l){return null}const kt=f(wt,[["render",bt]]);const Pt={name:"Teacher-Analytics-Dashboard",setup(){const t=E(),r=H(),s=q();return{userDetailsStore:t,analyticsStore:r,usersStore:s}},data(){return{progressChartMode:"teacher",progressData:{school:[],class:[]}}},components:{TeacherProgressChart:Ct,TeacherTimeChart:kt},async created(){await this.getProgressData()},methods:{async getProgressData(){await this.analyticsStore.getSchoolProgress(this.userDetailsStore.tenantId),this.progressData.school=[];for(let t=0;t<this.analyticsStore.progress.tenant.length;t++)this.progressData.school.push(this.analyticsStore.progress.tenant[t]);await this.analyticsStore.getClassProgress(this.userDetailsStore.userId),this.progressData.class=[];for(let t=0;t<this.analyticsStore.classProgress.length;t++)this.progressData.class.push(this.analyticsStore.classProgress[t]);this.$nextTick(()=>{this.$refs.progressChart&&this.$refs.progressChart.createChart(this.progressData)})},async getTimeData(){this.analyticsStore.durationPerDay=[];let t=`/student-analytics/tenant-duration-per-day/weekly/${this.userDetailsStore.tenantId}`;fetch(t).then(r=>r.json()).then(async r=>{this.analyticsStore.durationPerDay=[];for(let s=0;s<r.length;s++)r[s].date=new Date(r[s].date),r[s].minutes=r[s].milliseconds/(1e3*60),this.analyticsStore.durationPerDay.push(r[s]);this.analyticsStore.durationPerDay.sort((s,o)=>s.date-o.date),this.$nextTick(()=>{this.$refs.timeChart&&this.$refs.timeChart.createChart(this.analyticsStore.durationPerDay)})}).catch(r=>{console.error("Error fetching student progress:",r)})},async getComparisonData(){try{const t=await fetch(`/student-analytics/passed-assessments-by-subject/tenant/${this.userDetailsStore.tenantId}`);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);this.analyticsStore.rootSubjectsPassedAssessments=await t.json(),this.$nextTick(()=>{this.$refs.comparisonChart&&this.$refs.comparisonChart.createChart(this.analyticsStore.rootSubjectsPassedAssessments)})}catch(t){console.error("Error fetching cohort mastered assessments:",t),this.analyticsStore.rootSubjectsPassedAssessments=[]}}}},M=t=>(L("data-v-cb4058ae"),t=t(),V(),t),Tt={class:"dashboard"},At={class:"container-fluid"},It=R('<div class="row top-row" data-v-cb4058ae><div class="col-sm top-row-text" data-v-cb4058ae><strong data-v-cb4058ae>Skills Mastered: </strong><span data-v-cb4058ae>10</span></div><div class="col-sm top-row-text" data-v-cb4058ae><strong data-v-cb4058ae>Students: </strong><span data-v-cb4058ae>5</span></div><div class="col-sm top-row-text" data-v-cb4058ae></div><div class="col-sm top-row-text" data-v-cb4058ae></div></div>',1),Bt={class:"dash-row row"},jt={class:"col-md h-100"},Mt=M(()=>i("h2",{class:"heading h5"},"Progress",-1)),Et={id:"progress-chart-container",class:"position-relative"},qt=M(()=>i("div",{class:"col-md"},[i("h2",{class:"heading h5"},"Subject comparison")],-1)),Rt={class:"dash-row row mt-2 mb-2"},Lt={class:"col-md position-relative"},Vt=M(()=>i("h2",{class:"heading h5"},"Cost By Subject",-1)),Ht={class:"col-md position-relative"},Ot={id:"time-chart-container"},zt=M(()=>i("h2",{class:"heading h5"},"Engagement",-1));function Nt(t,r,s,o,h,l){const c=u("RouterLink"),n=u("TeacherProgressChart");return g(),w("div",Tt,[i("div",At,[It,i("div",Bt,[i("div",jt,[x(c,{to:"/reports/academics",class:""},{default:$(()=>[Mt]),_:1}),i("div",Et,[h.progressData.school.length>0||h.progressData.class.length>0?(g(),D(n,{key:0,ref:"progressChart"},null,512)):C("",!0)])]),qt]),i("div",Rt,[i("div",Lt,[x(c,{to:"/reports/cost",class:"me-2 position-absolute chart-heading"},{default:$(()=>[Vt]),_:1})]),i("div",Ht,[i("div",Ot,[x(c,{to:"/reports/engagement",class:"position-absolute chart-heading"},{default:$(()=>[zt]),_:1})])])])])])}const Wt=f(Pt,[["render",Nt],["__scopeId","data-v-cb4058ae"]]),Ft={name:"Dashboard",setup(){return{userDetailsStore:E()}},data(){return{}},components:{SchoolAdminAnalyticsDashboard:xt,TeacherAnalyticsDashboard:Wt},async created(){}};function Ut(t,r,s,o,h,l){const c=u("SchoolAdminAnalyticsDashboard"),n=u("TeacherAnalyticsDashboard");return g(),w(N,null,[o.userDetailsStore.role=="school_admin"?(g(),D(c,{key:0})):C("",!0),o.userDetailsStore.role=="instructor"||o.userDetailsStore.role=="partner"?(g(),D(n,{key:1})):C("",!0)],64)}const ne=f(Ft,[["render",Ut]]);export{ne as default};
