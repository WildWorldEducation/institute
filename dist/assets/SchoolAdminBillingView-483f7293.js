import{_ as g,G as w,H as y,e as f,o as i,c as l,a as t,m as d,t as s,p as h,b as m,F as k,x as p}from"./main-fb767ba2.js";const D={setup(){const o=w(),e=y(),a=f();return{settingsStore:o,tenantStore:e,userDetailsStore:a}},data(){return{monthlyTokenUsage:null,year:0,month:"",isAITokenLimitReached:!1,isMobileCheck:window.innerWidth,receipts:[],showTokensDropDown:!1,products:[{name:"1,000,000 tokens for $50",tokens:1e6},{name:"2,000,000 tokens for $100",tokens:2e6},{name:"5,000,000 tokens for $250",tokens:5e6}],chosenProduct:{}}},async created(){this.chosenProduct=this.products[0],this.settingsStore.freeTokenMonthlyLimit==0&&await this.settingsStore.getSettings(),await this.tenantStore.getTenantDetails(this.userDetailsStore.tenantId),await this.tenantStore.getTenantMonthlyTokenUsage(this.userDetailsStore.tenantId),this.getReceipts()},async mounted(){this.year=new Date().getFullYear();const o=["January","February","March","April","May","June","July","August","September","October","November","December"],e=new Date;this.month=o[e.getMonth()]},computed:{formattedMonthlyTokenUsage(){return this.tenantStore.monthlyTokenUsage?this.tenantStore.monthlyTokenUsage.toLocaleString():"0"}},methods:{closeOnDropdownOnClickAnywhere(){const o=document.getElementById("token-dropdown");document.body.addEventListener("click",e=>{o.contains(e.target)||(this.showTokensDropDown=!1)})},checkout(o){fetch("/tokens/tenant/create-checkout-session",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tenantId:this.userDetailsStore.tenantId,numberOfTokens:o})}).then(e=>e.ok?e.json():e.json().then(a=>Promise.reject(a))).then(({url:e})=>{window.location=e}).catch(e=>{console.error(e.error)})},async getReceipts(){const o=await fetch("/tokens/tenant/get-receipts/"+this.userDetailsStore.tenantId);this.receipts=await o.json()},formattedStripeReceiptDate(o){let e=new Date(o.date);const a=e.getUTCMonth()+1,u=e.getUTCDate();return e.getUTCFullYear()+"/"+a+"/"+u},formattedStripeReceiptAmount(o){return(o.amount/100).toLocaleString("en-US",{style:"currency",currency:"USD"})}}},S={class:"container"},T={class:"row"},b={class:"col-md"},v={class:"d-flex justify-content-between"},_={class:"secondary-heading h5"},C={class:"row"},M={class:"col col-md-8 col-lg-5 mt-2"},x={class:"d-flex flex-column position-relative"},A={key:0,class:"custom-dropdown-base"},U=["onClick"],I=["href"],L={key:0};function O(o,e,a,u,n,c){return i(),l("div",S,[t("div",T,[t("div",b,[t("span",v,[t("h1",{class:d(["heading mb-4 h2",{"text-center":n.isMobileCheck<576}])}," Monthly AI usage ",2),t("h2",_,s(n.month)+" "+s(n.year),1)]),t("ul",null,[t("li",null,[t("p",null,[e[2]||(e[2]=t("strong",null,"Free limit per student:",-1)),h(" "+s(u.settingsStore.freeTokenMonthlyLimit.toLocaleString()),1)])]),t("li",null,[t("p",null,[e[3]||(e[3]=t("strong",null,"Total token usage:",-1)),h(" "+s(c.formattedMonthlyTokenUsage),1)])]),t("li",null,[t("p",null,[e[4]||(e[4]=t("strong",null,"Current tokens:",-1)),h(" "+s(u.tenantStore.tokens),1)])])]),n.isAITokenLimitReached?(i(),l("div",{key:0,class:d(["alert alert-warning",{"mb-0":n.isMobileCheck>=576}]),role:"alert"}," You are over the monthly free limit. You can't use the AI features until next month. ",2)):m("",!0)])]),e[8]||(e[8]=t("hr",null,null,-1)),t("div",C,[t("div",M,[e[6]||(e[6]=t("h2",{class:"secondary-heading h4"},"Buy Tokens",-1)),t("div",x,[t("div",{id:"token-dropdown",class:d([n.showTokensDropDown?"custom-select-button-focus":"custom-select-button"]),onClick:e[0]||(e[0]=r=>{n.showTokensDropDown=!n.showTokensDropDown,c.closeOnDropdownOnClickAnywhere()})},[h(s(n.chosenProduct.name)+" ",1),e[5]||(e[5]=t("span",null,[t("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[t("path",{d:"M14.2929 8.70711C14.9229 8.07714 14.4767 7 13.5858 7H6.41421C5.52331 7 5.07714 8.07714 5.70711 8.70711L9.29289 12.2929C9.68342 12.6834 10.3166 12.6834 10.7071 12.2929L14.2929 8.70711Z",fill:"#344054"})])],-1))],2),n.showTokensDropDown?(i(),l("div",A,[(i(!0),l(k,null,p(n.products,r=>(i(),l("div",{class:"custom-dropdown-option",onClick:R=>{n.chosenProduct=r,n.showTokensDropDown=!1}},s(r.name),9,U))),256))])):m("",!0)])])]),t("button",{onClick:e[1]||(e[1]=r=>c.checkout(n.chosenProduct.tokens)),class:"btn buy-btn mt-2 mb-2"}," buy "),e[9]||(e[9]=t("hr",null,null,-1)),t("div",{class:d({"text-center":n.isMobileCheck<576})},[e[7]||(e[7]=t("h2",{class:"secondary-heading h4"},"Receipts",-1)),(i(!0),l(k,null,p(n.receipts,r=>(i(),l("div",null,[t("a",{href:r.url,target:"_blank"},s(c.formattedStripeReceiptAmount(r))+" "+s(c.formattedStripeReceiptDate(r)),9,I)]))),256)),n.isMobileCheck<576?(i(),l("p",L,"Â ")):m("",!0)],2)])}const j=g(D,[["render",O],["__scopeId","data-v-f67c227d"]]);export{j as default};
