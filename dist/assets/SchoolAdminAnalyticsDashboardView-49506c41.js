import{u as I}from"./AnalyticsStore-8a08293c.js";import{_,o as g,c as w,f as j,A as E,r as f,a as l,g as v,l as S,k as x,b,E as L,p as M,d as q}from"./main-c940865b.js";import"./transform-4d0f7c8f.js";import{u as k,l as A}from"./line-d122782f.js";import{e as P}from"./time-3c9385c3.js";import{l as C,c as T,b as D,a as R}from"./linear-d9b6cbf2.js";import{m as $}from"./continuous-93813e6c.js";import{o as H,b as V}from"./band-2263c9e7.js";import{s as u}from"./string-c67ea49d.js";import{c as N}from"./category10-63f9141e.js";import{s as O}from"./sort-fcaf8f38.js";import"./point-ea70dc51.js";import"./colors-98f238a0.js";const z={name:"SchoolProgressChart",props:[],data(){return{axisData:[]}},mounted(){},methods:{createChart(e){e.school.length>0?this.axisData=e.school:this.axisData=[];const s=Object.entries(e).map(([o,B])=>({name:o,values:B}));u("#progress-chart-container");const a=document.getElementById("progress-chart-container").clientWidth,r=document.getElementById("progress-chart-container").clientHeight,h=5,d=20,i=20,c=20,n=k(P(this.axisData,o=>o.date),[c,a-d]),m=C([0,$(this.axisData,o=>o.quantity)],[r-i,h]);H().domain(s.map(o=>o.name)).range(N);const p=A().x(o=>n(o.date)).y(o=>m(o.quantity)),t=u("#progress-chart-container").append("svg").attr("width","100%").attr("height","100%").attr("viewBox",[0,0,+Math.min(a,r),+Math.min(a,r)]).attr("preserveAspectRatio","xMinYMin");t.append("g").attr("transform",`translate(0,${r-20})`).call(T(n).ticks(a/100).tickSizeOuter(0)),t.append("g").attr("transform",`translate(${c},0)`).call(D(m).ticks(r/40)).call(o=>o.select(".domain").remove()).call(o=>o.selectAll(".tick line").clone().attr("x2",a-c-d).attr("stroke-opacity",.2)).call(o=>o.append("text").attr("x",-c).attr("y",10).attr("fill","currentColor").attr("text-anchor","start")),t.selectAll(".line").data(s).join("path").attr("fill","none").attr("stroke",o=>"green").attr("stroke-width",3).attr("d",o=>p(o.values))}}};function U(e,s,a,r,h,d){return null}const W=_(z,[["render",U]]),F={name:"SchoolComparisonChart",props:["colour"],data(){return{}},mounted(){},methods:{createChart(e){u("#school-comparison-chart-container");const s=40,a=0,r=20,h=10,d=200,i=1e3,c=Math.ceil((e.length+.1)*s)+a+h,n=C().domain([0,$(e,t=>t.quantity)]).range([d,i-r]),m=V().domain(O(e,t=>-t.quantity).map(t=>t.name)).rangeRound([a,c-h]).padding(.1);n.tickFormat(20);const p=u("#school-comparison-chart-container").append("svg").attr("width",i).attr("height",c).attr("viewBox",[0,0,i,c]).attr("style","max-width: 100%; height: 100%; font: 16px sans-serif;");p.append("g").selectAll().data(e).join("rect").attr("x",n(0)).attr("y",t=>m(t.name)).attr("width",t=>n(t.quantity)-n(0)).attr("height",m.bandwidth()).attr("fill",function(t){return t.name=="Language"?"DarkMagenta":t.name=="Mathematics"?"blue":t.name=="Science & Invention"?"purple":t.name=="Computer Science"?"deeppink":t.name=="Dangerous Ideas"?"brown":t.name=="History"?"cyan":t.name=="Life"?"magenta":"#ff7f0e"}),p.append("g").attr("fill","white").attr("text-anchor","end").selectAll().data(e).join("text").attr("x",t=>n(t.quantity)).attr("y",t=>m(t.name)+m.bandwidth()/2).attr("dy","0.35em").attr("dx",-4).text(t=>t.quantity).call(t=>t.filter(o=>n(o.quantity)-n(0)<20).attr("dx",4).attr("fill","black").attr("text-anchor","start")),p.append("g").attr("transform",`translate(0,${a})`).call(R(n).ticks(0)).call(t=>t.select(".domain").remove()),p.append("g").attr("transform",`translate(${d},0)`).style("font","20px sans-serif").call(D(m).tickSizeOuter(0))}}},Y={id:"school-comparison-chart-container"};function G(e,s,a,r,h,d){return g(),w("div",Y)}const J=_(F,[["render",G]]),K={name:"SchoolTimeChart",props:["colour"],data(){return{}},mounted(){},methods:{createChart(e){u("#school-time-chart-container");const s=document.getElementById("time-chart-container").clientWidth,a=document.getElementById("time-chart-container").clientHeight,r=0,h=20,d=20,i=25,c=k(P(e,t=>t.date),[i,s-h]),n=C([0,$(e,t=>t.minutes)],[a-d,r]),m=A().x(t=>c(t.date)).y(t=>n(t.minutes)),p=u("#school-time-chart-container").append("svg").attr("width",s).attr("height",a).attr("viewBox",[0,0,s,a]).attr("style","max-width: 100%; height: auto; height: intrinsic;");p.append("g").attr("transform",`translate(0,${a-d})`).call(T(c).ticks(e.length).tickSizeOuter(0)),p.append("g").attr("transform",`translate(${i},0)`).call(D(n).ticks(a/40)).call(t=>t.select(".domain").remove()).call(t=>t.selectAll(".tick line").clone().attr("x2",s-i-h).attr("stroke-opacity",.2)).call(t=>t.append("text").attr("x",-i).attr("y",10).attr("fill","currentColor").attr("text-anchor","start")),p.append("path").attr("fill","none").attr("stroke","#ff7f0e").attr("stroke-width",3).attr("d",m(e))}}},Q={id:"school-time-chart-container"};function X(e,s,a,r,h,d){return g(),w("div",Q)}const Z=_(K,[["render",X]]);const tt={name:"School-Admin-Dashboard",setup(){const e=j(),s=I(),a=E();return{userDetailsStore:e,analyticsStore:s,usersStore:a}},data(){return{showSidebar:!0,screenWidth:screen.width,isEveryone:!0,isSchoolData:!1,isLanguageData:!1,isMathData:!1,isHistoryData:!1,isLifeData:!1,isCSData:!1,isSAndIData:!1,isDIData:!1,progressData:{school:[]},isAboveTheCurve:!1}},components:{SchoolProgressChart:W,SchoolComparisonChart:J,SchoolTimeChart:Z},async created(){await this.analyticsStore.getSchoolProgress(this.userDetailsStore.tenantId),this.analyticsStore.rootSubjectsPassedAssessments.length==0&&await this.getComparisonData(),await this.getProgressData(),await this.getTimeData()},methods:{async getProgressData(){this.progressData.school=[];for(let e=0;e<this.analyticsStore.progress.tenant.length;e++)this.progressData.school.push(this.analyticsStore.progress.tenant[e]);this.$nextTick(()=>{this.$refs.progressChart&&this.$refs.progressChart.createChart(this.progressData)})},async getComparisonData(){try{const e=await fetch(`/student-analytics/passed-assessments-by-subject/tenant/${this.userDetailsStore.tenantId}`);if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);this.analyticsStore.rootSubjectsPassedAssessments=await e.json(),this.$nextTick(()=>{this.$refs.comparisonChart&&this.$refs.comparisonChart.createChart(this.analyticsStore.rootSubjectsPassedAssessments)})}catch(e){console.error("Error fetching cohort mastered assessments:",e),this.analyticsStore.rootSubjectsPassedAssessments=[]}},async getTimeData(){this.analyticsStore.durationPerDay=[];let e=`/student-analytics/tenant-duration-per-day/weekly/${this.userDetailsStore.tenantId}`;fetch(e).then(s=>s.json()).then(async s=>{this.analyticsStore.durationPerDay=[];for(let a=0;a<s.length;a++)s[a].date=new Date(s[a].date),s[a].minutes=s[a].milliseconds/(1e3*60),this.analyticsStore.durationPerDay.push(s[a]);this.analyticsStore.durationPerDay.sort((a,r)=>a.date-r.date),this.$nextTick(()=>{this.$refs.timeChart&&this.$refs.timeChart.createChart(this.analyticsStore.durationPerDay)})}).catch(s=>{console.error("Error fetching student progress:",s)})}}},y=e=>(M("data-v-f74ec64b"),e=e(),q(),e),et={class:"dashboard"},at={class:"container-fluid"},st=L('<div class="row top-row" data-v-f74ec64b><div class="col-sm top-row-text" data-v-f74ec64b><strong data-v-f74ec64b>Skills Mastered: </strong><span data-v-f74ec64b>10</span></div><div class="col-sm top-row-text" data-v-f74ec64b><strong data-v-f74ec64b>Students: </strong><span data-v-f74ec64b>35</span></div><div class="col-sm top-row-text" data-v-f74ec64b><strong data-v-f74ec64b>Teachers: </strong><span data-v-f74ec64b>5</span></div><div class="col-sm top-row-text" data-v-f74ec64b><strong data-v-f74ec64b>AI Tutor Usage: </strong><span data-v-f74ec64b>$500</span></div></div>',1),ot={class:"dash-row row"},rt={class:"col-md h-100"},nt=y(()=>l("h2",{class:"heading h5"},"Progress",-1)),it={id:"progress-chart-container",class:"position-relative"},ct={class:"col-md"},lt=y(()=>l("h2",{class:"heading h5"},"Subject comparison",-1)),ht={class:"dash-row row mt-2 mb-2"},dt={class:"col-md position-relative"},mt=y(()=>l("h2",{class:"heading h5"},"Cost By Subject",-1)),pt={class:"col-md position-relative"},gt={id:"time-chart-container"},ut=y(()=>l("h2",{class:"heading h5"},"Engagement",-1));function ft(e,s,a,r,h,d){const i=f("RouterLink"),c=f("SchoolProgressChart"),n=f("SchoolComparisonChart"),m=f("SchoolTimeChart");return g(),w("div",et,[l("div",at,[st,l("div",ot,[l("div",rt,[v(i,{to:"/reports/academics",class:""},{default:S(()=>[nt]),_:1}),l("div",it,[h.progressData.school.length>0?(g(),x(c,{key:0,ref:"progressChart"},null,512)):b("",!0)])]),l("div",ct,[lt,r.analyticsStore.rootSubjectsPassedAssessments.length>0?(g(),x(n,{key:0,colour:"#5f31dd",ref:"comparisonChart"},null,512)):b("",!0)])]),l("div",ht,[l("div",dt,[v(i,{to:"/reports/cost",class:"me-2 position-absolute chart-heading"},{default:S(()=>[mt]),_:1})]),l("div",pt,[l("div",gt,[v(i,{to:"/reports/engagement",class:"position-absolute chart-heading"},{default:S(()=>[ut,r.analyticsStore.durationPerDay.length>0?(g(),x(m,{key:0,ref:"timeChart"},null,512)):b("",!0)]),_:1})])])])])])}const Tt=_(tt,[["render",ft],["__scopeId","data-v-f74ec64b"]]);export{Tt as default};
