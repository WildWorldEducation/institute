import{_ as f,o as p,c as _,f as R,A as L,r as u,a as i,q as M,F,z as O,t as N,g as C,l as $,k as y,b as D,E as z,p as H,d as V}from"./main-1bd36309.js";import{u as j}from"./AnalyticsStore-7c81085a.js";import"./transform-4d0f7c8f.js";import{u as B,l as A}from"./line-d122782f.js";import{e as I}from"./time-3c9385c3.js";import{l as w,c as P,b as k,a as W}from"./linear-d9b6cbf2.js";import{m as T}from"./continuous-93813e6c.js";import{s as b}from"./string-c67ea49d.js";import{b as U}from"./band-2263c9e7.js";import{s as Y}from"./sort-fcaf8f38.js";import"./point-ea70dc51.js";const Q={name:"SchoolProgressChart",setup(){return{analyticsStore:j()}},data(){return{}},mounted(){},methods:{createChart(t){const r=document.getElementById("progress-chart-container").clientWidth,s=document.getElementById("progress-chart-container").clientHeight,a=5,h=20,d=20,n=20,l=B(I(this.analyticsStore.progress.tenant,e=>e.date),[n,r-h]),m=w([0,T(this.analyticsStore.progress.tenant,e=>e.quantity)],[s-d,a]),c=A().x(e=>l(e.date)).y(e=>m(e.quantity)),g=b("#progress-chart-container").append("svg").attr("width",r).attr("height",s).attr("viewBox",[0,0,r,s]).attr("style","max-width: 100%; height: auto; height: intrinsic;");g.append("g").attr("transform",`translate(0,${s-20})`).call(P(l).ticks(r/100).tickSizeOuter(0)),g.append("g").attr("transform",`translate(${n},0)`).call(k(m).ticks(s/40)).call(e=>e.select(".domain").remove()).call(e=>e.selectAll(".tick line").clone().attr("x2",r-n-h).attr("stroke-opacity",.2)).call(e=>e.append("text").attr("x",-n).attr("y",10).attr("fill","currentColor").attr("text-anchor","start")),g.append("path").attr("fill","none").attr("stroke","green").attr("stroke-width",3).attr("d",c(t))}}};function G(t,r,s,a,h,d){return null}const J=f(Q,[["render",G]]),K={name:"SchoolTimeChart",setup(){return{analyticsStore:j()}},data(){return{}},mounted(){},methods:{createChart(t){const r=document.getElementById("time-chart-container").clientWidth,s=document.getElementById("time-chart-container").clientHeight,a=0,h=20,d=20,n=25,l=B(I(this.analyticsStore.time.tenant,e=>e.date),[n,r-h]),m=w([0,T(this.analyticsStore.time.tenant,e=>e.minutes)],[s-d,a]),c=A().x(e=>l(e.date)).y(e=>m(e.minutes)),g=b("#school-time-chart-container").append("svg").attr("width",r).attr("height",s).attr("viewBox",[0,0,r,s]).attr("style","max-width: 100%; height: auto; height: intrinsic;");g.append("g").attr("transform",`translate(0,${s-d})`).call(P(l).ticks(t.length).tickSizeOuter(0)),g.append("g").attr("transform",`translate(${n},0)`).call(k(m).ticks(s/40)).call(e=>e.select(".domain").remove()).call(e=>e.selectAll(".tick line").clone().attr("x2",r-n-h).attr("stroke-opacity",.2)).call(e=>e.append("text").attr("x",-n).attr("y",10).attr("fill","currentColor").attr("text-anchor","start")),g.append("path").attr("fill","none").attr("stroke","#ff7f0e").attr("stroke-width",3).attr("d",c(t))}}},X={id:"school-time-chart-container"};function Z(t,r,s,a,h,d){return p(),_("div",X)}const tt=f(K,[["render",Z]]),et={name:"TenantFailedAssessmentsByRootSubjectHorizontalBarChart",props:["data"],data(){return{}},mounted(){const h=document.getElementById("failed-chart-container").clientWidth,d=document.getElementById("failed-chart-container").clientHeight,n=w().domain([0,T(this.data,c=>c.quantity)]).range([200,h-0]),l=U().domain(Y(this.data,c=>-c.quantity).map(c=>c.name)).rangeRound([0,d-10]).padding(.1);n.tickFormat(20);const m=b("#failed-chart-container").append("svg").attr("width",h).attr("height",d).attr("viewBox",[0,0,h,d]).attr("style","max-width: 100%; height: 100%;");m.append("g").attr("fill","darkred").selectAll().data(this.data).join("rect").attr("x",n(0)).attr("y",c=>l(c.name)).attr("width",c=>n(c.quantity)-n(0)).attr("height",l.bandwidth()),m.append("g").attr("fill","white").attr("text-anchor","end").selectAll().data(this.data).join("text").attr("x",c=>n(c.quantity)).attr("y",c=>l(c.name)+l.bandwidth()/2).attr("dy","0.35em").attr("dx",-4).text(c=>c.quantity).call(c=>c.filter(g=>n(g.quantity)-n(0)<20).attr("dx",4).attr("fill","black").attr("text-anchor","start")),m.append("g").attr("transform","translate(0,0)").call(W(n).ticks(0)).call(c=>c.select(".domain").remove()),m.append("g").attr("transform","translate(200,0)").call(k(l).tickSizeOuter(0))}};function st(t,r,s,a,h,d){return null}const at=f(et,[["render",st]]),rt={name:"TenantTokensPerDayLineChart",props:["colour"],data(){return{}},methods:{createChart(t){const r=document.getElementById("cost-chart-container").clientWidth,s=document.getElementById("cost-chart-container").clientHeight,a=20,h=20,d=20,n=25,l=B(I(t,e=>e.date),[n,r-h]),m=w([0,T(t,e=>e.quantity)],[s-d,a]),c=A().x(e=>l(e.date)).y(e=>m(e.quantity)),g=b("#cost-chart-container").append("svg").attr("width",r).attr("height",s).attr("viewBox",[0,0,r,s]).attr("style","max-width: 100%; height: auto; height: intrinsic;");g.append("g").attr("transform",`translate(0,${s-d})`).call(P(l).ticks(t.length/2).tickSizeOuter(0)),g.append("g").attr("transform",`translate(${n},0)`).call(k(m).ticks(s/80)).call(e=>e.selectAll(".tick line").clone().attr("x2",r-n-h).attr("stroke-opacity",.1)).call(e=>e.append("text").attr("x",-n).attr("y",10).attr("fill","currentColor").attr("text-anchor","start").text("â†‘ Tokens")),g.append("path").attr("fill","none").attr("stroke","#5f31dd").attr("stroke-width",1.5).attr("d",c(t))}}};function ot(t,r,s,a,h,d){return null}const nt=f(rt,[["render",ot]]);const it={name:"School-Admin-Class-Dashboard",setup(){const t=R(),r=j(),s=L();return{userDetailsStore:t,analyticsStore:r,usersStore:s}},data(){return{progressChartMode:"school",isAboveTheCurve:!1,teachers:[],selectedTeacher:{},isSchoolSelected:!0}},components:{SchoolProgressChart:J,SchoolTimeChart:tt,TenantFailedAssessmentsByRootSubjectHorizontalBarChart:at,SchoolCostChart:nt},async created(){this.teachers.length<1&&await this.getTeachers(this.userDetailsStore.tenantId),await this.getSchoolData(),this.analyticsStore.rootSubjectsFailedAssessments.length==0&&await this.getFailedAssessmentsBySubject(),await this.getSchoolCostData()},methods:{async getTeachers(t){const s=await(await fetch("/tenants/instructors/"+t)).json();for(let a=0;a<s.length;a++)s[a].type="teacher";this.teachers=s},async selectElement(t){this.clearCharts(),t.type==="teacher"?(this.selectedTeacher=t,this.isSchoolSelected=!1,await this.getClassData()):t==="school"&&(this.isSchoolSelected=!0,this.selectedTeacher={},await this.getSchoolData())},clearCharts(){this.analyticsStore.progress.class=[],this.analyticsStore.durationPerDay=[];let t=document.getElementById("progress-chart-container"),r=t.querySelector("svg");r&&r.remove(),t=document.getElementById("time-chart-container"),r=t.querySelector("svg"),r&&r.remove()},async getSchoolData(){this.progressChartMode="school",await this.getSchoolProgressData(),await this.getSchoolTimeData()},async getClassData(){this.progressChartMode="teacher",await this.getClassProgressData(this.selectedTeacher.id),await this.getClassTimeData()},async getSchoolProgressData(){await this.analyticsStore.getSchoolProgress(this.userDetailsStore.tenantId),this.$nextTick(()=>{this.$refs.progressChart&&this.$refs.progressChart.createChart(this.analyticsStore.progress.tenant)})},async getClassProgressData(){await this.analyticsStore.getClassProgress(this.selectedTeacher.id),this.$nextTick(()=>{this.$refs.progressChart&&this.$refs.progressChart.createChart(this.analyticsStore.progress.class)})},async getSchoolTimeData(){await this.analyticsStore.getSchoolTime(this.userDetailsStore.tenantId),this.$nextTick(()=>{this.$refs.timeChart&&this.$refs.timeChart.createChart(this.analyticsStore.time.tenant)})},async getClassTimeData(){await this.analyticsStore.getClassTime(this.selectedTeacher.id),this.$nextTick(()=>{this.$refs.timeChart&&this.$refs.timeChart.createChart(this.analyticsStore.time.class)})},async getFailedAssessmentsBySubject(){try{const t=await fetch(`/student-analytics/failed-assessments-by-subject/tenant/${this.userDetailsStore.tenantId}`);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);this.analyticsStore.rootSubjectsFailedAssessments=await t.json()}catch(t){console.error("Error fetching cohort mastered assessments:",t),this.analyticsStore.rootSubjectsFailedAssessments=[]}},async getSchoolCostData(){await this.analyticsStore.getSchoolCost(this.userDetailsStore.tenantId,"weekly"),this.$nextTick(()=>{this.$refs.costChart&&this.$refs.costChart.createChart(this.analyticsStore.cost.tenant)})}}},E=t=>(H("data-v-55f15514"),t=t(),V(),t),ct={class:"dashboard"},lt={class:"col-lg-1 col-md-2"},ht={class:"d-flex bg-light rounded p-2"},dt={class:"d-flex bg-light rounded p-2"},mt=["onClick"],gt={class:"col-lg-11 col-md-10 dashboard"},pt={class:"container-fluid"},ut=z('<div class="row top-row text-start" data-v-55f15514><div class="col-sm top-row-text" data-v-55f15514><strong data-v-55f15514>Students: </strong><span data-v-55f15514>10</span></div><div class="col-sm top-row-text" data-v-55f15514></div><div class="col-sm top-row-text" data-v-55f15514><strong data-v-55f15514>Skills Mastered: </strong><span data-v-55f15514>10</span></div><div class="col-sm top-row-text" data-v-55f15514><strong data-v-55f15514>Cost: </strong><span data-v-55f15514>$0</span></div></div>',1),_t={class:"dash-row row"},ft={class:"col-md h-100"},yt=E(()=>i("h2",{class:"heading h5"},"Progress",-1)),St={id:"progress-chart-container"},vt={key:1},xt={class:"col-md"},Ct=E(()=>i("h2",{class:"heading h5"},"Challenges",-1)),$t={id:"failed-chart-container"},wt={class:"dash-row row mt-2 mb-2"},kt={class:"col-md position-relative h-100"},Tt=E(()=>i("h2",{class:"heading h5"},"Cost",-1)),bt={id:"cost-chart-container"},Dt={key:1},Bt={class:"col-md h-100"},At=E(()=>i("h2",{class:"heading h5"},"Weekly engagement",-1)),It={id:"time-chart-container"},Pt={key:1};function jt(t,r,s,a,h,d){const n=u("RouterLink"),l=u("SchoolProgressChart"),m=u("TenantFailedAssessmentsByRootSubjectHorizontalBarChart"),c=u("SchoolCostChart"),g=u("SchoolTimeChart");return p(),_("div",ct,[i("div",lt,[i("div",ht,[i("button",{class:M(h.isSchoolSelected?"isCurrentlySelected":"side-buttons"),onClick:r[0]||(r[0]=e=>d.selectElement("school"))}," school ",2)]),(p(!0),_(F,null,O(h.teachers,e=>(p(),_("div",{key:e.id},[i("div",dt,[i("button",{class:M(e.id===h.selectedTeacher.id?"isCurrentlySelected":"side-buttons"),onClick:o=>d.selectElement(e)},N(e.username),11,mt)])]))),128))]),i("div",gt,[i("div",pt,[ut,i("div",_t,[i("div",ft,[C(n,{to:"/progress-report",class:"",target:"_blank"},{default:$(()=>[yt]),_:1}),i("div",St,[a.analyticsStore.progress.tenant.length>0||a.analyticsStore.progress.class.length>0?(p(),y(l,{key:0,ref:"progressChart"},null,512)):(p(),_("p",vt,"No data"))])]),i("div",xt,[C(n,{to:"/challenges-report",class:"",target:"_blank"},{default:$(()=>[Ct]),_:1}),i("div",$t,[a.analyticsStore.rootSubjectsFailedAssessments.length>0?(p(),y(m,{key:0,data:a.analyticsStore.rootSubjectsFailedAssessments,ref:"failedAssessmentsChart"},null,8,["data"])):D("",!0)])])]),i("div",wt,[i("div",kt,[C(n,{to:"/reports/cost",class:"",target:"_blank"},{default:$(()=>[Tt]),_:1}),i("div",bt,[a.analyticsStore.cost.tenant.length>0||a.analyticsStore.cost.class.length>0?(p(),y(c,{key:0,ref:"costChart"},null,512)):(p(),_("p",Dt,"No data"))])]),i("div",Bt,[C(n,{to:"/engagement-report",target:"_blank"},{default:$(()=>[At]),_:1}),i("div",It,[a.analyticsStore.time.tenant.length>0||a.analyticsStore.time.class.length>0?(p(),y(g,{key:0,ref:"timeChart"},null,512)):(p(),_("p",Pt,"No data"))])])])])])])}const Et=f(it,[["render",jt],["__scopeId","data-v-55f15514"]]),qt={name:"TeacherProgressChart",props:[],data(){return{axisData:[]}},mounted(){},methods:{createChart(t){if(console.log(t),t.class.length==0)this.axisData=t.tenant;else if(t.tenant.length==0)this.axisData=t.class;else{const o=t.class.reduce((v,x)=>Math.max(v,x.quantity),-1/0),S=t.tenant.reduce((v,x)=>Math.max(v,x.quantity),-1/0);o>=S?this.axisData=t.class:this.axisData=t.tenant}const r=Object.entries(t).map(([o,S])=>({name:o,values:S})),s=document.getElementById("progress-chart-container").clientWidth,a=document.getElementById("progress-chart-container").clientHeight,h=5,d=20,n=20,l=20,m=B(I(this.axisData,o=>o.date),[l,s-d]),c=w([0,T(this.axisData,o=>o.quantity)],[a-n,h]),g=A().x(o=>m(o.date)).y(o=>c(o.quantity)),e=b("#progress-chart-container").append("svg").attr("width","100%").attr("height","100%").attr("viewBox",[0,0,+Math.min(s,a),+Math.min(s,a)]).attr("preserveAspectRatio","xMinYMin");e.append("g").attr("transform",`translate(0,${a-20})`).call(P(m).ticks(s/100).tickSizeOuter(0)),e.append("g").attr("transform",`translate(${l},0)`).call(k(c).ticks(a/80)).call(o=>o.selectAll(".tick line").clone().attr("x2",s-l-d).attr("stroke-opacity",.1)),e.selectAll(".line").data(r).join("path").attr("fill","none").attr("stroke",o=>o.name=="class"?"green":"#ff7f0e").attr("stroke-width",3).attr("d",o=>g(o.values))}}};function Rt(t,r,s,a,h,d){return null}const Mt=f(qt,[["render",Rt]]),Lt={name:"SchoolTimeChart",props:[],data(){return{axisData:[]}},mounted(){},methods:{createChart(t){if(t.class.length==0)this.axisData=t.tenant;else if(t.tenant.length==0)this.axisData=t.class;else{const o=t.class.reduce((v,x)=>Math.max(v,x.quantity),-1/0),S=t.tenant.reduce((v,x)=>Math.max(v,x.quantity),-1/0);o>=S?this.axisData=t.class:this.axisData=t.tenant}const r=Object.entries(t).map(([o,S])=>({name:o,values:S})),s=document.getElementById("time-chart-container").clientWidth,a=document.getElementById("time-chart-container").clientHeight,h=0,d=20,n=20,l=20,m=B(I(this.axisData,o=>o.date),[l,s-d]),c=w([0,T(this.axisData,o=>o.formattedQuantity)],[a-n,h]),g=A().x(o=>m(o.date)).y(o=>c(o.minutes)),e=b("#time-chart-container").append("svg").attr("width","100%").attr("height","100%").attr("viewBox",[0,0,+Math.min(s,a),+Math.min(s,a)]).attr("preserveAspectRatio","xMinYMin");e.append("g").attr("transform",`translate(0,${a-n})`).call(P(m).ticks(this.axisData.length).tickSizeOuter(0)),e.append("g").attr("transform",`translate(${l},0)`).call(k(c).ticks(a/40)).call(o=>o.select(".domain").remove()).call(o=>o.selectAll(".tick line").clone().attr("x2",s-l-d).attr("stroke-opacity",.2)).call(o=>o.append("text").attr("x",-l).attr("y",10).attr("fill","currentColor").attr("text-anchor","start")),e.selectAll(".line").data(r).join("path").attr("fill","none").attr("stroke",o=>o.name=="class"?"RoyalBlue":"#ff7f0e").attr("stroke-width",3).attr("d",o=>{console.log(o),g(o.values)})}}};function Ft(t,r,s,a,h,d){return null}const zt=f(Lt,[["render",Ft]]);const Ht={name:"Teacher-Analytics-Dashboard",setup(){const t=R(),r=j(),s=L();return{userDetailsStore:t,analyticsStore:r,usersStore:s}},data(){return{progressChartMode:"teacher"}},components:{TeacherProgressChart:Mt,TeacherTimeChart:zt},async created(){await this.getProgressData(),await this.getTimeData()},methods:{async getProgressData(){await this.analyticsStore.getSchoolProgress(this.userDetailsStore.tenantId),await this.analyticsStore.getClassProgress(this.userDetailsStore.userId),this.$nextTick(()=>{this.$refs.progressChart&&this.$refs.progressChart.createChart(this.analyticsStore.progress)})},async getTimeData(){await this.analyticsStore.getClassTime(this.userDetailsStore.userId),await this.analyticsStore.getSchoolTime(this.userDetailsStore.tenantId),this.$nextTick(()=>{this.$refs.timeChart&&this.$refs.timeChart.createChart(this.analyticsStore.time)})},async getComparisonData(){try{const t=await fetch(`/student-analytics/passed-assessments-by-subject/tenant/${this.userDetailsStore.tenantId}`);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);this.analyticsStore.rootSubjectsPassedAssessments=await t.json(),this.$nextTick(()=>{this.$refs.comparisonChart&&this.$refs.comparisonChart.createChart(this.analyticsStore.rootSubjectsPassedAssessments)})}catch(t){console.error("Error fetching cohort mastered assessments:",t),this.analyticsStore.rootSubjectsPassedAssessments=[]}}}},q=t=>(H("data-v-08ae04fb"),t=t(),V(),t),Vt={class:"dashboard"},Ot={class:"container-fluid"},Nt=z('<div class="row top-row" data-v-08ae04fb><div class="col-sm top-row-text" data-v-08ae04fb><strong data-v-08ae04fb>Skills Mastered: </strong><span data-v-08ae04fb>10</span></div><div class="col-sm top-row-text" data-v-08ae04fb><strong data-v-08ae04fb>Students: </strong><span data-v-08ae04fb>5</span></div><div class="col-sm top-row-text" data-v-08ae04fb></div><div class="col-sm top-row-text" data-v-08ae04fb></div></div>',1),Wt={class:"dash-row row"},Ut={class:"col-md h-100"},Yt=q(()=>i("h2",{class:"heading h5"},"Progress",-1)),Qt={id:"progress-chart-container",class:"position-relative"},Gt=q(()=>i("div",{class:"col-md"},[i("h2",{class:"heading h5"},"Challenges")],-1)),Jt={class:"dash-row row mt-2 mb-2"},Kt={class:"col-md position-relative"},Xt=q(()=>i("h2",{class:"heading h5"},"Cost By Subject",-1)),Zt={class:"col-md position-relative"},te={id:"time-chart-container"},ee=q(()=>i("h2",{class:"heading h5"},"Engagement",-1));function se(t,r,s,a,h,d){const n=u("RouterLink"),l=u("TeacherProgressChart"),m=u("TeacherTimeChart");return p(),_("div",Vt,[i("div",Ot,[Nt,i("div",Wt,[i("div",Ut,[C(n,{to:"/reports/academics",class:""},{default:$(()=>[Yt]),_:1}),i("div",Qt,[a.analyticsStore.progress.tenant.length>0||a.analyticsStore.progress.class.length>0?(p(),y(l,{key:0,ref:"progressChart"},null,512)):D("",!0)])]),Gt]),i("div",Jt,[i("div",Kt,[C(n,{to:"/reports/cost",class:"me-2 position-absolute chart-heading"},{default:$(()=>[Xt]),_:1})]),i("div",Zt,[i("div",te,[C(n,{to:"/reports/engagement",class:"position-absolute chart-heading"},{default:$(()=>[ee]),_:1}),a.analyticsStore.time.tenant.length>0||a.analyticsStore.time.class.length>0?(p(),y(m,{key:0,ref:"timeChart"},null,512)):D("",!0)])])])])])}const ae=f(Ht,[["render",se],["__scopeId","data-v-08ae04fb"]]),re={name:"Dashboard",setup(){return{userDetailsStore:R()}},data(){return{}},components:{SchoolAdminDashboard:Et,TeacherAnalyticsDashboard:ae},async created(){}};function oe(t,r,s,a,h,d){const n=u("SchoolAdminDashboard"),l=u("TeacherAnalyticsDashboard");return p(),_(F,null,[a.userDetailsStore.role=="school_admin"?(p(),y(n,{key:0})):D("",!0),a.userDetailsStore.role=="instructor"||a.userDetailsStore.role=="partner"?(p(),y(l,{key:1})):D("",!0)],64)}const fe=f(re,[["render",oe]]);export{fe as default};
