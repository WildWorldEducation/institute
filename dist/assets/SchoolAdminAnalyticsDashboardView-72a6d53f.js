import{u as T}from"./AnalyticsStore-ba0e01a9.js";import{_,o as g,c as C,e as A,y as B,r as f,a as n,C as j,f as y,l as v,k as S,b}from"./main-c88d736d.js";import"./transform-4d0f7c8f.js";import{u as x,l as $}from"./line-d122782f.js";import{e as k}from"./time-3c9385c3.js";import{l as w,a as I,b as E,c as L}from"./linear-d9b6cbf2.js";import{m as D}from"./continuous-93813e6c.js";import{o as M,b as R}from"./band-2263c9e7.js";import{s as u}from"./string-c67ea49d.js";import{c as V}from"./category10-63f9141e.js";import{s as q}from"./sort-fcaf8f38.js";import"./point-ea70dc51.js";import"./colors-98f238a0.js";const H={name:"SchoolProgressChart",props:[],data(){return{axisData:[]}},mounted(){},methods:{createChart(s){s.school.length>0?this.axisData=s.school:this.axisData=[];const t=Object.entries(s).map(([r,P])=>({name:r,values:P}));u("#progress-chart-container");const a=document.getElementById("progress-chart-container").clientWidth,o=document.getElementById("progress-chart-container").clientHeight,i=0,c=0,h=0,d=0,l=x(k(this.axisData,r=>r.date),[d,a-c]),m=w([0,D(this.axisData,r=>r.quantity)],[o-h,i]),p=M().domain(t.map(r=>r.name)).range(V),e=$().x(r=>l(r.date)).y(r=>m(r.quantity));u("#progress-chart-container").append("svg").attr("width","100%").attr("height","100%").attr("viewBox",[0,0,+Math.min(a,o),+Math.min(a,o)]).attr("preserveAspectRatio","xMinYMin").selectAll(".line").data(t).join("path").attr("fill","none").attr("stroke",r=>p(r.name)).attr("stroke-width",3).attr("d",r=>e(r.values))},updateChart(s){}}};function N(s,t,a,o,i,c){return null}const O=_(H,[["render",N]]),U={name:"SchoolComparisonChart",props:["colour"],data(){return{}},mounted(){},methods:{createChart(s){u("#school-comparison-chart-container");const t=40,a=0,o=0,i=10,c=200,h=1e3,d=Math.ceil((s.length+.1)*t)+a+i,l=w().domain([0,D(s,e=>e.quantity)]).range([c,h-o]),m=R().domain(q(s,e=>-e.quantity).map(e=>e.name)).rangeRound([a,d-i]).padding(.1);l.tickFormat(20);const p=u("#school-comparison-chart-container").append("svg").attr("width",h).attr("height",d).attr("viewBox",[0,0,h,d]).attr("style","max-width: 100%; height: 100%; font: 16px sans-serif;");p.append("g").attr("fill",this.colour).selectAll().data(s).join("rect").attr("x",l(0)).attr("y",e=>m(e.name)).attr("width",e=>l(e.quantity)-l(0)).attr("height",m.bandwidth()),p.append("g").attr("transform",`translate(0,${a})`).call(I(l).ticks(0)).call(e=>e.select(".domain").remove()),p.append("g").attr("transform",`translate(${c},0)`).style("font","20px sans-serif").call(E(m).tickSizeOuter(0))}}},W={id:"school-comparison-chart-container"};function z(s,t,a,o,i,c){return g(),C("div",W)}const F=_(U,[["render",z]]),Y={name:"SchoolTimeChart",props:["colour"],data(){return{}},mounted(){},methods:{createChart(s){u("#school-time-chart-container");const t=document.getElementById("time-chart-container").clientWidth,a=document.getElementById("time-chart-container").clientHeight,o=0,i=0,c=0,h=0,d=x(k(s,e=>e.date),[h,t-i]),l=w([0,D(s,e=>e.minutes)],[a-c,o]),m=$().x(e=>d(e.date)).y(e=>l(e.minutes)),p=u("#school-time-chart-container").append("svg").attr("width",t).attr("height",a).attr("viewBox",[0,0,t,a]).attr("style","max-width: 100%; height: auto; height: intrinsic;");p.append("g").attr("transform",`translate(0,${a-c})`).call(L(d).ticks(s.length/2).tickSizeOuter(0)),p.append("path").attr("fill","none").attr("stroke","#ff7f0e").attr("stroke-width",3).attr("d",m(s))}}},G={id:"school-time-chart-container"};function J(s,t,a,o,i,c){return g(),C("div",G)}const K=_(Y,[["render",J]]);const Q={name:"School-Admin-Dashboard",setup(){const s=A(),t=T(),a=B();return{userDetailsStore:s,analyticsStore:t,usersStore:a}},data(){return{showSidebar:!0,screenWidth:screen.width,isEveryone:!0,isSchoolData:!1,isLanguageData:!1,isMathData:!1,isHistoryData:!1,isLifeData:!1,isCSData:!1,isSAndIData:!1,isDIData:!1,progressData:{school:[]},isAboveTheCurve:!1}},components:{SchoolProgressChart:O,SchoolComparisonChart:F,SchoolTimeChart:K},async created(){await this.analyticsStore.getSchoolProgress(this.userDetailsStore.tenantId),this.analyticsStore.rootSubjectsPassedAssessments.length==0&&await this.getComparisonData(),await this.getProgressData(),await this.getTimeData()},methods:{async getProgressData(){this.progressData.school=[];for(let s=0;s<this.analyticsStore.progress.tenant.length;s++)this.progressData.school.push(this.analyticsStore.progress.tenant[s]);this.$nextTick(()=>{this.$refs.progressChart&&this.$refs.progressChart.createChart(this.progressData)})},async getComparisonData(){try{const s=await fetch(`/student-analytics/passed-assessments-by-subject/tenant/${this.userDetailsStore.tenantId}`);if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);this.analyticsStore.rootSubjectsPassedAssessments=await s.json(),this.$nextTick(()=>{this.$refs.comparisonChart&&this.$refs.comparisonChart.createChart(this.analyticsStore.rootSubjectsPassedAssessments)})}catch(s){console.error("Error fetching cohort mastered assessments:",s),this.analyticsStore.rootSubjectsPassedAssessments=[]}},async getTimeData(){this.analyticsStore.durationPerDay=[];let s=`/student-analytics/tenant-duration-per-day/weekly/${this.userDetailsStore.tenantId}`;fetch(s).then(t=>t.json()).then(async t=>{this.analyticsStore.durationPerDay=[];for(let a=0;a<t.length;a++)t[a].date=new Date(t[a].date),t[a].minutes=t[a].milliseconds/(1e3*60),this.analyticsStore.durationPerDay.push(t[a]);this.analyticsStore.durationPerDay.sort((a,o)=>a.date-o.date),this.$nextTick(()=>{this.$refs.timeChart&&this.$refs.timeChart.createChart(this.analyticsStore.durationPerDay)})}).catch(t=>{console.error("Error fetching student progress:",t)})}}},X={class:"dashboard"},Z={class:"container"},tt={class:"dash-row row"},st={id:"progress-chart-container",class:"col-md position-relative"},at={class:"col-md"},et={class:"dash-row row mt-2 mb-2"},ot={class:"col-md position-relative"},rt={class:"col-md position-relative"},nt={id:"time-chart-container"};function it(s,t,a,o,i,c){const h=f("RouterLink"),d=f("SchoolProgressChart"),l=f("SchoolComparisonChart"),m=f("SchoolTimeChart");return g(),C("div",X,[n("div",Z,[t[4]||(t[4]=j('<div class="row top-row" data-v-401773fb><div class="col-sm" data-v-401773fb><h2 class="h5 heading m-0" data-v-401773fb>Avg # Skills Mastered</h2><span class="top-row-text" data-v-401773fb>10</span></div><div class="col-sm" data-v-401773fb><h2 class="h5 heading m-0" data-v-401773fb>Students</h2><span class="top-row-text" data-v-401773fb>35</span></div><div class="col-sm" data-v-401773fb><h2 class="h5 heading m-0" data-v-401773fb>Teachers</h2><span class="top-row-text" data-v-401773fb>5</span></div><div class="col-sm" data-v-401773fb><h2 class="h5 heading m-0" data-v-401773fb>AI Tutor Usage</h2><span class="top-row-text" data-v-401773fb>$500</span></div></div>',1)),n("div",tt,[n("div",st,[y(h,{to:"/reports/academics",class:"me-2 position-absolute chart-heading"},{default:v(()=>t[0]||(t[0]=[n("h2",{class:"heading h5"},"Student progress",-1)])),_:1,__:[0]}),i.progressData.school.length>0?(g(),S(d,{key:0,ref:"progressChart"},null,512)):b("",!0)]),n("div",at,[t[1]||(t[1]=n("h2",{class:"heading chart-heading h5"},"Subject comparison",-1)),o.analyticsStore.rootSubjectsPassedAssessments.length>0?(g(),S(l,{key:0,colour:"#5f31dd",ref:"comparisonChart"},null,512)):b("",!0)])]),n("div",et,[n("div",ot,[y(h,{to:"/reports/cost",class:"me-2 position-absolute chart-heading"},{default:v(()=>t[2]||(t[2]=[n("h2",{class:"heading h5"},"Cost By Subject",-1)])),_:1,__:[2]})]),n("div",rt,[n("div",nt,[y(h,{to:"/reports/engagement",class:"position-absolute chart-heading"},{default:v(()=>[t[3]||(t[3]=n("h2",{class:"heading h5"},"Student Engagement",-1)),o.analyticsStore.durationPerDay.length>0?(g(),S(m,{key:0,ref:"timeChart"},null,512)):b("",!0)]),_:1,__:[3]})])])])])])}const Ct=_(Q,[["render",it],["__scopeId","data-v-401773fb"]]);export{Ct as default};
