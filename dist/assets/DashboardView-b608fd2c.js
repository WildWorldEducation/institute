import{_ as S,o as c,c as y,e as F,y as M,r as _,a as o,m as A,F as R,x as H,t as z,b as w,j as p,k as f,f as x,p as L}from"./main-e512bfba.js";import{u as E}from"./AnalyticsStore-dae791b6.js";import"./transform-af9a74a2.js";import{u as B,l as I}from"./line-85f04100.js";import{e as P}from"./extent-4cf1c809.js";import{l as v,a as j,b as T,c as V}from"./linear-5b188edc.js";import{m as D,b as Y}from"./continuous-7328829e.js";import{s as b}from"./string-dd82ab4a.js";import{s as U}from"./sort-ed61f96d.js";import"./time-0457d93b.js";import"./point-ea70dc51.js";const G={name:"SchoolProgressChart",setup(){return{analyticsStore:E()}},data(){return{}},mounted(){},methods:{createChart(t){this.$parent.progressChartMode==="school"?(this.axisData=t.school,t.school):(this.axisData=t.teacher,t.teacher);const e=document.getElementById("progress-chart-container").clientWidth,r=document.getElementById("progress-chart-container").clientHeight,a=5,n=20,d=20,i=25,g=B(P(this.analyticsStore.progress.tenant,s=>s.date),[i,e-n]),m=v([0,D(this.analyticsStore.progress.tenant,s=>s.quantity)],[r-d,a]),h=I().x(s=>g(s.date)).y(s=>m(s.quantity)),u=b("#progress-chart-container").append("svg").attr("width",e).attr("height",r).attr("viewBox",[0,0,e,r]).attr("style","max-width: 100%; height: auto; height: intrinsic;");u.append("g").attr("transform",`translate(0,${r-20})`).call(j(g).ticks(e/100).tickSizeOuter(0)),u.append("g").attr("transform",`translate(${i},0)`).call(T(m).ticks(r/40)).call(s=>s.select(".domain").remove()).call(s=>s.selectAll(".tick line").clone().attr("x2",e-i-n).attr("stroke-opacity",.2)).call(s=>s.append("text").attr("x",-i).attr("y",10).attr("fill","currentColor").attr("text-anchor","start")),u.append("path").attr("fill","none").attr("stroke","green").attr("stroke-width",3).attr("d",h(t))}}};function J(t,e,r,a,n,d){return null}const N=S(G,[["render",J]]),K={name:"SchoolTimeChart",setup(){return{analyticsStore:E()}},data(){return{}},mounted(){},methods:{createChart(t){const e=document.getElementById("time-chart-container").clientWidth,r=document.getElementById("time-chart-container").clientHeight,a=0,n=20,d=20,i=25,g=B(P(this.analyticsStore.time.tenant,s=>s.date),[i,e-n]),m=v([0,D(this.analyticsStore.time.tenant,s=>s.minutes)],[r-d,a]),h=I().x(s=>g(s.date)).y(s=>m(s.minutes)),u=b("#school-time-chart-container").append("svg").attr("width",e).attr("height",r).attr("viewBox",[0,0,e,r]).attr("style","max-width: 100%; height: auto; height: intrinsic;");u.append("g").attr("transform",`translate(0,${r-d})`).call(j(g).ticks(t.length).tickSizeOuter(0)),u.append("g").attr("transform",`translate(${i},0)`).call(T(m).ticks(r/40)).call(s=>s.select(".domain").remove()).call(s=>s.selectAll(".tick line").clone().attr("x2",e-i-n).attr("stroke-opacity",.2)).call(s=>s.append("text").attr("x",-i).attr("y",10).attr("fill","currentColor").attr("text-anchor","start")),u.append("path").attr("fill","none").attr("stroke","#ff7f0e").attr("stroke-width",3).attr("d",h(t))}}},Q={id:"school-time-chart-container"};function X(t,e,r,a,n,d){return c(),y("div",Q)}const W=S(K,[["render",X]]),Z={name:"TenantFailedAssessmentsByRootSubjectHorizontalBarChart",props:["data"],data(){return{}},mounted(){const n=document.getElementById("failed-chart-container").clientWidth,d=document.getElementById("failed-chart-container").clientHeight,i=v().domain([0,D(this.data,h=>h.quantity)]).range([200,n-0]),g=Y().domain(U(this.data,h=>-h.quantity).map(h=>h.name)).rangeRound([0,d-10]).padding(.1);i.tickFormat(20);const m=b("#failed-chart-container").append("svg").attr("width",n).attr("height",d).attr("viewBox",[0,0,n,d]).attr("style","max-width: 100%; height: 100%;");m.append("g").attr("fill","darkred").selectAll().data(this.data).join("rect").attr("x",i(0)).attr("y",h=>g(h.name)).attr("width",h=>i(h.quantity)-i(0)).attr("height",g.bandwidth()),m.append("g").attr("fill","white").attr("text-anchor","end").selectAll().data(this.data).join("text").attr("x",h=>i(h.quantity)).attr("y",h=>g(h.name)+g.bandwidth()/2).attr("dy","0.35em").attr("dx",-4).text(h=>h.quantity).call(h=>h.filter(u=>i(u.quantity)-i(0)<20).attr("dx",4).attr("fill","black").attr("text-anchor","start")),m.append("g").attr("transform","translate(0,0)").call(V(i).ticks(0)).call(h=>h.select(".domain").remove()),m.append("g").attr("transform","translate(200,0)").call(T(g).tickSizeOuter(0))}};function tt(t,e,r,a,n,d){return null}const q=S(Z,[["render",tt]]),et={name:"TenantTokensPerDayLineChart",props:[],data(){return{}},methods:{createChart(t){const e=document.getElementById("cost-chart-container").clientWidth,r=document.getElementById("cost-chart-container").clientHeight,a=20,n=20,d=20,i=25,g=B(P(t,s=>s.date),[i,e-n]),m=v([0,D(t,s=>s.quantity)],[r-d,a]),h=I().x(s=>g(s.date)).y(s=>m(s.quantity)),u=b("#cost-chart-container").append("svg").attr("width",e).attr("height",r).attr("viewBox",[0,0,e,r]).attr("style","max-width: 100%; height: auto; height: intrinsic;");u.append("g").attr("transform",`translate(0,${r-d})`).call(j(g).ticks(t.length).tickSizeOuter(0)),u.append("g").attr("transform",`translate(${i},0)`).call(T(m).ticks(r/80)).call(s=>s.selectAll(".tick line").clone().attr("x2",e-i-n).attr("stroke-opacity",.1)).call(s=>s.append("text").attr("x",-i).attr("y",10).attr("fill","currentColor").attr("text-anchor","start").text("↑ Tokens")),u.append("path").attr("fill","none").attr("stroke","teal").attr("stroke-width",3).attr("d",h(t))}}};function st(t,e,r,a,n,d){return null}const O=S(et,[["render",st]]);const at={name:"School-Admin-Class-Dashboard",setup(){const t=F(),e=E(),r=M();return{userDetailsStore:t,analyticsStore:e,usersStore:r}},data(){return{progressChartMode:"school",isAboveTheCurve:!1,teachers:[],selectedTeacher:{},isSchoolSelected:!0}},components:{SchoolProgressChart:N,SchoolTimeChart:W,TenantFailedAssessmentsByRootSubjectHorizontalBarChart:q,SchoolCostChart:O},async created(){this.teachers.length<1&&await this.getTeachers(this.userDetailsStore.tenantId),await this.getSchoolData(),this.analyticsStore.rootSubjectsFailedAssessments.length==0&&await this.getFailedAssessmentsBySubject(),await this.getSchoolCostData()},methods:{async getTeachers(t){const r=await(await fetch("/tenants/instructors/"+t)).json();for(let a=0;a<r.length;a++)r[a].type="teacher";this.teachers=r},async selectElement(t){this.clearCharts(),t.type==="teacher"?(this.selectedTeacher=t,this.isSchoolSelected=!1,await this.getClassData()):t==="school"&&(this.isSchoolSelected=!0,this.selectedTeacher={},await this.getSchoolData())},clearCharts(){this.analyticsStore.progress.class=[],this.analyticsStore.durationPerDay=[];let t=document.getElementById("progress-chart-container"),e=t.querySelector("svg");e&&e.remove(),t=document.getElementById("time-chart-container"),e=t.querySelector("svg"),e&&e.remove()},async getSchoolData(){this.progressChartMode="school",await this.getSchoolProgressData(),await this.getSchoolTimeData()},async getClassData(){this.progressChartMode="teacher",await this.getClassProgressData(this.selectedTeacher.id),await this.getClassTimeData()},async getSchoolProgressData(){await this.analyticsStore.getSchoolProgress(this.userDetailsStore.tenantId),this.$nextTick(()=>{this.$refs.progressChart&&this.$refs.progressChart.createChart(this.analyticsStore.progress.tenant)})},async getClassProgressData(){await this.analyticsStore.getClassProgress(this.selectedTeacher.id),this.$nextTick(()=>{this.$refs.progressChart&&this.$refs.progressChart.createChart(this.analyticsStore.progress.class)})},async getSchoolTimeData(){await this.analyticsStore.getSchoolTime(this.userDetailsStore.tenantId),this.$nextTick(()=>{this.$refs.timeChart&&this.$refs.timeChart.createChart(this.analyticsStore.time.tenant)})},async getClassTimeData(){await this.analyticsStore.getClassTime(this.selectedTeacher.id),this.$nextTick(()=>{this.$refs.timeChart&&this.$refs.timeChart.createChart(this.analyticsStore.time.class)})},async getFailedAssessmentsBySubject(){try{const t=await fetch(`/student-analytics/failed-assessments-by-subject/tenant/${this.userDetailsStore.tenantId}`);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);this.analyticsStore.rootSubjectsFailedAssessments=await t.json()}catch(t){console.error("Error fetching cohort mastered assessments:",t),this.analyticsStore.rootSubjectsFailedAssessments=[]}},async getSchoolCostData(){await this.analyticsStore.getSchoolCost(this.userDetailsStore.tenantId,"weekly"),this.$nextTick(()=>{this.$refs.costChart&&this.$refs.costChart.createChart(this.analyticsStore.cost.tenant)})}}},rt={class:"dashboard"},ot={key:0,class:"col-lg-1 col-md-2"},nt={class:"d-flex bg-light rounded p-2"},it={class:"d-flex bg-light rounded p-2"},ct=["onClick"],lt={class:"container-fluid"},ht={class:"dash-row row"},dt={class:"col-md h-100"},gt={key:1,class:"heading h5"},mt={id:"progress-chart-container"},ut={key:1},yt={class:"col-md"},pt={key:1,class:"heading h5"},_t={id:"failed-chart-container"},ft={key:1},St={class:"dash-row row"},Ct={class:"col-md position-relative h-100"},kt={key:1,class:"heading h5"},$t={id:"cost-chart-container"},xt={key:1},wt={class:"col-md h-100"},vt={key:1,class:"heading h5"},Tt={id:"time-chart-container"},Dt={key:1};function bt(t,e,r,a,n,d){const i=_("RouterLink"),g=_("SchoolProgressChart"),m=_("TenantFailedAssessmentsByRootSubjectHorizontalBarChart"),h=_("SchoolCostChart"),u=_("SchoolTimeChart");return c(),y("div",rt,[n.teachers.length>0?(c(),y("div",ot,[o("div",nt,[o("button",{class:A(n.isSchoolSelected?"isCurrentlySelected":"side-buttons"),onClick:e[0]||(e[0]=s=>d.selectElement("school"))}," school ",2)]),(c(!0),y(R,null,H(n.teachers,s=>(c(),y("div",{key:s.id},[o("div",it,[o("button",{class:A(s.id===n.selectedTeacher.id?"isCurrentlySelected":"side-buttons"),onClick:l=>d.selectElement(s)},z(s.username),11,ct)])]))),128))])):w("",!0),o("div",{class:A([{"col-lg-11":n.teachers.length>0,"col-md-10":n.teachers.length>0,"col-lg-12":n.teachers.length==0},"dashboard"])},[o("div",lt,[o("div",ht,[o("div",dt,[n.progressChartMode=="school"?(c(),p(i,{key:0,to:"/progress-report",class:"",target:"_blank"},{default:f(()=>e[1]||(e[1]=[o("h2",{class:"heading h5"},"Progress",-1)])),_:1,__:[1]})):(c(),y("h2",gt,"Progress")),o("div",mt,[n.progressChartMode=="school"&&a.analyticsStore.progress.tenant.length>0||n.progressChartMode=="teacher"&&a.analyticsStore.progress.class.length>0?(c(),p(g,{key:0,ref:"progressChart"},null,512)):(c(),y("p",ut,"No data yet"))])]),o("div",yt,[n.progressChartMode=="school"?(c(),p(i,{key:0,to:"/challenges-report",class:"",target:"_blank"},{default:f(()=>e[2]||(e[2]=[o("h2",{class:"heading h5"},"Challenges",-1)])),_:1,__:[2]})):(c(),y("h2",pt,"Challenges")),o("div",_t,[a.analyticsStore.rootSubjectsFailedAssessments.length>0?(c(),p(m,{key:0,data:a.analyticsStore.rootSubjectsFailedAssessments,ref:"failedAssessmentsChart"},null,8,["data"])):(c(),y("p",ft,"No challenges yet"))])])]),o("div",St,[o("div",Ct,[n.progressChartMode=="school"?(c(),p(i,{key:0,to:"/cost-report",class:"",target:"_blank"},{default:f(()=>e[3]||(e[3]=[o("h2",{class:"heading h5"},"Cost",-1)])),_:1,__:[3]})):(c(),y("h2",kt,"Cost")),o("div",$t,[a.analyticsStore.cost.tenant.length>0||a.analyticsStore.cost.class.length>0?(c(),p(h,{key:0,ref:"costChart"},null,512)):(c(),y("p",xt,"No data yet"))])]),o("div",wt,[n.progressChartMode=="school"?(c(),p(i,{key:0,to:"/engagement-report",target:"_blank"},{default:f(()=>e[4]||(e[4]=[o("h2",{class:"heading h5"},"Weekly engagement",-1)])),_:1,__:[4]})):(c(),y("h2",vt,"Weekly engagement")),o("div",Tt,[a.analyticsStore.time.tenant.length>0||a.analyticsStore.time.class.length>0?(c(),p(u,{key:0,ref:"timeChart"},null,512)):(c(),y("p",Dt,"No data"))])])])])],2)])}const At=S(at,[["render",bt],["__scopeId","data-v-ddc63e53"]]);const Bt={name:"Platform-Admin-Class-Dashboard",setup(){const t=F(),e=E(),r=M();return{userDetailsStore:t,analyticsStore:e,usersStore:r}},data(){return{tenantId:this.$route.params.tenantId,progressChartMode:"school",isAboveTheCurve:!1,teachers:[],selectedTeacher:{},isSchoolSelected:!0}},components:{SchoolProgressChart:N,SchoolTimeChart:W,TenantFailedAssessmentsByRootSubjectHorizontalBarChart:q,SchoolCostChart:O},async created(){this.teachers.length<1&&await this.getTeachers(this.tenantId),await this.getSchoolData(),this.analyticsStore.rootSubjectsFailedAssessments.length==0&&await this.getFailedAssessmentsBySubject(),await this.getSchoolCostData()},methods:{async getTeachers(t){const r=await(await fetch("/tenants/instructors/"+t)).json();for(let a=0;a<r.length;a++)r[a].type="teacher";this.teachers=r},async selectElement(t){this.clearCharts(),t.type==="teacher"?(this.selectedTeacher=t,this.isSchoolSelected=!1,await this.getClassData()):t==="school"&&(this.isSchoolSelected=!0,this.selectedTeacher={},await this.getSchoolData())},clearCharts(){this.analyticsStore.progress.class=[],this.analyticsStore.durationPerDay=[];let t=document.getElementById("progress-chart-container"),e=t.querySelector("svg");e&&e.remove(),t=document.getElementById("time-chart-container"),e=t.querySelector("svg"),e&&e.remove()},async getSchoolData(){this.progressChartMode="school",await this.getSchoolProgressData(),await this.getSchoolTimeData()},async getClassData(){this.progressChartMode="teacher",await this.getClassProgressData(this.selectedTeacher.id),await this.getClassTimeData()},async getSchoolProgressData(){await this.analyticsStore.getSchoolProgress(this.tenantId),this.$nextTick(()=>{this.$refs.progressChart&&this.$refs.progressChart.createChart(this.analyticsStore.progress.tenant)})},async getClassProgressData(){await this.analyticsStore.getClassProgress(this.tenantId,this.selectedTeacher.id),this.$nextTick(()=>{this.$refs.progressChart&&this.$refs.progressChart.createChart(this.analyticsStore.progress.class)})},async getSchoolTimeData(){await this.analyticsStore.getSchoolTime(this.tenantId),this.$nextTick(()=>{this.$refs.timeChart&&this.$refs.timeChart.createChart(this.analyticsStore.time.tenant)})},async getClassTimeData(){await this.analyticsStore.getClassTime(this.selectedTeacher.id),this.$nextTick(()=>{this.$refs.timeChart&&this.$refs.timeChart.createChart(this.analyticsStore.time.class)})},async getFailedAssessmentsBySubject(){try{const t=await fetch(`/student-analytics/failed-assessments-by-subject/tenant/${this.tenantId}`);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);this.analyticsStore.rootSubjectsFailedAssessments=await t.json()}catch(t){console.error("Error fetching cohort mastered assessments:",t),this.analyticsStore.rootSubjectsFailedAssessments=[]}},async getSchoolCostData(){await this.analyticsStore.getSchoolCost(this.tenantId,"weekly"),this.$nextTick(()=>{this.$refs.costChart&&this.$refs.costChart.createChart(this.analyticsStore.cost.tenant)})}}},It={class:"dashboard"},Pt={key:0,class:"col-lg-1 col-md-2"},jt={class:"d-flex bg-light rounded p-2"},Et={class:"d-flex bg-light rounded p-2"},Ft=["onClick"],Mt={class:"container-fluid"},Rt={class:"dash-row row"},qt={class:"col-md h-100"},Lt={id:"progress-chart-container"},Ht={key:1},zt={class:"col-md"},Nt={id:"failed-chart-container"},Wt={key:1},Ot={class:"dash-row row"},Vt={class:"col-md position-relative h-100"},Yt={id:"cost-chart-container"},Ut={key:1},Gt={class:"col-md h-100"},Jt={id:"time-chart-container"},Kt={key:1};function Qt(t,e,r,a,n,d){const i=_("RouterLink"),g=_("SchoolProgressChart"),m=_("TenantFailedAssessmentsByRootSubjectHorizontalBarChart"),h=_("SchoolCostChart"),u=_("SchoolTimeChart");return c(),y("div",It,[n.teachers.length>0?(c(),y("div",Pt,[o("div",jt,[o("button",{class:A(n.isSchoolSelected?"isCurrentlySelected":"side-buttons"),onClick:e[0]||(e[0]=s=>d.selectElement("school"))}," school ",2)]),(c(!0),y(R,null,H(n.teachers,s=>(c(),y("div",{key:s.id},[o("div",Et,[o("button",{class:A(s.id===n.selectedTeacher.id?"isCurrentlySelected":"side-buttons"),onClick:l=>d.selectElement(s)},z(s.username),11,Ft)])]))),128))])):w("",!0),o("div",{class:A([{"col-lg-11":n.teachers.length>0,"col-md-10":n.teachers.length>0,"col-lg-12":n.teachers.length==0},"dashboard"])},[o("div",Mt,[o("div",Rt,[o("div",qt,[x(i,{to:"/progress-report",class:"",target:"_blank"},{default:f(()=>e[1]||(e[1]=[o("h2",{class:"heading h5"},"Progress",-1)])),_:1,__:[1]}),o("div",Lt,[n.progressChartMode=="school"&&a.analyticsStore.progress.tenant.length>0||n.progressChartMode=="class"&&a.analyticsStore.progress.class.length>0?(c(),p(g,{key:0,ref:"progressChart"},null,512)):(c(),y("p",Ht,"No data yet"))])]),o("div",zt,[x(i,{to:"/challenges-report",class:"",target:"_blank"},{default:f(()=>e[2]||(e[2]=[o("h2",{class:"heading h5"},"Challenges",-1)])),_:1,__:[2]}),o("div",Nt,[a.analyticsStore.rootSubjectsFailedAssessments.length>0?(c(),p(m,{key:0,data:a.analyticsStore.rootSubjectsFailedAssessments,ref:"failedAssessmentsChart"},null,8,["data"])):(c(),y("p",Wt,"No challenges yet"))])])]),o("div",Ot,[o("div",Vt,[x(i,{to:"/cost-report",class:"",target:"_blank"},{default:f(()=>e[3]||(e[3]=[o("h2",{class:"heading h5"},"Cost",-1)])),_:1,__:[3]}),o("div",Yt,[a.analyticsStore.cost.tenant.length>0||a.analyticsStore.cost.class.length>0?(c(),p(h,{key:0,ref:"costChart"},null,512)):(c(),y("p",Ut,"No data yet"))])]),o("div",Gt,[x(i,{to:"/engagement-report",target:"_blank"},{default:f(()=>e[4]||(e[4]=[o("h2",{class:"heading h5"},"Weekly engagement",-1)])),_:1,__:[4]}),o("div",Jt,[a.analyticsStore.time.tenant.length>0||a.analyticsStore.time.class.length>0?(c(),p(u,{key:0,ref:"timeChart"},null,512)):(c(),y("p",Kt,"No data"))])])])])],2)])}const Xt=S(Bt,[["render",Qt],["__scopeId","data-v-698f898b"]]),Zt={name:"TeacherProgressChart",props:[],data(){return{axisData:[]}},mounted(){},methods:{createChart(t){if(t.class.length==0)this.axisData=t.tenant;else if(t.tenant.length==0)this.axisData=t.class;else{const l=t.class.reduce((k,$)=>Math.max(k,$.quantity),-1/0),C=t.tenant.reduce((k,$)=>Math.max(k,$.quantity),-1/0);l>=C?this.axisData=t.class:this.axisData=t.tenant}const e=Object.entries(t).map(([l,C])=>({name:l,values:C})),r=document.getElementById("progress-chart-container").clientWidth,a=document.getElementById("progress-chart-container").clientHeight,n=5,d=20,i=20,g=20,m=B(P(this.axisData,l=>l.date),[g,r-d]),h=v([0,D(this.axisData,l=>l.quantity)],[a-i,n]),u=I().x(l=>m(l.date)).y(l=>h(l.quantity)),s=b("#progress-chart-container").append("svg").attr("width","100%").attr("height","100%").attr("viewBox",[0,0,+Math.min(r,a),+Math.min(r,a)]).attr("preserveAspectRatio","xMinYMin");s.append("g").attr("transform",`translate(0,${a-20})`).call(j(m).ticks(r/100).tickSizeOuter(0)),s.append("g").attr("transform",`translate(${g},0)`).call(T(h).ticks(a/80)).call(l=>l.selectAll(".tick line").clone().attr("x2",r-g-d).attr("stroke-opacity",.1)),s.selectAll(".line").data(e).join("path").attr("fill","none").attr("stroke",l=>l.name=="class"?"green":"#ff7f0e").attr("stroke-width",l=>l.name=="class"?3:2).attr("d",l=>u(l.values))}}};function te(t,e,r,a,n,d){return null}const ee=S(Zt,[["render",te]]),se={name:"SchoolTimeChart",props:[],data(){return{axisData:[]}},mounted(){},methods:{createChart(t){if(t.class.length==0)this.axisData=t.tenant;else if(t.tenant.length==0)this.axisData=t.class;else{const l=t.class.reduce((k,$)=>Math.max(k,$.quantity),-1/0),C=t.tenant.reduce((k,$)=>Math.max(k,$.quantity),-1/0);l>=C?this.axisData=t.class:this.axisData=t.tenant}const e=Object.entries(t).map(([l,C])=>({name:l,values:C})),r=document.getElementById("time-chart-container").clientWidth,a=document.getElementById("time-chart-container").clientHeight,n=0,d=20,i=20,g=25,m=B(P(this.axisData,l=>l.date),[g,r-d]),h=v([0,D(this.axisData,l=>l.minutes)],[a-i,n]),u=I().x(l=>m(l.date)).y(l=>h(l.minutes)),s=b("#time-chart-container").append("svg").attr("width","100%").attr("height","100%").attr("viewBox",[0,0,+Math.min(r,a),+Math.min(r,a)]).attr("preserveAspectRatio","xMinYMin");s.append("g").attr("transform",`translate(0,${a-i})`).call(j(m).ticks(r/100).tickSizeOuter(0)),s.append("g").attr("transform",`translate(${g},0)`).call(T(h).ticks(a/80)).call(l=>l.selectAll(".tick line").clone().attr("x2",r-g-d).attr("stroke-opacity",.1)),s.selectAll(".line").data(e).join("path").attr("fill","none").attr("stroke",l=>l.name=="class"?"RoyalBlue":"#ff7f0e").attr("stroke-width",l=>l.name=="class"?3:2).attr("d",l=>u(l.values))}}};function ae(t,e,r,a,n,d){return null}const re=S(se,[["render",ae]]),oe={name:"TenantTokensPerDayLineChart",props:[],data(){return{}},methods:{createChart(t){const e=document.getElementById("cost-chart-container").clientWidth,r=document.getElementById("cost-chart-container").clientHeight,a=0,n=20,d=20,i=25,g=B(P(t,s=>s.date),[i,e-n]),m=v([0,D(t,s=>s.quantity)],[r-d,a]),h=I().x(s=>g(s.date)).y(s=>m(s.quantity)),u=b("#cost-chart-container").append("svg").attr("width",e).attr("height",r).attr("viewBox",[0,0,e,r]).attr("style","max-width: 100%; height: auto; height: intrinsic;");u.append("g").attr("transform",`translate(0,${r-d})`).call(j(g).ticks(t.length).tickSizeOuter(0)),u.append("g").attr("transform",`translate(${i},0)`).call(T(m).ticks(r/80)).call(s=>s.selectAll(".tick line").clone().attr("x2",e-i-n).attr("stroke-opacity",.1)).call(s=>s.append("text").attr("x",-i).attr("y",10).attr("fill","currentColor").attr("text-anchor","start").text("↑ Tokens")),u.append("path").attr("fill","none").attr("stroke","teal").attr("stroke-width",3).attr("d",h(t))}}};function ne(t,e,r,a,n,d){return null}const ie=S(oe,[["render",ne]]);const ce={name:"Teacher-Analytics-Dashboard",setup(){const t=F(),e=E(),r=M();return{userDetailsStore:t,analyticsStore:e,usersStore:r}},data(){return{progressChartMode:"teacher"}},components:{TeacherProgressChart:ee,TeacherTimeChart:re,TeacherCostChart:ie,TenantFailedAssessmentsByRootSubjectHorizontalBarChart:q},async created(){await this.getProgressData(),await this.getTimeData(),await this.getCostData(),await this.getChallengesData()},methods:{async getProgressData(){await this.analyticsStore.getSchoolProgress(this.userDetailsStore.tenantId),await this.analyticsStore.getClassProgress(this.userDetailsStore.userId),this.$nextTick(()=>{this.$refs.progressChart&&this.$refs.progressChart.createChart(this.analyticsStore.progress)})},async getTimeData(){await this.analyticsStore.getClassTime(this.userDetailsStore.userId),await this.analyticsStore.getSchoolTime(this.userDetailsStore.tenantId),this.$nextTick(()=>{this.$refs.timeChart&&this.$refs.timeChart.createChart(this.analyticsStore.time)})},async getCostData(){await this.analyticsStore.getClassCost(this.userDetailsStore.userId,"weekly"),await this.analyticsStore.getSchoolCost(this.userDetailsStore.tenantId,"weekly"),this.$nextTick(()=>{this.$refs.costChart&&this.$refs.costChart.createChart(this.analyticsStore.cost.class)})},async getComparisonData(){try{const t=await fetch(`/student-analytics/passed-assessments-by-subject/tenant/${this.userDetailsStore.tenantId}`);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);this.analyticsStore.rootSubjectsPassedAssessments=await t.json(),this.$nextTick(()=>{this.$refs.comparisonChart&&this.$refs.comparisonChart.createChart(this.analyticsStore.rootSubjectsPassedAssessments)})}catch(t){console.error("Error fetching cohort mastered assessments:",t),this.analyticsStore.rootSubjectsPassedAssessments=[]}},async getChallengesData(){await this.analyticsStore.getTeacherClassFailedAssessmentsBySubject(this.userDetailsStore.userId)}}},le={class:"dashboard"},he={class:"container-fluid"},de={class:"dash-row row"},ge={class:"col-md h-100"},me={id:"progress-chart-container",class:"position-relative"},ue={class:"col-md h-100"},ye={id:"failed-chart-container"},pe={key:1},_e={class:"dash-row row"},fe={class:"col-md position-relative h-100"},Se={id:"cost-chart-container"},Ce={key:1},ke={class:"col-md position-relative h-100"},$e={id:"time-chart-container"};function xe(t,e,r,a,n,d){const i=_("RouterLink"),g=_("TeacherProgressChart"),m=_("TenantFailedAssessmentsByRootSubjectHorizontalBarChart"),h=_("TeacherCostChart"),u=_("TeacherTimeChart");return c(),y("div",le,[o("div",he,[o("div",de,[o("div",ge,[x(i,{to:"/progress-report",class:"",target:"_blank"},{default:f(()=>e[0]||(e[0]=[o("h2",{class:"heading h5"},"Progress",-1)])),_:1,__:[0]}),o("div",me,[a.analyticsStore.progress.tenant.length>0||a.analyticsStore.progress.class.length>0?(c(),p(g,{key:0,ref:"progressChart"},null,512)):w("",!0)]),e[1]||(e[1]=o("figcaption",null,[o("span",{style:{color:"green"}},"Your class"),L(" | "),o("span",{style:{color:"#ff7f0e"}},"the whole school")],-1))]),o("div",ue,[x(i,{to:"/challenges-report",class:"",target:"_blank"},{default:f(()=>e[2]||(e[2]=[o("h2",{class:"heading h5"},"Challenges",-1)])),_:1,__:[2]}),o("div",ye,[a.analyticsStore.cohortRootSubjectsFailedAssessments.length>0?(c(),p(m,{key:0,data:a.analyticsStore.cohortRootSubjectsFailedAssessments},null,8,["data"])):(c(),y("p",pe,"No challenges yet"))])])]),o("div",_e,[o("div",fe,[e[3]||(e[3]=o("h2",{class:"heading h5"},"AI usage",-1)),o("div",Se,[a.analyticsStore.cost.tenant.length>0||a.analyticsStore.cost.class.length>0?(c(),p(h,{key:0,ref:"costChart"},null,512)):(c(),y("p",Ce,"No usage yet"))])]),o("div",ke,[x(i,{to:"/engagement-report",class:"chart-heading",target:"_blank"},{default:f(()=>e[4]||(e[4]=[o("h2",{class:"heading h5"},"Engagement",-1)])),_:1,__:[4]}),o("div",$e,[a.analyticsStore.time.tenant.length>0||a.analyticsStore.time.class.length>0?(c(),p(u,{key:0,ref:"timeChart"},null,512)):w("",!0)]),e[5]||(e[5]=o("figcaption",null,[o("span",{style:{color:"green"}},"Your class"),L(" | "),o("span",{style:{color:"#ff7f0e"}},"the whole school")],-1))])])])])}const we=S(ce,[["render",xe],["__scopeId","data-v-e92d3877"]]),ve={name:"Dashboard",setup(){return{userDetailsStore:F()}},data(){return{}},components:{PlatformAdminDashboard:Xt,SchoolAdminDashboard:At,TeacherAnalyticsDashboard:we},async created(){}};function Te(t,e,r,a,n,d){const i=_("PlatformAdminDashboard"),g=_("SchoolAdminDashboard"),m=_("TeacherAnalyticsDashboard");return c(),y(R,null,[a.userDetailsStore.role=="platform_admin"?(c(),p(i,{key:0})):w("",!0),a.userDetailsStore.role=="school_admin"?(c(),p(g,{key:1})):w("",!0),a.userDetailsStore.role=="instructor"||a.userDetailsStore.role=="partner"?(c(),p(m,{key:2})):w("",!0)],64)}const qe=S(ve,[["render",Te]]);export{qe as default};
