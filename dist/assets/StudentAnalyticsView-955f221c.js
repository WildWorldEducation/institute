import{_ as S,o as n,c as l,e as A,H as T,r as u,a as o,k as h}from"./main-341f8131.js";import{u as _}from"./TeacherAnalyticsStore-844ef8cd.js";import{P as D,A as P}from"./AttemptedAssessmentsTimelineChart-00682926.js";import{F as v}from"./FailedAssessmentsHorizontalBarChart-7b430cad.js";import{T as w,S as x}from"./StudentDurationPerDayLineChart-633a2280.js";import{s as g}from"./transform-62bed377.js";import{l as C,m as B,f as M,b}from"./linear-c1216a03.js";import{b as H}from"./band-22321830.js";import{s as z}from"./sort-a49d696f.js";import"./time-8a8f3333.js";import"./line-61e28c6d.js";import"./point-ea70dc51.js";import"./ordinal-3694ef9e.js";const F={name:"TenantAvgTokensToMasterSkillsHorizontalBarChart",props:["data","colour"],data(){return{padding:60}},mounted(){g("#tenant-avg-tokens-to-master-skills-chart-container");const s=25,t=0,r=0,m=10,a=200,p=1e3,k=Math.ceil((this.data.length+.1)*s)+t+m,i=C().domain([0,B(this.data,e=>e.quantity)]).range([a,p-r]),d=H().domain(z(this.data,e=>-e.quantity).map(e=>e.name)).rangeRound([t,k-m]).padding(.1),y=i.tickFormat(20),c=g("#tenant-avg-tokens-to-master-skills-chart-container").append("svg").attr("width",p).attr("height",k).attr("viewBox",[0,0,p,k]).attr("style","max-width: 100%; height: 100%; font: 14px sans-serif;");c.append("g").attr("fill",this.colour).selectAll().data(this.data).join("rect").attr("x",i(0)).attr("y",e=>d(e.name)).attr("width",e=>i(e.quantity)-i(0)).attr("height",d.bandwidth()),c.append("g").attr("fill","white").attr("text-anchor","end").selectAll().data(this.data).join("text").attr("x",e=>i(e.quantity)).attr("y",e=>d(e.name)+d.bandwidth()/2).attr("dy","0.35em").attr("dx",-4).text(e=>y(e.quantity)).call(e=>e.filter(f=>i(f.quantity)-i(0)<20).attr("dx",4).attr("fill","black").attr("text-anchor","start")),c.append("g").attr("transform",`translate(0,${t})`).call(M(i).ticks(0)).call(e=>e.select(".domain").remove()),c.append("g").attr("transform",`translate(${a},0)`).call(b(d).tickSizeOuter(0))},computed:{}},$={id:"tenant-avg-tokens-to-master-skills-chart-container"};function j(s,t,r,m,a,p){return n(),l("div",$)}const I=S(F,[["render",j],["__scopeId","data-v-6e86d297"]]),q={setup(){const s=A(),t=_(),r=T();return{userDetailsStore:s,teacherAnalyticsStore:t,userSkillsStore:r}},components:{PassedAssessmentsTimelineChart:D,AttemptedAssessmentsTimelineChart:P,FailedAssessmentsHorizontalBarChart:v,TimePerSkillHorizontalBarChart:w,StudentDurationPerDayLineChart:x,StudentAvgTokensToMasterSkillsHorizontalBarChart:I},data(){return{studentId:this.userDetailsStore.userId,assessmentPasses:[],assessmentAttempts:[],multipleFails:[],skillDurations:[],durationsPerDay:[],tokensPerSkills:[]}},async created(){await this.getAssessmentAttempts(),await this.getAssessmentPasses(),await this.teacherAnalyticsStore.getStudentMultipleFails(this.userDetailsStore.userId),await this.getSkillDuration(),await this.getStudentDurationPerDay(),await this.getAvgTokensToMasterSkills()},methods:{async getAssessmentAttempts(){fetch(`/student-analytics/started-unmastered-assessments/${this.userDetailsStore.userId}`).then(s=>s.json()).then(s=>{this.assessmentAttempts=s.map(t=>({...t,url:`/skills/${t.url}`,labelName:`${t.name}`}))}).catch(s=>{console.error("Error fetching last visited skills:",s)})},async getAssessmentPasses(){await this.userSkillsStore.getMasteredSkills(this.userDetailsStore.userId),this.assessmentPasses=this.userSkillsStore.masteredSkills.map(s=>({...s,url:`/skills/${s.url}`,labelName:`${s.name}`}))},async getSkillDuration(){fetch(`/student-analytics/skill-durations/${this.studentId}`).then(s=>s.json()).then(s=>{this.skillDurations=s;for(let t=0;t<this.skillDurations.length;t++)this.skillDurations[t].formattedQuantity=this.millisToMinutesAndSeconds(this.skillDurations[t].quantity)}).catch(s=>{console.error("Error fetching last visited skills:",s)})},async getStudentDurationPerDay(){fetch(`/student-analytics/student-duration-per-day/${this.studentId}`).then(s=>s.json()).then(s=>{for(let t=0;t<s.length;t++)s[t].formattedQuantity=s[t].quantity/1e3,s[t].date=new Date(s[t].date);s.sort((t,r)=>t.date-r.date),this.durationsPerDay=s}).catch(s=>{console.error("Error fetching student duration per day:",s)})},async getAvgTokensToMasterSkills(){try{const s=await fetch(`/student-analytics/avg-tokens-to-master-skills/student/${this.studentId}`);if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const t=await s.json();this.tokensPerSkills=Array.isArray(t)?t:[]}catch(s){console.error("Error fetching cohort mastered assessments:",s),this.tokensPerSkills=[]}},millisToMinutesAndSeconds(s){var t=Math.floor(s/6e4),r=(s%6e4/1e3).toFixed(0);return t+":"+(r<10?"0":"")+r},assessmentDate(s){return new Date(s).toLocaleString("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})}}},E={class:"container"},L={key:1},N={key:3},U={key:5},Q={key:7},R={key:9},V={key:11};function O(s,t,r,m,a,p){const k=u("FailedAssessmentsHorizontalBarChart"),i=u("PassedAssessmentsTimelineChart"),d=u("AttemptedAssessmentsTimelineChart"),y=u("TimePerSkillHorizontalBarChart"),c=u("StudentDurationPerDayLineChart"),e=u("StudentAvgTokensToMasterSkillsHorizontalBarChart");return n(),l("div",E,[t[0]||(t[0]=o("span",{class:"d-flex justify-content-between w-100"},[o("h1",{class:"heading"},"My Progress")],-1)),t[1]||(t[1]=o("h2",{class:"heading"},"Assessments",-1)),t[2]||(t[2]=o("h4",{class:"secondary-heading"}," Failed multiple times",-1)),m.teacherAnalyticsStore.studentMultipleFails.length>0?(n(),h(k,{key:0,data:m.teacherAnalyticsStore.studentMultipleFails,colour:"darkred",class:"mb-5"},null,8,["data"])):(n(),l("p",L," This student has not failed any assessments more than once yet. ")),t[3]||(t[3]=o("h4",{class:"secondary-heading"},"Passed",-1)),a.assessmentPasses.length>0?(n(),h(i,{key:2,class:"mb-5",data:a.assessmentPasses},null,8,["data"])):(n(),l("p",N,"This student has not completed any assessments yet.")),t[4]||(t[4]=o("h4",{class:"secondary-heading"},"Attempted",-1)),a.assessmentAttempts.length>0?(n(),h(d,{key:4,class:"mb-5",data:a.assessmentAttempts},null,8,["data"])):(n(),l("p",U,"This student has attempted any assessments yet.")),t[5]||(t[5]=o("h2",{class:"heading"},"Engagement",-1)),t[6]||(t[6]=o("h4",null,"Time spent on each skill",-1)),a.skillDurations.length>0?(n(),h(y,{key:6,data:a.skillDurations,colour:"purple"},null,8,["data"])):(n(),l("p",Q,"No data yet")),t[7]||(t[7]=o("h4",{class:"mt-5"},"Time spent per day",-1)),a.durationsPerDay.length>0?(n(),h(c,{key:8,data:a.durationsPerDay,colour:"purple"},null,8,["data"])):(n(),l("p",R,"No data yet")),t[8]||(t[8]=o("h4",{class:"mt-5"},"Tokens spent per skill",-1)),a.tokensPerSkills.length>0?(n(),h(e,{key:10,class:"mb-5",data:a.tokensPerSkills,colour:"purple"},null,8,["data"])):(n(),l("p",V,"No data yet"))])}const it=S(q,[["render",O]]);export{it as default};
