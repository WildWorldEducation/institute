import{_ as m,e as p,L as b,o as n,c as i,a as e,t as r,s as l,b as o,q as _}from"./main-b824f3f8.js";const y={setup(){const s=p(),t=b();return{userDetailsStore:s,settingsStore:t}},data(){return{monthlyTokenUsage:null,year:0,month:"",isAITokenLimitReached:!1,isMobileCheck:window.innerWidth}},async mounted(){let s=document.createElement("script");s.setAttribute("src","https://js.stripe.com/v3/"),document.head.appendChild(s),this.settingsStore.freePlanTokenLimit==0&&await this.settingsStore.getSettings(),await this.userDetailsStore.getUserDetails(),this.userDetailsStore.subscriptionTier=="free"?this.settingsStore.freePlanTokenLimit<=this.userDetailsStore.monthlyTokenUsage&&(this.isAITokenLimitReached=!0):this.userDetailsStore.subscriptionTier=="capped"&&this.settingsStore.cappedPlanTokenLimit<=this.userDetailsStore.monthlyTokenUsage&&(this.isAITokenLimitReached=!0),this.year=new Date().getFullYear();const t=["January","February","March","April","May","June","July","August","September","October","November","December"],a=new Date;this.month=t[a.getMonth()]},methods:{checkout(s){fetch("/subscriptions/create-checkout-session",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:this.userDetailsStore.userId,planType:s})}).then(t=>t.ok?t.json():t.json().then(a=>Promise.reject(a))).then(({url:t})=>{window.location=t}).catch(t=>{console.error(t.error)})},loadPortal(){fetch("/subscriptions/create-customer-portal-session",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:this.userDetailsStore.userId})}).then(s=>s.ok?s.json():s.json().then(t=>Promise.reject(t))).then(({url:s})=>{window.location=s}).catch(s=>{console.error(s.error)})}}},g={class:"container"},S=e("h1",{class:"heading"},"Subscription",-1),f={class:"row mt-4"},k={class:"col-md mb-3"},T={class:"secondary-heading h4 mb-4"},D=e("strong",null,"Your subscription tier:",-1),v=e("strong",null,"Current token usage:",-1),w={key:0,class:"alert alert-warning",role:"alert"},I=e("hr",null,null,-1),L={class:"row mt-4"},C={class:"col-md mb-3"},j=e("h2",{class:"secondary-heading h4"},"Free plan",-1),P=e("strong",null,"Token limit:",-1),A={key:0,disabled:"",class:"btn primary-btn mt-2"},M={class:"col-md mb-3"},x=e("h2",{class:"secondary-heading h4"},"Capped plan",-1),N=e("p",null,"Ideal for moderate use",-1),U=e("p",null,"$20 / month",-1),J=e("strong",null,"Token limit:",-1),O={key:1,disabled:"",class:"btn primary-btn mt-2"},R={class:"col-md mb-3"},V=e("h2",{class:"secondary-heading h4"},"Infinite plan",-1),Y=e("p",null,"Ideal for daily use",-1),B=e("p",null,"$100 / month",-1),F=e("p",null,[e("strong",null,"Token limit:"),l(" Infinite ")],-1),E={key:1,disabled:"",class:"btn primary-btn mt-2"};function q(s,t,a,h,c,u){return n(),i("div",g,[S,e("div",f,[e("div",k,[e("h2",T," Monthly AI usage: "+r(c.month)+", "+r(c.year),1),e("ul",null,[e("li",null,[e("p",null,[D,l(" "+r(h.userDetailsStore.subscriptionTier.toLocaleString()),1)])]),e("li",null,[e("p",null,[v,l(" "+r(h.userDetailsStore.monthlyTokenUsage.toLocaleString()),1)])])]),c.isAITokenLimitReached?(n(),i("div",w," You are over the monthly free limit. You can't use the AI features until next month. ")):o("",!0)]),e("div",{class:_(["col-md mb-3 d-flex",c.isMobileCheck>576?"justify-content-end":"justify-content-center"])},[this.userDetailsStore.subscriptionTier!="free"?(n(),i("button",{key:0,class:"btn primary-btn",onClick:t[0]||(t[0]=d=>u.loadPortal())}," Manage billing ")):o("",!0)],2)]),I,e("div",L,[e("div",C,[j,e("p",null,[P,l(" "+r(this.settingsStore.freePlanTokenLimit.toLocaleString()),1)]),this.userDetailsStore.subscriptionTier=="free"?(n(),i("button",A," current plan ")):o("",!0)]),e("div",M,[x,N,U,e("p",null,[J,l(" "+r(this.settingsStore.cappedPlanTokenLimit.toLocaleString()),1)]),this.userDetailsStore.subscriptionTier=="free"?(n(),i("button",{key:0,onClick:t[1]||(t[1]=d=>u.checkout("capped")),class:"btn primary-btn mt-2"}," buy ")):o("",!0),this.userDetailsStore.subscriptionTier=="capped"?(n(),i("button",O," current plan ")):o("",!0)]),e("div",R,[V,Y,B,F,this.userDetailsStore.subscriptionTier=="free"?(n(),i("button",{key:0,onClick:t[2]||(t[2]=d=>u.checkout("infinite")),class:"btn primary-btn mt-2"}," buy ")):o("",!0),this.userDetailsStore.subscriptionTier=="infinite"?(n(),i("button",E," current plan ")):o("",!0)])])])}const W=m(y,[["render",q]]);export{W as default};
