import{_ as b,e as p,L as _,o as n,c as o,a as e,q as l,t as c,s as a,b as r}from"./main-cf1e6ea9.js";const y={setup(){const s=p(),t=_();return{userDetailsStore:s,settingsStore:t}},data(){return{monthlyTokenUsage:null,year:0,month:"",isAITokenLimitReached:!1,isMobileCheck:window.innerWidth}},async mounted(){let s=document.createElement("script");s.setAttribute("src","https://js.stripe.com/v3/"),document.head.appendChild(s),this.settingsStore.freePlanTokenLimit==0&&await this.settingsStore.getSettings(),await this.userDetailsStore.getUserDetails(),this.userDetailsStore.subscriptionTier=="free"?this.settingsStore.freePlanTokenLimit<=this.userDetailsStore.monthlyTokenUsage&&(this.isAITokenLimitReached=!0):this.userDetailsStore.subscriptionTier=="basic"&&this.settingsStore.basicPlanTokenLimit<=this.userDetailsStore.monthlyTokenUsage&&(this.isAITokenLimitReached=!0),this.year=new Date().getFullYear();const t=["January","February","March","April","May","June","July","August","September","October","November","December"],u=new Date;this.month=t[u.getMonth()]},methods:{checkout(s){fetch("/subscriptions/create-checkout-session",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:this.userDetailsStore.userId,planType:s})}).then(t=>t.ok?t.json():t.json().then(u=>Promise.reject(u))).then(({url:t})=>{window.location=t}).catch(t=>{console.error(t.error)})},loadPortal(){fetch("/subscriptions/create-customer-portal-session",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:this.userDetailsStore.userId})}).then(s=>s.ok?s.json():s.json().then(t=>Promise.reject(t))).then(({url:s})=>{window.location=s}).catch(s=>{console.error(s.error)})}}},k={class:"container"},g={class:"row mt-4"},S={class:"col-md mb-3"},f=e("strong",null,"Your subscription tier:",-1),T=e("strong",null,"Current token usage:",-1),D={key:0,class:"alert alert-warning",role:"alert"},C=e("hr",null,null,-1),v={class:"row mt-4"},w=e("h2",{class:"secondary-heading h4"},"Free plan",-1),I=e("strong",null,"Token limit:",-1),L={key:0,disabled:"",class:"btn primary-btn mt-2"},M=e("h2",{class:"secondary-heading h4"},"Basic plan",-1),j=e("p",null,"Ideal for moderate use",-1),x=e("p",null,"$20 / month",-1),P=e("strong",null,"Token limit:",-1),A={key:1,disabled:"",class:"btn primary-btn mt-1 mb-3"},N=e("h2",{class:"secondary-heading h4"},"Infinite plan",-1),U=e("p",null,"Ideal for daily use",-1),J=e("p",null,"$100 / month",-1),O=e("p",null,[e("strong",null,"Token limit:"),a(" Infinite ")],-1),B={key:1,disabled:"",class:"btn primary-btn mt-1 mb-3"};function R(s,t,u,d,i,h){return n(),o("div",k,[e("h1",{class:l(["heading",{"text-center":i.isMobileCheck<576}])}," Subscription ",2),e("div",g,[e("div",S,[e("h2",{class:l(["secondary-heading h4 mb-4",{"text-center":i.isMobileCheck<576}])}," Monthly AI usage: "+c(i.month)+", "+c(i.year),3),e("ul",null,[e("li",null,[e("p",null,[f,a(" "+c(d.userDetailsStore.subscriptionTier.toLocaleString()),1)])]),e("li",null,[e("p",null,[T,a(" "+c(d.userDetailsStore.monthlyTokenUsage.toLocaleString()),1)])])]),i.isAITokenLimitReached?(n(),o("div",D," You are over the monthly free limit. You can't use the AI features until next month. ")):r("",!0)]),e("div",{class:l(["col-md mb-3 d-flex",i.isMobileCheck>576?"justify-content-end":"justify-content-center"])},[this.userDetailsStore.subscriptionTier!="free"?(n(),o("button",{key:0,class:"btn primary-btn",onClick:t[0]||(t[0]=m=>h.loadPortal())}," Manage billing ")):r("",!0)],2)]),C,e("div",v,[e("div",{class:l(["col-md mb-3",{"text-center":i.isMobileCheck<576}])},[w,e("p",null,[I,a(" "+c(this.settingsStore.freePlanTokenLimit.toLocaleString()),1)]),this.userDetailsStore.subscriptionTier=="free"?(n(),o("button",L," current plan ")):r("",!0)],2),e("div",{class:l(["col-md mb-3",{"text-center":i.isMobileCheck<576}])},[M,j,x,e("p",null,[P,a(" "+c(this.settingsStore.basicPlanTokenLimit.toLocaleString()),1)]),this.userDetailsStore.subscriptionTier=="free"?(n(),o("button",{key:0,onClick:t[1]||(t[1]=m=>h.checkout("basic")),class:"btn primary-btn mt-2"}," buy ")):r("",!0),this.userDetailsStore.subscriptionTier=="basic"?(n(),o("button",A," current plan ")):r("",!0)],2),e("div",{class:l(["col-md mb-3",{"text-center":i.isMobileCheck<576}])},[N,U,J,O,this.userDetailsStore.subscriptionTier=="free"?(n(),o("button",{key:0,onClick:t[2]||(t[2]=m=>h.checkout("infinite")),class:"btn primary-btn mt-2"}," buy ")):r("",!0),this.userDetailsStore.subscriptionTier=="infinite"?(n(),o("button",B," current plan ")):r("",!0)],2)])])}const Y=b(y,[["render",R]]);export{Y as default};
