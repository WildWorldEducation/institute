import{u as B}from"./AnalyticsStore-8a08293c.js";import{u as M}from"./TeacherAnalyticsStore-e550a651.js";import{_ as $,o as m,c as _,f as P,r as y,a as s,g as f,l as S,k as w,b,F as q,z as H,s as D,t as L,p as R,d as j}from"./main-c940865b.js";import{S as V}from"./StudentProgressChart-868d3524.js";import"./transform-4d0f7c8f.js";import{u as F,l as N}from"./line-d122782f.js";import{e as z}from"./time-3c9385c3.js";import{l as A,c as E,b as T,a as O}from"./linear-d9b6cbf2.js";import{m as I}from"./continuous-93813e6c.js";import{o as Q,b as W}from"./band-2263c9e7.js";import{s as v}from"./string-c67ea49d.js";import{c as U}from"./category10-63f9141e.js";import{s as Y}from"./sort-fcaf8f38.js";import"./point-ea70dc51.js";import"./colors-98f238a0.js";const G={name:"SchoolTimeChart",props:[],data(){return{axisData:[]}},mounted(){},methods:{createChart(t){if(console.log(t),t.student.length==0)this.axisData=t.tenant;else if(t.tenant.length==0)this.axisData=t.student;else{const a=t.student.reduce((C,k)=>Math.max(C,k.quantity),-1/0),x=t.tenant.reduce((C,k)=>Math.max(C,k.quantity),-1/0);a>=x?this.axisData=t.student:this.axisData=t.tenant}const h=Object.entries(t).map(([a,x])=>({name:a,values:x}));v("#time-chart-container");const r=document.getElementById("time-chart-container").clientWidth,n=document.getElementById("time-chart-container").clientHeight,d=0,p=20,o=20,u=20,i=F(z(this.axisData,a=>a.date),[u,r-p]),c=A([0,I(this.axisData,a=>a.formattedQuantity)],[n-o,d]);Q().domain(h.map(a=>a.name)).range(U);const l=N().x(a=>i(a.date)).y(a=>c(a.formattedQuantity)),e=v("#time-chart-container").append("svg").attr("width","100%").attr("height","100%").attr("viewBox",[0,0,+Math.min(r,n),+Math.min(r,n)]).attr("preserveAspectRatio","xMinYMin");e.append("g").attr("transform",`translate(0,${n-o})`).call(E(i).ticks(t.length).tickSizeOuter(0)),e.append("g").attr("transform",`translate(${u},0)`).call(T(c).ticks(n/40)).call(a=>a.select(".domain").remove()).call(a=>a.selectAll(".tick line").clone().attr("x2",r-u-p).attr("stroke-opacity",.2)).call(a=>a.append("text").attr("x",-u).attr("y",10).attr("fill","currentColor").attr("text-anchor","start")),e.selectAll(".line").data(h).join("path").attr("fill","none").attr("stroke",a=>a.name=="student"?"RoyalBlue":"#ff7f0e").attr("stroke-width",3).attr("d",a=>l(a.values))}}};function J(t,h,r,n,d,p){return null}const K=$(G,[["render",J]]),X={name:"StudentComparisonChart",props:["data","colour"],data(){return{}},mounted(){},methods:{createChart(t){v("#student-comparison-container");const h=25,r=0,n=20,d=10,p=200,o=700,u=Math.ceil((t.length+.1)*h)+r+d,i=A().domain([0,I(t,e=>e.quantity)]).range([p,o-n]),c=W().domain(Y(t,e=>-e.quantity).map(e=>e.name)).rangeRound([r,u-d]).padding(.1);i.tickFormat(20);const l=v("#student-comparison-container").append("svg").attr("width","100%").attr("height","100%").attr("viewBox",[0,0,o,u]).attr("style","max-width: 100%; height: 100%; font: 14px sans-serif;");l.append("g").selectAll().data(t).join("rect").attr("x",i(0)).attr("y",e=>c(e.name)).attr("width",e=>i(e.quantity)-i(0)).attr("height",c.bandwidth()).attr("fill",function(e){return e.name=="Language"?"DarkMagenta":e.name=="Mathematics"?"blue":e.name=="Science & Invention"?"purple":e.name=="Computer Science"?"deeppink":e.name=="Dangerous Ideas"?"brown":e.name=="History"?"cyan":e.name=="Life"?"magenta":"#ff7f0e"}),l.append("g").attr("fill","white").attr("text-anchor","end").selectAll().data(t).join("text").attr("x",e=>i(e.quantity)).attr("y",e=>c(e.name)+c.bandwidth()/2).attr("dy","0.35em").attr("dx",-4).text(e=>e.quantity).call(e=>e.filter(a=>i(a.quantity)-i(0)<20).attr("dx",4).attr("fill","black").attr("text-anchor","start")),l.append("g").attr("transform",`translate(0,${r})`).call(O(i).ticks(0)).call(e=>e.select(".domain").remove()),l.append("g").attr("transform",`translate(${p},0)`).attr("style","font-size: 16px").call(T(c).tickSizeOuter(0))}}},Z={id:"student-comparison-container"};function tt(t,h,r,n,d,p){return m(),_("div",Z)}const et=$(X,[["render",tt]]);const st={name:"Student-Dashboard",setup(){const t=P(),h=B(),r=M();return{userDetailsStore:t,analyticsStore:h,teacherAnalyticsStore:r}},data(){return{showSidebar:!0,screenWidth:screen.width,isStudentData:!0,isSchoolData:!0,isLanguageData:!1,isMathData:!1,isHistoryData:!1,isLifeData:!1,isCSData:!1,isSAndIData:!1,isDIData:!1,progressData:{student:[],average:[]},isAboveTheCurve:!1}},components:{StudentProgressChart:V,StudentComparisonChart:et,StudentTimeChart:K},async created(){await this.analyticsStore.getStudentProgress(this.userDetailsStore.userId,this.userDetailsStore.tenantId),await this.analyticsStore.getStudentPassedAssessmentsBySubject(this.userDetailsStore.userId),await this.analyticsStore.getStudentTime(this.userDetailsStore.userId,this.userDetailsStore.tenantId),await this.teacherAnalyticsStore.getStudentMultipleFails(this.userDetailsStore.userId),this.analyticsStore.progress.student[this.analyticsStore.progress.student.length-1].quantity>this.analyticsStore.progress.tenant[this.analyticsStore.progress.tenant.length-1].quantity&&(this.isAboveTheCurve=!0),await this.HandleProgressData(),await this.HandleComparisonData(),await this.HandleTimeData()},methods:{async HandleProgressData(){if(this.isStudentData){this.progressData.student=[];for(let t=0;t<this.analyticsStore.progress.student.length;t++)this.progressData.student.push(this.analyticsStore.progress.student[t])}else this.progressData.student=[];if(this.isSchoolData){this.progressData.average=[];for(let t=0;t<this.analyticsStore.progress.tenant.length;t++)this.progressData.average.push(this.analyticsStore.progress.tenant[t])}else this.progressData.average=[];this.$nextTick(()=>{this.$refs.progressChart&&this.$refs.progressChart.createChart(this.progressData)})},async HandleComparisonData(){this.$nextTick(()=>{this.$refs.comparisonChart&&this.$refs.comparisonChart.createChart(this.analyticsStore.studentRootSubjectsPassedAssessments)})},async HandleTimeData(){this.$nextTick(()=>{this.$refs.timeChart&&this.$refs.timeChart.createChart(this.analyticsStore.time)})},toggleSidebar(){this.showSidebar=!this.showSidebar}}},g=t=>(R("data-v-0a3775dd"),t=t(),j(),t),at={class:"dashboard"},nt={class:"main"},rt={class:"content container-fluid"},it={class:"dash-row row"},ot={class:"col-md-6 h-100 position-relative"},ct=g(()=>s("h2",{class:"heading h5"},"Progress over time",-1)),lt={id:"progress-chart-container"},ht={class:"col-md-6"},dt={id:"comparison-chart-container"},ut=g(()=>s("h2",{class:"heading h5 mt-1"},"Subject comparison",-1)),mt={class:"dash-row row"},pt={class:"col-md h-100 position-relative"},gt=g(()=>s("h2",{class:"heading h5"},"Study time",-1)),_t={id:"time-chart-container"},ft={class:"col-md position-relative"},St={class:"row"},yt={class:"col-md"},Dt=g(()=>s("h2",{class:"h5 heading"}," Super challenging skills ",-1)),vt={key:0},xt={key:1},Ct={class:"col-md"},kt=g(()=>s("h2",{class:"h5 heading"},"Stats",-1)),wt=g(()=>s("li",null,[s("strong",null,"Skills passed:"),D(" 25")],-1)),bt=g(()=>s("li",null,[s("strong",null,"Total time spent:"),D(" 5:00 ")],-1)),$t=g(()=>s("strong",null,"Tokens used:",-1));function At(t,h,r,n,d,p){const o=y("RouterLink"),u=y("StudentProgressChart"),i=y("StudentComparisonChart"),c=y("StudentTimeChart");return m(),_("div",at,[s("div",nt,[s("div",rt,[s("div",it,[s("div",ot,[f(o,{to:"/my-progress/skills",class:""},{default:S(()=>[ct]),_:1}),s("div",lt,[d.progressData.student.length>0||d.progressData.average.length>0?(m(),w(u,{key:0,ref:"progressChart"},null,512)):b("",!0)])]),s("div",ht,[s("div",dt,[ut,n.analyticsStore.studentRootSubjectsPassedAssessments.length>0?(m(),w(i,{key:0,ref:"comparisonChart",data:n.analyticsStore.studentRootSubjectsPassedAssessments,colour:"#5f31dd"},null,8,["data"])):b("",!0)])])]),s("div",mt,[s("div",pt,[f(o,{to:"/my-progress/time"},{default:S(()=>[gt]),_:1}),s("div",_t,[n.analyticsStore.time.student.length>0||n.analyticsStore.time.tenant.length>0?(m(),w(c,{key:0,ref:"timeChart"},null,512)):b("",!0)])]),s("div",ft,[s("div",St,[s("div",yt,[f(o,{to:"/my-progress/super-challenging",class:"col"},{default:S(()=>[Dt]),_:1}),n.teacherAnalyticsStore.studentMultipleFails.length>0?(m(),_("ul",vt,[(m(!0),_(q,null,H(n.teacherAnalyticsStore.studentMultipleFails,l=>(m(),_("li",{class:"failed-skills",key:l.id},[f(o,{to:"/skills/"+l.url,target:"_blank"},{default:S(()=>[D(L(l.name),1)]),_:2},1032,["to"])]))),128))])):(m(),_("p",xt,"Nothing to worry about yet"))]),s("div",Ct,[kt,s("ul",null,[wt,bt,s("li",null,[f(o,{to:"/my-progress/tokens"},{default:S(()=>[$t,D(" 10,000")]),_:1})])])])])])])])])])}const Ot=$(st,[["render",At],["__scopeId","data-v-0a3775dd"]]);export{Ot as default};
