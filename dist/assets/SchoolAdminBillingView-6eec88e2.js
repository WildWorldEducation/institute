import{u as g}from"./SettingsStore-a431ffed.js";import{_ as f,I as w,f as y,o as i,c,a as e,q as u,t as s,s as m,b as p,F as _,z as k,p as S,d as D}from"./main-63ddc164.js";const T={setup(){const o=g(),t=w(),a=y();return{settingsStore:o,tenantStore:t,userDetailsStore:a}},data(){return{monthlyTokenUsage:null,year:0,month:"",isAITokenLimitReached:!1,isMobileCheck:window.innerWidth,receipts:[],showTokensDropDown:!1,products:[{name:"1,000,000 tokens for $50",tokens:1e6},{name:"2,000,000 tokens for $100",tokens:2e6},{name:"5,000,000 tokens for $250",tokens:5e6}],chosenProduct:{}}},async created(){this.chosenProduct=this.products[0],this.settingsStore.freeTokenMonthlyLimit==0&&await this.settingsStore.getSettings(),await this.tenantStore.getTenantDetails(this.userDetailsStore.tenantId),await this.tenantStore.getTenantMonthlyTokenUsage(this.userDetailsStore.tenantId),this.getReceipts()},async mounted(){this.year=new Date().getFullYear();const o=["January","February","March","April","May","June","July","August","September","October","November","December"],t=new Date;this.month=o[t.getMonth()]},computed:{formattedMonthlyTokenUsage(){return this.tenantStore.monthlyTokenUsage?this.tenantStore.monthlyTokenUsage.toLocaleString():"0"}},methods:{closeOnDropdownOnClickAnywhere(){const o=document.getElementById("token-dropdown");document.body.addEventListener("click",t=>{o.contains(t.target)||(this.showTokensDropDown=!1)})},checkout(o){fetch("/tokens/tenant/create-checkout-session",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tenantId:this.userDetailsStore.tenantId,numberOfTokens:o})}).then(t=>t.ok?t.json():t.json().then(a=>Promise.reject(a))).then(({url:t})=>{window.location=t}).catch(t=>{console.error(t.error)})},async getReceipts(){const o=await fetch("/tokens/tenant/get-receipts/"+this.userDetailsStore.tenantId);this.receipts=await o.json()},formattedStripeReceiptDate(o){let t=new Date(o.date);const a=t.getUTCMonth()+1,d=t.getUTCDate();return t.getUTCFullYear()+"/"+a+"/"+d},formattedStripeReceiptAmount(o){return(o.amount/100).toLocaleString("en-US",{style:"currency",currency:"USD"})}}},l=o=>(S("data-v-f67c227d"),o=o(),D(),o),b={class:"container"},v={class:"row"},C={class:"col-md"},M={class:"d-flex justify-content-between"},I={class:"secondary-heading h5"},A=l(()=>e("strong",null,"Free limit per student:",-1)),x=l(()=>e("strong",null,"Total token usage:",-1)),U=l(()=>e("strong",null,"Current tokens:",-1)),L=l(()=>e("hr",null,null,-1)),O={class:"row"},R={class:"col col-md-8 col-lg-5 mt-2"},B=l(()=>e("h2",{class:"secondary-heading h4"},"Buy Tokens",-1)),j={class:"d-flex flex-column position-relative"},P=l(()=>e("span",null,[e("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M14.2929 8.70711C14.9229 8.07714 14.4767 7 13.5858 7H6.41421C5.52331 7 5.07714 8.07714 5.70711 8.70711L9.29289 12.2929C9.68342 12.6834 10.3166 12.6834 10.7071 12.2929L14.2929 8.70711Z",fill:"#344054"})])],-1)),F={key:0,class:"custom-dropdown-base"},N=["onClick"],V=l(()=>e("hr",null,null,-1)),J=l(()=>e("h2",{class:"secondary-heading h4"},"Receipts",-1)),Y=["href"],E={key:0};function z(o,t,a,d,n,h){return i(),c("div",b,[e("div",v,[e("div",C,[e("span",M,[e("h1",{class:u(["heading mb-4 h2",{"text-center":n.isMobileCheck<576}])}," Monthly AI usage ",2),e("h2",I,s(n.month)+" "+s(n.year),1)]),e("ul",null,[e("li",null,[e("p",null,[A,m(" "+s(d.settingsStore.freeTokenMonthlyLimit.toLocaleString()),1)])]),e("li",null,[e("p",null,[x,m(" "+s(h.formattedMonthlyTokenUsage),1)])]),e("li",null,[e("p",null,[U,m(" "+s(d.tenantStore.tokens),1)])])]),n.isAITokenLimitReached?(i(),c("div",{key:0,class:u(["alert alert-warning",{"mb-0":n.isMobileCheck>=576}]),role:"alert"}," You are over the monthly free limit. You can't use the AI features until next month. ",2)):p("",!0)])]),L,e("div",O,[e("div",R,[B,e("div",j,[e("div",{id:"token-dropdown",class:u([n.showTokensDropDown?"custom-select-button-focus":"custom-select-button"]),onClick:t[0]||(t[0]=r=>{n.showTokensDropDown=!n.showTokensDropDown,h.closeOnDropdownOnClickAnywhere()})},[m(s(n.chosenProduct.name)+" ",1),P],2),n.showTokensDropDown?(i(),c("div",F,[(i(!0),c(_,null,k(n.products,r=>(i(),c("div",{class:"custom-dropdown-option",onClick:q=>{n.chosenProduct=r,n.showTokensDropDown=!1}},s(r.name),9,N))),256))])):p("",!0)])])]),e("button",{onClick:t[1]||(t[1]=r=>h.checkout(n.chosenProduct.tokens)),class:"btn buy-btn mt-2 mb-2"}," buy "),V,e("div",{class:u({"text-center":n.isMobileCheck<576})},[J,(i(!0),c(_,null,k(n.receipts,r=>(i(),c("div",null,[e("a",{href:r.url,target:"_blank"},s(h.formattedStripeReceiptAmount(r))+" "+s(h.formattedStripeReceiptDate(r)),9,Y)]))),256)),n.isMobileCheck<576?(i(),c("p",E,"Â ")):p("",!0)],2)])}const Z=f(T,[["render",z],["__scopeId","data-v-f67c227d"]]);export{Z as default};
