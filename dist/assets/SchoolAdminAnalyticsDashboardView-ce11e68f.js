import{u as B}from"./AnalyticsStore-e2fb6718.js";import{_,o as g,c as b,f as I,A as j,r as u,a as h,g as S,l as v,k as x,b as C,E,p as q,d as L}from"./main-bae3386c.js";import"./transform-4d0f7c8f.js";import{u as k,l as P}from"./line-d122782f.js";import{e as T}from"./time-3c9385c3.js";import{l as w,c as A,b as $,a as M}from"./linear-d9b6cbf2.js";import{m as D}from"./continuous-93813e6c.js";import{s as f}from"./string-c67ea49d.js";import{b as R}from"./band-2263c9e7.js";import{s as V}from"./sort-fcaf8f38.js";import"./point-ea70dc51.js";const H={name:"SchoolProgressChart",props:[],data(){return{axisData:[]}},mounted(){},methods:{createChart(e){console.log("Creating chart with data:",e);let a=[];this.$parent.progressChartMode==="school"?(this.axisData=e.school,a=e.school):(this.axisData=e.teacher,a=e.teacher),console.log("Progress data for chart:",a);const s=document.getElementById("progress-chart-container").clientWidth,r=document.getElementById("progress-chart-container").clientHeight,l=5,d=20,i=20,c=20,o=k(T(this.axisData,n=>n.date),[c,s-d]),p=w([0,D(this.axisData,n=>n.quantity)],[r-i,l]),m=P().x(n=>o(n.date)).y(n=>p(n.quantity)),t=f("#progress-chart-container").append("svg").attr("width",s).attr("height",r).attr("viewBox",[0,0,s,r]).attr("style","max-width: 100%; height: auto; height: intrinsic;");t.append("g").attr("transform",`translate(0,${r-20})`).call(A(o).ticks(s/100).tickSizeOuter(0)),t.append("g").attr("transform",`translate(${c},0)`).call($(p).ticks(r/40)).call(n=>n.select(".domain").remove()).call(n=>n.selectAll(".tick line").clone().attr("x2",s-c-d).attr("stroke-opacity",.2)).call(n=>n.append("text").attr("x",-c).attr("y",10).attr("fill","currentColor").attr("text-anchor","start")),t.append("path").attr("fill","none").attr("stroke","green").attr("stroke-width",3).attr("d",m(a))}}};function N(e,a,s,r,l,d){return null}const z=_(H,[["render",N]]),O={name:"SchoolComparisonChart",props:["colour"],data(){return{}},mounted(){},methods:{createChart(e){f("#school-comparison-chart-container");const a=40,s=0,r=20,l=10,d=200,i=1e3,c=Math.ceil((e.length+.1)*a)+s+l,o=w().domain([0,D(e,t=>t.quantity)]).range([d,i-r]),p=R().domain(V(e,t=>-t.quantity).map(t=>t.name)).rangeRound([s,c-l]).padding(.1);o.tickFormat(20);const m=f("#school-comparison-chart-container").append("svg").attr("width",i).attr("height",c).attr("viewBox",[0,0,i,c]).attr("style","max-width: 100%; height: 100%; font: 16px sans-serif;");m.append("g").selectAll().data(e).join("rect").attr("x",o(0)).attr("y",t=>p(t.name)).attr("width",t=>o(t.quantity)-o(0)).attr("height",p.bandwidth()).attr("fill",function(t){return t.name=="Language"?"DarkMagenta":t.name=="Mathematics"?"blue":t.name=="Science & Invention"?"purple":t.name=="Computer Science"?"deeppink":t.name=="Dangerous Ideas"?"brown":t.name=="History"?"cyan":t.name=="Life"?"magenta":"#ff7f0e"}),m.append("g").attr("fill","white").attr("text-anchor","end").selectAll().data(e).join("text").attr("x",t=>o(t.quantity)).attr("y",t=>p(t.name)+p.bandwidth()/2).attr("dy","0.35em").attr("dx",-4).text(t=>t.quantity).call(t=>t.filter(n=>o(n.quantity)-o(0)<20).attr("dx",4).attr("fill","black").attr("text-anchor","start")),m.append("g").attr("transform",`translate(0,${s})`).call(M(o).ticks(0)).call(t=>t.select(".domain").remove()),m.append("g").attr("transform",`translate(${d},0)`).style("font","20px sans-serif").call($(p).tickSizeOuter(0))}}},U={id:"school-comparison-chart-container"};function W(e,a,s,r,l,d){return g(),b("div",U)}const F=_(O,[["render",W]]),G={name:"SchoolTimeChart",props:["colour"],data(){return{}},mounted(){},methods:{createChart(e){const a=document.getElementById("time-chart-container").clientWidth,s=document.getElementById("time-chart-container").clientHeight,r=0,l=20,d=20,i=25,c=k(T(e,t=>t.date),[i,a-l]),o=w([0,D(e,t=>t.minutes)],[s-d,r]),p=P().x(t=>c(t.date)).y(t=>o(t.minutes)),m=f("#school-time-chart-container").append("svg").attr("width",a).attr("height",s).attr("viewBox",[0,0,a,s]).attr("style","max-width: 100%; height: auto; height: intrinsic;");m.append("g").attr("transform",`translate(0,${s-d})`).call(A(c).ticks(e.length).tickSizeOuter(0)),m.append("g").attr("transform",`translate(${i},0)`).call($(o).ticks(s/40)).call(t=>t.select(".domain").remove()).call(t=>t.selectAll(".tick line").clone().attr("x2",a-i-l).attr("stroke-opacity",.2)).call(t=>t.append("text").attr("x",-i).attr("y",10).attr("fill","currentColor").attr("text-anchor","start")),m.append("path").attr("fill","none").attr("stroke","#ff7f0e").attr("stroke-width",3).attr("d",p(e))}}},J={id:"school-time-chart-container"};function K(e,a,s,r,l,d){return g(),b("div",J)}const Q=_(G,[["render",K]]);const X={name:"School-Admin-Dashboard",setup(){const e=I(),a=B(),s=j();return{userDetailsStore:e,analyticsStore:a,usersStore:s}},data(){return{progressChartMode:"teacher",progressData:{school:[],teacher:[]},isAboveTheCurve:!1}},components:{SchoolProgressChart:z,SchoolComparisonChart:F,SchoolTimeChart:Q},async created(){this.analyticsStore.rootSubjectsPassedAssessments.length==0&&await this.getComparisonData(),await this.getClassProgressData(),await this.getTimeData()},methods:{async getSchoolProgressData(){await this.analyticsStore.getSchoolProgress(this.userDetailsStore.tenantId),this.progressData.school=[];for(let e=0;e<this.analyticsStore.progress.tenant.length;e++)this.progressData.school.push(this.analyticsStore.progress.tenant[e]);this.$nextTick(()=>{this.$refs.progressChart&&this.$refs.progressChart.createChart(this.progressData)})},async getClassProgressData(){await this.analyticsStore.getClassProgress("01982d32-db35-7550-83aa-bc32039d99eb"),this.progressData.teacher=[];for(let e=0;e<this.analyticsStore.classProgress.length;e++)this.progressData.teacher.push(this.analyticsStore.classProgress[e]);this.$nextTick(()=>{this.$refs.progressChart&&this.$refs.progressChart.createChart(this.progressData)})},async getTimeData(){this.analyticsStore.durationPerDay=[];let e=`/student-analytics/tenant-duration-per-day/weekly/${this.userDetailsStore.tenantId}`;fetch(e).then(a=>a.json()).then(async a=>{this.analyticsStore.durationPerDay=[];for(let s=0;s<a.length;s++)a[s].date=new Date(a[s].date),a[s].minutes=a[s].milliseconds/(1e3*60),this.analyticsStore.durationPerDay.push(a[s]);this.analyticsStore.durationPerDay.sort((s,r)=>s.date-r.date),this.$nextTick(()=>{this.$refs.timeChart&&this.$refs.timeChart.createChart(this.analyticsStore.durationPerDay)})}).catch(a=>{console.error("Error fetching student progress:",a)})},async getComparisonData(){try{const e=await fetch(`/student-analytics/passed-assessments-by-subject/tenant/${this.userDetailsStore.tenantId}`);if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);this.analyticsStore.rootSubjectsPassedAssessments=await e.json(),this.$nextTick(()=>{this.$refs.comparisonChart&&this.$refs.comparisonChart.createChart(this.analyticsStore.rootSubjectsPassedAssessments)})}catch(e){console.error("Error fetching cohort mastered assessments:",e),this.analyticsStore.rootSubjectsPassedAssessments=[]}}}},y=e=>(q("data-v-486b4f34"),e=e(),L(),e),Y={class:"dashboard"},Z={class:"container-fluid"},tt=E('<div class="row top-row" data-v-486b4f34><div class="col-sm top-row-text" data-v-486b4f34><strong data-v-486b4f34>Skills Mastered: </strong><span data-v-486b4f34>10</span></div><div class="col-sm top-row-text" data-v-486b4f34><strong data-v-486b4f34>Students: </strong><span data-v-486b4f34>35</span></div><div class="col-sm top-row-text" data-v-486b4f34><strong data-v-486b4f34>Teachers: </strong><span data-v-486b4f34>5</span></div><div class="col-sm top-row-text" data-v-486b4f34><strong data-v-486b4f34>AI Tutor Usage: </strong><span data-v-486b4f34>$500</span></div></div>',1),et={class:"dash-row row"},st={class:"col-md h-100"},at=y(()=>h("h2",{class:"heading h5"},"Progress",-1)),rt={id:"progress-chart-container",class:"position-relative"},ot={class:"col-md"},nt=y(()=>h("h2",{class:"heading h5"},"Subject comparison",-1)),it={class:"dash-row row mt-2 mb-2"},ct={class:"col-md position-relative"},ht=y(()=>h("h2",{class:"heading h5"},"Cost By Subject",-1)),lt={class:"col-md position-relative"},dt={id:"time-chart-container"},pt=y(()=>h("h2",{class:"heading h5"},"Engagement",-1));function mt(e,a,s,r,l,d){const i=u("RouterLink"),c=u("SchoolProgressChart"),o=u("SchoolComparisonChart"),p=u("SchoolTimeChart");return g(),b("div",Y,[h("div",Z,[tt,h("div",et,[h("div",st,[S(i,{to:"/reports/academics",class:""},{default:v(()=>[at]),_:1}),h("div",rt,[l.progressData.school.length>0||r.analyticsStore.classProgress.length>0?(g(),x(c,{key:0,ref:"progressChart"},null,512)):C("",!0)])]),h("div",ot,[nt,r.analyticsStore.rootSubjectsPassedAssessments.length>0?(g(),x(o,{key:0,colour:"#5f31dd",ref:"comparisonChart"},null,512)):C("",!0)])]),h("div",it,[h("div",ct,[S(i,{to:"/reports/cost",class:"me-2 position-absolute chart-heading"},{default:v(()=>[ht]),_:1})]),h("div",lt,[h("div",dt,[S(i,{to:"/reports/engagement",class:"position-absolute chart-heading"},{default:v(()=>[pt,r.analyticsStore.durationPerDay.length>0?(g(),x(p,{key:0,ref:"timeChart"},null,512)):C("",!0)]),_:1})])])])])])}const $t=_(X,[["render",mt],["__scopeId","data-v-486b4f34"]]);export{$t as default};
