import{_ as M,o as n,c as o,d as s,w as y,j as Q,F as g,k as v,b as c,a as N,E as F,u as R,r as p,l as S,m as $,s as b,t as _,L as E,G as U,i as A,p as z,f as L,g as V,e as T}from"./main-e6748f32.js";import{u as j}from"./SettingsStore-ed2391dc.js";import{u as B}from"./AssessmentsStore-4be3c8a8.js";import{F as P}from"./FlagModals-1b69a68c.js";const O={data(){return{skillId:this.$route.params.id,essayAnswer:""}},setup(){},methods:{getAnswer(){return this.essayAnswer},clearAnswer(){this.essayAnswer=""},setAnswer(i){this.essayAnswer=i}}},Y={class:"container mt-3"},J={class:"row"},H={class:"mb-3"};function K(i,e,l,a,t,u){return n(),o("div",Y,[s("div",J,[s("div",H,[y(s("textarea",{"onUpdate:modelValue":e[0]||(e[0]=h=>t.essayAnswer=h),class:"form-control",id:"exampleFormControlTextarea1",rows:"3"},null,512),[[Q,t.essayAnswer]])])])])}const W=M(O,[["render",K]]);const G={data(){return{skillId:this.$route.params.id,imageAnswer:[]}},props:["numImagesRequired"],methods:{getAnswer(){return this.imageAnswer},clearAnswer(){this.imageAnswer=[]},setAnswer(i){this.imageAnswer=i},onFileChange(i){var e=i.target.files||i.dataTransfer.files;if(e.length>0)for(var l=0;l<e.length;l++){var a=new FileReader;a.readAsDataURL(e[l])}if(e.length)for(let t=0;t<e.length;t++){if(e[t].size>7e5){alert("image is too big");return}this.createImage(e[t],t)}},createImage(i,e){var l=new Image,a=new FileReader,t=this;a.onload=u=>{t.image=u.target.result,this.imageAnswer.push(u.target.result),l.src=u.target.result},a.readAsDataURL(i)},removeImages:function(i){this.imageAnswer=[]}}},X={class:"mb-3"},Z={class:"main-content-container container-fluid"},ss={class:"row"},es={class:"col-lg-4"},ts=["onUpdate:modelValue"],is={class:"row"},ns={class:"preview col-xl-3 col-lg-4 col-md-6 my-2"},os=["src"];function ls(i,e,l,a,t,u){return n(),o("div",X,[s("div",Z,[s("div",ss,[s("div",es,[s("div",null,[(n(!0),o(g,null,v(l.numImagesRequired,(h,d)=>y((n(),o("input",{class:"form-control mb-2","onUpdate:modelValue":r=>t.imageAnswer[d]=r,placeholder:"add image link"},null,8,ts)),[[Q,t.imageAnswer[d]]])),256))])])]),s("div",is,[(n(!0),o(g,null,v(t.imageAnswer.length,(h,d)=>(n(),o("div",ns,[s("img",{src:t.imageAnswer[d]},null,8,os)]))),256))]),t.imageAnswer.length>0?(n(),o("button",{key:0,class:"btn red-btn mt-3",onClick:e[0]||(e[0]=(...h)=>u.removeImages&&u.removeImages(...h))}," Start again ")):c("",!0)])])}const rs=M(G,[["render",ls]]);const as={setup(){const i=N(),e=F(),l=R();return{userDetailsStore:i,userSkillsStore:e,skillTreeStore:l}},data(){return{skillId:this.$route.params.id,question:{text:"",explanation:"",correct_answer:1,is_random:!1},answers:[{text:""},{text:""},{text:""},{text:""},{text:""}],validate:{validated:!1,name:!1,question:!1,answer:!1,explanation:!1},studentId:null,reshake:!1,questionAddedModal:!1,questionSubmitted:!1,submittedMess:!1}},async mounted(){},methods:{Submit(){if(this.studentId=this.userDetailsStore.userId,this.validate.validated=!1,(this.question.text===""||this.question.text===null)&&(this.validate.question=!0,this.validate.validated=!0),this.answers.forEach(l=>{l.text==""&&(this.validate.validated=!0)}),(this.question.explanation===""||this.question.explanation===null)&&(this.validate.explanation=!0,this.validate.validated=!0),this.validate.validated){this.reshake=!0;return}const i={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:this.question,answers:this.answers,skill_id:this.skillId,student_id:this.studentId})};var e="/questions/student-mc-questions/add";fetch(e,i).then(()=>{this.questionAddedModal=!0,this.questionSubmitted=!0,window.scrollTo(0,0)})},showSubmittedMess(){this.submittedMess=!0,setTimeout(()=>{this.submittedMess=!1},2e3)},skipAddingQuestion(){this.questionSubmitted=!0,window.scrollTo(0,0)}}},us={class:"student-add-result pb-3 w-100"},cs={class:"main-content-container container-fluid"},ds={class:"row p-0"},hs={key:1,id:"form-container",class:"col p-4"},ms={key:0,class:"d-flex flex-column"},_s=s("div",{id:"congrats-tile"}," Well done, you have passed! ",-1),fs=s("p",null," Would you like to add your own question on this subject? ",-1),gs=[_s,fs],ps={key:1,class:"d-flex flex-column shake"},ws=s("div",{id:"congrats-tile"}," Thank you for submitting your question. ",-1),ys=[ws],vs={class:"mb-3"},ks=s("label",{for:"last_name",class:"form-label"},"Question",-1),bs={key:0,class:"form-validate"},qs={class:"form-label"},xs={class:"d-flex answer-option"},As=["onUpdate:modelValue","id"],Ss={key:0,class:"form-validate"},Ms={class:"form-check"},Is=["id","value"],Ts=["for"],Qs={class:"mb-3"},$s=s("svg",{width:"20",height:"20",fill:"#ffffff",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512"},[s("path",{d:"M256 80c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 144L48 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l144 0 0 144c0 17.7 14.3 32 32 32s32-14.3 32-32l0-144 144 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-144 0 0-144z"})],-1),Cs={class:"mb-3 form-check"},Ns=s("label",{for:"randomOrder",class:"form-check-label"},"Show answers in random order",-1),zs={class:"mb-3"},Ls=s("label",{class:"form-label"},"Explanation",-1),Fs={key:0,class:"form-validate"},Rs={class:"d-flex justify-content-end gap-4"},Es={key:2,class:"form-validate shake"},Vs={key:0},Ps={id:"myModal",class:"modal"},Ds={class:"modal-content"},Us=s("div",{class:"d-flex align-content-center"},[s("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",width:"50",height:"50",fill:"green"},[s("path",{d:"M256 48a208 208 0 1 1 0 416 208 208 0 1 1 0-416zm0 464A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM369 209c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0l-111 111-47-47c-9.4-9.4-24.6-9.4-33.9 0s-9.4 24.6 0 33.9l64 64c9.4 9.4 24.6 9.4 33.9 0L369 209z"})]),s("div",{class:"my-auto ms-2"}," Your question have been submitted ")],-1),js={class:"d-flex flex-row-reverse"};function Bs(i,e,l,a,t,u){const h=p("RouterLink");return n(),o(g,null,[s("div",us,[s("div",cs,[s("div",ds,[t.questionSubmitted?(n(),S(h,{key:0,class:"btn btn-light purple-btn",style:{width:"136px"},to:"/skills"},{default:$(()=>[b(" Back to skills ")]),_:1})):c("",!0),t.questionSubmitted?c("",!0):(n(),o("div",hs,[t.questionSubmitted?c("",!0):(n(),o("div",ms,gs)),t.questionSubmitted?(n(),o("div",ps,ys)):c("",!0),s("div",vs,[ks,y(s("textarea",{"onUpdate:modelValue":e[0]||(e[0]=d=>t.question.text=d),rows:"1",class:"form-control"},`\r
                        `,512),[[Q,t.question.text]]),t.validate.question&&(t.question.text===""||t.question.text===null)?(n(),o("div",bs," please enter a question ! ")):c("",!0)]),(n(!0),o(g,null,v(t.answers,(d,r)=>(n(),o("div",{key:r,class:"mb-3"},[s("label",qs,"Answer "+_(r+1)+":",1),s("div",xs,[y(s("input",{"onUpdate:modelValue":m=>d.text=m,id:"answer"+(r+1),placeholder:"Enter answer option",type:"text",class:"form-control"},null,8,As),[[Q,d.text]])]),t.validate.validated&&d.text===""?(n(),o("div",Ss," please enter a correct answer ! ")):c("",!0),s("div",Ms,[y(s("input",{class:"form-check-input",type:"radio",id:"correct"+(r+1),name:"correctAnswer",value:r+1,"onUpdate:modelValue":e[1]||(e[1]=m=>t.question.correct_answer=m)},null,8,Is),[[E,t.question.correct_answer]]),s("label",{for:"correct"+(r+1),class:""},"Set as correct",8,Ts)])]))),128)),s("div",Qs,[t.answers.length<5?(n(),o("button",{key:0,onClick:e[2]||(e[2]=(...d)=>i.addAnswer&&i.addAnswer(...d)),class:"btn purple-btn"},[$s,b(" Add Answer ")])):c("",!0)]),s("div",Cs,[y(s("input",{type:"checkbox",id:"randomOrder","onUpdate:modelValue":e[3]||(e[3]=d=>t.question.is_random=d),class:"form-check-input"},null,512),[[U,t.question.is_random]]),Ns]),s("div",zs,[Ls,y(s("textarea",{"onUpdate:modelValue":e[4]||(e[4]=d=>t.question.explanation=d),class:"form-control",rows:"3"},null,512),[[Q,t.question.explanation]]),t.validate.explanation&&(t.question.explanation===""||t.question.explanation===null)?(n(),o("div",Fs," please enter a explanation ! ")):c("",!0)]),s("div",Rs,[s("button",{class:"btn btn-light",onClick:e[5]||(e[5]=(...d)=>u.skipAddingQuestion&&u.skipAddingQuestion(...d))}," Skip "),s("button",{class:"btn purple-btn",onClick:e[6]||(e[6]=d=>t.questionSubmitted?u.showSubmittedMess():u.Submit())}," Submit ")]),t.submittedMess?(n(),o("div",Es," You already submitted a question !! ")):c("",!0)]))])])]),t.questionAddedModal?(n(),o("div",Vs,[s("div",Ps,[s("div",Ds,[Us,s("div",js,[s("button",{type:"button",class:"btn green-btn",onClick:e[7]||(e[7]=d=>t.questionAddedModal=!1)}," ok "),t.questionSubmitted?(n(),S(h,{key:0,class:"btn btn-light purple-btn mx-2",to:"/skills"},{default:$(()=>[b(" Back to skills ")]),_:1})):c("",!0)])])])])):c("",!0)],64)}const D=M(as,[["render",Bs]]);const Os={setup(){return{userDetailsStore:N()}},components:{StudentAddMCQuestion:D,FlagModals:P},data(){return{assessmentResult:"",finishDate:"",finishTime:"",parent:"",score:0,totalScore:1,scorePercent:0,questions:[],essayQuestionsLength:0,correctIndex:[],passModal:!1,failsModal:!1,waitForMarkModal:!1,questionToFlagId:0,questionToFlagType:"",showFlaggingModal:!1}},props:["skill","isManualEssayMarking"],mounted(){switch(this.assessmentResult=this.$parent.assessmentStatus,this.assessmentResult){case"pass":this.passModal=!0;break;case"fails":this.failsModal=!0;break;case"wait for essay answers to be mark":this.waitForMarkModal=!0;break}this.finishDate=this.$parent.finishTime.toLocaleString(void 0,{weekday:"long",year:"numeric",month:"long",day:"numeric"}),this.finishTime=this.$parent.finishTime.toLocaleTimeString(),this.score=this.$parent.score,this.isManualEssayMarking==1?this.totalScore=this.$parent.numMCQuestions:this.totalScore=this.$parent.questions.length,this.totalScore!==0&&(this.scorePercent=Math.floor(this.score/this.totalScore*100)),this.isManualEssayMarking==1?(this.questions=this.$parent.questions.filter(i=>i.questionType==="mc"),this.essayQuestionsLength=this.$parent.questions.length-this.questions.length):this.questions=this.$parent.questions,this.correctIndex=[1]},methods:{setQuestionForFlagging(i,e){this.questionToFlagId=i,this.questionToFlagType=e,this.showFlaggingModal=!0}}},f=i=>(z("data-v-6381db42"),i=i(),L(),i),Ys={class:"container mt-3 pb-3"},Js=f(()=>s("div",{class:"page-tile"},"Assessment Result",-1)),Hs={class:"d-flex flex-md-row flex-column gap-3"},Ks={class:"assessment-info"},Ws=f(()=>s("span",{class:"info-label"},"Result:",-1)),Gs={key:0,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 512",fill:"red",height:"14",width:"14",class:"status-icon"},Xs=f(()=>s("path",{d:"M64 64c0-17.7-14.3-32-32-32S0 46.3 0 64V320c0 17.7 14.3 32 32 32s32-14.3 32-32V64zM32 480a40 40 0 1 0 0-80 40 40 0 1 0 0 80z"},null,-1)),Zs=[Xs],se={key:1,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",fill:"green",height:"14",width:"14",class:"mb-1"},ee=f(()=>s("path",{d:"M438.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L160 338.7 393.4 105.4c12.5-12.5 32.8-12.5 45.3 0z"},null,-1)),te=[ee],ie=f(()=>s("span",{class:"info-label"},"Finish Date: ",-1)),ne={class:"info-value"},oe={id:"finish-time"},le={class:"hover-cursor","b-on-hover":"",title:"you need to score above 80% to pass the assessment"},re=f(()=>s("span",{class:"info-label"},"Score: ",-1)),ae={class:"info-value"},ue=f(()=>s("span",null,"*",-1)),ce={key:0,class:"essay-warning"},de={class:"mc-question-result"},he=["onClick"],me={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",style:{height:"22px",opacity:"0.5"}},_e=f(()=>s("path",{fill:"#8f7bd6",d:"M64 32C64 14.3 49.7 0 32 0S0 14.3 0 32V64 368 480c0 17.7 14.3 32 32 32s32-14.3 32-32V352l64.3-16.1c41.1-10.3 84.6-5.5 122.5 13.4c44.2 22.1 95.5 24.8 141.7 7.4l34.7-13c12.5-4.7 20.8-16.6 20.8-30V66.1c0-23-24.2-38-44.8-27.7l-9.6 4.8c-46.3 23.2-100.8 23.2-147.1 0c-35.1-17.6-75.4-22-113.5-12.5L64 48V32z"},null,-1)),fe=[_e],ge={class:"question"},pe={class:"d-flex flex-column"},we={class:"form-check my-3"},ye={class:"control control-checkbox"},ve={key:0,class:"correct-indicate"},ke={key:1,class:"user-answer-indicate"},be={key:2,class:"correct-indicate"},qe=["value","disabled"],xe={class:"control_indicator"},Ae={key:0,class:"checked"},Se={key:1},Me=f(()=>s("span",{class:"explain-label"},"Your answer:",-1)),Ie={class:"explain-text"},Te={key:2},Qe=f(()=>s("span",{class:"explain-label"},"Your answer:",-1)),$e=["src"],Ce={key:3,class:"explain-answer"},Ne=f(()=>s("div",{class:"explain-label"},"Explanation:",-1)),ze={class:"explain-text"},Le={key:0},Fe={id:"myModal",class:"modal"},Re={class:"modal-content"},Ee=f(()=>s("div",{class:"d-flex align-content-center"},[s("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",width:"50",height:"50",fill:"green"},[s("path",{d:"M256 48a208 208 0 1 1 0 416 208 208 0 1 1 0-416zm0 464A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM369 209c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0l-111 111-47-47c-9.4-9.4-24.6-9.4-33.9 0s-9.4 24.6 0 33.9l64 64c9.4 9.4 24.6 9.4 33.9 0L369 209z"})]),s("div",{class:"my-auto ms-2"}," Well done! You passed and have now mastered the skill! ")],-1)),Ve={class:"d-flex flex-row-reverse"},Pe={key:1},De={id:"myModal",class:"modal"},Ue={class:"modal-content"},je=f(()=>s("div",{class:"d-flex align-content-center"},[s("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",fill:"red",width:"50",height:"50"},[s("path",{d:"M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zm0-384c13.3 0 24 10.7 24 24V264c0 13.3-10.7 24-24 24s-24-10.7-24-24V152c0-13.3 10.7-24 24-24zM224 352a32 32 0 1 1 64 0 32 32 0 1 1 -64 0z"})]),s("div",{class:"my-auto ms-2"}," You failed this time, try again later! ")],-1)),Be={class:"d-flex flex-row-reverse"},Oe={key:2},Ye={id:"myModal",class:"modal"},Je={class:"modal-content"},He=f(()=>s("div",null," There is at least one question that needs to be marked by your instructor. Please check whether you passed later. ",-1)),Ke={class:"d-flex flex-row-reverse"};function We(i,e,l,a,t,u){const h=p("StudentAddMCQuestion"),d=p("FlagModals");return n(),o(g,null,[s("div",Ys,[Js,s("div",Hs,[s("div",Ks,[s("div",null,[Ws,s("span",{class:A(t.assessmentResult=="pass"?"student-pass":"student-fail")},[b(_(t.assessmentResult)+" ",1),t.assessmentResult==="failed"?(n(),o("svg",Gs,Zs)):c("",!0),t.assessmentResult==="pass"?(n(),o("svg",se,te)):c("",!0)],2)]),s("div",null,[ie,s("span",ne,[b(_(t.finishDate)+" ",1),s("span",oe," at "+_(t.finishTime),1)])]),s("div",le,[re,s("span",ae,_(t.score)+" out "+_(t.totalScore),1),b(" ( "+_(t.scorePercent)+"%) ",1),ue]),l.isManualEssayMarking==1&&t.essayQuestionsLength!=0?(n(),o("div",ce," There are "+_(t.essayQuestionsLength)+" answers that needed to be mark by your instructor ",1)):c("",!0)]),t.assessmentResult==="pass"?(n(),S(h,{key:0})):c("",!0)]),(n(!0),o(g,null,v(t.questions,r=>(n(),o("div",de,[r.questionType=="mc"?(n(),o("div",{key:0,"b-tooltip.hover":"",title:"flag this question for review",onClick:m=>u.setQuestionForFlagging(r.id,"mc_question"),class:"flagging-icon",style:{height:"50px"}},[(n(),o("svg",me,fe))],8,he)):c("",!0),s("div",{class:A(r.userAnswer==r.correct_answer||r.isCorrect==!0?"correct-label":"wrong-label")},_(r.userAnswer==r.correct_answer||r.isCorrect==!0?"Correct !!":"Incorrect !!"),3),s("div",ge,_(r.question),1),s("div",pe,[r.questionType=="mc"?(n(!0),o(g,{key:0},v(r.answerOptions,(m,q)=>(n(),o("div",we,[s("label",ye,[s("div",{class:A(["my-auto mx-2 me-4 answer-option ",m.index==r.correct_answer?" correct-answer":r.userAnswer==m.index?"user-answer":" incorrect-answer"])},[b(_(m.option)+" ",1),m.index==r.correct_answer&&r.userAnswer!==r.correct_answer?(n(),o("span",ve," (correct answer)")):c("",!0),m.index!==r.correct_answer&&r.userAnswer==m.index?(n(),o("span",ke," (your answer)")):c("",!0),m.index==r.correct_answer&&r.userAnswer==r.correct_answer?(n(),o("span",be," (you are correct !)")):c("",!0)],2),s("input",{type:"radio",name:"nodeType",value:m.index,disabled:m.index!=r.correct_answer},null,8,qe),s("div",xe,[m.index==r.correct_answer?(n(),o("div",Ae)):c("",!0)])])]))),256)):r.questionType=="essay"?(n(),o("div",Se,[Me,s("div",Ie,_(r.userAnswer),1)])):r.questionType=="image"?(n(),o("div",Te,[Qe,(n(!0),o(g,null,v(r.userAnswer.length,(m,q)=>(n(),o("img",{src:r.userAnswer[q],width:"80"},null,8,$e))),256))])):c("",!0),r.questionType=="mc"||r.isCorrect==!1?(n(),o("div",Ce,[Ne,s("div",ze,_(r.explanation),1)])):c("",!0)])]))),256))]),t.passModal?(n(),o("div",Le,[s("div",Fe,[s("div",Re,[Ee,s("div",Ve,[s("button",{type:"button",class:"btn green-btn",onClick:e[0]||(e[0]=r=>t.passModal=!1)}," Great! ")])])])])):c("",!0),t.failsModal?(n(),o("div",Pe,[s("div",De,[s("div",Ue,[je,s("div",Be,[s("button",{type:"button",class:"btn red-btn",onClick:e[1]||(e[1]=r=>t.failsModal=!1)}," OK ")])])])])):c("",!0),t.waitForMarkModal?(n(),o("div",Oe,[s("div",Ye,[s("div",Je,[He,s("div",Ke,[s("button",{type:"button",class:"btn green-btn",onClick:e[2]||(e[2]=r=>t.waitForMarkModal=!1)}," OK ")])])])])):c("",!0),t.showFlaggingModal?(n(),S(d,{key:3,userId:a.userDetailsStore.userId,contentType:t.questionToFlagType,contentId:t.questionToFlagId},null,8,["userId","contentType","contentId"])):c("",!0)],64)}const Ge=M(Os,[["render",We],["__scopeId","data-v-6381db42"]]);const Xe={setup(){const i=N(),e=j(),l=V(),a=B(),t=F(),u=R();return{userDetailsStore:i,settingsStore:e,skillsStore:l,assessmentsStore:a,userSkillsStore:t,skillTreeStore:u}},data(){return{loading:!0,skillId:this.$route.params.id,skill:{},mcQuestions:[],mcQuestionsAnswer:[],essayQuestions:[],imageQuestions:[],questions:[],question:{},questionNumber:0,score:0,assessmentId:null,numMCQuestions:0,numEssayQuestions:0,numImageQuestions:0,totalNumOfQuestions:0,isAllQuestionsAnswered:!1,waitForMarkModal:!1,oldAssessment:void 0,updatedAssessment:!1,showFlaggingModal:!1,flagContentType:"",isQuizPassed:!1,answerHoveredIndex:1/0,showResult:!1,assessmentStatus:"",haveEssayQuestion:!1,finishTime:null,needToSelectInstructor:!1,aiLoading:!1,numOfImagesRequired:1}},async created(){this.settingsStore.quizMaxQuestions==null&&await this.settingsStore.getSettings(),await this.assessmentsStore.getAssessments();const i=this.assessmentsStore.assessments,e=await this.userDetailsStore.getUserDetails();let l;for(let a=0;a<this.skillsStore.skillsList.length;a++)this.skillsStore.skillsList[a].id==this.skillId&&(l=this.skillsStore.skillsList[a].type,this.skill=this.skillsStore.skillsList[a]);if(this.oldAssessment=i.find(a=>a.student_id===e.userId&&a.skill_id===this.skill.id),this.oldAssessment!==void 0&&(this.updatedAssessment=!0),l!="super")await this.fetchMCQuestions(this.skillId);else{let a=[];for(let t=0;t<this.skillsStore.skillsList.length;t++)this.skillsStore.skillsList[t].parent==this.skillId&&this.skillsStore.skillsList[t].type=="sub"&&a.push(this.skillsStore.skillsList[t]);for(let t=0;t<a.length;t++)await this.fetchMCQuestions(a[t].id)}},components:{EssayAnswer:W,ImageAnswer:rs,StudentAddMCQuestion:D,AssessmentResult:Ge,FlagModals:P},methods:{async fetchMCQuestions(i){fetch("/questions/"+i+"/multiple-choice").then(function(e){return e.json()}).then(e=>{this.mcQuestions=this.mcQuestions.concat(e)}).then(()=>{for(let l=0;l<this.mcQuestions.length;l++)this.mcQuestions[l].userAnswer=null,this.mcQuestions[l].questionType="mc";for(let l=0;l<this.mcQuestions.length;l++){var e=[];this.mcQuestions[l].answer_1&&e.push({option:this.mcQuestions[l].answer_1,index:1}),this.mcQuestions[l].answer_2&&e.push({option:this.mcQuestions[l].answer_2,index:2}),this.mcQuestions[l].answer_3&&e.push({option:this.mcQuestions[l].answer_3,index:3}),this.mcQuestions[l].answer_4&&e.push({option:this.mcQuestions[l].answer_4,index:4}),this.mcQuestions[l].answer_5&&e.push({option:this.mcQuestions[l].answer_5,index:5}),this.mcQuestions[l].is_random&&(e=e.sort((a,t)=>.5-Math.random()));for(let a=0;a<e.length;a++)e[a].option.toUpperCase()=="all of the above".toUpperCase()&&function(u,h,d){var r=u[h];u.splice(h,1),u.splice(d,0,r)}(e,a,4);this.mcQuestions[l].answerOptions=e}}).then(()=>{this.fetchEssayQuestions(i)})},async fetchEssayQuestions(i){fetch("/questions/"+i+"/essay").then(function(e){return e.json()}).then(e=>{e.length>0&&!this.userDetailsStore.instructorId&&this.settingsStore.isManualEssayMarking==1&&(this.needToSelectInstructor=!0),this.essayQuestions=this.essayQuestions.concat(e)}).then(()=>{for(let e=0;e<this.essayQuestions.length;e++)this.essayQuestions[e].userAnswer=null,this.essayQuestions[e].questionType="essay"}).then(()=>{this.questions=this.essayQuestions.concat(this.mcQuestions)}).then(()=>{this.fetchImageQuestions(i)})},async fetchImageQuestions(i){fetch("/questions/"+i+"/image").then(function(e){return e.json()}).then(e=>{e.length>0&&!this.userDetailsStore.instructorId&&this.settingsStore.isManualEssayMarking==1&&(this.needToSelectInstructor=!0),this.imageQuestions=this.imageQuestions.concat(e)}).then(()=>{for(let e=0;e<this.imageQuestions.length;e++)this.imageQuestions[e].userAnswer=null,this.imageQuestions[e].questionType="image"}).then(()=>{this.questions=this.imageQuestions.concat(this.questions),this.questions=this.questions.sort((e,l)=>.5-Math.random()),this.questions.length>this.settingsStore.quizMaxQuestions&&(this.questions.length=this.settingsStore.quizMaxQuestions),this.question=this.questions[0],this.question.questionType=="image"&&(this.numOfImagesRequired=this.question.num_images_required),this.totalNumOfQuestions=this.questions.length}).then(()=>{this.loading=!1})},Next(){if(this.questions[this.questionNumber].questionType=="essay"){const i=this.$refs.essayAnswer.getAnswer();this.questions[this.questionNumber].userAnswer=i,this.$refs.essayAnswer.clearAnswer()}else if(this.questions[this.questionNumber].questionType=="image"){const i=this.$refs.imageAnswer.getAnswer();this.questions[this.questionNumber].userAnswer=i,this.$refs.imageAnswer.clearAnswer()}this.questionNumber++,this.questions[this.questionNumber].questionType=="essay"?this.questions[this.questionNumber].userAnswer&&this.$refs.essayAnswer.setAnswer(this.questions[this.questionNumber].userAnswer):this.questions[this.questionNumber].questionType=="image"&&(this.questions[this.questionNumber].userAnswer&&this.$refs.imageAnswer.setAnswer(this.questions[this.questionNumber].userAnswer),this.numOfImagesRequired=this.questions[this.questionNumber].num_images_required)},Previous(){if(this.questions[this.questionNumber].questionType=="essay"){const i=this.$refs.essayAnswer.getAnswer();this.questions[this.questionNumber].userAnswer=i}else if(this.questions[this.questionNumber].questionType=="image"){const i=this.$refs.imageAnswer.getAnswer();this.questions[this.questionNumber].userAnswer=i}this.questionNumber--,this.questions[this.questionNumber].questionType=="essay"?this.$refs.essayAnswer.setAnswer(this.questions[this.questionNumber].userAnswer):this.questions[this.questionNumber].questionType=="image"&&(this.$refs.imageAnswer.setAnswer(this.questions[this.questionNumber].userAnswer),this.numOfImagesRequired=this.questions[this.questionNumber].num_images_required)},async Submit(){if(this.finishTime=new Date,this.questions[this.questionNumber].questionType=="essay"){let e;e=this.$refs.essayAnswer.getAnswer(),this.questions[this.questionNumber].userAnswer=e}else if(this.questions[this.questionNumber].questionType=="image"){let e;e=this.$refs.imageAnswer.getAnswer(),this.questions[this.questionNumber].userAnswer=e}for(let e=0;e<this.questions.length;e++)this.questions[e].questionType=="mc"?(this.numMCQuestions++,this.questions[e].userAnswer==this.questions[e].correct_answer&&this.score++):this.questions[e].questionType=="essay"?this.numEssayQuestions++:this.numImageQuestions++;if(this.numEssayQuestions===0&&this.numImageQuestions===0)this.score/this.numMCQuestions*100>=this.settingsStore.passMark?(this.MakeMastered(this.skill),this.isQuizPassed=!0,this.assessmentStatus="pass",this.showResult=!0):(this.isQuizPassed=!0,this.assessmentStatus="fails",this.showResult=!0);else if(this.settingsStore.isManualEssayMarking==1){let e="POST";this.oldAssessment!==void 0&&(e="PUT");let l=this.numEssayQuestions+this.numImageQuestions;const a={method:e,headers:{"Content-Type":"application/json"},body:JSON.stringify({totalScore:this.totalNumOfQuestions,currentScore:this.score,numUnmarkedQuestions:l})};var i="/assessments/"+this.userDetailsStore.userId+"/"+this.skillId;const t=()=>{this.isQuizPassed=!0,this.showResult=!0,this.assessmentStatus="please wait for answers to be marked"};fetch(i,a).then(function(u){return u.json()}).then(u=>{this.assessmentId=u.id,fetch("/unmarked-answers/delete/"+this.assessmentId,{method:"DELETE"}).then(()=>{for(let d=0;d<this.questions.length;d++)if(this.questions[d].questionType=="essay"){const r={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({answer:this.questions[d].userAnswer,questionId:this.questions[d].id})};var h="/unmarked-answers/add/essay/"+this.assessmentId;fetch(h,r).then(function(m){t()})}else if(this.questions[d].questionType=="image"){const r={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({answer:this.questions[d].userAnswer,questionId:this.questions[d].id})};var h="/unmarked-answers/add/image/"+this.assessmentId;fetch(h,r).then(function(q){t()})}})})}else{for(let e=0;e<this.questions.length;e++)if(this.questions[e].questionType=="essay"){let l=this.questions[e].question,a=this.questions[e].userAnswer;await this.AIMarkEssayQuestion(l,a,e)}else if(this.questions[e].questionType=="image"){let l=this.questions[e].question,a=this.questions[e].userAnswer;await this.AIMarkImageQuestion(l,a,e)}this.score/this.questions.length*100>=this.settingsStore.passMark?(this.MakeMastered(this.skill),this.isQuizPassed=!0,this.assessmentStatus="pass",this.showResult=!0):(this.isQuizPassed=!0,this.assessmentStatus="fails",this.showResult=!0)}},async AIMarkEssayQuestion(i,e,l){this.aiLoading=!0;const a={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:i,answer:e,level:this.skill.level})};await fetch("/questions/mark-essay-question",a).then(function(u){return u.json()}).then(u=>{u.isCorrect==!0?(this.score++,this.questions[l].isCorrect=!0):(this.questions[l].explanation=u.explanation,this.questions[l].isCorrect=!1)}).finally(()=>{this.aiLoading=!1})},async AIMarkImageQuestion(i,e,l){this.aiLoading=!0;const a={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:i,answer:e,level:this.skill.level})};await fetch("/questions/mark-image-question",a).then(function(u){return u.json()}).then(u=>{u.isError==!0?(this.questions[l].isCorrect=!1,this.questions[l].explanation="There was an error grading this question. The file size(s) may be too big."):u.isCorrect==!0?(this.score++,this.questions[l].isCorrect=!0):(this.questions[l].explanation=u.explanation,this.questions[l].isCorrect=!1)}).finally(()=>{this.aiLoading=!1})},UserAnswer(){for(let i=0;i<this.questions.length;i++)if(this.questions[i].userAnswer==null){this.isAllQuestionsAnswered=!1;return}else this.isAllQuestionsAnswered=!0},TestPass(){this.isQuizPassed=!0},handleClickFlagIcon(){switch(this.questions[this.questionNumber].questionType){case"mc":this.flagContentType="mc_question";break;case"essay":this.flagContentType="essay_question";break;case"image":this.flagContentType="image_question";break}this.showFlaggingModal=!0},async MakeMastered(i){await this.userSkillsStore.MakeMastered(this.userDetailsStore.userId,i),await this.skillTreeStore.getUserSkills()}}},k=i=>(z("data-v-6e257e52"),i=i(),L(),i),Ze={key:0},st={key:1,class:"loading-animation d-flex justify-content-center align-items-center py-4"},et=k(()=>s("span",{class:"loader"},null,-1)),tt=[et],it={key:2},nt={key:0},ot={id:"myModal",class:"modal"},lt={class:"modal-content"},rt=k(()=>s("div",{class:"mb-2"}," You are taking a new quiz for this skill while your old one is still waiting to be marked. Please note that your old answers will be replaced. ",-1)),at={class:"d-flex flex-row-reverse"},ut={class:"pb-2 pb-md-0"},ct={key:0,class:"container mt-5 mb-3 p-3 pt-2 mb-3",id:"question-container"},dt={class:"row"},ht={key:0},mt={class:"col d-flex my-2 gap-2 justify-content-between flex-column flex-md-row"},_t={class:"d-flex align-items-lg-center"},ft={id:"question-number-div"},gt={id:"question-content"},pt={class:"d-flex justify-content-end"},wt={key:0,"b-tooltip.hover":"",title:"This question was written or edited by a human",class:"author-icon me-4",style:{height:"50px"}},yt={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 320 512",height:"22",style:{opacity:"0.5"}},vt=k(()=>s("path",{d:"M112 48a48 48 0 1 1 96 0 48 48 0 1 1 -96 0zm40 304l0 128c0 17.7-14.3 32-32 32s-32-14.3-32-32l0-223.1L59.4 304.5c-9.1 15.1-28.8 20-43.9 10.9s-20-28.8-10.9-43.9l58.3-97c17.4-28.9 48.6-46.6 82.3-46.6l29.7 0c33.7 0 64.9 17.7 82.3 46.6l58.3 97c9.1 15.1 4.2 34.8-10.9 43.9s-34.8 4.2-43.9-10.9L232 256.9 232 480c0 17.7-14.3 32-32 32s-32-14.3-32-32l0-128-16 0z",fill:"#8f7bd6"},null,-1)),kt=[vt],bt={key:1,"b-tooltip.hover":"",title:"This question was written by an AI",class:"author-icon me-4",style:{height:"50px"}},qt={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 640 512",height:"22",style:{opacity:"0.5"}},xt=k(()=>s("path",{d:"M320 0c17.7 0 32 14.3 32 32l0 64 120 0c39.8 0 72 32.2 72 72l0 272c0 39.8-32.2 72-72 72l-304 0c-39.8 0-72-32.2-72-72l0-272c0-39.8 32.2-72 72-72l120 0 0-64c0-17.7 14.3-32 32-32zM208 384c-8.8 0-16 7.2-16 16s7.2 16 16 16l32 0c8.8 0 16-7.2 16-16s-7.2-16-16-16l-32 0zm96 0c-8.8 0-16 7.2-16 16s7.2 16 16 16l32 0c8.8 0 16-7.2 16-16s-7.2-16-16-16l-32 0zm96 0c-8.8 0-16 7.2-16 16s7.2 16 16 16l32 0c8.8 0 16-7.2 16-16s-7.2-16-16-16l-32 0zM264 256a40 40 0 1 0 -80 0 40 40 0 1 0 80 0zm152 40a40 40 0 1 0 0-80 40 40 0 1 0 0 80zM48 224l16 0 0 192-16 0c-26.5 0-48-21.5-48-48l0-96c0-26.5 21.5-48 48-48zm544 0c26.5 0 48 21.5 48 48l0 96c0 26.5-21.5 48-48 48l-16 0 0-192 16 0z",fill:"#8f7bd6"},null,-1)),At=[xt],St={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",style:{height:"22px",opacity:"0.5"}},Mt=k(()=>s("path",{fill:"#8f7bd6",d:"M64 32C64 14.3 49.7 0 32 0S0 14.3 0 32V64 368 480c0 17.7 14.3 32 32 32s32-14.3 32-32V352l64.3-16.1c41.1-10.3 84.6-5.5 122.5 13.4c44.2 22.1 95.5 24.8 141.7 7.4l34.7-13c12.5-4.7 20.8-16.6 20.8-30V66.1c0-23-24.2-38-44.8-27.7l-9.6 4.8c-46.3 23.2-100.8 23.2-147.1 0c-35.1-17.6-75.4-22-113.5-12.5L64 48V32z"},null,-1)),It=[Mt],Tt={key:0},Qt={class:"form-check my-3"},$t={class:"control control-checkbox"},Ct=["name","value","onUpdate:modelValue"],Nt=["onMouseover"],zt={class:"form-group"},Lt={class:"form-group"},Ft={class:"mt-3 d-flex justify-content-end"},Rt={key:1,id:"question-content"},Et={key:5,class:"modal"},Vt={class:"modal-content"},Pt=k(()=>s("div",{class:""},[s("p",{class:"text-center"}," Please choose an instructor before taking these quizzes. ")],-1)),Dt={class:"d-flex flex-column-reverse flex-md-row justify-content-center gap-2"},Ut=k(()=>s("span",null,"Back",-1)),jt=k(()=>s("span",null,"Select Instructor",-1));function Bt(i,e,l,a,t,u){const h=p("EssayAnswer"),d=p("ImageAnswer"),r=p("AssessmentResult"),m=p("FlagModals"),q=p("RouterLink");return n(),o(g,null,[t.loading==!0?(n(),o("div",Ze,"Loading...")):c("",!0),t.aiLoading?(n(),o("div",st,tt)):c("",!0),t.loading==!1&&t.isQuizPassed==!1&&!t.needToSelectInstructor&&!t.aiLoading?(n(),o("div",it,[t.updatedAssessment?(n(),o("div",nt,[s("div",ot,[s("div",lt,[rt,s("div",at,[s("button",{type:"button",class:"btn green-btn",onClick:e[0]||(e[0]=w=>t.updatedAssessment=!1)}," OK ")])])])])):c("",!0),s("div",ut,[t.questions.length>0?(n(),o("div",ct,[(n(!0),o(g,null,v(t.questions,(w,I)=>(n(),o("div",dt,[I==t.questionNumber?(n(),o("div",ht,[s("div",mt,[s("div",_t,[s("div",ft,_(I+1),1),s("div",gt,_(w.question),1)]),s("div",pt,[w.is_human_edited?(n(),o("div",wt,[(n(),o("svg",yt,kt))])):(n(),o("div",bt,[(n(),o("svg",qt,At))])),s("div",{"b-tooltip.hover":"",title:"Flag this question for review",onClick:e[1]||(e[1]=(...x)=>u.handleClickFlagIcon&&u.handleClickFlagIcon(...x)),class:"flagging-icon",style:{height:"50px"}},[(n(),o("svg",St,It))])])]),w.questionType=="mc"?(n(),o("div",Tt,[(n(!0),o(g,null,v(w.answerOptions,(x,ii)=>(n(),o("div",Qt,[s("label",$t,[s("div",{class:A(t.answerHoveredIndex==x.index?"my-auto mx-2 me-4 answer-option checkbox-hovered":"my-auto mx-2 me-4 answer-option")},_(x.option),3),y(s("input",{type:"radio",name:I+"answer",value:x.index,"onUpdate:modelValue":C=>t.questions[I].userAnswer=C},null,8,Ct),[[E,t.questions[I].userAnswer]]),s("div",{class:"control_indicator",onMouseover:C=>t.answerHoveredIndex=x.index,onMouseleave:e[2]||(e[2]=C=>t.answerHoveredIndex=1/0)},null,40,Nt)])]))),256))])):c("",!0)])):c("",!0)]))),256)),s("div",{class:A(`${t.questions[t.questionNumber].questionType=="essay"?"d-block":"d-none"}`)},[s("div",zt,[T(h,{ref:"essayAnswer"},null,512)])],2),s("div",{class:A(`${t.questions[t.questionNumber].questionType=="image"?"d-block":"d-none"}`)},[s("div",Lt,[T(d,{numImagesRequired:t.numOfImagesRequired,ref:"imageAnswer"},null,8,["numImagesRequired"])])],2),s("div",Ft,[t.questionNumber>0?(n(),o("button",{key:0,onClick:e[3]||(e[3]=w=>u.Previous()),class:"btn red-btn me-2"}," Previous ")):c("",!0),t.questionNumber<t.questions.length-1?(n(),o("button",{key:1,onClick:e[4]||(e[4]=w=>u.Next()),class:"btn green-btn"}," Next ")):c("",!0),t.questionNumber>=t.questions.length-1?(n(),o("button",{key:2,onClick:e[5]||(e[5]=w=>u.Submit()),class:"btn green-btn"}," Submit ")):c("",!0)])])):(n(),o("div",Rt," There is no quiz for this skill yet. Please check again soon. "))])])):c("",!0),t.showResult?(n(),S(r,{key:3,skill:t.skill,isManualEssayMarking:a.settingsStore.isManualEssayMarking},null,8,["skill","isManualEssayMarking"])):c("",!0),t.showFlaggingModal?(n(),S(m,{key:4,userId:a.userDetailsStore.userId,contentId:t.questions[t.questionNumber].id,contentType:t.flagContentType},null,8,["userId","contentId","contentType"])):c("",!0),t.needToSelectInstructor?(n(),o("div",Et,[s("div",Vt,[Pt,s("div",Dt,[T(q,{to:`/skills/${t.skillId}`,type:"button",class:"btn green-btn w-100 w-md-50"},{default:$(()=>[Ut]),_:1},8,["to"]),T(q,{to:"/profile/edit",type:"button",class:"btn green-btn w-100 w-md-50"},{default:$(()=>[jt]),_:1})])])])):c("",!0)],64)}const Ot=M(Xe,[["render",Bt],["__scopeId","data-v-6e257e52"]]);const Yt={setup(){return{skillsStore:V()}},data(){return{skillId:this.$route.params.id,skill:{name:null,image:null,firstAncestorId:null,levelInHierarchy:null,url:""}}},async mounted(){this.skillsStore.skillsList.length==0&&await this.skillsStore.getSkillsList();for(let i=0;i<this.skillsStore.skillsList.length;i++)this.skillId==this.skillsStore.skillsList[i].id&&(this.skill.name=this.skillsStore.skillsList[i].name,this.skill.url=this.skillsStore.skillsList[i].url)},components:{Assessment:Ot},methods:{imageUrlAlternative(i){i.target.src="/images/skill-avatar/recurso.png"}}},Jt=i=>(z("data-v-bac856b7"),i=i(),L(),i),Ht={id:"banner"},Kt=["src"],Wt={class:"container mt-3"},Gt={class:"d-flex justify-content-md-between justify-content-center"},Xt={class:"d-flex flex-column flex-md-row"},Zt=["src","onerror"],si={id:"assessment-skill-name",class:"ms-3 d-flex justify-content-md-end text-center justify-content-center"},ei=Jt(()=>s("div",{class:"mt-4 mb-4"},[s("hr",{class:"border border-2 opacity-100 w-md-75 w-100",id:"assessment-horizontal-line"})],-1));function ti(i,e,l,a,t,u){const h=p("Assessment");return n(),o(g,null,[s("div",Ht,[s("img",{src:"/images/banners/skills-banner.png",class:"img-fluid"},null,8,Kt)]),s("div",Wt,[s("div",Gt,[s("div",Xt,[s("img",{id:"skill-icon",src:"https://institute-skill-infobox-image-thumbnails.s3.amazonaws.com/"+t.skill.url,onerror:u.imageUrlAlternative,class:"rounded"},null,8,Zt),s("div",si,_(this.skill.name)+" Quiz ",1)])]),ei,T(h)])],64)}const ai=M(Yt,[["render",ti],["__scopeId","data-v-bac856b7"]]);export{ai as default};
