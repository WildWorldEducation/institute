import{_ as m,e as p,L as _,o,c as n,a as e,t as i,s as l,b as r,q as b}from"./main-d0b72fba.js";const g={setup(){const s=p(),t=_();return{userDetailsStore:s,settingsStore:t}},data(){return{monthlyTokenUsage:null,year:0,month:"",isAITokenLimitReached:!1,isMobileCheck:window.innerWidth}},async mounted(){let s=document.createElement("script");s.setAttribute("src","https://js.stripe.com/v3/"),document.head.appendChild(s),this.settingsStore.freePlanTokenLimit==0&&await this.settingsStore.getSettings(),await this.userDetailsStore.getUserDetails(),this.userDetailsStore.subscriptionTier=="free"?this.settingsStore.freePlanTokenLimit<=this.userDetailsStore.monthlyTokenUsage&&(this.isAITokenLimitReached=!0):this.userDetailsStore.subscriptionTier=="capped"&&this.settingsStore.cappedPlanTokenLimit<=this.userDetailsStore.monthlyTokenUsage&&(this.isAITokenLimitReached=!0),this.year=new Date().getFullYear();const t=["January","February","March","April","May","June","July","August","September","October","November","December"],a=new Date;this.month=t[a.getMonth()]},methods:{checkout(s){fetch("/subscriptions/create-checkout-session",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:this.userDetailsStore.userId,planType:s})}).then(t=>t.ok?t.json():t.json().then(a=>Promise.reject(a))).then(({url:t})=>{window.location=t}).catch(t=>{console.error(t.error)})},loadPortal(){fetch("/subscriptions/create-customer-portal-session",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:this.userDetailsStore.userId})}).then(s=>s.ok?s.json():s.json().then(t=>Promise.reject(t))).then(({url:s})=>{window.location=s}).catch(s=>{console.error(s.error)})}}},y={class:"container"},S=e("h1",{class:"heading"},"Subscription",-1),f={class:"row mt-4"},k={class:"col-md mb-3"},T={class:"secondary-heading h4 mb-4"},D=e("strong",null,"Your subscription tier:",-1),v=e("strong",null,"Current token usage:",-1),w={key:0,class:"alert alert-warning",role:"alert"},I=e("hr",null,null,-1),L={class:"row mt-4"},C={class:"col-md mb-3"},j=e("h2",{class:"secondary-heading h4"},"Free plan",-1),P=e("strong",null,"Token limit:",-1),A={class:"col-md mb-3"},M=e("h2",{class:"secondary-heading h4"},"Capped plan",-1),x=e("p",null,"Ideal for moderate use",-1),N=e("p",null,"$20 / month",-1),U=e("strong",null,"Token limit:",-1),J={key:1,disabled:"",class:"btn primary-btn mt-2"},O={class:"col-md mb-3"},R=e("h2",{class:"secondary-heading h4"},"Infinite plan",-1),V=e("p",null,"Ideal for daily use",-1),Y=e("p",null,"$100 / month",-1),B=e("p",null,[e("strong",null,"Token limit:"),l(" Infinite ")],-1);function F(s,t,a,h,c,u){return o(),n("div",y,[S,e("div",f,[e("div",k,[e("h2",T," Monthly AI usage: "+i(c.month)+", "+i(c.year),1),e("ul",null,[e("li",null,[e("p",null,[D,l(" "+i(h.userDetailsStore.subscriptionTier.toLocaleString()),1)])]),e("li",null,[e("p",null,[v,l(" "+i(h.userDetailsStore.monthlyTokenUsage.toLocaleString()),1)])])]),c.isAITokenLimitReached?(o(),n("div",w," You are over the monthly free limit. You can't use the AI features until next month. ")):r("",!0)]),e("div",{class:b(["col-md mb-3 d-flex",c.isMobileCheck>576?"justify-content-end":"justify-content-center"])},[this.userDetailsStore.subscriptionTier!="free"?(o(),n("button",{key:0,class:"btn primary-btn",onClick:t[0]||(t[0]=d=>u.loadPortal())}," Manage billing ")):r("",!0)],2)]),I,e("div",L,[e("div",C,[j,e("p",null,[P,l(" "+i(this.settingsStore.freePlanTokenLimit.toLocaleString()),1)])]),e("div",A,[M,x,N,e("p",null,[U,l(" "+i(this.settingsStore.cappedPlanTokenLimit.toLocaleString()),1)]),this.userDetailsStore.subscriptionTier=="free"?(o(),n("button",{key:0,onClick:t[1]||(t[1]=d=>u.checkout("capped")),class:"btn primary-btn mt-2"}," buy ")):r("",!0),this.userDetailsStore.subscriptionTier=="capped"?(o(),n("button",J," current plan ")):r("",!0)]),e("div",O,[R,V,Y,B,this.userDetailsStore.subscriptionTier=="free"?(o(),n("button",{key:0,onClick:t[2]||(t[2]=d=>u.checkout("infinite")),class:"btn primary-btn mt-2"}," buy ")):r("",!0)])])])}const q=m(g,[["render",F]]);export{q as default};
