import{u as k}from"./AnalyticsStore-bbd1c302.js";import{_ as y,o as g,c as C,f as P,A as j,r as S,a as r,g as v,l as b,k as x,b as w,E as B,p as I,d as T}from"./main-3a119cac.js";import"./transform-4d0f7c8f.js";import{u as q,l as E}from"./line-d122782f.js";import{e as L}from"./time-3c9385c3.js";import{l as D,a as M,b as H}from"./linear-d9b6cbf2.js";import{m as $}from"./continuous-93813e6c.js";import{o as R,b as V}from"./band-2263c9e7.js";import{s as u}from"./string-c67ea49d.js";import{c as N}from"./category10-63f9141e.js";import{s as U}from"./sort-fcaf8f38.js";import"./point-ea70dc51.js";import"./colors-98f238a0.js";const O={name:"SchoolProgressChart",props:[],data(){return{axisData:[]}},mounted(){},methods:{createChart(t){t.school.length>0?this.axisData=t.school:this.axisData=[];const n=Object.entries(t).map(([a,A])=>({name:a,values:A}));u("#progress-chart-container");const e=document.getElementById("progress-chart-container").clientWidth,i=document.getElementById("progress-chart-container").clientHeight,h=0,d=0,c=0,l=0,o=q(L(this.axisData,a=>a.date),[l,e-d]),m=D([0,$(this.axisData,a=>a.quantity)],[i-c,h]),_=R().domain(n.map(a=>a.name)).range(N),p=E().x(a=>o(a.date)).y(a=>m(a.quantity));u("#progress-chart-container").append("svg").attr("width","100%").attr("height","100%").attr("viewBox",[0,0,+Math.min(e,i),+Math.min(e,i)]).attr("preserveAspectRatio","xMinYMin").selectAll(".line").data(n).join("path").attr("fill","none").attr("stroke",a=>_(a.name)).attr("stroke-width",3).attr("d",a=>p(a.values))},updateChart(t){}}};function W(t,n,e,i,h,d){return null}const z=y(O,[["render",W]]),F={name:"SchoolComparisonChart",props:["data","colour"],data(){return{}},mounted(){},methods:{createChart(t){u("#school-comparison-chart-container");const n=40,e=0,i=0,h=10,d=200,c=1e3,l=Math.ceil((t.length+.1)*n)+e+h,o=D().domain([0,$(t,s=>s.quantity)]).range([d,c-i]),m=V().domain(U(t,s=>-s.quantity).map(s=>s.name)).rangeRound([e,l-h]).padding(.1),_=o.tickFormat(20),p=u("#school-comparison-chart-container").append("svg").attr("width",c).attr("height",l).attr("viewBox",[0,0,c,l]).attr("style","max-width: 100%; height: 100%; font: 16px sans-serif;");p.append("g").attr("fill",this.colour).selectAll().data(t).join("rect").attr("x",o(0)).attr("y",s=>m(s.name)).attr("width",s=>o(s.quantity)-o(0)).attr("height",m.bandwidth()),p.append("g").attr("fill","white").attr("text-anchor","end").selectAll().data(t).join("text").attr("x",s=>o(s.quantity)).attr("y",s=>m(s.name)+m.bandwidth()/2).attr("dy","0.35em").attr("dx",-4).text(s=>_(s.quantity)).call(s=>s.filter(a=>o(a.quantity)-o(0)<20).attr("dx",4).attr("fill","black").attr("text-anchor","start")),p.append("g").attr("transform",`translate(0,${e})`).call(M(o).ticks(0)).call(s=>s.select(".domain").remove()),p.append("g").attr("transform",`translate(${d},0)`).call(H(m).tickSizeOuter(0))}}},Y={id:"school-comparison-chart-container"};function G(t,n,e,i,h,d){return g(),C("div",Y)}const J=y(F,[["render",G]]);const K={name:"School-Admin-Dashboard",setup(){const t=P(),n=k(),e=j();return{userDetailsStore:t,analyticsStore:n,usersStore:e}},data(){return{showSidebar:!0,screenWidth:screen.width,isEveryone:!0,isSchoolData:!1,isLanguageData:!1,isMathData:!1,isHistoryData:!1,isLifeData:!1,isCSData:!1,isSAndIData:!1,isDIData:!1,progressData:{school:[]},isAboveTheCurve:!1}},components:{SchoolProgressChart:z,SchoolComparisonChart:J},async created(){await this.analyticsStore.getSchoolProgress(this.userDetailsStore.tenantId),this.analyticsStore.rootSubjectsPassedAssessments.length==0&&await this.getPassedAssessmentsBySubject(),await this.usersStore.getInstructorsByTenant(this.userDetailsStore.tenantId),await this.usersStore.getStudentsPerTenant(this.userDetailsStore.tenantId),await this.HandleProgressData()},methods:{async HandleProgressData(){this.progressData.school=[];for(let t=0;t<this.analyticsStore.progress.tenant.length;t++)this.progressData.school.push(this.analyticsStore.progress.tenant[t]);this.$nextTick(()=>{this.$refs.progressChart&&this.$refs.progressChart.createChart(this.progressData)})},async getPassedAssessmentsBySubject(){try{const t=await fetch(`/student-analytics/passed-assessments-by-subject/tenant/${this.userDetailsStore.tenantId}`);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);this.analyticsStore.rootSubjectsPassedAssessments=await t.json(),console.log(this.analyticsStore.rootSubjectsPassedAssessments),this.$nextTick(()=>{this.$refs.comparisonChart&&(console.log("Creating comparison chart"),this.$refs.comparisonChart.createChart(this.analyticsStore.rootSubjectsPassedAssessments))})}catch(t){console.error("Error fetching cohort mastered assessments:",t),this.analyticsStore.rootSubjectsPassedAssessments=[]}},toggleSidebar(){this.showSidebar=!this.showSidebar}}},f=t=>(I("data-v-fc929b43"),t=t(),T(),t),Q={class:"dashboard"},X={class:"content container"},Z=B('<div class="row top-row" data-v-fc929b43><div class="col-md text-center" data-v-fc929b43><h2 class="h5 heading m-0" data-v-fc929b43>Avg # Skills Mastered</h2><span class="top-row-text" data-v-fc929b43>10</span></div><div class="col-md text-center" data-v-fc929b43><h2 class="h5 heading m-0" data-v-fc929b43>Students</h2><span class="top-row-text" data-v-fc929b43>35</span></div><div class="col-md text-center" data-v-fc929b43><h2 class="h5 heading m-0" data-v-fc929b43>Teachers</h2><span class="top-row-text" data-v-fc929b43>5</span></div><div class="col-md text-center" data-v-fc929b43><h2 class="h5 heading m-0" data-v-fc929b43>AI Tutor Usage</h2><span class="top-row-text" data-v-fc929b43>$500</span></div></div>',1),tt={class:"dash-row row"},st={id:"progress-chart-container",class:"col-md position-relative"},at=f(()=>r("h2",{class:"heading h5"},"Student progress",-1)),et={class:"col-md"},ot=f(()=>r("h2",{class:"heading chart-heading h5"},"Subject comparison",-1)),rt={class:"dash-row row mt-2"},nt={class:"col-md position-relative"},it=f(()=>r("h2",{class:"heading h5"},"Cost By Subject",-1)),ct={class:"col-md position-relative"},ht=f(()=>r("h2",{class:"heading h5"},"Student Engagement",-1));function dt(t,n,e,i,h,d){const c=S("RouterLink"),l=S("SchoolProgressChart"),o=S("SchoolComparisonChart");return g(),C("div",Q,[r("div",X,[Z,r("div",tt,[r("div",st,[v(c,{to:"/reports/academics",class:"me-2 position-absolute chart-heading"},{default:b(()=>[at]),_:1}),h.progressData.school.length>0?(g(),x(l,{key:0,ref:"progressChart"},null,512)):w("",!0)]),r("div",et,[ot,i.analyticsStore.rootSubjectsPassedAssessments.length>0?(g(),x(o,{key:0,ref:"comparisonChart"},null,512)):w("",!0)])]),r("div",rt,[r("div",nt,[v(c,{to:"/reports/cost",class:"me-2 position-absolute chart-heading"},{default:b(()=>[it]),_:1})]),r("div",ct,[v(c,{to:"/reports/engagement",class:"position-absolute chart-heading"},{default:b(()=>[ht]),_:1})])])])])}const Ct=y(K,[["render",dt],["__scopeId","data-v-fc929b43"]]);export{Ct as default};
