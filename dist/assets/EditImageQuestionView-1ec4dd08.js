import{_,f as q,r as v,o as n,c as r,a as e,w as m,C as c,b as u,y as f,k as b,F as p,E as g}from"./main-85e56c1f.js";import{S as k}from"./SkillTimeTracker-00b864d0.js";const w={setup(){return{userDetailsStore:q()}},data(){return{questionId:this.$route.params.questionId,question:{},validate:{validated:!1,name:!1,question:!1},comment:"",originalQuestion:{},skillId:null}},components:{SkillTimeTracker:k},async created(){const t=await(await fetch("/questions/image/"+this.questionId+"/get-skill-id/")).json();this.skillId=t.skillId,this.getQuestion()},beforeRouteLeave(s,t,a){this.$refs.skillTimeTracker.saveDuration(),a()},methods:{getQuestion(){fetch("/questions/image/show/"+this.questionId).then(function(s){return s.json()}).then(s=>{this.question=s,this.originalQuestion={...s}})},Submit(){const s={method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:this.question.name,question:this.question.question,num_images_required:this.question.num_images_required})};var t="/questions/image/"+this.questionId+"/edit";fetch(t,s).then(()=>{let a=this.$route.query.dismissFlagId;a?fetch("/content-flags/"+a,{method:"DELETE"}).finally(()=>{this.$router.back()}):this.$router.back()})},SubmitForReview(){const s={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:this.userDetailsStore.userId,name:this.question.name,question:this.question.question,num_images_required:this.question.num_images_required,comment:this.comment})};var t="/questions/image/"+this.questionId+"/edit-for-review";fetch(t,s).then(()=>{alert(`This edit is being submitted for review.
We do this to prevent misinformation and sloppy wording from being added. If you would like to become an editor and help with this, please reach out.`),this.$router.back()})},ValidateForm(s){this.validate.validated=!1,(this.question.name===""||this.question.name===null)&&(this.validate.name=!0,this.validate.validated=!0),(this.question.question===""||this.question.question===null)&&(this.validate.question=!0,this.validate.validated=!0),!this.validate.validated&&(s=="submission"?this.Submit():s=="submissionForReview"&&this.SubmitForReview())}},computed:{isFormChanged(){return this.question.name!==this.originalQuestion.name||this.question.question!==this.originalQuestion.question||this.comment!=""}}},S={class:"container p-3 bg-light rounded"},y=e("h1",{class:"heading"},"Edit Question",-1),I={class:"container-fluid mt-4"},T={class:"row p-0"},V={id:"form-container",class:"col p-4"},F={class:"mb-3"},D=e("label",{class:"form-label"},"Name",-1),x={key:0,class:"form-validate"},C={class:"mb-3"},Q=e("label",{class:"form-label"},"Question",-1),E={key:0,class:"form-validate"},L={class:"mb-3"},N=e("label",{class:"form-label"},"Number of Images Required ",-1),M=g('<option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option>',5),O=[M],R={key:0,class:"mb-3"},U=e("label",{class:"form-label"},"Optional: explain this edit",-1),j={class:"mb-3 d-flex justify-content-end"},B=["disabled"],z=["disabled"],H=e("div",{class:"d-none d-md-block"}," Submit for review ",-1),J=e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",fill:"white",height:"20",width:"20",class:"d-md-none"},[e("path",{d:"M441 58.9L453.1 71c9.4 9.4 9.4 24.6 0 33.9L424 134.1 377.9 88 407 58.9c9.4-9.4 24.6-9.4 33.9 0zM209.8 256.2L344 121.9 390.1 168 255.8 302.2c-2.9 2.9-6.5 5-10.4 6.1l-58.5 16.7 16.7-58.5c1.1-3.9 3.2-7.5 6.1-10.4zM373.1 25L175.8 222.2c-8.7 8.7-15 19.4-18.3 31.1l-28.6 100c-2.4 8.4-.1 17.4 6.1 23.6s15.2 8.5 23.6 6.1l100-28.6c11.8-3.4 22.5-9.7 31.1-18.3L487 138.9c28.1-28.1 28.1-73.7 0-101.8L474.9 25C446.8-3.1 401.2-3.1 373.1 25zM88 64C39.4 64 0 103.4 0 152V424c0 48.6 39.4 88 88 88H360c48.6 0 88-39.4 88-88V312c0-13.3-10.7-24-24-24s-24 10.7-24 24V424c0 22.1-17.9 40-40 40H88c-22.1 0-40-17.9-40-40V152c0-22.1 17.9-40 40-40H200c13.3 0 24-10.7 24-24s-10.7-24-24-24H88z"})],-1),P=[H,J];function W(s,t,a,l,i,d){const h=v("SkillTimeTracker");return n(),r(p,null,[e("div",S,[y,e("div",I,[e("div",T,[e("div",V,[e("div",F,[D,m(e("input",{"onUpdate:modelValue":t[0]||(t[0]=o=>i.question.name=o),type:"text",class:"form-control"},null,512),[[c,i.question.name]]),i.validate.name&&(i.question.name===""||i.question.name===null)?(n(),r("div",x," please enter a question name ! ")):u("",!0)]),e("div",C,[Q,m(e("textarea",{"onUpdate:modelValue":t[1]||(t[1]=o=>i.question.question=o),rows:"3",class:"form-control"},`
                        `,512),[[c,i.question.question]]),i.validate.question&&(i.question.question===""||i.question.question===null)?(n(),r("div",E," please enter question content ! ")):u("",!0)]),e("div",L,[N,m(e("select",{class:"form-control","onUpdate:modelValue":t[2]||(t[2]=o=>i.question.num_images_required=o)},O,512),[[f,i.question.num_images_required]])]),l.userDetailsStore.role=="instructor"||l.userDetailsStore.role=="student"?(n(),r("div",R,[U,m(e("textarea",{"onUpdate:modelValue":t[3]||(t[3]=o=>i.comment=o),class:"form-control",rows:"3"},null,512),[[c,i.comment]])])):u("",!0),e("div",j,[l.userDetailsStore.role=="platform_admin"||l.userDetailsStore.role=="editor"?(n(),r("button",{key:0,onClick:t[4]||(t[4]=o=>d.ValidateForm("submission")),class:"btn primary-btn",disabled:!d.isFormChanged}," Submit ",8,B)):l.userDetailsStore.role=="instructor"||l.userDetailsStore.role=="student"?(n(),r("button",{key:1,class:"btn primary-btn",onClick:t[5]||(t[5]=o=>d.ValidateForm("submissionForReview")),disabled:!d.isFormChanged},P,8,z)):u("",!0)])])])])]),i.skillId?(n(),b(h,{key:0,ref:"skillTimeTracker"},null,512)):u("",!0)],64)}const K=_(w,[["render",W]]);export{K as default};
