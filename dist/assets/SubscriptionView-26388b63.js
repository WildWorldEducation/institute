import{_ as p,f as y,L as g,i as _,o as r,c as l,a as t,q as m,t as u,s as b,b as h,p as S,d as T}from"./main-febb8869.js";const f={setup(){const s=y(),e=g(),a=_();return{userDetailsStore:s,settingsStore:e,sessionDetailsStore:a}},data(){return{monthlyTokenUsage:null,year:0,month:"",isAITokenLimitReached:!1,isMobileCheck:window.innerWidth,showTooltip:!1,subscription:{}}},async created(){this.settingsStore.freePlanTokenLimit||await this.settingsStore.getSettings(),await this.userDetailsStore.getUserDetails(),await this.getSubscription()},async mounted(){let s=document.createElement("script");s.setAttribute("src","https://js.stripe.com/v3/"),document.head.appendChild(s),this.userDetailsStore.subscriptionTier=="free"?this.settingsStore.freePlanTokenLimit&&this.userDetailsStore.monthlyTokenUsage&&this.settingsStore.freePlanTokenLimit<=this.userDetailsStore.monthlyTokenUsage&&(this.isAITokenLimitReached=!0):this.userDetailsStore.subscriptionTier=="basic"&&this.settingsStore.basicPlanTokenLimit&&this.userDetailsStore.monthlyTokenUsage&&this.settingsStore.basicPlanTokenLimit<=this.userDetailsStore.monthlyTokenUsage&&(this.isAITokenLimitReached=!0),this.year=new Date().getFullYear();const e=["January","February","March","April","May","June","July","August","September","October","November","December"],a=new Date;this.month=e[a.getMonth()]},computed:{formattedStripeDate(){let s=new Date(this.subscription.current_period_end*1e3);const e=s.getUTCMonth()+1,a=s.getUTCDate();return s.getUTCFullYear()+"/"+e+"/"+a},formattedMonthlyTokenUsage(){return this.userDetailsStore.monthlyTokenUsage?this.userDetailsStore.monthlyTokenUsage.toLocaleString():"0"},formattedFreePlanTokenLimit(){return this.settingsStore.freePlanTokenLimit?this.settingsStore.freePlanTokenLimit.toLocaleString():"0"},formattedBasicPlanTokenLimit(){return this.settingsStore.basicPlanTokenLimit?this.settingsStore.basicPlanTokenLimit.toLocaleString():"0"},subscriptionTierFormatted(){return this.userDetailsStore.subscriptionTier?this.userDetailsStore.subscriptionTier.toLocaleString():"free"}},methods:{async getSubscription(){const e=await(await fetch("/subscriptions/subscription-id/"+this.userDetailsStore.userId)).json();this.subscription=e.subscription},checkout(s){fetch("/subscriptions/create-checkout-session",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:this.userDetailsStore.userId,planType:s})}).then(e=>e.ok?e.json():e.json().then(a=>Promise.reject(a))).then(({url:e})=>{window.location=e}).catch(e=>{console.error(e.error)})},loadPortal(){fetch("/subscriptions/create-customer-portal-session",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:this.userDetailsStore.userId})}).then(s=>s.ok?s.json():s.json().then(e=>Promise.reject(e))).then(({url:s})=>{window.location=s}).catch(s=>{console.error(s.error)})},cancelPlan(){if(confirm("Are you sure you want to downgrade to the Free plan?"))fetch("/subscriptions/cancel",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:this.userDetailsStore.userId})}).then(()=>{this.getSubscription()});else return},openTooltip(){this.showTooltip=!0},closeTooltip(){this.showTooltip=!1}}},i=s=>(S("data-v-1e7b01c9"),s=s(),T(),s),k={class:"container"},D={class:"d-flex justify-content-end w-100"},w=i(()=>t("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 192 512",width:"20",height:"20",class:"primary-icon"},[t("path",{d:"M48 80a48 48 0 1 1 96 0A48 48 0 1 1 48 80zM0 224c0-17.7 14.3-32 32-32l64 0c17.7 0 32 14.3 32 32l0 224 32 0c17.7 0 32 14.3 32 32s-14.3 32-32 32L32 512c-17.7 0-32-14.3-32-32s14.3-32 32-32l32 0 0-192-32 0c-17.7 0-32-14.3-32-32z"})],-1)),v=[w],C={class:"row mt-4"},L={class:"col-md mb-3"},I=i(()=>t("strong",null,"Your subscription tier:",-1)),P=i(()=>t("strong",null,"Current token usage:",-1)),M={key:0,class:"alert alert-warning",role:"alert"},j={key:1,class:"alert alert-warning",role:"alert"},U={key:0,class:"modal"},x={class:"modal-content"},A=i(()=>t("p",null," It is against our policy to share accounts and each account is meant to only be used by one user. ",-1)),F=i(()=>t("hr",null,null,-1)),O={class:"row mt-4"},B=i(()=>t("h2",{class:"secondary-heading h4"},"Free",-1)),N=i(()=>t("strong",null,"Token limit:",-1)),J={key:0,disabled:"",class:"btn primary-btn mt-2"},Y=i(()=>t("h2",{class:"secondary-heading h4"},"Basic",-1)),R=i(()=>t("p",null,"Ideal for moderate use",-1)),V=i(()=>t("p",null,"$20 / month",-1)),z=i(()=>t("strong",null,"Token limit:",-1)),E={key:1,disabled:"",class:"btn primary-btn mt-1 mb-3"},q=i(()=>t("h2",{class:"secondary-heading h4"},"Infinite",-1)),W=i(()=>t("p",null,"Ideal for daily use",-1)),G=i(()=>t("p",null,"$100 / month",-1)),H=i(()=>t("p",null,[t("strong",null,"Token limit:"),b(" Infinite ")],-1)),K={key:1,disabled:"",class:"btn primary-btn mt-1"};function Q(s,e,a,d,o,n){return r(),l("div",k,[t("div",D,[t("button",{class:"btn mb-2",onClick:e[0]||(e[0]=(...c)=>n.openTooltip&&n.openTooltip(...c))},v)]),t("div",C,[t("div",L,[t("h2",{class:m(["secondary-heading h4 mb-4",{"text-center":o.isMobileCheck<576}])}," Monthly AI usage: "+u(o.month)+" "+u(o.year),3),t("ul",null,[t("li",null,[t("p",null,[I,b(" "+u(n.subscriptionTierFormatted),1)])]),t("li",null,[t("p",null,[P,b(" "+u(n.formattedMonthlyTokenUsage),1)])])]),o.isAITokenLimitReached?(r(),l("div",M," You are over the monthly free limit. You can't use the AI features until next month. ")):h("",!0),o.subscription&&o.subscription.cancel_at_period_end?(r(),l("div",j," Your plan will downgrade to the Free plan on "+u(n.formattedStripeDate),1)):h("",!0)]),o.showTooltip?(r(),l("div",U,[t("div",x,[t("div",null,[A,t("button",{class:"btn primary-btn",onClick:e[1]||(e[1]=(...c)=>n.closeTooltip&&n.closeTooltip(...c))}," Close ")])])])):h("",!0),t("div",{class:m(["col-md mb-3 d-flex",o.isMobileCheck>576?"justify-content-end":"justify-content-center"])},[d.userDetailsStore.subscriptionTier!="free"?(r(),l("button",{key:0,class:"btn primary-btn",onClick:e[2]||(e[2]=c=>n.loadPortal())}," Manage billing ")):h("",!0)],2)]),F,t("div",O,[t("div",{class:m(["col-md mb-3",{"text-center":o.isMobileCheck<576}])},[B,t("p",null,[N,b(" "+u(n.formattedFreePlanTokenLimit),1)]),d.userDetailsStore.subscriptionTier=="free"?(r(),l("button",J," current plan ")):o.subscription.cancel_at_period_end==!1?(r(),l("button",{key:1,onClick:e[3]||(e[3]=c=>n.cancelPlan()),class:"btn primary-btn mt-1 mb-3"}," downgrade ")):h("",!0)],2),t("div",{class:m(["col-md mb-3",{"text-center":o.isMobileCheck<576}])},[Y,R,V,t("p",null,[z,b(" "+u(n.formattedBasicPlanTokenLimit),1)]),d.userDetailsStore.subscriptionTier=="free"?(r(),l("button",{key:0,onClick:e[4]||(e[4]=c=>n.checkout("basic")),class:"btn primary-btn mt-2"}," buy ")):this.userDetailsStore.subscriptionTier=="basic"?(r(),l("button",E," current plan ")):h("",!0)],2),t("div",{class:m(["col-md mb-3",{"text-center":o.isMobileCheck<576}])},[q,W,G,H,d.userDetailsStore.subscriptionTier=="free"?(r(),l("button",{key:0,onClick:e[5]||(e[5]=c=>n.checkout("infinite")),class:"btn primary-btn mt-2"}," buy ")):this.userDetailsStore.subscriptionTier=="infinite"?(r(),l("button",K," current plan ")):h("",!0)],2)])])}const Z=p(f,[["render",Q],["__scopeId","data-v-1e7b01c9"]]);export{Z as default};
